var ml=Object.defineProperty,gl=Object.defineProperties;var _l=Object.getOwnPropertyDescriptors;var ys=Object.getOwnPropertySymbols,vl=Object.getPrototypeOf,qa=Object.prototype.hasOwnProperty,Za=Object.prototype.propertyIsEnumerable,xl=Reflect.get;var xi=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),zs=t=>{throw TypeError(t)},Vs=Math.pow,Hs=(t,e,r)=>e in t?ml(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Er=(t,e)=>{for(var r in e||(e={}))qa.call(e,r)&&Hs(t,r,e[r]);if(ys)for(var r of ys(e))Za.call(e,r)&&Hs(t,r,e[r]);return t},Br=(t,e)=>gl(t,_l(e));var Jn=(t,e)=>{var r={};for(var n in t)qa.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&ys)for(var n of ys(t))e.indexOf(n)<0&&Za.call(t,n)&&(r[n]=t[n]);return r};var Hr=(t,e,r)=>Hs(t,typeof e!="symbol"?e+"":e,r),$s=(t,e,r)=>e.has(t)||zs("Cannot "+r);var de=(t,e,r)=>($s(t,e,"read from private field"),r?r.call(t):e.get(t)),ct=(t,e,r)=>e.has(t)?zs("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),ft=(t,e,r,n)=>($s(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r),Qe=(t,e,r)=>($s(t,e,"access private method"),r);var Xi=(t,e,r,n)=>({set _(i){ft(t,e,i,r)},get _(){return de(t,e,n)}}),Qn=(t,e,r)=>xl(vl(t),r,e);var Ye=(t,e,r)=>new Promise((n,i)=>{var s=c=>{try{o(r.next(c))}catch(u){i(u)}},a=c=>{try{o(r.throw(c))}catch(u){i(u)}},o=c=>c.done?n(c.value):Promise.resolve(c.value).then(s,a);o((r=r.apply(t,e)).next())}),ei=function(t,e){this[0]=t,this[1]=e},Gs=(t,e,r)=>{var n=(a,o,c,u)=>{try{var h=r[a](o),f=(o=h.value)instanceof ei,m=h.done;Promise.resolve(f?o[0]:o).then(E=>f?n(a==="return"?a:"next",o[1]?{done:E.done,value:E.value}:E,c,u):c({value:E,done:m})).catch(E=>n("throw",E,c,u))}catch(E){u(E)}},i=a=>s[a]=o=>new Promise((c,u)=>n(a,o,c,u)),s={};return r=r.apply(t,e),s[xi("asyncIterator")]=()=>s,i("next"),i("throw"),i("return"),s},Xs=t=>{var e=t[xi("asyncIterator")],r=!1,n,i={};return e==null?(e=t[xi("iterator")](),n=s=>i[s]=a=>e[s](a)):(e=e.call(t),n=s=>i[s]=a=>{if(r){if(r=!1,s==="throw")throw a;return a}return r=!0,{done:!1,value:new ei(new Promise(o=>{var c=e[s](a);c instanceof Object||zs("Object expected"),o(c)}),1)}}),i[xi("iterator")]=()=>i,n("next"),"throw"in e?n("throw"):i.throw=s=>{throw s},"return"in e&&n("return"),i},Ja=(t,e,r)=>(e=t[xi("asyncIterator")])?e.call(t):(t=t[xi("iterator")](),e={},r=(n,i)=>(i=t[n])&&(e[n]=s=>new Promise((a,o,c)=>(s=i.call(t,s),c=s.done,Promise.resolve(s.value).then(u=>a({value:u,done:c}),o)))),r("next"),r("return"),e);import{r as reactExports,u as useTheme,j as jsxRuntimeExports,B as Box,C as Container,T as Typography,A as Accordion,a as AccordionSummary,b as AccordionDetails,d as Button,D as Dialog,e as Chip,f as Divider,G as Grid,g as Card,h as CardContent,i as CardMedia,L as Link$1,k as DialogTitle,l as DialogContent,R as React,m as clsx,M as Modal,I as IconButton,F as FormControl,S as Select,n as MenuItem,o as Table,p as TableBody,q as TableRow,s as TableCell,t as Collapse,v as Checkbox,w as TextField,x as TableContainer,P as Paper,y as TableHead,z as BottomNavigation,E as BottomNavigationAction,H as List,J as ListItem,K as ListItemText,N as useMediaQuery,O as Drawer,Q as Tabs,U as Tab,V as Backdrop,W as CircularProgress,X as AppBar,Y as Menu,Z as InputAdornment,_ as ListItemButton,$ as FormControlLabel,a0 as Tooltip,a1 as Fab}from"./mui-core-BTeM3N7B.js";import{a as requireReactDom,c as commonjsGlobal$2,r as requireReact,b as getAugmentedNamespace,g as getDefaultExportFromCjs}from"./react-vendor-DofT-e_A.js";import{E as ExpandMoreIcon,a as EngineeringIcon,D as DesignServicesIcon,B as BuildIcon,S as SettingsIcon,M as ManageAccountsIcon,P as PrecisionManufacturingIcon,b as BoltIcon,G as GroupsIcon,V as VibrationIcon,c as SearchIcon,d as EvStationIcon,A as AgricultureIcon,e as GpsFixedIcon,C as CloseIcon,f as CancelIcon,g as SaveIcon,h as ExpandLessIcon,i as ArrowUpwardIcon,j as ArrowDownwardIcon,k as ContentCopyIcon,l as DeleteIcon,m as CloudUploadIcon,n as CloudDownloadIcon,o as MapIcon,p as CalculateIcon,q as MoreVertIcon,T as TuneIcon,r as PictureAsPdfIcon,s as PlayCircleFilledIcon,H as HomeIcon,F as FilterAltIcon,t as ArrowDropDownIcon,u as ArrowRightIcon,v as DescriptionIcon,w as ContactMailIcon,x as GavelIcon,y as PolicyIcon,I as InfoIcon,z as HelpOutlineIcon,J as PersonOutlineIcon,K as VisibilityIcon,L as VisibilityOffIcon,N as ArrowRightIcon$1,W as WhatsAppIcon}from"./mui-icons-5EMVw0ny.js";import{c as commonjsRequire,r as require$$6}from"./pdf-js-BBijSJyh.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var client={},hasRequiredClient;function requireClient(){if(hasRequiredClient)return client;hasRequiredClient=1;var t=requireReactDom();return client.createRoot=t.createRoot,client.hydrateRoot=t.hydrateRoot,client}var clientExports=requireClient(),dist={},hasRequiredDist;function requireDist(){if(hasRequiredDist)return dist;hasRequiredDist=1,Object.defineProperty(dist,"__esModule",{value:!0}),dist.parse=a,dist.serialize=u;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,r=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,i=Object.prototype.toString,s=(()=>{const m=function(){};return m.prototype=Object.create(null),m})();function a(m,E){const g=new s,p=m.length;if(p<2)return g;const _=(E==null?void 0:E.decode)||h;let A=0;do{const H=m.indexOf("=",A);if(H===-1)break;const te=m.indexOf(";",A),ne=te===-1?p:te;if(H>ne){A=m.lastIndexOf(";",H-1)+1;continue}const j=o(m,A,H),ee=c(m,H,j),x=m.slice(j,ee);if(g[x]===void 0){let M=o(m,H+1,ne),T=c(m,ne,M);const O=_(m.slice(M,T));g[x]=O}A=ne+1}while(A<p);return g}function o(m,E,g){do{const p=m.charCodeAt(E);if(p!==32&&p!==9)return E}while(++E<g);return g}function c(m,E,g){for(;E>g;){const p=m.charCodeAt(--E);if(p!==32&&p!==9)return E+1}return g}function u(m,E,g){const p=(g==null?void 0:g.encode)||encodeURIComponent;if(!t.test(m))throw new TypeError(`argument name is invalid: ${m}`);const _=p(E);if(!e.test(_))throw new TypeError(`argument val is invalid: ${E}`);let A=m+"="+_;if(!g)return A;if(g.maxAge!==void 0){if(!Number.isInteger(g.maxAge))throw new TypeError(`option maxAge is invalid: ${g.maxAge}`);A+="; Max-Age="+g.maxAge}if(g.domain){if(!r.test(g.domain))throw new TypeError(`option domain is invalid: ${g.domain}`);A+="; Domain="+g.domain}if(g.path){if(!n.test(g.path))throw new TypeError(`option path is invalid: ${g.path}`);A+="; Path="+g.path}if(g.expires){if(!f(g.expires)||!Number.isFinite(g.expires.valueOf()))throw new TypeError(`option expires is invalid: ${g.expires}`);A+="; Expires="+g.expires.toUTCString()}if(g.httpOnly&&(A+="; HttpOnly"),g.secure&&(A+="; Secure"),g.partitioned&&(A+="; Partitioned"),g.priority)switch(typeof g.priority=="string"?g.priority.toLowerCase():void 0){case"low":A+="; Priority=Low";break;case"medium":A+="; Priority=Medium";break;case"high":A+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${g.priority}`)}if(g.sameSite)switch(typeof g.sameSite=="string"?g.sameSite.toLowerCase():g.sameSite){case!0:case"strict":A+="; SameSite=Strict";break;case"lax":A+="; SameSite=Lax";break;case"none":A+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${g.sameSite}`)}return A}function h(m){if(m.indexOf("%")===-1)return m;try{return decodeURIComponent(m)}catch(E){return m}}function f(m){return i.call(m)==="[object Date]"}return dist}requireDist();/**
 * react-router v7.2.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var PopStateEventType="popstate";function createHashHistory(t={}){function e(i,s){let{pathname:a="/",search:o="",hash:c=""}=parsePath(i.location.hash.substring(1));return!a.startsWith("/")&&!a.startsWith(".")&&(a="/"+a),createLocation("",{pathname:a,search:o,hash:c},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(i,s){let a=i.document.querySelector("base"),o="";if(a&&a.getAttribute("href")){let c=i.location.href,u=c.indexOf("#");o=u===-1?c:c.slice(0,u)}return o+"#"+(typeof s=="string"?s:createPath(s))}function n(i,s){warning(i.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(s)})`)}return getUrlBasedHistory(e,r,n,t)}function invariant(t,e){if(t===!1||t===null||typeof t=="undefined")throw new Error(e)}function warning(t,e){if(!t){typeof console!="undefined"&&console.warn(e);try{throw new Error(e)}catch(r){}}}function createKey(){return Math.random().toString(36).substring(2,10)}function getHistoryState(t,e){return{usr:t.state,key:t.key,idx:e}}function createLocation(t,e,r=null,n){return Br(Er({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?parsePath(e):e),{state:r,key:e&&e.key||n||createKey()})}function createPath({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function parsePath(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function getUrlBasedHistory(t,e,r,n={}){let{window:i=document.defaultView,v5Compat:s=!1}=n,a=i.history,o="POP",c=null,u=h();u==null&&(u=0,a.replaceState(Br(Er({},a.state),{idx:u}),""));function h(){return(a.state||{idx:null}).idx}function f(){o="POP";let _=h(),A=_==null?null:_-u;u=_,c&&c({action:o,location:p.location,delta:A})}function m(_,A){o="PUSH";let H=createLocation(p.location,_,A);r&&r(H,_),u=h()+1;let te=getHistoryState(H,u),ne=p.createHref(H);try{a.pushState(te,"",ne)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;i.location.assign(ne)}s&&c&&c({action:o,location:p.location,delta:1})}function E(_,A){o="REPLACE";let H=createLocation(p.location,_,A);r&&r(H,_),u=h();let te=getHistoryState(H,u),ne=p.createHref(H);a.replaceState(te,"",ne),s&&c&&c({action:o,location:p.location,delta:0})}function g(_){let A=i.location.origin!=="null"?i.location.origin:i.location.href,H=typeof _=="string"?_:createPath(_);return H=H.replace(/ $/,"%20"),invariant(A,`No window.location.(origin|href) available to create URL for href: ${H}`),new URL(H,A)}let p={get action(){return o},get location(){return t(i,a)},listen(_){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(PopStateEventType,f),c=_,()=>{i.removeEventListener(PopStateEventType,f),c=null}},createHref(_){return e(i,_)},createURL:g,encodeLocation(_){let A=g(_);return{pathname:A.pathname,search:A.search,hash:A.hash}},push:m,replace:E,go(_){return a.go(_)}};return p}function matchRoutes(t,e,r="/"){return matchRoutesImpl(t,e,r,!1)}function matchRoutesImpl(t,e,r,n){let i=typeof e=="string"?parsePath(e):e,s=stripBasename(i.pathname||"/",r);if(s==null)return null;let a=flattenRoutes(t);rankRouteBranches(a);let o=null;for(let c=0;o==null&&c<a.length;++c){let u=decodePath$1(s);o=matchRouteBranch(a[c],u,n)}return o}function flattenRoutes(t,e=[],r=[],n=""){let i=(s,a,o)=>{let c={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};c.relativePath.startsWith("/")&&(invariant(c.relativePath.startsWith(n),`Absolute route path "${c.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(n.length));let u=joinPaths([n,c.relativePath]),h=r.concat(c);s.children&&s.children.length>0&&(invariant(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),flattenRoutes(s.children,e,h,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:computeScore(u,s.index),routesMeta:h})};return t.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,a);else for(let c of explodeOptionalSegments(s.path))i(s,a,c)}),e}function explodeOptionalSegments(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let a=explodeOptionalSegments(n.join("/")),o=[];return o.push(...a.map(c=>c===""?s:[s,c].join("/"))),i&&o.push(...a),o.map(c=>t.startsWith("/")&&c===""?"/":c)}function rankRouteBranches(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:compareIndexes(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=t=>t==="*";function computeScore(t,e){let r=t.split("/"),n=r.length;return r.some(isSplat)&&(n+=splatPenalty),e&&(n+=indexRouteValue),r.filter(i=>!isSplat(i)).reduce((i,s)=>i+(paramRe.test(s)?dynamicSegmentValue:s===""?emptySegmentValue:staticSegmentValue),n)}function compareIndexes(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function matchRouteBranch(t,e,r=!1){let{routesMeta:n}=t,i={},s="/",a=[];for(let o=0;o<n.length;++o){let c=n[o],u=o===n.length-1,h=s==="/"?e:e.slice(s.length)||"/",f=matchPath({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},h),m=c.route;if(!f&&u&&r&&!n[n.length-1].route.index&&(f=matchPath({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},h)),!f)return null;Object.assign(i,f.params),a.push({params:i,pathname:joinPaths([s,f.pathname]),pathnameBase:normalizePathname(joinPaths([s,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(s=joinPaths([s,f.pathnameBase]))}return a}function matchPath(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=compilePath(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce((u,{paramName:h,isOptional:f},m)=>{if(h==="*"){let g=o[m]||"";a=s.slice(0,s.length-g.length).replace(/(.)\/+$/,"$1")}const E=o[m];return f&&!E?u[h]=void 0:u[h]=(E||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:a,pattern:t}}function compilePath(t,e=!1,r=!0){warning(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function decodePath$1(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return warning(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function stripBasename(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function resolvePath(t,e="/"){let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?parsePath(t):t;return{pathname:r?r.startsWith("/")?r:resolvePathname(r,e):e,search:normalizeSearch(n),hash:normalizeHash(i)}}function resolvePathname(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function getInvalidPathError(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function getPathContributingMatches(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function getResolveToMatches(t){let e=getPathContributingMatches(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function resolveTo(t,e,r,n=!1){let i;typeof t=="string"?i=parsePath(t):(i=Er({},t),invariant(!i.pathname||!i.pathname.includes("?"),getInvalidPathError("?","pathname","search",i)),invariant(!i.pathname||!i.pathname.includes("#"),getInvalidPathError("#","pathname","hash",i)),invariant(!i.search||!i.search.includes("#"),getInvalidPathError("#","search","hash",i)));let s=t===""||i.pathname==="",a=s?"/":i.pathname,o;if(a==null)o=r;else{let f=e.length-1;if(!n&&a.startsWith("..")){let m=a.split("/");for(;m[0]==="..";)m.shift(),f-=1;i.pathname=m.join("/")}o=f>=0?e[f]:"/"}let c=resolvePath(i,o),u=a&&a!=="/"&&a.endsWith("/"),h=(s||a===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||h)&&(c.pathname+="/"),c}var joinPaths=t=>t.join("/").replace(/\/\/+/g,"/"),normalizePathname=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,normalizeHash=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function isRouteErrorResponse(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var validMutationMethodsArr=["POST","PUT","PATCH","DELETE"];new Set(validMutationMethodsArr);var validRequestMethodsArr=["GET",...validMutationMethodsArr];new Set(validRequestMethodsArr);var DataRouterContext=reactExports.createContext(null);DataRouterContext.displayName="DataRouter";var DataRouterStateContext=reactExports.createContext(null);DataRouterStateContext.displayName="DataRouterState";var ViewTransitionContext=reactExports.createContext({isTransitioning:!1});ViewTransitionContext.displayName="ViewTransition";var FetchersContext=reactExports.createContext(new Map);FetchersContext.displayName="Fetchers";var AwaitContext=reactExports.createContext(null);AwaitContext.displayName="Await";var NavigationContext=reactExports.createContext(null);NavigationContext.displayName="Navigation";var LocationContext=reactExports.createContext(null);LocationContext.displayName="Location";var RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1});RouteContext.displayName="Route";var RouteErrorContext=reactExports.createContext(null);RouteErrorContext.displayName="RouteError";function useHref(t,{relative:e}={}){invariant(useInRouterContext(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=reactExports.useContext(NavigationContext),{hash:i,pathname:s,search:a}=useResolvedPath(t,{relative:e}),o=s;return r!=="/"&&(o=s==="/"?r:joinPaths([r,s])),n.createHref({pathname:o,search:a,hash:i})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return invariant(useInRouterContext(),"useLocation() may be used only in the context of a <Router> component."),reactExports.useContext(LocationContext).location}var navigateEffectWarning="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function useIsomorphicLayoutEffect(t){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(t)}function useNavigate(){let{isDataRoute:t}=reactExports.useContext(RouteContext);return t?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){invariant(useInRouterContext(),"useNavigate() may be used only in the context of a <Router> component.");let t=reactExports.useContext(DataRouterContext),{basename:e,navigator:r}=reactExports.useContext(NavigationContext),{matches:n}=reactExports.useContext(RouteContext),{pathname:i}=useLocation(),s=JSON.stringify(getResolveToMatches(n)),a=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{a.current=!0}),reactExports.useCallback((c,u={})=>{if(warning(a.current,navigateEffectWarning),!a.current)return;if(typeof c=="number"){r.go(c);return}let h=resolveTo(c,JSON.parse(s),i,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:joinPaths([e,h.pathname])),(u.replace?r.replace:r.push)(h,u.state,u)},[e,r,s,i,t])}reactExports.createContext(null);function useResolvedPath(t,{relative:e}={}){let{matches:r}=reactExports.useContext(RouteContext),{pathname:n}=useLocation(),i=JSON.stringify(getResolveToMatches(r));return reactExports.useMemo(()=>resolveTo(t,JSON.parse(i),n,e==="path"),[t,i,n,e])}function useRoutes(t,e){return useRoutesImpl(t,e)}function useRoutesImpl(t,e,r,n){var H;invariant(useInRouterContext(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i,static:s}=reactExports.useContext(NavigationContext),{matches:a}=reactExports.useContext(RouteContext),o=a[a.length-1],c=o?o.params:{},u=o?o.pathname:"/",h=o?o.pathnameBase:"/",f=o&&o.route;{let te=f&&f.path||"";warningOnce(u,!f||te.endsWith("*")||te.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${te}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${te}"> to <Route path="${te==="/"?"*":`${te}/*`}">.`)}let m=useLocation(),E;if(e){let te=typeof e=="string"?parsePath(e):e;invariant(h==="/"||((H=te.pathname)==null?void 0:H.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${te.pathname}" was given in the \`location\` prop.`),E=te}else E=m;let g=E.pathname||"/",p=g;if(h!=="/"){let te=h.replace(/^\//,"").split("/");p="/"+g.replace(/^\//,"").split("/").slice(te.length).join("/")}let _=!s&&r&&r.matches&&r.matches.length>0?r.matches:matchRoutes(t,{pathname:p});warning(f||_!=null,`No routes matched location "${E.pathname}${E.search}${E.hash}" `),warning(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${E.pathname}${E.search}${E.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let A=_renderMatches(_&&_.map(te=>Object.assign({},te,{params:Object.assign({},c,te.params),pathname:joinPaths([h,i.encodeLocation?i.encodeLocation(te.pathname).pathname:te.pathname]),pathnameBase:te.pathnameBase==="/"?h:joinPaths([h,i.encodeLocation?i.encodeLocation(te.pathnameBase).pathname:te.pathnameBase])})),a,r,n);return e&&A?reactExports.createElement(LocationContext.Provider,{value:{location:Er({pathname:"/",search:"",hash:"",state:null,key:"default"},E),navigationType:"POP"}},A):A}function DefaultErrorComponent(){let t=useRouteError(),e=isRouteErrorResponse(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},a=null;return console.error("Error handled by React Router default ErrorBoundary:",t),a=reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("p",null,"ðŸ’¿ Hey developer ðŸ‘‹"),reactExports.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",reactExports.createElement("code",{style:s},"ErrorBoundary")," or"," ",reactExports.createElement("code",{style:s},"errorElement")," prop on your route.")),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},e),r?reactExports.createElement("pre",{style:i},r):null,a)}var defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null),RenderErrorBoundary=class extends reactExports.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function RenderedRoute({routeContext:t,match:e,children:r}){let n=reactExports.useContext(DataRouterContext);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),reactExports.createElement(RouteContext.Provider,{value:t},r)}function _renderMatches(t,e=[],r=null,n=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let i=t,s=r==null?void 0:r.errors;if(s!=null){let c=i.findIndex(u=>u.route.id&&(s==null?void 0:s[u.route.id])!==void 0);invariant(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),i=i.slice(0,Math.min(i.length,c+1))}let a=!1,o=-1;if(r)for(let c=0;c<i.length;c++){let u=i[c];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(o=c),u.route.id){let{loaderData:h,errors:f}=r,m=u.route.loader&&!h.hasOwnProperty(u.route.id)&&(!f||f[u.route.id]===void 0);if(u.route.lazy||m){a=!0,o>=0?i=i.slice(0,o+1):i=[i[0]];break}}}return i.reduceRight((c,u,h)=>{let f,m=!1,E=null,g=null;r&&(f=s&&u.route.id?s[u.route.id]:void 0,E=u.route.errorElement||defaultErrorElement,a&&(o<0&&h===0?(warningOnce("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),m=!0,g=null):o===h&&(m=!0,g=u.route.hydrateFallbackElement||null)));let p=e.concat(i.slice(0,h+1)),_=()=>{let A;return f?A=E:m?A=g:u.route.Component?A=reactExports.createElement(u.route.Component,null):u.route.element?A=u.route.element:A=c,reactExports.createElement(RenderedRoute,{match:u,routeContext:{outlet:c,matches:p,isDataRoute:r!=null},children:A})};return r&&(u.route.ErrorBoundary||u.route.errorElement||h===0)?reactExports.createElement(RenderErrorBoundary,{location:r.location,revalidation:r.revalidation,component:E,error:f,children:_(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):_()},null)}function getDataRouterConsoleError(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext(t){let e=reactExports.useContext(DataRouterContext);return invariant(e,getDataRouterConsoleError(t)),e}function useDataRouterState(t){let e=reactExports.useContext(DataRouterStateContext);return invariant(e,getDataRouterConsoleError(t)),e}function useRouteContext(t){let e=reactExports.useContext(RouteContext);return invariant(e,getDataRouterConsoleError(t)),e}function useCurrentRouteId(t){let e=useRouteContext(t),r=e.matches[e.matches.length-1];return invariant(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function useRouteId(){return useCurrentRouteId("useRouteId")}function useRouteError(){var n;let t=reactExports.useContext(RouteErrorContext),e=useDataRouterState("useRouteError"),r=useCurrentRouteId("useRouteError");return t!==void 0?t:(n=e.errors)==null?void 0:n[r]}function useNavigateStable(){let{router:t}=useDataRouterContext("useNavigate"),e=useCurrentRouteId("useNavigate"),r=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{r.current=!0}),reactExports.useCallback((a,...o)=>Ye(this,[a,...o],function*(i,s={}){warning(r.current,navigateEffectWarning),r.current&&(typeof i=="number"?t.navigate(i):yield t.navigate(i,Er({fromRouteId:e},s)))}),[t,e])}var alreadyWarned={};function warningOnce(t,e,r){!e&&!alreadyWarned[t]&&(alreadyWarned[t]=!0,warning(!1,r))}reactExports.memo(DataRoutes);function DataRoutes({routes:t,future:e,state:r}){return useRoutesImpl(t,void 0,r,e)}function Navigate({to:t,replace:e,state:r,relative:n}){invariant(useInRouterContext(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=reactExports.useContext(NavigationContext);warning(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=reactExports.useContext(RouteContext),{pathname:a}=useLocation(),o=useNavigate(),c=resolveTo(t,getResolveToMatches(s),a,n==="path"),u=JSON.stringify(c);return reactExports.useEffect(()=>{o(JSON.parse(u),{replace:e,state:r,relative:n})},[o,u,n,e,r]),null}function Route(t){invariant(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Router({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:i,static:s=!1}){invariant(!useInRouterContext(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=t.replace(/^\/*/,"/"),o=reactExports.useMemo(()=>({basename:a,navigator:i,static:s,future:{}}),[a,i,s]);typeof r=="string"&&(r=parsePath(r));let{pathname:c="/",search:u="",hash:h="",state:f=null,key:m="default"}=r,E=reactExports.useMemo(()=>{let g=stripBasename(c,a);return g==null?null:{location:{pathname:g,search:u,hash:h,state:f,key:m},navigationType:n}},[a,c,u,h,f,m,n]);return warning(E!=null,`<Router basename="${a}"> is not able to match the URL "${c}${u}${h}" because it does not start with the basename, so the <Router> won't render anything.`),E==null?null:reactExports.createElement(NavigationContext.Provider,{value:o},reactExports.createElement(LocationContext.Provider,{children:e,value:E}))}function Routes({children:t,location:e}){return useRoutes(createRoutesFromChildren(t),e)}function createRoutesFromChildren(t,e=[]){let r=[];return reactExports.Children.forEach(t,(n,i)=>{if(!reactExports.isValidElement(n))return;let s=[...e,i];if(n.type===reactExports.Fragment){r.push.apply(r,createRoutesFromChildren(n.props.children,s));return}invariant(n.type===Route,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),invariant(!n.props.index||!n.props.children,"An index route cannot have child routes.");let a={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=createRoutesFromChildren(n.props.children,s)),r.push(a)}),r}var defaultMethod="get",defaultEncType="application/x-www-form-urlencoded";function isHtmlElement(t){return t!=null&&typeof t.tagName=="string"}function isButtonElement(t){return isHtmlElement(t)&&t.tagName.toLowerCase()==="button"}function isFormElement(t){return isHtmlElement(t)&&t.tagName.toLowerCase()==="form"}function isInputElement(t){return isHtmlElement(t)&&t.tagName.toLowerCase()==="input"}function isModifiedEvent(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function shouldProcessLinkClick(t,e){return t.button===0&&(!e||e==="_self")&&!isModifiedEvent(t)}var _formDataSupportsSubmitter=null;function isFormDataSubmitterSupported(){if(_formDataSupportsSubmitter===null)try{new FormData(document.createElement("form"),0),_formDataSupportsSubmitter=!1}catch(t){_formDataSupportsSubmitter=!0}return _formDataSupportsSubmitter}var supportedFormEncTypes=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function getFormEncType(t){return t!=null&&!supportedFormEncTypes.has(t)?(warning(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${defaultEncType}"`),null):t}function getFormSubmissionInfo(t,e){let r,n,i,s,a;if(isFormElement(t)){let o=t.getAttribute("action");n=o?stripBasename(o,e):null,r=t.getAttribute("method")||defaultMethod,i=getFormEncType(t.getAttribute("enctype"))||defaultEncType,s=new FormData(t)}else if(isButtonElement(t)||isInputElement(t)&&(t.type==="submit"||t.type==="image")){let o=t.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||o.getAttribute("action");if(n=c?stripBasename(c,e):null,r=t.getAttribute("formmethod")||o.getAttribute("method")||defaultMethod,i=getFormEncType(t.getAttribute("formenctype"))||getFormEncType(o.getAttribute("enctype"))||defaultEncType,s=new FormData(o,t),!isFormDataSubmitterSupported()){let{name:u,type:h,value:f}=t;if(h==="image"){let m=u?`${u}.`:"";s.append(`${m}x`,"0"),s.append(`${m}y`,"0")}else u&&s.append(u,f)}}else{if(isHtmlElement(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=defaultMethod,n=null,i=defaultEncType,a=t}return s&&i==="text/plain"&&(a=s,s=void 0),{action:n,method:r.toLowerCase(),encType:i,formData:s,body:a}}function invariant2(t,e){if(t===!1||t===null||typeof t=="undefined")throw new Error(e)}function loadRouteModule(t,e){return Ye(this,null,function*(){if(t.id in e)return e[t.id];try{let r=yield import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}})}function isHtmlLinkDescriptor(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}function getKeyedPrefetchLinks(t,e,r){return Ye(this,null,function*(){let n=yield Promise.all(t.map(i=>Ye(this,null,function*(){let s=e.routes[i.route.id];if(s){let a=yield loadRouteModule(s,r);return a.links?a.links():[]}return[]})));return dedupeLinkDescriptors(n.flat(1).filter(isHtmlLinkDescriptor).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?Br(Er({},i),{rel:"prefetch",as:"style"}):Br(Er({},i),{rel:"prefetch"})))})}function getNewMatchesForLinks(t,e,r,n,i,s){let a=(c,u)=>r[u]?c.route.id!==r[u].route.id:!0,o=(c,u)=>{var h;return r[u].pathname!==c.pathname||((h=r[u].route.path)==null?void 0:h.endsWith("*"))&&r[u].params["*"]!==c.params["*"]};return s==="assets"?e.filter((c,u)=>a(c,u)||o(c,u)):s==="data"?e.filter((c,u)=>{var f;let h=n.routes[c.route.id];if(!h||!h.hasLoader)return!1;if(a(c,u)||o(c,u))return!0;if(c.route.shouldRevalidate){let m=c.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((f=r[0])==null?void 0:f.params)||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function getModuleLinkHrefs(t,e,{includeHydrateFallback:r}={}){return dedupeHrefs(t.map(n=>{let i=e.routes[n.route.id];if(!i)return[];let s=[i.module];return i.clientActionModule&&(s=s.concat(i.clientActionModule)),i.clientLoaderModule&&(s=s.concat(i.clientLoaderModule)),r&&i.hydrateFallbackModule&&(s=s.concat(i.hydrateFallbackModule)),i.imports&&(s=s.concat(i.imports)),s}).flat(1))}function dedupeHrefs(t){return[...new Set(t)]}function sortKeys(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function dedupeLinkDescriptors(t,e){let r=new Set;return new Set(e),t.reduce((n,i)=>{let s=JSON.stringify(sortKeys(i));return r.has(s)||(r.add(s),n.push({key:s,link:i})),n},[])}function singleFetchUrl(t){let e=typeof t=="string"?new URL(t,typeof window=="undefined"?"server://singlefetch/":window.location.origin):t;return e.pathname==="/"?e.pathname="_root.data":e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function useDataRouterContext2(){let t=reactExports.useContext(DataRouterContext);return invariant2(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function useDataRouterStateContext(){let t=reactExports.useContext(DataRouterStateContext);return invariant2(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var FrameworkContext=reactExports.createContext(void 0);FrameworkContext.displayName="FrameworkContext";function useFrameworkContext(){let t=reactExports.useContext(FrameworkContext);return invariant2(t,"You must render this element inside a <HydratedRouter> element"),t}function usePrefetchBehavior(t,e){let r=reactExports.useContext(FrameworkContext),[n,i]=reactExports.useState(!1),[s,a]=reactExports.useState(!1),{onFocus:o,onBlur:c,onMouseEnter:u,onMouseLeave:h,onTouchStart:f}=e,m=reactExports.useRef(null);reactExports.useEffect(()=>{if(t==="render"&&a(!0),t==="viewport"){let p=A=>{A.forEach(H=>{a(H.isIntersecting)})},_=new IntersectionObserver(p,{threshold:.5});return m.current&&_.observe(m.current),()=>{_.disconnect()}}},[t]),reactExports.useEffect(()=>{if(n){let p=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(p)}}},[n]);let E=()=>{i(!0)},g=()=>{i(!1),a(!1)};return r?t!=="intent"?[s,m,{}]:[s,m,{onFocus:composeEventHandlers(o,E),onBlur:composeEventHandlers(c,g),onMouseEnter:composeEventHandlers(u,E),onMouseLeave:composeEventHandlers(h,g),onTouchStart:composeEventHandlers(f,E)}]:[!1,m,{}]}function composeEventHandlers(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function PrefetchPageLinks(r){var n=r,{page:t}=n,e=Jn(n,["page"]);let{router:i}=useDataRouterContext2(),s=reactExports.useMemo(()=>matchRoutes(i.routes,t,i.basename),[i.routes,t,i.basename]);return s?reactExports.createElement(PrefetchPageLinksImpl,Er({page:t,matches:s},e)):null}function useKeyedPrefetchLinks(t){let{manifest:e,routeModules:r}=useFrameworkContext(),[n,i]=reactExports.useState([]);return reactExports.useEffect(()=>{let s=!1;return getKeyedPrefetchLinks(t,e,r).then(a=>{s||i(a)}),()=>{s=!0}},[t,e,r]),n}function PrefetchPageLinksImpl(n){var i=n,{page:t,matches:e}=i,r=Jn(i,["page","matches"]);let s=useLocation(),{manifest:a,routeModules:o}=useFrameworkContext(),{loaderData:c,matches:u}=useDataRouterStateContext(),h=reactExports.useMemo(()=>getNewMatchesForLinks(t,e,u,a,s,"data"),[t,e,u,a,s]),f=reactExports.useMemo(()=>getNewMatchesForLinks(t,e,u,a,s,"assets"),[t,e,u,a,s]),m=reactExports.useMemo(()=>{if(t===s.pathname+s.search+s.hash)return[];let p=new Set,_=!1;if(e.forEach(H=>{var ne;let te=a.routes[H.route.id];!te||!te.hasLoader||(!h.some(j=>j.route.id===H.route.id)&&H.route.id in c&&((ne=o[H.route.id])!=null&&ne.shouldRevalidate)||te.hasClientLoader?_=!0:p.add(H.route.id))}),p.size===0)return[];let A=singleFetchUrl(t);return _&&p.size>0&&A.searchParams.set("_routes",e.filter(H=>p.has(H.route.id)).map(H=>H.route.id).join(",")),[A.pathname+A.search]},[c,s,a,h,e,t,o]),E=reactExports.useMemo(()=>getModuleLinkHrefs(f,a),[f,a]),g=useKeyedPrefetchLinks(f);return reactExports.createElement(reactExports.Fragment,null,m.map(p=>reactExports.createElement("link",Er({key:p,rel:"prefetch",as:"fetch",href:p},r))),E.map(p=>reactExports.createElement("link",Er({key:p,rel:"modulepreload",href:p},r))),g.map(({key:p,link:_})=>reactExports.createElement("link",Er({key:p},_))))}function mergeRefs(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var isBrowser$1=typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined";try{isBrowser$1&&(window.__reactRouterVersion="7.2.0")}catch(t){}function HashRouter({basename:t,children:e,window:r}){let n=reactExports.useRef();n.current==null&&(n.current=createHashHistory({window:r,v5Compat:!0}));let i=n.current,[s,a]=reactExports.useState({action:i.action,location:i.location}),o=reactExports.useCallback(c=>{reactExports.startTransition(()=>a(c))},[a]);return reactExports.useLayoutEffect(()=>i.listen(o),[i,o]),reactExports.createElement(Router,{basename:t,children:e,location:s.location,navigationType:s.action,navigator:i})}var ABSOLUTE_URL_REGEX2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function(g,E){var p=g,{onClick:e,discover:r="render",prefetch:n="none",relative:i,reloadDocument:s,replace:a,state:o,target:c,to:u,preventScrollReset:h,viewTransition:f}=p,m=Jn(p,["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"]);let{basename:_}=reactExports.useContext(NavigationContext),A=typeof u=="string"&&ABSOLUTE_URL_REGEX2.test(u),H,te=!1;if(typeof u=="string"&&A&&(H=u,isBrowser$1))try{let R=new URL(window.location.href),Y=u.startsWith("//")?new URL(R.protocol+u):new URL(u),q=stripBasename(Y.pathname,_);Y.origin===R.origin&&q!=null?u=q+Y.search+Y.hash:te=!0}catch(R){warning(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let ne=useHref(u,{relative:i}),[j,ee,x]=usePrefetchBehavior(n,m),M=useLinkClickHandler(u,{replace:a,state:o,target:c,preventScrollReset:h,relative:i,viewTransition:f});function T(R){e&&e(R),R.defaultPrevented||M(R)}let O=reactExports.createElement("a",Br(Er(Er({},m),x),{href:H||ne,onClick:te||s?e:T,ref:mergeRefs(E,ee),target:c,"data-discover":!A&&r==="render"?"true":void 0}));return j&&!A?reactExports.createElement(reactExports.Fragment,null,O,reactExports.createElement(PrefetchPageLinks,{page:ne})):O});Link.displayName="Link";var NavLink=reactExports.forwardRef(function(f,h){var m=f,{"aria-current":e="page",caseSensitive:r=!1,className:n="",end:i=!1,style:s,to:a,viewTransition:o,children:c}=m,u=Jn(m,["aria-current","caseSensitive","className","end","style","to","viewTransition","children"]);let E=useResolvedPath(a,{relative:u.relative}),g=useLocation(),p=reactExports.useContext(DataRouterStateContext),{navigator:_,basename:A}=reactExports.useContext(NavigationContext),H=p!=null&&useViewTransitionState(E)&&o===!0,te=_.encodeLocation?_.encodeLocation(E).pathname:E.pathname,ne=g.pathname,j=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;r||(ne=ne.toLowerCase(),j=j?j.toLowerCase():null,te=te.toLowerCase()),j&&A&&(j=stripBasename(j,A)||j);const ee=te!=="/"&&te.endsWith("/")?te.length-1:te.length;let x=ne===te||!i&&ne.startsWith(te)&&ne.charAt(ee)==="/",M=j!=null&&(j===te||!i&&j.startsWith(te)&&j.charAt(te.length)==="/"),T={isActive:x,isPending:M,isTransitioning:H},O=x?e:void 0,R;typeof n=="function"?R=n(T):R=[n,x?"active":null,M?"pending":null,H?"transitioning":null].filter(Boolean).join(" ");let Y=typeof s=="function"?s(T):s;return reactExports.createElement(Link,Br(Er({},u),{"aria-current":O,className:R,ref:h,style:Y,to:a,viewTransition:o}),typeof c=="function"?c(T):c)});NavLink.displayName="NavLink";var Form=reactExports.forwardRef((g,E)=>{var p=g,{discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:i,state:s,method:a=defaultMethod,action:o,onSubmit:c,relative:u,preventScrollReset:h,viewTransition:f}=p,m=Jn(p,["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"]);let _=useSubmit(),A=useFormAction(o,{relative:u}),H=a.toLowerCase()==="get"?"get":"post",te=typeof o=="string"&&ABSOLUTE_URL_REGEX2.test(o),ne=j=>{if(c&&c(j),j.defaultPrevented)return;j.preventDefault();let ee=j.nativeEvent.submitter,x=(ee==null?void 0:ee.getAttribute("formmethod"))||a;_(ee||j.currentTarget,{fetcherKey:e,method:x,navigate:r,replace:i,state:s,relative:u,preventScrollReset:h,viewTransition:f})};return reactExports.createElement("form",Br(Er({ref:E,method:H,action:A,onSubmit:n?c:ne},m),{"data-discover":!te&&t==="render"?"true":void 0}))});Form.displayName="Form";function getDataRouterConsoleError2(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext3(t){let e=reactExports.useContext(DataRouterContext);return invariant(e,getDataRouterConsoleError2(t)),e}function useLinkClickHandler(t,{target:e,replace:r,state:n,preventScrollReset:i,relative:s,viewTransition:a}={}){let o=useNavigate(),c=useLocation(),u=useResolvedPath(t,{relative:s});return reactExports.useCallback(h=>{if(shouldProcessLinkClick(h,e)){h.preventDefault();let f=r!==void 0?r:createPath(c)===createPath(u);o(t,{replace:f,state:n,preventScrollReset:i,relative:s,viewTransition:a})}},[c,o,u,r,n,e,t,i,s,a])}var fetcherId=0,getUniqueFetcherId=()=>`__${String(++fetcherId)}__`;function useSubmit(){let{router:t}=useDataRouterContext3("useSubmit"),{basename:e}=reactExports.useContext(NavigationContext),r=useRouteId();return reactExports.useCallback((s,...a)=>Ye(this,[s,...a],function*(n,i={}){let{action:o,method:c,encType:u,formData:h,body:f}=getFormSubmissionInfo(n,e);if(i.navigate===!1){let m=i.fetcherKey||getUniqueFetcherId();yield t.fetch(m,r,i.action||o,{preventScrollReset:i.preventScrollReset,formData:h,body:f,formMethod:i.method||c,formEncType:i.encType||u,flushSync:i.flushSync})}else yield t.navigate(i.action||o,{preventScrollReset:i.preventScrollReset,formData:h,body:f,formMethod:i.method||c,formEncType:i.encType||u,replace:i.replace,state:i.state,fromRouteId:r,flushSync:i.flushSync,viewTransition:i.viewTransition})}),[t,e,r])}function useFormAction(t,{relative:e}={}){let{basename:r}=reactExports.useContext(NavigationContext),n=reactExports.useContext(RouteContext);invariant(n,"useFormAction must be used inside a RouteContext");let[i]=n.matches.slice(-1),s=Er({},useResolvedPath(t||".",{relative:e})),a=useLocation();if(t==null){s.search=a.search;let o=new URLSearchParams(s.search),c=o.getAll("index");if(c.some(h=>h==="")){o.delete("index"),c.filter(f=>f).forEach(f=>o.append("index",f));let h=o.toString();s.search=h?`?${h}`:""}}return(!t||t===".")&&i.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(s.pathname=s.pathname==="/"?r:joinPaths([r,s.pathname])),createPath(s)}function useViewTransitionState(t,e={}){let r=reactExports.useContext(ViewTransitionContext);invariant(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=useDataRouterContext3("useViewTransitionState"),i=useResolvedPath(t,{relative:e.relative});if(!r.isTransitioning)return!1;let s=stripBasename(r.currentLocation.pathname,n)||r.currentLocation.pathname,a=stripBasename(r.nextLocation.pathname,n)||r.nextLocation.pathname;return matchPath(i.pathname,a)!=null||matchPath(i.pathname,s)!=null}new TextEncoder;var lib={},slider={},innerSlider={},initialState={},hasRequiredInitialState;function requireInitialState(){return hasRequiredInitialState||(hasRequiredInitialState=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e={animating:!1,autoplaying:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,dragging:!1,edgeDragged:!1,initialized:!1,lazyLoadedList:[],listHeight:null,listWidth:null,scrolling:!1,slideCount:null,slideHeight:null,slideWidth:null,swipeLeft:null,swiped:!1,swiping:!1,touchObject:{startX:0,startY:0,curX:0,curY:0},trackStyle:{},trackWidth:0,targetSlide:0};t.default=e}(initialState)),initialState}var lodash_debounce,hasRequiredLodash_debounce;function requireLodash_debounce(){if(hasRequiredLodash_debounce)return lodash_debounce;hasRequiredLodash_debounce=1;var t="Expected a function",e=NaN,r="[object Symbol]",n=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,a=/^0o[0-7]+$/i,o=parseInt,c=typeof commonjsGlobal$2=="object"&&commonjsGlobal$2&&commonjsGlobal$2.Object===Object&&commonjsGlobal$2,u=typeof self=="object"&&self&&self.Object===Object&&self,h=c||u||Function("return this")(),f=Object.prototype,m=f.toString,E=Math.max,g=Math.min,p=function(){return h.Date.now()};function _(j,ee,x){var M,T,O,R,Y,q,me=0,xe=!1,Ee=!1,se=!0;if(typeof j!="function")throw new TypeError(t);ee=ne(ee)||0,A(x)&&(xe=!!x.leading,Ee="maxWait"in x,O=Ee?E(ne(x.maxWait)||0,ee):O,se="trailing"in x?!!x.trailing:se);function Fe(pe){var ve=M,Ae=T;return M=T=void 0,me=pe,R=j.apply(Ae,ve),R}function ue(pe){return me=pe,Y=setTimeout(oe,ee),xe?Fe(pe):R}function ae(pe){var ve=pe-q,Ae=pe-me,be=ee-ve;return Ee?g(be,O-Ae):be}function _e(pe){var ve=pe-q,Ae=pe-me;return q===void 0||ve>=ee||ve<0||Ee&&Ae>=O}function oe(){var pe=p();if(_e(pe))return ie(pe);Y=setTimeout(oe,ae(pe))}function ie(pe){return Y=void 0,se&&M?Fe(pe):(M=T=void 0,R)}function re(){Y!==void 0&&clearTimeout(Y),me=0,M=q=T=Y=void 0}function ce(){return Y===void 0?R:ie(p())}function fe(){var pe=p(),ve=_e(pe);if(M=arguments,T=this,q=pe,ve){if(Y===void 0)return ue(q);if(Ee)return Y=setTimeout(oe,ee),Fe(q)}return Y===void 0&&(Y=setTimeout(oe,ee)),R}return fe.cancel=re,fe.flush=ce,fe}function A(j){var ee=typeof j;return!!j&&(ee=="object"||ee=="function")}function H(j){return!!j&&typeof j=="object"}function te(j){return typeof j=="symbol"||H(j)&&m.call(j)==r}function ne(j){if(typeof j=="number")return j;if(te(j))return e;if(A(j)){var ee=typeof j.valueOf=="function"?j.valueOf():j;j=A(ee)?ee+"":ee}if(typeof j!="string")return j===0?j:+j;j=j.replace(n,"");var x=s.test(j);return x||a.test(j)?o(j.slice(2),x?2:8):i.test(j)?e:+j}return lodash_debounce=_,lodash_debounce}var classnames={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var hasRequiredClassnames;function requireClassnames(){return hasRequiredClassnames||(hasRequiredClassnames=1,function(t){(function(){var e={}.hasOwnProperty;function r(){for(var s="",a=0;a<arguments.length;a++){var o=arguments[a];o&&(s=i(s,n(o)))}return s}function n(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return r.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var a="";for(var o in s)e.call(s,o)&&s[o]&&(a=i(a,o));return a}function i(s,a){return a?s?s+" "+a:s+a:s}t.exports?(r.default=r,t.exports=r):window.classNames=r})()}(classnames)),classnames.exports}var innerSliderUtils={},defaultProps={},hasRequiredDefaultProps;function requireDefaultProps(){return hasRequiredDefaultProps||(hasRequiredDefaultProps=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=r(requireReact());function r(i){return i&&i.__esModule?i:{default:i}}var n={accessibility:!0,adaptiveHeight:!1,afterChange:null,appendDots:function(s){return e.default.createElement("ul",{style:{display:"block"}},s)},arrows:!0,autoplay:!1,autoplaySpeed:3e3,beforeChange:null,centerMode:!1,centerPadding:"50px",className:"",cssEase:"ease",customPaging:function(s){return e.default.createElement("button",null,s+1)},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,infinite:!0,initialSlide:0,lazyLoad:null,nextArrow:null,onEdge:null,onInit:null,onLazyLoadError:null,onReInit:null,pauseOnDotsHover:!1,pauseOnFocus:!1,pauseOnHover:!0,prevArrow:null,responsive:null,rows:1,rtl:!1,slide:"div",slidesPerRow:1,slidesToScroll:1,slidesToShow:1,speed:500,swipe:!0,swipeEvent:null,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,useTransform:!0,variableWidth:!1,vertical:!1,waitForAnimate:!0,asNavFor:null,unslick:!1};t.default=n}(defaultProps)),defaultProps}var hasRequiredInnerSliderUtils;function requireInnerSliderUtils(){if(hasRequiredInnerSliderUtils)return innerSliderUtils;hasRequiredInnerSliderUtils=1,Object.defineProperty(innerSliderUtils,"__esModule",{value:!0}),innerSliderUtils.checkSpecKeys=innerSliderUtils.checkNavigable=innerSliderUtils.changeSlide=innerSliderUtils.canUseDOM=innerSliderUtils.canGoNext=void 0,innerSliderUtils.clamp=u,innerSliderUtils.extractObject=void 0,innerSliderUtils.filterSettings=Fe,innerSliderUtils.validSettings=innerSliderUtils.swipeStart=innerSliderUtils.swipeMove=innerSliderUtils.swipeEnd=innerSliderUtils.slidesOnRight=innerSliderUtils.slidesOnLeft=innerSliderUtils.slideHandler=innerSliderUtils.siblingDirection=innerSliderUtils.safePreventDefault=innerSliderUtils.lazyStartIndex=innerSliderUtils.lazySlidesOnRight=innerSliderUtils.lazySlidesOnLeft=innerSliderUtils.lazyEndIndex=innerSliderUtils.keyHandler=innerSliderUtils.initializedState=innerSliderUtils.getWidth=innerSliderUtils.getTrackLeft=innerSliderUtils.getTrackCSS=innerSliderUtils.getTrackAnimateCSS=innerSliderUtils.getTotalSlides=innerSliderUtils.getSwipeDirection=innerSliderUtils.getSlideCount=innerSliderUtils.getRequiredLazySlides=innerSliderUtils.getPreClones=innerSliderUtils.getPostClones=innerSliderUtils.getOnDemandLazySlides=innerSliderUtils.getNavigableIndexes=innerSliderUtils.getHeight=void 0;var t=r(requireReact()),e=r(requireDefaultProps());function r(ue){return ue&&ue.__esModule?ue:{default:ue}}function n(ue){"@babel/helpers - typeof";return n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ae){return typeof ae}:function(ae){return ae&&typeof Symbol=="function"&&ae.constructor===Symbol&&ae!==Symbol.prototype?"symbol":typeof ae},n(ue)}function i(ue,ae){var _e=Object.keys(ue);if(Object.getOwnPropertySymbols){var oe=Object.getOwnPropertySymbols(ue);ae&&(oe=oe.filter(function(ie){return Object.getOwnPropertyDescriptor(ue,ie).enumerable})),_e.push.apply(_e,oe)}return _e}function s(ue){for(var ae=1;ae<arguments.length;ae++){var _e=arguments[ae]!=null?arguments[ae]:{};ae%2?i(Object(_e),!0).forEach(function(oe){a(ue,oe,_e[oe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ue,Object.getOwnPropertyDescriptors(_e)):i(Object(_e)).forEach(function(oe){Object.defineProperty(ue,oe,Object.getOwnPropertyDescriptor(_e,oe))})}return ue}function a(ue,ae,_e){return ae=o(ae),ae in ue?Object.defineProperty(ue,ae,{value:_e,enumerable:!0,configurable:!0,writable:!0}):ue[ae]=_e,ue}function o(ue){var ae=c(ue,"string");return n(ae)=="symbol"?ae:String(ae)}function c(ue,ae){if(n(ue)!="object"||!ue)return ue;var _e=ue[Symbol.toPrimitive];if(_e!==void 0){var oe=_e.call(ue,ae);if(n(oe)!="object")return oe;throw new TypeError("@@toPrimitive must return a primitive value.")}return(ae==="string"?String:Number)(ue)}function u(ue,ae,_e){return Math.max(ae,Math.min(ue,_e))}var h=innerSliderUtils.safePreventDefault=function(ae){var _e=["onTouchStart","onTouchMove","onWheel"];_e.includes(ae._reactName)||ae.preventDefault()},f=innerSliderUtils.getOnDemandLazySlides=function(ae){for(var _e=[],oe=m(ae),ie=E(ae),re=oe;re<ie;re++)ae.lazyLoadedList.indexOf(re)<0&&_e.push(re);return _e};innerSliderUtils.getRequiredLazySlides=function(ae){for(var _e=[],oe=m(ae),ie=E(ae),re=oe;re<ie;re++)_e.push(re);return _e};var m=innerSliderUtils.lazyStartIndex=function(ae){return ae.currentSlide-g(ae)},E=innerSliderUtils.lazyEndIndex=function(ae){return ae.currentSlide+p(ae)},g=innerSliderUtils.lazySlidesOnLeft=function(ae){return ae.centerMode?Math.floor(ae.slidesToShow/2)+(parseInt(ae.centerPadding)>0?1:0):0},p=innerSliderUtils.lazySlidesOnRight=function(ae){return ae.centerMode?Math.floor((ae.slidesToShow-1)/2)+1+(parseInt(ae.centerPadding)>0?1:0):ae.slidesToShow},_=innerSliderUtils.getWidth=function(ae){return ae&&ae.offsetWidth||0},A=innerSliderUtils.getHeight=function(ae){return ae&&ae.offsetHeight||0},H=innerSliderUtils.getSwipeDirection=function(ae){var _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,oe,ie,re,ce;return oe=ae.startX-ae.curX,ie=ae.startY-ae.curY,re=Math.atan2(ie,oe),ce=Math.round(re*180/Math.PI),ce<0&&(ce=360-Math.abs(ce)),ce<=45&&ce>=0||ce<=360&&ce>=315?"left":ce>=135&&ce<=225?"right":_e===!0?ce>=35&&ce<=135?"up":"down":"vertical"},te=innerSliderUtils.canGoNext=function(ae){var _e=!0;return ae.infinite||(ae.centerMode&&ae.currentSlide>=ae.slideCount-1||ae.slideCount<=ae.slidesToShow||ae.currentSlide>=ae.slideCount-ae.slidesToShow)&&(_e=!1),_e};innerSliderUtils.extractObject=function(ae,_e){var oe={};return _e.forEach(function(ie){return oe[ie]=ae[ie]}),oe},innerSliderUtils.initializedState=function(ae){var _e=t.default.Children.count(ae.children),oe=ae.listRef,ie=Math.ceil(_(oe)),re=ae.trackRef&&ae.trackRef.node,ce=Math.ceil(_(re)),fe;if(ae.vertical)fe=ie;else{var pe=ae.centerMode&&parseInt(ae.centerPadding)*2;typeof ae.centerPadding=="string"&&ae.centerPadding.slice(-1)==="%"&&(pe*=ie/100),fe=Math.ceil((ie-pe)/ae.slidesToShow)}var ve=oe&&A(oe.querySelector('[data-index="0"]')),Ae=ve*ae.slidesToShow,be=ae.currentSlide===void 0?ae.initialSlide:ae.currentSlide;ae.rtl&&ae.currentSlide===void 0&&(be=_e-1-ae.initialSlide);var je=ae.lazyLoadedList||[],Se=f(s(s({},ae),{},{currentSlide:be,lazyLoadedList:je}));je=je.concat(Se);var Xe={slideCount:_e,slideWidth:fe,listWidth:ie,trackWidth:ce,currentSlide:be,slideHeight:ve,listHeight:Ae,lazyLoadedList:je};return ae.autoplaying===null&&ae.autoplay&&(Xe.autoplaying="playing"),Xe},innerSliderUtils.slideHandler=function(ae){var _e=ae.waitForAnimate,oe=ae.animating,ie=ae.fade,re=ae.infinite,ce=ae.index,fe=ae.slideCount,pe=ae.lazyLoad,ve=ae.currentSlide,Ae=ae.centerMode,be=ae.slidesToScroll,je=ae.slidesToShow,Se=ae.useCSS,Xe=ae.lazyLoadedList;if(_e&&oe)return{};var qe=ce,Je,We,Ue,Ce={},Le={},Ve=re?ce:u(ce,0,fe-1);if(ie){if(!re&&(ce<0||ce>=fe))return{};ce<0?qe=ce+fe:ce>=fe&&(qe=ce-fe),pe&&Xe.indexOf(qe)<0&&(Xe=Xe.concat(qe)),Ce={animating:!0,currentSlide:qe,lazyLoadedList:Xe,targetSlide:qe},Le={animating:!1,targetSlide:qe}}else Je=qe,qe<0?(Je=qe+fe,re?fe%be!==0&&(Je=fe-fe%be):Je=0):!te(ae)&&qe>ve?qe=Je=ve:Ae&&qe>=fe?(qe=re?fe:fe-1,Je=re?0:fe-1):qe>=fe&&(Je=qe-fe,re?fe%be!==0&&(Je=0):Je=fe-je),!re&&qe+je>=fe&&(Je=fe-je),We=O(s(s({},ae),{},{slideIndex:qe})),Ue=O(s(s({},ae),{},{slideIndex:Je})),re||(We===Ue&&(qe=Je),We=Ue),pe&&(Xe=Xe.concat(f(s(s({},ae),{},{currentSlide:qe})))),Se?(Ce={animating:!0,currentSlide:Je,trackStyle:T(s(s({},ae),{},{left:We})),lazyLoadedList:Xe,targetSlide:Ve},Le={animating:!1,currentSlide:Je,trackStyle:M(s(s({},ae),{},{left:Ue})),swipeLeft:null,targetSlide:Ve}):Ce={currentSlide:Je,trackStyle:M(s(s({},ae),{},{left:Ue})),lazyLoadedList:Xe,targetSlide:Ve};return{state:Ce,nextState:Le}},innerSliderUtils.changeSlide=function(ae,_e){var oe,ie,re,ce,fe,pe=ae.slidesToScroll,ve=ae.slidesToShow,Ae=ae.slideCount,be=ae.currentSlide,je=ae.targetSlide,Se=ae.lazyLoad,Xe=ae.infinite;if(ce=Ae%pe!==0,oe=ce?0:(Ae-be)%pe,_e.message==="previous")re=oe===0?pe:ve-oe,fe=be-re,Se&&!Xe&&(ie=be-re,fe=ie===-1?Ae-1:ie),Xe||(fe=je-pe);else if(_e.message==="next")re=oe===0?pe:oe,fe=be+re,Se&&!Xe&&(fe=(be+pe)%Ae+oe),Xe||(fe=je+pe);else if(_e.message==="dots")fe=_e.index*_e.slidesToScroll;else if(_e.message==="children"){if(fe=_e.index,Xe){var qe=me(s(s({},ae),{},{targetSlide:fe}));fe>_e.currentSlide&&qe==="left"?fe=fe-Ae:fe<_e.currentSlide&&qe==="right"&&(fe=fe+Ae)}}else _e.message==="index"&&(fe=Number(_e.index));return fe},innerSliderUtils.keyHandler=function(ae,_e,oe){return ae.target.tagName.match("TEXTAREA|INPUT|SELECT")||!_e?"":ae.keyCode===37?oe?"next":"previous":ae.keyCode===39?oe?"previous":"next":""},innerSliderUtils.swipeStart=function(ae,_e,oe){return ae.target.tagName==="IMG"&&h(ae),!_e||!oe&&ae.type.indexOf("mouse")!==-1?"":{dragging:!0,touchObject:{startX:ae.touches?ae.touches[0].pageX:ae.clientX,startY:ae.touches?ae.touches[0].pageY:ae.clientY,curX:ae.touches?ae.touches[0].pageX:ae.clientX,curY:ae.touches?ae.touches[0].pageY:ae.clientY}}},innerSliderUtils.swipeMove=function(ae,_e){var oe=_e.scrolling,ie=_e.animating,re=_e.vertical,ce=_e.swipeToSlide,fe=_e.verticalSwiping,pe=_e.rtl,ve=_e.currentSlide,Ae=_e.edgeFriction,be=_e.edgeDragged,je=_e.onEdge,Se=_e.swiped,Xe=_e.swiping,qe=_e.slideCount,Je=_e.slidesToScroll,We=_e.infinite,Ue=_e.touchObject,Ce=_e.swipeEvent,Le=_e.listHeight,Ve=_e.listWidth;if(!oe){if(ie)return h(ae);re&&ce&&fe&&h(ae);var Ge,ut={},Jt=O(_e);Ue.curX=ae.touches?ae.touches[0].pageX:ae.clientX,Ue.curY=ae.touches?ae.touches[0].pageY:ae.clientY,Ue.swipeLength=Math.round(Math.sqrt(Math.pow(Ue.curX-Ue.startX,2)));var Kt=Math.round(Math.sqrt(Math.pow(Ue.curY-Ue.startY,2)));if(!fe&&!Xe&&Kt>10)return{scrolling:!0};fe&&(Ue.swipeLength=Kt);var Ze=(pe?-1:1)*(Ue.curX>Ue.startX?1:-1);fe&&(Ze=Ue.curY>Ue.startY?1:-1);var tr=Math.ceil(qe/Je),nr=H(_e.touchObject,fe),xr=Ue.swipeLength;return We||(ve===0&&(nr==="right"||nr==="down")||ve+1>=tr&&(nr==="left"||nr==="up")||!te(_e)&&(nr==="left"||nr==="up"))&&(xr=Ue.swipeLength*Ae,be===!1&&je&&(je(nr),ut.edgeDragged=!0)),!Se&&Ce&&(Ce(nr),ut.swiped=!0),re?Ge=Jt+xr*(Le/Ve)*Ze:pe?Ge=Jt-xr*Ze:Ge=Jt+xr*Ze,fe&&(Ge=Jt+xr*Ze),ut=s(s({},ut),{},{touchObject:Ue,swipeLeft:Ge,trackStyle:M(s(s({},_e),{},{left:Ge}))}),Math.abs(Ue.curX-Ue.startX)<Math.abs(Ue.curY-Ue.startY)*.8||Ue.swipeLength>10&&(ut.swiping=!0,h(ae)),ut}},innerSliderUtils.swipeEnd=function(ae,_e){var oe=_e.dragging,ie=_e.swipe,re=_e.touchObject,ce=_e.listWidth,fe=_e.touchThreshold,pe=_e.verticalSwiping,ve=_e.listHeight,Ae=_e.swipeToSlide,be=_e.scrolling,je=_e.onSwipe,Se=_e.targetSlide,Xe=_e.currentSlide,qe=_e.infinite;if(!oe)return ie&&h(ae),{};var Je=pe?ve/fe:ce/fe,We=H(re,pe),Ue={dragging:!1,edgeDragged:!1,scrolling:!1,swiping:!1,swiped:!1,swipeLeft:null,touchObject:{}};if(be||!re.swipeLength)return Ue;if(re.swipeLength>Je){h(ae),je&&je(We);var Ce,Le,Ve=qe?Xe:Se;switch(We){case"left":case"up":Le=Ve+ee(_e),Ce=Ae?j(_e,Le):Le,Ue.currentDirection=0;break;case"right":case"down":Le=Ve-ee(_e),Ce=Ae?j(_e,Le):Le,Ue.currentDirection=1;break;default:Ce=Ve}Ue.triggerSlideHandler=Ce}else{var Ge=O(_e);Ue.trackStyle=T(s(s({},_e),{},{left:Ge}))}return Ue};var ne=innerSliderUtils.getNavigableIndexes=function(ae){for(var _e=ae.infinite?ae.slideCount*2:ae.slideCount,oe=ae.infinite?ae.slidesToShow*-1:0,ie=ae.infinite?ae.slidesToShow*-1:0,re=[];oe<_e;)re.push(oe),oe=ie+ae.slidesToScroll,ie+=Math.min(ae.slidesToScroll,ae.slidesToShow);return re},j=innerSliderUtils.checkNavigable=function(ae,_e){var oe=ne(ae),ie=0;if(_e>oe[oe.length-1])_e=oe[oe.length-1];else for(var re in oe){if(_e<oe[re]){_e=ie;break}ie=oe[re]}return _e},ee=innerSliderUtils.getSlideCount=function(ae){var _e=ae.centerMode?ae.slideWidth*Math.floor(ae.slidesToShow/2):0;if(ae.swipeToSlide){var oe,ie=ae.listRef,re=ie.querySelectorAll&&ie.querySelectorAll(".slick-slide")||[];if(Array.from(re).every(function(pe){if(ae.vertical){if(pe.offsetTop+A(pe)/2>ae.swipeLeft*-1)return oe=pe,!1}else if(pe.offsetLeft-_e+_(pe)/2>ae.swipeLeft*-1)return oe=pe,!1;return!0}),!oe)return 0;var ce=ae.rtl===!0?ae.slideCount-ae.currentSlide:ae.currentSlide,fe=Math.abs(oe.dataset.index-ce)||1;return fe}else return ae.slidesToScroll},x=innerSliderUtils.checkSpecKeys=function(ae,_e){return _e.reduce(function(oe,ie){return oe&&ae.hasOwnProperty(ie)},!0)?null:console.error("Keys Missing:",ae)},M=innerSliderUtils.getTrackCSS=function(ae){x(ae,["left","variableWidth","slideCount","slidesToShow","slideWidth"]);var _e,oe,ie=ae.slideCount+2*ae.slidesToShow;ae.vertical?oe=ie*ae.slideHeight:_e=q(ae)*ae.slideWidth;var re={opacity:1,transition:"",WebkitTransition:""};if(ae.useTransform){var ce=ae.vertical?"translate3d(0px, "+ae.left+"px, 0px)":"translate3d("+ae.left+"px, 0px, 0px)",fe=ae.vertical?"translate3d(0px, "+ae.left+"px, 0px)":"translate3d("+ae.left+"px, 0px, 0px)",pe=ae.vertical?"translateY("+ae.left+"px)":"translateX("+ae.left+"px)";re=s(s({},re),{},{WebkitTransform:ce,transform:fe,msTransform:pe})}else ae.vertical?re.top=ae.left:re.left=ae.left;return ae.fade&&(re={opacity:1}),_e&&(re.width=_e),oe&&(re.height=oe),window&&!window.addEventListener&&window.attachEvent&&(ae.vertical?re.marginTop=ae.left+"px":re.marginLeft=ae.left+"px"),re},T=innerSliderUtils.getTrackAnimateCSS=function(ae){x(ae,["left","variableWidth","slideCount","slidesToShow","slideWidth","speed","cssEase"]);var _e=M(ae);return ae.useTransform?(_e.WebkitTransition="-webkit-transform "+ae.speed+"ms "+ae.cssEase,_e.transition="transform "+ae.speed+"ms "+ae.cssEase):ae.vertical?_e.transition="top "+ae.speed+"ms "+ae.cssEase:_e.transition="left "+ae.speed+"ms "+ae.cssEase,_e},O=innerSliderUtils.getTrackLeft=function(ae){if(ae.unslick)return 0;x(ae,["slideIndex","trackRef","infinite","centerMode","slideCount","slidesToShow","slidesToScroll","slideWidth","listWidth","variableWidth","slideHeight"]);var _e=ae.slideIndex,oe=ae.trackRef,ie=ae.infinite,re=ae.centerMode,ce=ae.slideCount,fe=ae.slidesToShow,pe=ae.slidesToScroll,ve=ae.slideWidth,Ae=ae.listWidth,be=ae.variableWidth,je=ae.slideHeight,Se=ae.fade,Xe=ae.vertical,qe=0,Je,We,Ue=0;if(Se||ae.slideCount===1)return 0;var Ce=0;if(ie?(Ce=-R(ae),ce%pe!==0&&_e+pe>ce&&(Ce=-(_e>ce?fe-(_e-ce):ce%pe)),re&&(Ce+=parseInt(fe/2))):(ce%pe!==0&&_e+pe>ce&&(Ce=fe-ce%pe),re&&(Ce=parseInt(fe/2))),qe=Ce*ve,Ue=Ce*je,Xe?Je=_e*je*-1+Ue:Je=_e*ve*-1+qe,be===!0){var Le,Ve=oe&&oe.node;if(Le=_e+R(ae),We=Ve&&Ve.childNodes[Le],Je=We?We.offsetLeft*-1:0,re===!0){Le=ie?_e+R(ae):_e,We=Ve&&Ve.children[Le],Je=0;for(var Ge=0;Ge<Le;Ge++)Je-=Ve&&Ve.children[Ge]&&Ve.children[Ge].offsetWidth;Je-=parseInt(ae.centerPadding),Je+=We&&(Ae-We.offsetWidth)/2}}return Je},R=innerSliderUtils.getPreClones=function(ae){return ae.unslick||!ae.infinite?0:ae.variableWidth?ae.slideCount:ae.slidesToShow+(ae.centerMode?1:0)},Y=innerSliderUtils.getPostClones=function(ae){return ae.unslick||!ae.infinite?0:ae.slideCount},q=innerSliderUtils.getTotalSlides=function(ae){return ae.slideCount===1?1:R(ae)+ae.slideCount+Y(ae)},me=innerSliderUtils.siblingDirection=function(ae){return ae.targetSlide>ae.currentSlide?ae.targetSlide>ae.currentSlide+xe(ae)?"left":"right":ae.targetSlide<ae.currentSlide-Ee(ae)?"right":"left"},xe=innerSliderUtils.slidesOnRight=function(ae){var _e=ae.slidesToShow,oe=ae.centerMode,ie=ae.rtl,re=ae.centerPadding;if(oe){var ce=(_e-1)/2+1;return parseInt(re)>0&&(ce+=1),ie&&_e%2===0&&(ce+=1),ce}return ie?0:_e-1},Ee=innerSliderUtils.slidesOnLeft=function(ae){var _e=ae.slidesToShow,oe=ae.centerMode,ie=ae.rtl,re=ae.centerPadding;if(oe){var ce=(_e-1)/2+1;return parseInt(re)>0&&(ce+=1),!ie&&_e%2===0&&(ce+=1),ce}return ie?_e-1:0};innerSliderUtils.canUseDOM=function(){return!!(typeof window!="undefined"&&window.document&&window.document.createElement)};var se=innerSliderUtils.validSettings=Object.keys(e.default);function Fe(ue){return se.reduce(function(ae,_e){return ue.hasOwnProperty(_e)&&(ae[_e]=ue[_e]),ae},{})}return innerSliderUtils}var track={},hasRequiredTrack;function requireTrack(){if(hasRequiredTrack)return track;hasRequiredTrack=1,Object.defineProperty(track,"__esModule",{value:!0}),track.Track=void 0;var t=n(requireReact()),e=n(requireClassnames()),r=requireInnerSliderUtils();function n(T){return T&&T.__esModule?T:{default:T}}function i(T){"@babel/helpers - typeof";return i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(O){return typeof O}:function(O){return O&&typeof Symbol=="function"&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O},i(T)}function s(){return s=Object.assign?Object.assign.bind():function(T){for(var O=1;O<arguments.length;O++){var R=arguments[O];for(var Y in R)Object.prototype.hasOwnProperty.call(R,Y)&&(T[Y]=R[Y])}return T},s.apply(this,arguments)}function a(T,O){if(!(T instanceof O))throw new TypeError("Cannot call a class as a function")}function o(T,O){for(var R=0;R<O.length;R++){var Y=O[R];Y.enumerable=Y.enumerable||!1,Y.configurable=!0,"value"in Y&&(Y.writable=!0),Object.defineProperty(T,te(Y.key),Y)}}function c(T,O,R){return O&&o(T.prototype,O),Object.defineProperty(T,"prototype",{writable:!1}),T}function u(T,O){if(typeof O!="function"&&O!==null)throw new TypeError("Super expression must either be null or a function");T.prototype=Object.create(O&&O.prototype,{constructor:{value:T,writable:!0,configurable:!0}}),Object.defineProperty(T,"prototype",{writable:!1}),O&&h(T,O)}function h(T,O){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Y,q){return Y.__proto__=q,Y},h(T,O)}function f(T){var O=g();return function(){var Y=p(T),q;if(O){var me=p(this).constructor;q=Reflect.construct(Y,arguments,me)}else q=Y.apply(this,arguments);return m(this,q)}}function m(T,O){if(O&&(i(O)==="object"||typeof O=="function"))return O;if(O!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return E(T)}function E(T){if(T===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T}function g(){try{var T=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(O){}return(g=function(){return!!T})()}function p(T){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(R){return R.__proto__||Object.getPrototypeOf(R)},p(T)}function _(T,O){var R=Object.keys(T);if(Object.getOwnPropertySymbols){var Y=Object.getOwnPropertySymbols(T);O&&(Y=Y.filter(function(q){return Object.getOwnPropertyDescriptor(T,q).enumerable})),R.push.apply(R,Y)}return R}function A(T){for(var O=1;O<arguments.length;O++){var R=arguments[O]!=null?arguments[O]:{};O%2?_(Object(R),!0).forEach(function(Y){H(T,Y,R[Y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(T,Object.getOwnPropertyDescriptors(R)):_(Object(R)).forEach(function(Y){Object.defineProperty(T,Y,Object.getOwnPropertyDescriptor(R,Y))})}return T}function H(T,O,R){return O=te(O),O in T?Object.defineProperty(T,O,{value:R,enumerable:!0,configurable:!0,writable:!0}):T[O]=R,T}function te(T){var O=ne(T,"string");return i(O)=="symbol"?O:String(O)}function ne(T,O){if(i(T)!="object"||!T)return T;var R=T[Symbol.toPrimitive];if(R!==void 0){var Y=R.call(T,O);if(i(Y)!="object")return Y;throw new TypeError("@@toPrimitive must return a primitive value.")}return(O==="string"?String:Number)(T)}var j=function(O){var R,Y,q,me,xe;O.rtl?xe=O.slideCount-1-O.index:xe=O.index,q=xe<0||xe>=O.slideCount,O.centerMode?(me=Math.floor(O.slidesToShow/2),Y=(xe-O.currentSlide)%O.slideCount===0,xe>O.currentSlide-me-1&&xe<=O.currentSlide+me&&(R=!0)):R=O.currentSlide<=xe&&xe<O.currentSlide+O.slidesToShow;var Ee;O.targetSlide<0?Ee=O.targetSlide+O.slideCount:O.targetSlide>=O.slideCount?Ee=O.targetSlide-O.slideCount:Ee=O.targetSlide;var se=xe===Ee;return{"slick-slide":!0,"slick-active":R,"slick-center":Y,"slick-cloned":q,"slick-current":se}},ee=function(O){var R={};return(O.variableWidth===void 0||O.variableWidth===!1)&&(R.width=O.slideWidth),O.fade&&(R.position="relative",O.vertical?R.top=-O.index*parseInt(O.slideHeight):R.left=-O.index*parseInt(O.slideWidth),R.opacity=O.currentSlide===O.index?1:0,R.zIndex=O.currentSlide===O.index?999:998,O.useCSS&&(R.transition="opacity "+O.speed+"ms "+O.cssEase+", visibility "+O.speed+"ms "+O.cssEase)),R},x=function(O,R){return O.key||R},M=function(O){var R,Y=[],q=[],me=[],xe=t.default.Children.count(O.children),Ee=(0,r.lazyStartIndex)(O),se=(0,r.lazyEndIndex)(O);return t.default.Children.forEach(O.children,function(Fe,ue){var ae,_e={message:"children",index:ue,slidesToScroll:O.slidesToScroll,currentSlide:O.currentSlide};!O.lazyLoad||O.lazyLoad&&O.lazyLoadedList.indexOf(ue)>=0?ae=Fe:ae=t.default.createElement("div",null);var oe=ee(A(A({},O),{},{index:ue})),ie=ae.props.className||"",re=j(A(A({},O),{},{index:ue}));if(Y.push(t.default.cloneElement(ae,{key:"original"+x(ae,ue),"data-index":ue,className:(0,e.default)(re,ie),tabIndex:"-1","aria-hidden":!re["slick-active"],style:A(A({outline:"none"},ae.props.style||{}),oe),onClick:function(pe){ae.props&&ae.props.onClick&&ae.props.onClick(pe),O.focusOnSelect&&O.focusOnSelect(_e)}})),O.infinite&&O.fade===!1){var ce=xe-ue;ce<=(0,r.getPreClones)(O)&&(R=-ce,R>=Ee&&(ae=Fe),re=j(A(A({},O),{},{index:R})),q.push(t.default.cloneElement(ae,{key:"precloned"+x(ae,R),"data-index":R,tabIndex:"-1",className:(0,e.default)(re,ie),"aria-hidden":!re["slick-active"],style:A(A({},ae.props.style||{}),oe),onClick:function(pe){ae.props&&ae.props.onClick&&ae.props.onClick(pe),O.focusOnSelect&&O.focusOnSelect(_e)}}))),R=xe+ue,R<se&&(ae=Fe),re=j(A(A({},O),{},{index:R})),me.push(t.default.cloneElement(ae,{key:"postcloned"+x(ae,R),"data-index":R,tabIndex:"-1",className:(0,e.default)(re,ie),"aria-hidden":!re["slick-active"],style:A(A({},ae.props.style||{}),oe),onClick:function(pe){ae.props&&ae.props.onClick&&ae.props.onClick(pe),O.focusOnSelect&&O.focusOnSelect(_e)}}))}}),O.rtl?q.concat(Y,me).reverse():q.concat(Y,me)};return track.Track=function(T){u(R,T);var O=f(R);function R(){var Y;a(this,R);for(var q=arguments.length,me=new Array(q),xe=0;xe<q;xe++)me[xe]=arguments[xe];return Y=O.call.apply(O,[this].concat(me)),H(E(Y),"node",null),H(E(Y),"handleRef",function(Ee){Y.node=Ee}),Y}return c(R,[{key:"render",value:function(){var q=M(this.props),me=this.props,xe=me.onMouseEnter,Ee=me.onMouseOver,se=me.onMouseLeave,Fe={onMouseEnter:xe,onMouseOver:Ee,onMouseLeave:se};return t.default.createElement("div",s({ref:this.handleRef,className:"slick-track",style:this.props.trackStyle},Fe),q)}}]),R}(t.default.PureComponent),track}var dots={},hasRequiredDots;function requireDots(){if(hasRequiredDots)return dots;hasRequiredDots=1;function t(j){"@babel/helpers - typeof";return t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ee){return typeof ee}:function(ee){return ee&&typeof Symbol=="function"&&ee.constructor===Symbol&&ee!==Symbol.prototype?"symbol":typeof ee},t(j)}Object.defineProperty(dots,"__esModule",{value:!0}),dots.Dots=void 0;var e=i(requireReact()),r=i(requireClassnames()),n=requireInnerSliderUtils();function i(j){return j&&j.__esModule?j:{default:j}}function s(j,ee){var x=Object.keys(j);if(Object.getOwnPropertySymbols){var M=Object.getOwnPropertySymbols(j);ee&&(M=M.filter(function(T){return Object.getOwnPropertyDescriptor(j,T).enumerable})),x.push.apply(x,M)}return x}function a(j){for(var ee=1;ee<arguments.length;ee++){var x=arguments[ee]!=null?arguments[ee]:{};ee%2?s(Object(x),!0).forEach(function(M){o(j,M,x[M])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(x)):s(Object(x)).forEach(function(M){Object.defineProperty(j,M,Object.getOwnPropertyDescriptor(x,M))})}return j}function o(j,ee,x){return ee=f(ee),ee in j?Object.defineProperty(j,ee,{value:x,enumerable:!0,configurable:!0,writable:!0}):j[ee]=x,j}function c(j,ee){if(!(j instanceof ee))throw new TypeError("Cannot call a class as a function")}function u(j,ee){for(var x=0;x<ee.length;x++){var M=ee[x];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(j,f(M.key),M)}}function h(j,ee,x){return ee&&u(j.prototype,ee),Object.defineProperty(j,"prototype",{writable:!1}),j}function f(j){var ee=m(j,"string");return t(ee)=="symbol"?ee:String(ee)}function m(j,ee){if(t(j)!="object"||!j)return j;var x=j[Symbol.toPrimitive];if(x!==void 0){var M=x.call(j,ee);if(t(M)!="object")return M;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(j)}function E(j,ee){if(typeof ee!="function"&&ee!==null)throw new TypeError("Super expression must either be null or a function");j.prototype=Object.create(ee&&ee.prototype,{constructor:{value:j,writable:!0,configurable:!0}}),Object.defineProperty(j,"prototype",{writable:!1}),ee&&g(j,ee)}function g(j,ee){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(M,T){return M.__proto__=T,M},g(j,ee)}function p(j){var ee=H();return function(){var M=te(j),T;if(ee){var O=te(this).constructor;T=Reflect.construct(M,arguments,O)}else T=M.apply(this,arguments);return _(this,T)}}function _(j,ee){if(ee&&(t(ee)==="object"||typeof ee=="function"))return ee;if(ee!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return A(j)}function A(j){if(j===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return j}function H(){try{var j=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(ee){}return(H=function(){return!!j})()}function te(j){return te=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(x){return x.__proto__||Object.getPrototypeOf(x)},te(j)}var ne=function(ee){var x;return ee.infinite?x=Math.ceil(ee.slideCount/ee.slidesToScroll):x=Math.ceil((ee.slideCount-ee.slidesToShow)/ee.slidesToScroll)+1,x};return dots.Dots=function(j){E(x,j);var ee=p(x);function x(){return c(this,x),ee.apply(this,arguments)}return h(x,[{key:"clickHandler",value:function(T,O){O.preventDefault(),this.props.clickHandler(T)}},{key:"render",value:function(){for(var T=this.props,O=T.onMouseEnter,R=T.onMouseOver,Y=T.onMouseLeave,q=T.infinite,me=T.slidesToScroll,xe=T.slidesToShow,Ee=T.slideCount,se=T.currentSlide,Fe=ne({slideCount:Ee,slidesToScroll:me,slidesToShow:xe,infinite:q}),ue={onMouseEnter:O,onMouseOver:R,onMouseLeave:Y},ae=[],_e=0;_e<Fe;_e++){var oe=(_e+1)*me-1,ie=q?oe:(0,n.clamp)(oe,0,Ee-1),re=ie-(me-1),ce=q?re:(0,n.clamp)(re,0,Ee-1),fe=(0,r.default)({"slick-active":q?se>=ce&&se<=ie:se===ce}),pe={message:"dots",index:_e,slidesToScroll:me,currentSlide:se},ve=this.clickHandler.bind(this,pe);ae=ae.concat(e.default.createElement("li",{key:_e,className:fe},e.default.cloneElement(this.props.customPaging(_e),{onClick:ve})))}return e.default.cloneElement(this.props.appendDots(ae),a({className:this.props.dotsClass},ue))}}]),x}(e.default.PureComponent),dots}var arrows={},hasRequiredArrows;function requireArrows(){if(hasRequiredArrows)return arrows;hasRequiredArrows=1;function t(j){"@babel/helpers - typeof";return t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ee){return typeof ee}:function(ee){return ee&&typeof Symbol=="function"&&ee.constructor===Symbol&&ee!==Symbol.prototype?"symbol":typeof ee},t(j)}Object.defineProperty(arrows,"__esModule",{value:!0}),arrows.PrevArrow=arrows.NextArrow=void 0;var e=i(requireReact()),r=i(requireClassnames()),n=requireInnerSliderUtils();function i(j){return j&&j.__esModule?j:{default:j}}function s(){return s=Object.assign?Object.assign.bind():function(j){for(var ee=1;ee<arguments.length;ee++){var x=arguments[ee];for(var M in x)Object.prototype.hasOwnProperty.call(x,M)&&(j[M]=x[M])}return j},s.apply(this,arguments)}function a(j,ee){var x=Object.keys(j);if(Object.getOwnPropertySymbols){var M=Object.getOwnPropertySymbols(j);ee&&(M=M.filter(function(T){return Object.getOwnPropertyDescriptor(j,T).enumerable})),x.push.apply(x,M)}return x}function o(j){for(var ee=1;ee<arguments.length;ee++){var x=arguments[ee]!=null?arguments[ee]:{};ee%2?a(Object(x),!0).forEach(function(M){c(j,M,x[M])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(x)):a(Object(x)).forEach(function(M){Object.defineProperty(j,M,Object.getOwnPropertyDescriptor(x,M))})}return j}function c(j,ee,x){return ee=m(ee),ee in j?Object.defineProperty(j,ee,{value:x,enumerable:!0,configurable:!0,writable:!0}):j[ee]=x,j}function u(j,ee){if(!(j instanceof ee))throw new TypeError("Cannot call a class as a function")}function h(j,ee){for(var x=0;x<ee.length;x++){var M=ee[x];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(j,m(M.key),M)}}function f(j,ee,x){return ee&&h(j.prototype,ee),Object.defineProperty(j,"prototype",{writable:!1}),j}function m(j){var ee=E(j,"string");return t(ee)=="symbol"?ee:String(ee)}function E(j,ee){if(t(j)!="object"||!j)return j;var x=j[Symbol.toPrimitive];if(x!==void 0){var M=x.call(j,ee);if(t(M)!="object")return M;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(j)}function g(j,ee){if(typeof ee!="function"&&ee!==null)throw new TypeError("Super expression must either be null or a function");j.prototype=Object.create(ee&&ee.prototype,{constructor:{value:j,writable:!0,configurable:!0}}),Object.defineProperty(j,"prototype",{writable:!1}),ee&&p(j,ee)}function p(j,ee){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(M,T){return M.__proto__=T,M},p(j,ee)}function _(j){var ee=te();return function(){var M=ne(j),T;if(ee){var O=ne(this).constructor;T=Reflect.construct(M,arguments,O)}else T=M.apply(this,arguments);return A(this,T)}}function A(j,ee){if(ee&&(t(ee)==="object"||typeof ee=="function"))return ee;if(ee!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return H(j)}function H(j){if(j===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return j}function te(){try{var j=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(ee){}return(te=function(){return!!j})()}function ne(j){return ne=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(x){return x.__proto__||Object.getPrototypeOf(x)},ne(j)}return arrows.PrevArrow=function(j){g(x,j);var ee=_(x);function x(){return u(this,x),ee.apply(this,arguments)}return f(x,[{key:"clickHandler",value:function(T,O){O&&O.preventDefault(),this.props.clickHandler(T,O)}},{key:"render",value:function(){var T={"slick-arrow":!0,"slick-prev":!0},O=this.clickHandler.bind(this,{message:"previous"});!this.props.infinite&&(this.props.currentSlide===0||this.props.slideCount<=this.props.slidesToShow)&&(T["slick-disabled"]=!0,O=null);var R={key:"0","data-role":"none",className:(0,r.default)(T),style:{display:"block"},onClick:O},Y={currentSlide:this.props.currentSlide,slideCount:this.props.slideCount},q;return this.props.prevArrow?q=e.default.cloneElement(this.props.prevArrow,o(o({},R),Y)):q=e.default.createElement("button",s({key:"0",type:"button"},R)," ","Previous"),q}}]),x}(e.default.PureComponent),arrows.NextArrow=function(j){g(x,j);var ee=_(x);function x(){return u(this,x),ee.apply(this,arguments)}return f(x,[{key:"clickHandler",value:function(T,O){O&&O.preventDefault(),this.props.clickHandler(T,O)}},{key:"render",value:function(){var T={"slick-arrow":!0,"slick-next":!0},O=this.clickHandler.bind(this,{message:"next"});(0,n.canGoNext)(this.props)||(T["slick-disabled"]=!0,O=null);var R={key:"1","data-role":"none",className:(0,r.default)(T),style:{display:"block"},onClick:O},Y={currentSlide:this.props.currentSlide,slideCount:this.props.slideCount},q;return this.props.nextArrow?q=e.default.cloneElement(this.props.nextArrow,o(o({},R),Y)):q=e.default.createElement("button",s({key:"1",type:"button"},R)," ","Next"),q}}]),x}(e.default.PureComponent),arrows}var MapShim=function(){if(typeof Map!="undefined")return Map;function t(e,r){var n=-1;return e.some(function(i,s){return i[0]===r?(n=s,!0):!1}),n}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(r){var n=t(this.__entries__,r),i=this.__entries__[n];return i&&i[1]},e.prototype.set=function(r,n){var i=t(this.__entries__,r);~i?this.__entries__[i][1]=n:this.__entries__.push([r,n])},e.prototype.delete=function(r){var n=this.__entries__,i=t(n,r);~i&&n.splice(i,1)},e.prototype.has=function(r){return!!~t(this.__entries__,r)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(r,n){n===void 0&&(n=null);for(var i=0,s=this.__entries__;i<s.length;i++){var a=s[i];r.call(n,a[1],a[0])}},e}()}(),isBrowser=typeof window!="undefined"&&typeof document!="undefined"&&window.document===document,global$1=function(){return typeof global!="undefined"&&global.Math===Math?global:typeof self!="undefined"&&self.Math===Math?self:typeof window!="undefined"&&window.Math===Math?window:Function("return this")()}(),requestAnimationFrame$1=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(global$1):function(t){return setTimeout(function(){return t(Date.now())},1e3/60)}}(),trailingTimeout=2;function throttle$1(t,e){var r=!1,n=!1,i=0;function s(){r&&(r=!1,t()),n&&o()}function a(){requestAnimationFrame$1(s)}function o(){var c=Date.now();if(r){if(c-i<trailingTimeout)return;n=!0}else r=!0,n=!1,setTimeout(a,e);i=c}return o}var REFRESH_DELAY=20,transitionKeys=["top","right","bottom","left","width","height","size","weight"],mutationObserverSupported=typeof MutationObserver!="undefined",ResizeObserverController=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=throttle$1(this.refresh.bind(this),REFRESH_DELAY)}return t.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},t.prototype.removeObserver=function(e){var r=this.observers_,n=r.indexOf(e);~n&&r.splice(n,1),!r.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},t.prototype.updateObservers_=function(){var e=this.observers_.filter(function(r){return r.gatherActive(),r.hasActive()});return e.forEach(function(r){return r.broadcastActive()}),e.length>0},t.prototype.connect_=function(){!isBrowser||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),mutationObserverSupported?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){!isBrowser||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(e){var r=e.propertyName,n=r===void 0?"":r,i=transitionKeys.some(function(s){return!!~n.indexOf(s)});i&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),defineConfigurable=function(t,e){for(var r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];Object.defineProperty(t,i,{value:e[i],enumerable:!1,writable:!1,configurable:!0})}return t},getWindowOf=function(t){var e=t&&t.ownerDocument&&t.ownerDocument.defaultView;return e||global$1},emptyRect=createRectInit(0,0,0,0);function toFloat(t){return parseFloat(t)||0}function getBordersSize(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return e.reduce(function(n,i){var s=t["border-"+i+"-width"];return n+toFloat(s)},0)}function getPaddings(t){for(var e=["top","right","bottom","left"],r={},n=0,i=e;n<i.length;n++){var s=i[n],a=t["padding-"+s];r[s]=toFloat(a)}return r}function getSVGContentRect(t){var e=t.getBBox();return createRectInit(0,0,e.width,e.height)}function getHTMLElementContentRect(t){var e=t.clientWidth,r=t.clientHeight;if(!e&&!r)return emptyRect;var n=getWindowOf(t).getComputedStyle(t),i=getPaddings(n),s=i.left+i.right,a=i.top+i.bottom,o=toFloat(n.width),c=toFloat(n.height);if(n.boxSizing==="border-box"&&(Math.round(o+s)!==e&&(o-=getBordersSize(n,"left","right")+s),Math.round(c+a)!==r&&(c-=getBordersSize(n,"top","bottom")+a)),!isDocumentElement(t)){var u=Math.round(o+s)-e,h=Math.round(c+a)-r;Math.abs(u)!==1&&(o-=u),Math.abs(h)!==1&&(c-=h)}return createRectInit(i.left,i.top,o,c)}var isSVGGraphicsElement=function(){return typeof SVGGraphicsElement!="undefined"?function(t){return t instanceof getWindowOf(t).SVGGraphicsElement}:function(t){return t instanceof getWindowOf(t).SVGElement&&typeof t.getBBox=="function"}}();function isDocumentElement(t){return t===getWindowOf(t).document.documentElement}function getContentRect(t){return isBrowser?isSVGGraphicsElement(t)?getSVGContentRect(t):getHTMLElementContentRect(t):emptyRect}function createReadOnlyRect(t){var e=t.x,r=t.y,n=t.width,i=t.height,s=typeof DOMRectReadOnly!="undefined"?DOMRectReadOnly:Object,a=Object.create(s.prototype);return defineConfigurable(a,{x:e,y:r,width:n,height:i,top:r,right:e+n,bottom:i+r,left:e}),a}function createRectInit(t,e,r,n){return{x:t,y:e,width:r,height:n}}var ResizeObservation=function(){function t(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=createRectInit(0,0,0,0),this.target=e}return t.prototype.isActive=function(){var e=getContentRect(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},t}(),ResizeObserverEntry=function(){function t(e,r){var n=createReadOnlyRect(r);defineConfigurable(this,{target:e,contentRect:n})}return t}(),ResizeObserverSPI=function(){function t(e,r,n){if(this.activeObservations_=[],this.observations_=new MapShim,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=r,this.callbackCtx_=n}return t.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element=="undefined"||!(Element instanceof Object))){if(!(e instanceof getWindowOf(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var r=this.observations_;r.has(e)||(r.set(e,new ResizeObservation(e)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element=="undefined"||!(Element instanceof Object))){if(!(e instanceof getWindowOf(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var r=this.observations_;r.has(e)&&(r.delete(e),r.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(r){r.isActive()&&e.activeObservations_.push(r)})},t.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,r=this.activeObservations_.map(function(n){return new ResizeObserverEntry(n.target,n.broadcastRect())});this.callback_.call(e,r,e),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),observers=typeof WeakMap!="undefined"?new WeakMap:new MapShim,ResizeObserver$1=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var r=ResizeObserverController.getInstance(),n=new ResizeObserverSPI(e,r,this);observers.set(this,n)}return t}();["observe","unobserve","disconnect"].forEach(function(t){ResizeObserver$1.prototype[t]=function(){var e;return(e=observers.get(this))[t].apply(e,arguments)}});var index=function(){return typeof global$1.ResizeObserver!="undefined"?global$1.ResizeObserver:ResizeObserver$1}();const ResizeObserver_es=Object.freeze(Object.defineProperty({__proto__:null,default:index},Symbol.toStringTag,{value:"Module"})),require$$8=getAugmentedNamespace(ResizeObserver_es);var hasRequiredInnerSlider;function requireInnerSlider(){if(hasRequiredInnerSlider)return innerSlider;hasRequiredInnerSlider=1,Object.defineProperty(innerSlider,"__esModule",{value:!0}),innerSlider.InnerSlider=void 0;var t=u(requireReact()),e=u(requireInitialState()),r=u(requireLodash_debounce()),n=u(requireClassnames()),i=requireInnerSliderUtils(),s=requireTrack(),a=requireDots(),o=requireArrows(),c=u(require$$8);function u(q){return q&&q.__esModule?q:{default:q}}function h(q){"@babel/helpers - typeof";return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(me){return typeof me}:function(me){return me&&typeof Symbol=="function"&&me.constructor===Symbol&&me!==Symbol.prototype?"symbol":typeof me},h(q)}function f(){return f=Object.assign?Object.assign.bind():function(q){for(var me=1;me<arguments.length;me++){var xe=arguments[me];for(var Ee in xe)Object.prototype.hasOwnProperty.call(xe,Ee)&&(q[Ee]=xe[Ee])}return q},f.apply(this,arguments)}function m(q,me){if(q==null)return{};var xe=E(q,me),Ee,se;if(Object.getOwnPropertySymbols){var Fe=Object.getOwnPropertySymbols(q);for(se=0;se<Fe.length;se++)Ee=Fe[se],!(me.indexOf(Ee)>=0)&&Object.prototype.propertyIsEnumerable.call(q,Ee)&&(xe[Ee]=q[Ee])}return xe}function E(q,me){if(q==null)return{};var xe={},Ee=Object.keys(q),se,Fe;for(Fe=0;Fe<Ee.length;Fe++)se=Ee[Fe],!(me.indexOf(se)>=0)&&(xe[se]=q[se]);return xe}function g(q,me){var xe=Object.keys(q);if(Object.getOwnPropertySymbols){var Ee=Object.getOwnPropertySymbols(q);me&&(Ee=Ee.filter(function(se){return Object.getOwnPropertyDescriptor(q,se).enumerable})),xe.push.apply(xe,Ee)}return xe}function p(q){for(var me=1;me<arguments.length;me++){var xe=arguments[me]!=null?arguments[me]:{};me%2?g(Object(xe),!0).forEach(function(Ee){O(q,Ee,xe[Ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(q,Object.getOwnPropertyDescriptors(xe)):g(Object(xe)).forEach(function(Ee){Object.defineProperty(q,Ee,Object.getOwnPropertyDescriptor(xe,Ee))})}return q}function _(q,me){if(!(q instanceof me))throw new TypeError("Cannot call a class as a function")}function A(q,me){for(var xe=0;xe<me.length;xe++){var Ee=me[xe];Ee.enumerable=Ee.enumerable||!1,Ee.configurable=!0,"value"in Ee&&(Ee.writable=!0),Object.defineProperty(q,R(Ee.key),Ee)}}function H(q,me,xe){return me&&A(q.prototype,me),Object.defineProperty(q,"prototype",{writable:!1}),q}function te(q,me){if(typeof me!="function"&&me!==null)throw new TypeError("Super expression must either be null or a function");q.prototype=Object.create(me&&me.prototype,{constructor:{value:q,writable:!0,configurable:!0}}),Object.defineProperty(q,"prototype",{writable:!1}),me&&ne(q,me)}function ne(q,me){return ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Ee,se){return Ee.__proto__=se,Ee},ne(q,me)}function j(q){var me=M();return function(){var Ee=T(q),se;if(me){var Fe=T(this).constructor;se=Reflect.construct(Ee,arguments,Fe)}else se=Ee.apply(this,arguments);return ee(this,se)}}function ee(q,me){if(me&&(h(me)==="object"||typeof me=="function"))return me;if(me!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return x(q)}function x(q){if(q===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return q}function M(){try{var q=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(me){}return(M=function(){return!!q})()}function T(q){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(xe){return xe.__proto__||Object.getPrototypeOf(xe)},T(q)}function O(q,me,xe){return me=R(me),me in q?Object.defineProperty(q,me,{value:xe,enumerable:!0,configurable:!0,writable:!0}):q[me]=xe,q}function R(q){var me=Y(q,"string");return h(me)=="symbol"?me:String(me)}function Y(q,me){if(h(q)!="object"||!q)return q;var xe=q[Symbol.toPrimitive];if(xe!==void 0){var Ee=xe.call(q,me);if(h(Ee)!="object")return Ee;throw new TypeError("@@toPrimitive must return a primitive value.")}return(me==="string"?String:Number)(q)}return innerSlider.InnerSlider=function(q){te(xe,q);var me=j(xe);function xe(Ee){var se;_(this,xe),se=me.call(this,Ee),O(x(se),"listRefHandler",function(ue){return se.list=ue}),O(x(se),"trackRefHandler",function(ue){return se.track=ue}),O(x(se),"adaptHeight",function(){if(se.props.adaptiveHeight&&se.list){var ue=se.list.querySelector('[data-index="'.concat(se.state.currentSlide,'"]'));se.list.style.height=(0,i.getHeight)(ue)+"px"}}),O(x(se),"componentDidMount",function(){if(se.props.onInit&&se.props.onInit(),se.props.lazyLoad){var ue=(0,i.getOnDemandLazySlides)(p(p({},se.props),se.state));ue.length>0&&(se.setState(function(_e){return{lazyLoadedList:_e.lazyLoadedList.concat(ue)}}),se.props.onLazyLoad&&se.props.onLazyLoad(ue))}var ae=p({listRef:se.list,trackRef:se.track},se.props);se.updateState(ae,!0,function(){se.adaptHeight(),se.props.autoplay&&se.autoPlay("update")}),se.props.lazyLoad==="progressive"&&(se.lazyLoadTimer=setInterval(se.progressiveLazyLoad,1e3)),se.ro=new c.default(function(){se.state.animating?(se.onWindowResized(!1),se.callbackTimers.push(setTimeout(function(){return se.onWindowResized()},se.props.speed))):se.onWindowResized()}),se.ro.observe(se.list),document.querySelectorAll&&Array.prototype.forEach.call(document.querySelectorAll(".slick-slide"),function(_e){_e.onfocus=se.props.pauseOnFocus?se.onSlideFocus:null,_e.onblur=se.props.pauseOnFocus?se.onSlideBlur:null}),window.addEventListener?window.addEventListener("resize",se.onWindowResized):window.attachEvent("onresize",se.onWindowResized)}),O(x(se),"componentWillUnmount",function(){se.animationEndCallback&&clearTimeout(se.animationEndCallback),se.lazyLoadTimer&&clearInterval(se.lazyLoadTimer),se.callbackTimers.length&&(se.callbackTimers.forEach(function(ue){return clearTimeout(ue)}),se.callbackTimers=[]),window.addEventListener?window.removeEventListener("resize",se.onWindowResized):window.detachEvent("onresize",se.onWindowResized),se.autoplayTimer&&clearInterval(se.autoplayTimer),se.ro.disconnect()}),O(x(se),"componentDidUpdate",function(ue){if(se.checkImagesLoad(),se.props.onReInit&&se.props.onReInit(),se.props.lazyLoad){var ae=(0,i.getOnDemandLazySlides)(p(p({},se.props),se.state));ae.length>0&&(se.setState(function(ie){return{lazyLoadedList:ie.lazyLoadedList.concat(ae)}}),se.props.onLazyLoad&&se.props.onLazyLoad(ae))}se.adaptHeight();var _e=p(p({listRef:se.list,trackRef:se.track},se.props),se.state),oe=se.didPropsChange(ue);oe&&se.updateState(_e,oe,function(){se.state.currentSlide>=t.default.Children.count(se.props.children)&&se.changeSlide({message:"index",index:t.default.Children.count(se.props.children)-se.props.slidesToShow,currentSlide:se.state.currentSlide}),se.props.autoplay?se.autoPlay("update"):se.pause("paused")})}),O(x(se),"onWindowResized",function(ue){se.debouncedResize&&se.debouncedResize.cancel(),se.debouncedResize=(0,r.default)(function(){return se.resizeWindow(ue)},50),se.debouncedResize()}),O(x(se),"resizeWindow",function(){var ue=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,ae=!!(se.track&&se.track.node);if(ae){var _e=p(p({listRef:se.list,trackRef:se.track},se.props),se.state);se.updateState(_e,ue,function(){se.props.autoplay?se.autoPlay("update"):se.pause("paused")}),se.setState({animating:!1}),clearTimeout(se.animationEndCallback),delete se.animationEndCallback}}),O(x(se),"updateState",function(ue,ae,_e){var oe=(0,i.initializedState)(ue);ue=p(p(p({},ue),oe),{},{slideIndex:oe.currentSlide});var ie=(0,i.getTrackLeft)(ue);ue=p(p({},ue),{},{left:ie});var re=(0,i.getTrackCSS)(ue);(ae||t.default.Children.count(se.props.children)!==t.default.Children.count(ue.children))&&(oe.trackStyle=re),se.setState(oe,_e)}),O(x(se),"ssrInit",function(){if(se.props.variableWidth){var ue=0,ae=0,_e=[],oe=(0,i.getPreClones)(p(p(p({},se.props),se.state),{},{slideCount:se.props.children.length})),ie=(0,i.getPostClones)(p(p(p({},se.props),se.state),{},{slideCount:se.props.children.length}));se.props.children.forEach(function(We){_e.push(We.props.style.width),ue+=We.props.style.width});for(var re=0;re<oe;re++)ae+=_e[_e.length-1-re],ue+=_e[_e.length-1-re];for(var ce=0;ce<ie;ce++)ue+=_e[ce];for(var fe=0;fe<se.state.currentSlide;fe++)ae+=_e[fe];var pe={width:ue+"px",left:-ae+"px"};if(se.props.centerMode){var ve="".concat(_e[se.state.currentSlide],"px");pe.left="calc(".concat(pe.left," + (100% - ").concat(ve,") / 2 ) ")}return{trackStyle:pe}}var Ae=t.default.Children.count(se.props.children),be=p(p(p({},se.props),se.state),{},{slideCount:Ae}),je=(0,i.getPreClones)(be)+(0,i.getPostClones)(be)+Ae,Se=100/se.props.slidesToShow*je,Xe=100/je,qe=-Xe*((0,i.getPreClones)(be)+se.state.currentSlide)*Se/100;se.props.centerMode&&(qe+=(100-Xe*Se/100)/2);var Je={width:Se+"%",left:qe+"%"};return{slideWidth:Xe+"%",trackStyle:Je}}),O(x(se),"checkImagesLoad",function(){var ue=se.list&&se.list.querySelectorAll&&se.list.querySelectorAll(".slick-slide img")||[],ae=ue.length,_e=0;Array.prototype.forEach.call(ue,function(oe){var ie=function(){return++_e&&_e>=ae&&se.onWindowResized()};if(!oe.onclick)oe.onclick=function(){return oe.parentNode.focus()};else{var re=oe.onclick;oe.onclick=function(ce){re(ce),oe.parentNode.focus()}}oe.onload||(se.props.lazyLoad?oe.onload=function(){se.adaptHeight(),se.callbackTimers.push(setTimeout(se.onWindowResized,se.props.speed))}:(oe.onload=ie,oe.onerror=function(){ie(),se.props.onLazyLoadError&&se.props.onLazyLoadError()}))})}),O(x(se),"progressiveLazyLoad",function(){for(var ue=[],ae=p(p({},se.props),se.state),_e=se.state.currentSlide;_e<se.state.slideCount+(0,i.getPostClones)(ae);_e++)if(se.state.lazyLoadedList.indexOf(_e)<0){ue.push(_e);break}for(var oe=se.state.currentSlide-1;oe>=-(0,i.getPreClones)(ae);oe--)if(se.state.lazyLoadedList.indexOf(oe)<0){ue.push(oe);break}ue.length>0?(se.setState(function(ie){return{lazyLoadedList:ie.lazyLoadedList.concat(ue)}}),se.props.onLazyLoad&&se.props.onLazyLoad(ue)):se.lazyLoadTimer&&(clearInterval(se.lazyLoadTimer),delete se.lazyLoadTimer)}),O(x(se),"slideHandler",function(ue){var ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,_e=se.props,oe=_e.asNavFor,ie=_e.beforeChange,re=_e.onLazyLoad,ce=_e.speed,fe=_e.afterChange,pe=se.state.currentSlide,ve=(0,i.slideHandler)(p(p(p({index:ue},se.props),se.state),{},{trackRef:se.track,useCSS:se.props.useCSS&&!ae})),Ae=ve.state,be=ve.nextState;if(Ae){ie&&ie(pe,Ae.currentSlide);var je=Ae.lazyLoadedList.filter(function(Se){return se.state.lazyLoadedList.indexOf(Se)<0});re&&je.length>0&&re(je),!se.props.waitForAnimate&&se.animationEndCallback&&(clearTimeout(se.animationEndCallback),fe&&fe(pe),delete se.animationEndCallback),se.setState(Ae,function(){oe&&se.asNavForIndex!==ue&&(se.asNavForIndex=ue,oe.innerSlider.slideHandler(ue)),be&&(se.animationEndCallback=setTimeout(function(){var Se=be.animating,Xe=m(be,["animating"]);se.setState(Xe,function(){se.callbackTimers.push(setTimeout(function(){return se.setState({animating:Se})},10)),fe&&fe(Ae.currentSlide),delete se.animationEndCallback})},ce))})}}),O(x(se),"changeSlide",function(ue){var ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,_e=p(p({},se.props),se.state),oe=(0,i.changeSlide)(_e,ue);if(!(oe!==0&&!oe)&&(ae===!0?se.slideHandler(oe,ae):se.slideHandler(oe),se.props.autoplay&&se.autoPlay("update"),se.props.focusOnSelect)){var ie=se.list.querySelectorAll(".slick-current");ie[0]&&ie[0].focus()}}),O(x(se),"clickHandler",function(ue){se.clickable===!1&&(ue.stopPropagation(),ue.preventDefault()),se.clickable=!0}),O(x(se),"keyHandler",function(ue){var ae=(0,i.keyHandler)(ue,se.props.accessibility,se.props.rtl);ae!==""&&se.changeSlide({message:ae})}),O(x(se),"selectHandler",function(ue){se.changeSlide(ue)}),O(x(se),"disableBodyScroll",function(){var ue=function(_e){_e=_e||window.event,_e.preventDefault&&_e.preventDefault(),_e.returnValue=!1};window.ontouchmove=ue}),O(x(se),"enableBodyScroll",function(){window.ontouchmove=null}),O(x(se),"swipeStart",function(ue){se.props.verticalSwiping&&se.disableBodyScroll();var ae=(0,i.swipeStart)(ue,se.props.swipe,se.props.draggable);ae!==""&&se.setState(ae)}),O(x(se),"swipeMove",function(ue){var ae=(0,i.swipeMove)(ue,p(p(p({},se.props),se.state),{},{trackRef:se.track,listRef:se.list,slideIndex:se.state.currentSlide}));ae&&(ae.swiping&&(se.clickable=!1),se.setState(ae))}),O(x(se),"swipeEnd",function(ue){var ae=(0,i.swipeEnd)(ue,p(p(p({},se.props),se.state),{},{trackRef:se.track,listRef:se.list,slideIndex:se.state.currentSlide}));if(ae){var _e=ae.triggerSlideHandler;delete ae.triggerSlideHandler,se.setState(ae),_e!==void 0&&(se.slideHandler(_e),se.props.verticalSwiping&&se.enableBodyScroll())}}),O(x(se),"touchEnd",function(ue){se.swipeEnd(ue),se.clickable=!0}),O(x(se),"slickPrev",function(){se.callbackTimers.push(setTimeout(function(){return se.changeSlide({message:"previous"})},0))}),O(x(se),"slickNext",function(){se.callbackTimers.push(setTimeout(function(){return se.changeSlide({message:"next"})},0))}),O(x(se),"slickGoTo",function(ue){var ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(ue=Number(ue),isNaN(ue))return"";se.callbackTimers.push(setTimeout(function(){return se.changeSlide({message:"index",index:ue,currentSlide:se.state.currentSlide},ae)},0))}),O(x(se),"play",function(){var ue;if(se.props.rtl)ue=se.state.currentSlide-se.props.slidesToScroll;else if((0,i.canGoNext)(p(p({},se.props),se.state)))ue=se.state.currentSlide+se.props.slidesToScroll;else return!1;se.slideHandler(ue)}),O(x(se),"autoPlay",function(ue){se.autoplayTimer&&clearInterval(se.autoplayTimer);var ae=se.state.autoplaying;if(ue==="update"){if(ae==="hovered"||ae==="focused"||ae==="paused")return}else if(ue==="leave"){if(ae==="paused"||ae==="focused")return}else if(ue==="blur"&&(ae==="paused"||ae==="hovered"))return;se.autoplayTimer=setInterval(se.play,se.props.autoplaySpeed+50),se.setState({autoplaying:"playing"})}),O(x(se),"pause",function(ue){se.autoplayTimer&&(clearInterval(se.autoplayTimer),se.autoplayTimer=null);var ae=se.state.autoplaying;ue==="paused"?se.setState({autoplaying:"paused"}):ue==="focused"?(ae==="hovered"||ae==="playing")&&se.setState({autoplaying:"focused"}):ae==="playing"&&se.setState({autoplaying:"hovered"})}),O(x(se),"onDotsOver",function(){return se.props.autoplay&&se.pause("hovered")}),O(x(se),"onDotsLeave",function(){return se.props.autoplay&&se.state.autoplaying==="hovered"&&se.autoPlay("leave")}),O(x(se),"onTrackOver",function(){return se.props.autoplay&&se.pause("hovered")}),O(x(se),"onTrackLeave",function(){return se.props.autoplay&&se.state.autoplaying==="hovered"&&se.autoPlay("leave")}),O(x(se),"onSlideFocus",function(){return se.props.autoplay&&se.pause("focused")}),O(x(se),"onSlideBlur",function(){return se.props.autoplay&&se.state.autoplaying==="focused"&&se.autoPlay("blur")}),O(x(se),"render",function(){var ue=(0,n.default)("slick-slider",se.props.className,{"slick-vertical":se.props.vertical,"slick-initialized":!0}),ae=p(p({},se.props),se.state),_e=(0,i.extractObject)(ae,["fade","cssEase","speed","infinite","centerMode","focusOnSelect","currentSlide","lazyLoad","lazyLoadedList","rtl","slideWidth","slideHeight","listHeight","vertical","slidesToShow","slidesToScroll","slideCount","trackStyle","variableWidth","unslick","centerPadding","targetSlide","useCSS"]),oe=se.props.pauseOnHover;_e=p(p({},_e),{},{onMouseEnter:oe?se.onTrackOver:null,onMouseLeave:oe?se.onTrackLeave:null,onMouseOver:oe?se.onTrackOver:null,focusOnSelect:se.props.focusOnSelect&&se.clickable?se.selectHandler:null});var ie;if(se.props.dots===!0&&se.state.slideCount>=se.props.slidesToShow){var re=(0,i.extractObject)(ae,["dotsClass","slideCount","slidesToShow","currentSlide","slidesToScroll","clickHandler","children","customPaging","infinite","appendDots"]),ce=se.props.pauseOnDotsHover;re=p(p({},re),{},{clickHandler:se.changeSlide,onMouseEnter:ce?se.onDotsLeave:null,onMouseOver:ce?se.onDotsOver:null,onMouseLeave:ce?se.onDotsLeave:null}),ie=t.default.createElement(a.Dots,re)}var fe,pe,ve=(0,i.extractObject)(ae,["infinite","centerMode","currentSlide","slideCount","slidesToShow","prevArrow","nextArrow"]);ve.clickHandler=se.changeSlide,se.props.arrows&&(fe=t.default.createElement(o.PrevArrow,ve),pe=t.default.createElement(o.NextArrow,ve));var Ae=null;se.props.vertical&&(Ae={height:se.state.listHeight});var be=null;se.props.vertical===!1?se.props.centerMode===!0&&(be={padding:"0px "+se.props.centerPadding}):se.props.centerMode===!0&&(be={padding:se.props.centerPadding+" 0px"});var je=p(p({},Ae),be),Se=se.props.touchMove,Xe={className:"slick-list",style:je,onClick:se.clickHandler,onMouseDown:Se?se.swipeStart:null,onMouseMove:se.state.dragging&&Se?se.swipeMove:null,onMouseUp:Se?se.swipeEnd:null,onMouseLeave:se.state.dragging&&Se?se.swipeEnd:null,onTouchStart:Se?se.swipeStart:null,onTouchMove:se.state.dragging&&Se?se.swipeMove:null,onTouchEnd:Se?se.touchEnd:null,onTouchCancel:se.state.dragging&&Se?se.swipeEnd:null,onKeyDown:se.props.accessibility?se.keyHandler:null},qe={className:ue,dir:"ltr",style:se.props.style};return se.props.unslick&&(Xe={className:"slick-list"},qe={className:ue}),t.default.createElement("div",qe,se.props.unslick?"":fe,t.default.createElement("div",f({ref:se.listRefHandler},Xe),t.default.createElement(s.Track,f({ref:se.trackRefHandler},_e),se.props.children)),se.props.unslick?"":pe,se.props.unslick?"":ie)}),se.list=null,se.track=null,se.state=p(p({},e.default),{},{currentSlide:se.props.initialSlide,targetSlide:se.props.initialSlide?se.props.initialSlide:0,slideCount:t.default.Children.count(se.props.children)}),se.callbackTimers=[],se.clickable=!0,se.debouncedResize=null;var Fe=se.ssrInit();return se.state=p(p({},se.state),Fe),se}return H(xe,[{key:"didPropsChange",value:function(se){for(var Fe=!1,ue=0,ae=Object.keys(this.props);ue<ae.length;ue++){var _e=ae[ue];if(!se.hasOwnProperty(_e)){Fe=!0;break}if(!(h(se[_e])==="object"||typeof se[_e]=="function"||isNaN(se[_e]))&&se[_e]!==this.props[_e]){Fe=!0;break}}return Fe||t.default.Children.count(this.props.children)!==t.default.Children.count(se.children)}}]),xe}(t.default.Component),innerSlider}var camel2hyphen_1,hasRequiredCamel2hyphen;function requireCamel2hyphen(){if(hasRequiredCamel2hyphen)return camel2hyphen_1;hasRequiredCamel2hyphen=1;var t=function(e){return e.replace(/[A-Z]/g,function(r){return"-"+r.toLowerCase()}).toLowerCase()};return camel2hyphen_1=t,camel2hyphen_1}var json2mq_1,hasRequiredJson2mq;function requireJson2mq(){if(hasRequiredJson2mq)return json2mq_1;hasRequiredJson2mq=1;var t=requireCamel2hyphen(),e=function(i){var s=/[height|width]$/;return s.test(i)},r=function(i){var s="",a=Object.keys(i);return a.forEach(function(o,c){var u=i[o];o=t(o),e(o)&&typeof u=="number"&&(u=u+"px"),u===!0?s+=o:u===!1?s+="not "+o:s+="("+o+": "+u+")",c<a.length-1&&(s+=" and ")}),s},n=function(i){var s="";return typeof i=="string"?i:i instanceof Array?(i.forEach(function(a,o){s+=r(a),o<i.length-1&&(s+=", ")}),s):r(i)};return json2mq_1=n,json2mq_1}var QueryHandler_1,hasRequiredQueryHandler;function requireQueryHandler(){if(hasRequiredQueryHandler)return QueryHandler_1;hasRequiredQueryHandler=1;function t(e){this.options=e,!e.deferSetup&&this.setup()}return t.prototype={constructor:t,setup:function(){this.options.setup&&this.options.setup(),this.initialised=!0},on:function(){!this.initialised&&this.setup(),this.options.match&&this.options.match()},off:function(){this.options.unmatch&&this.options.unmatch()},destroy:function(){this.options.destroy?this.options.destroy():this.off()},equals:function(e){return this.options===e||this.options.match===e}},QueryHandler_1=t,QueryHandler_1}var Util,hasRequiredUtil;function requireUtil(){if(hasRequiredUtil)return Util;hasRequiredUtil=1;function t(n,i){var s=0,a=n.length,o;for(s;s<a&&(o=i(n[s],s),o!==!1);s++);}function e(n){return Object.prototype.toString.apply(n)==="[object Array]"}function r(n){return typeof n=="function"}return Util={isFunction:r,isArray:e,each:t},Util}var MediaQuery_1,hasRequiredMediaQuery;function requireMediaQuery(){if(hasRequiredMediaQuery)return MediaQuery_1;hasRequiredMediaQuery=1;var t=requireQueryHandler(),e=requireUtil().each;function r(n,i){this.query=n,this.isUnconditional=i,this.handlers=[],this.mql=window.matchMedia(n);var s=this;this.listener=function(a){s.mql=a.currentTarget||a,s.assess()},this.mql.addListener(this.listener)}return r.prototype={constuctor:r,addHandler:function(n){var i=new t(n);this.handlers.push(i),this.matches()&&i.on()},removeHandler:function(n){var i=this.handlers;e(i,function(s,a){if(s.equals(n))return s.destroy(),!i.splice(a,1)})},matches:function(){return this.mql.matches||this.isUnconditional},clear:function(){e(this.handlers,function(n){n.destroy()}),this.mql.removeListener(this.listener),this.handlers.length=0},assess:function(){var n=this.matches()?"on":"off";e(this.handlers,function(i){i[n]()})}},MediaQuery_1=r,MediaQuery_1}var MediaQueryDispatch_1,hasRequiredMediaQueryDispatch;function requireMediaQueryDispatch(){if(hasRequiredMediaQueryDispatch)return MediaQueryDispatch_1;hasRequiredMediaQueryDispatch=1;var t=requireMediaQuery(),e=requireUtil(),r=e.each,n=e.isFunction,i=e.isArray;function s(){if(!window.matchMedia)throw new Error("matchMedia not present, legacy browsers require a polyfill");this.queries={},this.browserIsIncapable=!window.matchMedia("only all").matches}return s.prototype={constructor:s,register:function(a,o,c){var u=this.queries,h=c&&this.browserIsIncapable;return u[a]||(u[a]=new t(a,h)),n(o)&&(o={match:o}),i(o)||(o=[o]),r(o,function(f){n(f)&&(f={match:f}),u[a].addHandler(f)}),this},unregister:function(a,o){var c=this.queries[a];return c&&(o?c.removeHandler(o):(c.clear(),delete this.queries[a])),this}},MediaQueryDispatch_1=s,MediaQueryDispatch_1}var src,hasRequiredSrc;function requireSrc(){if(hasRequiredSrc)return src;hasRequiredSrc=1;var t=requireMediaQueryDispatch();return src=new t,src}var hasRequiredSlider;function requireSlider(){return hasRequiredSlider||(hasRequiredSlider=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=a(requireReact()),r=requireInnerSlider(),n=a(requireJson2mq()),i=a(requireDefaultProps()),s=requireInnerSliderUtils();function a(T){return T&&T.__esModule?T:{default:T}}function o(T){"@babel/helpers - typeof";return o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(O){return typeof O}:function(O){return O&&typeof Symbol=="function"&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O},o(T)}function c(){return c=Object.assign?Object.assign.bind():function(T){for(var O=1;O<arguments.length;O++){var R=arguments[O];for(var Y in R)Object.prototype.hasOwnProperty.call(R,Y)&&(T[Y]=R[Y])}return T},c.apply(this,arguments)}function u(T,O){var R=Object.keys(T);if(Object.getOwnPropertySymbols){var Y=Object.getOwnPropertySymbols(T);O&&(Y=Y.filter(function(q){return Object.getOwnPropertyDescriptor(T,q).enumerable})),R.push.apply(R,Y)}return R}function h(T){for(var O=1;O<arguments.length;O++){var R=arguments[O]!=null?arguments[O]:{};O%2?u(Object(R),!0).forEach(function(Y){j(T,Y,R[Y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(T,Object.getOwnPropertyDescriptors(R)):u(Object(R)).forEach(function(Y){Object.defineProperty(T,Y,Object.getOwnPropertyDescriptor(R,Y))})}return T}function f(T,O){if(!(T instanceof O))throw new TypeError("Cannot call a class as a function")}function m(T,O){for(var R=0;R<O.length;R++){var Y=O[R];Y.enumerable=Y.enumerable||!1,Y.configurable=!0,"value"in Y&&(Y.writable=!0),Object.defineProperty(T,ee(Y.key),Y)}}function E(T,O,R){return O&&m(T.prototype,O),Object.defineProperty(T,"prototype",{writable:!1}),T}function g(T,O){if(typeof O!="function"&&O!==null)throw new TypeError("Super expression must either be null or a function");T.prototype=Object.create(O&&O.prototype,{constructor:{value:T,writable:!0,configurable:!0}}),Object.defineProperty(T,"prototype",{writable:!1}),O&&p(T,O)}function p(T,O){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Y,q){return Y.__proto__=q,Y},p(T,O)}function _(T){var O=te();return function(){var Y=ne(T),q;if(O){var me=ne(this).constructor;q=Reflect.construct(Y,arguments,me)}else q=Y.apply(this,arguments);return A(this,q)}}function A(T,O){if(O&&(o(O)==="object"||typeof O=="function"))return O;if(O!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return H(T)}function H(T){if(T===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T}function te(){try{var T=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(O){}return(te=function(){return!!T})()}function ne(T){return ne=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(R){return R.__proto__||Object.getPrototypeOf(R)},ne(T)}function j(T,O,R){return O=ee(O),O in T?Object.defineProperty(T,O,{value:R,enumerable:!0,configurable:!0,writable:!0}):T[O]=R,T}function ee(T){var O=x(T,"string");return o(O)=="symbol"?O:String(O)}function x(T,O){if(o(T)!="object"||!T)return T;var R=T[Symbol.toPrimitive];if(R!==void 0){var Y=R.call(T,O);if(o(Y)!="object")return Y;throw new TypeError("@@toPrimitive must return a primitive value.")}return(O==="string"?String:Number)(T)}var M=(0,s.canUseDOM)()&&requireSrc();t.default=function(T){g(R,T);var O=_(R);function R(Y){var q;return f(this,R),q=O.call(this,Y),j(H(q),"innerSliderRefHandler",function(me){return q.innerSlider=me}),j(H(q),"slickPrev",function(){return q.innerSlider.slickPrev()}),j(H(q),"slickNext",function(){return q.innerSlider.slickNext()}),j(H(q),"slickGoTo",function(me){var xe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return q.innerSlider.slickGoTo(me,xe)}),j(H(q),"slickPause",function(){return q.innerSlider.pause("paused")}),j(H(q),"slickPlay",function(){return q.innerSlider.autoPlay("play")}),q.state={breakpoint:null},q._responsiveMediaHandlers=[],q}return E(R,[{key:"media",value:function(q,me){M.register(q,me),this._responsiveMediaHandlers.push({query:q,handler:me})}},{key:"componentDidMount",value:function(){var q=this;if(this.props.responsive){var me=this.props.responsive.map(function(Ee){return Ee.breakpoint});me.sort(function(Ee,se){return Ee-se}),me.forEach(function(Ee,se){var Fe;se===0?Fe=(0,n.default)({minWidth:0,maxWidth:Ee}):Fe=(0,n.default)({minWidth:me[se-1]+1,maxWidth:Ee}),(0,s.canUseDOM)()&&q.media(Fe,function(){q.setState({breakpoint:Ee})})});var xe=(0,n.default)({minWidth:me.slice(-1)[0]});(0,s.canUseDOM)()&&this.media(xe,function(){q.setState({breakpoint:null})})}}},{key:"componentWillUnmount",value:function(){this._responsiveMediaHandlers.forEach(function(q){M.unregister(q.query,q.handler)})}},{key:"render",value:function(){var q=this,me,xe;this.state.breakpoint?(xe=this.props.responsive.filter(function(ce){return ce.breakpoint===q.state.breakpoint}),me=xe[0].settings==="unslick"?"unslick":h(h(h({},i.default),this.props),xe[0].settings)):me=h(h({},i.default),this.props),me.centerMode&&(me.slidesToScroll>1,me.slidesToScroll=1),me.fade&&(me.slidesToShow>1,me.slidesToScroll>1,me.slidesToShow=1,me.slidesToScroll=1);var Ee=e.default.Children.toArray(this.props.children);Ee=Ee.filter(function(ce){return typeof ce=="string"?!!ce.trim():!!ce}),me.variableWidth&&(me.rows>1||me.slidesPerRow>1)&&(console.warn("variableWidth is not supported in case of rows > 1 or slidesPerRow > 1"),me.variableWidth=!1);for(var se=[],Fe=null,ue=0;ue<Ee.length;ue+=me.rows*me.slidesPerRow){for(var ae=[],_e=ue;_e<ue+me.rows*me.slidesPerRow;_e+=me.slidesPerRow){for(var oe=[],ie=_e;ie<_e+me.slidesPerRow&&(me.variableWidth&&Ee[ie].props.style&&(Fe=Ee[ie].props.style.width),!(ie>=Ee.length));ie+=1)oe.push(e.default.cloneElement(Ee[ie],{key:100*ue+10*_e+ie,tabIndex:-1,style:{width:"".concat(100/me.slidesPerRow,"%"),display:"inline-block"}}));ae.push(e.default.createElement("div",{key:10*ue+_e},oe))}me.variableWidth?se.push(e.default.createElement("div",{key:ue,style:{width:Fe}},ae)):se.push(e.default.createElement("div",{key:ue},ae))}if(me==="unslick"){var re="regular slider "+(this.props.className||"");return e.default.createElement("div",{className:re},Ee)}else se.length<=me.slidesToShow&&!me.infinite&&(me.unslick=!0);return e.default.createElement(r.InnerSlider,c({style:this.props.style,ref:this.innerSliderRefHandler},(0,s.filterSettings)(me)),se)}}]),R}(e.default.Component)}(slider)),slider}var hasRequiredLib;function requireLib(){return hasRequiredLib||(hasRequiredLib=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=r(requireSlider());function r(n){return n&&n.__esModule?n:{default:n}}t.default=e.default}(lib)),lib}var libExports=requireLib();const Slider=getDefaultExportFromCjs(libExports),Catalogo=JSON.parse(`[{"sector":"A11_Hasta_50_kW","grupo":"A1_GestiÃ³n_y_negociaciÃ³n_de_contratos_de_energÃ­a","cod":"A112_FacturaciÃ³n_por_potencia","descripcion":["La facturaciÃ³n por potencia contratada se calcula segÃºn lo establecido en el artÃ­culo 9 de la Circular 3/2020,             de 15 de enero, por la que se establece la metodologÃ­a para el cÃ¡lculo de los peajes de transporte y distribuciÃ³n de energÃ­a elÃ©ctrica."]},{"sector":"A11_Hasta_50_kW","grupo":"A1_GestiÃ³n_y_negociaciÃ³n_de_contratos_de_energÃ­a","cod":"A111_OptimizaciÃ³n_de_la_potencia_contratada","descripcion":["La facturaciÃ³n por potencia tiene dos partes: la potencia contratada, que es un coste fijo,             y la potencia demandada, que se paga si se supera la contratada.             Se calcula segÃºn lo establecido en el artÃ­culo 9 de la Circular 3/2020,de 15 de enero.            El objetivo es encontrar la potencia Ã³ptima a contratar en cada periodo horario para minimizar el coste total anual.","diagrama(conexiones=[('FACTURA \\\\n ELÃ‰CTRICA', 'TÃ©rmino \\\\n de Potencia.', '', ''), ('FACTURA \\\\n ELÃ‰CTRICA', 'TÃ©rmino \\\\n de EnergÃ­a', '', ''), ('FACTURA \\\\n ELÃ‰CTRICA', 'Exceso  \\\\n Recativa', '', ''), ('FACTURA \\\\n ELÃ‰CTRICA', 'Impuesto\\\\n Electrico', '', ''), ('FACTURA \\\\n ELÃ‰CTRICA', 'Alquiler\\\\n Contador', '', ''), ('TÃ©rmino \\\\n de EnergÃ­a', 'ID', '', ''), ('TÃ©rmino \\\\n de EnergÃ­a', 'IDs', '', ''), ('TÃ©rmino \\\\n de Potencia.', 'potencia contratada.', '', ''), ('TÃ©rmino \\\\n de Potencia.', 'Exceso \\\\n potencia demandada.', '', '')], orientacion='LR', ancho_max=420, alto_max=300, fontsize=14, label_fontsize=None, titulo='FACTURA ELÃ‰CTRICA')"]},{"sector":"A12_Mayor_de_50_kW","grupo":"A1_GestiÃ³n_y_negociaciÃ³n_de_contratos_de_energÃ­a","cod":"A114_OptimizaciÃ³n_de_la_potencia_contratada_hasta_50_kW_con_lecturas","descripcion":["La facturaciÃ³n por potencia contratada se calcula segÃºn lo establecido en el artÃ­culo 9 de la Circular 3/2020,             de 15 de enero, por la que se establece la metodologÃ­a para el cÃ¡lculo de los peajes de transporte y distribuciÃ³n de energÃ­a elÃ©ctrica."]},{"sector":"A12_Mayor_de_50_kW","grupo":"A1_GestiÃ³n_y_negociaciÃ³n_de_contratos_de_energÃ­a","cod":"FacturaciÃ³n_por_potencia_mayor_de_50_kW_con_sobrepasamientos","descripcion":["La facturaciÃ³n por potencia contratada se calcula segÃºn lo establecido en el artÃ­culo 9 de la Circular 3/2020,             de 15 de enero, por la que se establece la metodologÃ­a para el cÃ¡lculo de los peajes de transporte y distribuciÃ³n de energÃ­a elÃ©ctrica."]},{"sector":"A12_Mayor_de_50_kW","grupo":"A1_GestiÃ³n_y_negociaciÃ³n_de_contratos_de_energÃ­a","cod":"A113_FacturaciÃ³n_por_potencia_hasta_50_kW_con_lecturas","descripcion":["La facturaciÃ³n por potencia contratada se calcula segÃºn lo establecido en el artÃ­culo 9 de la Circular 3/2020,             de 15 de enero, por la que se establece la metodologÃ­a para el cÃ¡lculo de los peajes de transporte y distribuciÃ³n de energÃ­a elÃ©ctrica."]},{"sector":"A52_Residencial","grupo":"A5_Certificados_de_ahorro_energÃ©tico","cod":"RES020_RehabilitaciÃ³n_de_la_parte_opaca_de_la_envolvente_tÃ©rmica_de_edificios_de_viviendas_con_superficie_afectada_inferior_o_igual_al_25_por_ciento_de_la_envolvente_tÃ©rmica_final","descripcion":["RehabilitaciÃ³n de la parte opaca de la envolvente tÃ©rmica, cuando la superficie afectada represente hasta un 25 % de la superficie total de la envolvente tÃ©rmica final, de un edificio existente de uso residencial privado[1], ubicado en la PenÃ­nsula, las Illes Balears o en las ciudades de Ceuta o Melilla."]},{"sector":"A52_Residencial","grupo":"A5_Certificados_de_ahorro_energÃ©tico","cod":"RES092_HibridaciÃ³n_en_modo_paralelo_de_caldera_s_de_combustiÃ³n_con_bomba_de_calor_de_accionamiento_elÃ©ctrico_en_edificios_residenciales_ubicados_en_la_zona_climÃ¡tica_C1_C2_C3_o_C4","descripcion":["HibridaciÃ³n en modo paralelo de caldera/s de combustiÃ³n existente/s en un edificio de uso residencial privado[1], ubicado en zona climÃ¡tica A3 o A4, con bomba de calor de accionamiento elÃ©ctrico tipo aire-aire, aire-agua o agua-agua o combinadas, para la calefacciÃ³n y/o, agua caliente sanitaria (ACS).","En esta ficha no es aplicable las bombas de calor cuyo compresor estÃ© accionado tÃ©rmicamente."]},{"sector":"A52_Residencial","grupo":"A5_Certificados_de_ahorro_energÃ©tico","cod":"RES090_HibridaciÃ³n_en_modo_paralelo_de_caldera_s_de_combustiÃ³n_con_bomba_de_calor_de_accionamiento_elÃ©ctrico_en_edificios_residenciales_ubicados_en_la_zona_climÃ¡tica_A3_o_A4","descripcion":["HibridaciÃ³n en modo paralelo de caldera/s de combustiÃ³n existente/s en un edificio de uso residencial privado[1], ubicado en zona climÃ¡tica A3 o A4, con bomba de calor de accionamiento elÃ©ctrico tipo aire-aire, aire-agua o agua-agua o combinadas, para la calefacciÃ³n y/o, agua caliente sanitaria (ACS).","En esta ficha no es aplicable las bombas de calor cuyo compresor estÃ© accionado tÃ©rmicamente."]},{"sector":"A52_Residencial","grupo":"A5_Certificados_de_ahorro_energÃ©tico","cod":"RES010_RehabilitaciÃ³n_de_la_envolvente_tÃ©rmica_de_edificios_de_viviendas_con_superficie_afectada_mayor_del_25_por_ciento","descripcion":["RehabilitaciÃ³n de mÃ¡s del 25 % de la superficie total de la envolvente tÃ©rmica final de un edificio existente de uso residencial privado[1], ubicado en la PenÃ­nsula, las Illes Balears o en las ciudades de Ceuta y Melilla."]},{"sector":"A52_Residencial","grupo":"A5_Certificados_de_ahorro_energÃ©tico","cod":"RES093_HibridaciÃ³n_en_modo_paralelo_de_caldera_s_de_combustiÃ³n_con_bomba_de_calor_de_accionamiento_elÃ©ctrico_en_edificios_residenciales_ubicados_en_la_zona_climÃ¡tica_D1_D2_o_D3","descripcion":["HibridaciÃ³n en modo paralelo de caldera/s de combustiÃ³n existente/s en un edificio de uso residencial privado[1], ubicado en zona climÃ¡tica A3 o A4, con bomba de calor de accionamiento elÃ©ctrico tipo aire-aire, aire-agua o agua-agua o combinadas, para la calefacciÃ³n y/o, agua caliente sanitaria (ACS).","En esta ficha no es aplicable las bombas de calor cuyo compresor estÃ© accionado tÃ©rmicamente."]},{"sector":"A52_Residencial","grupo":"A5_Certificados_de_ahorro_energÃ©tico","cod":"RES060_SustituciÃ³n_de_caldera_de_combustiÃ³n_por_una_bomba_de_calor_de_accionamiento_elÃ©ctrico","descripcion":["SustituciÃ³n[1] de la caldera de combustiÃ³n en un edificio de uso residencial privado[2] por una bomba de calor de accionamiento elÃ©ctrico tipo aire-aire, aire-agua, agua-agua, tierra-agua o tierra-aire para calefacciÃ³n y/o agua caliente sanitaria (ACS).","La actuaciÃ³n no afecta a los elementos terminales que configuran la instalaciÃ³n tÃ©rmica."]},{"sector":"A52_Residencial","grupo":"A5_Certificados_de_ahorro_energÃ©tico","cod":"RES094_HibridaciÃ³n_en_modo_paralelo_de_caldera_s_de_combustiÃ³n_con_bomba_de_calor_de_accionamiento_elÃ©ctrico_en_edificios_residenciales_ubicados_en_la_zona_climÃ¡tica_E1","descripcion":["HibridaciÃ³n en modo paralelo de caldera/s de combustiÃ³n existente/s en un edificio de uso residencial privado[1], ubicado en zona climÃ¡tica A3 o A4, con bomba de calor de accionamiento elÃ©ctrico tipo aire-aire, aire-agua o agua-agua o combinadas, para la calefacciÃ³n y/o, agua caliente sanitaria (ACS).","En esta ficha no es aplicable las bombas de calor cuyo compresor estÃ© accionado tÃ©rmicamente."]},{"sector":"A52_Residencial","grupo":"A5_Certificados_de_ahorro_energÃ©tico","cod":"RES091_HibridaciÃ³n_en_modo_paralelo_de_caldera_s_de_combustiÃ³n_con_bomba_de_calor_de_accionamiento_elÃ©ctrico_en_edificios_residenciales_ubicados_en_la_zona_climÃ¡tica_B3_o_B4","descripcion":["HibridaciÃ³n en modo paralelo de caldera/s de combustiÃ³n existente/s en un edificio de uso residencial privado[1], ubicado en zona climÃ¡tica A3 o A4, con bomba de calor de accionamiento elÃ©ctrico tipo aire-aire, aire-agua o agua-agua o combinadas, para la calefacciÃ³n y/o, agua caliente sanitaria (ACS).","En esta ficha no es aplicable las bombas de calor cuyo compresor estÃ© accionado tÃ©rmicamente."]},{"sector":"A51_Industrial","grupo":"A5_Certificados_de_ahorro_energÃ©tico","cod":"IND260_SustituciÃ³n_de_un_Sistema_de_AlimentaciÃ³n_Ininterrumpida_SAI","descripcion":["SustituciÃ³n de uno o varios Sistema(s) de AlimentaciÃ³n Ininterrumpida (SAI) por uno o varios nuevo(s) mÃ¡s eficiente(s) para uso en actividades industriales."]},{"sector":"A51_Industrial","grupo":"A5_Certificados_de_ahorro_energÃ©tico","cod":"IND090_SustituciÃ³n_o_reemplazo_de_compresor_de_aire_por_uno_mÃ¡s_eficiente","descripcion":["SustituciÃ³n de un compresor neumÃ¡tico por uno nuevo mÃ¡s eficiente, ambos sin variadores de velocidad, para uso en procesos industriales donde la demanda Ãºtil de aire comprimido no varÃ­e."]},{"sector":"A51_Industrial","grupo":"A5_Certificados_de_ahorro_energÃ©tico","cod":"IND240_ImplantaciÃ³n_de_variador_de_velocidad","descripcion":["InstalaciÃ³n y puesta en funcionamiento de uno o varios variadores de velocidad en sus correspondientes motores para la regulaciÃ³n de la carga cuando la demanda de energÃ­a sea variable en el proceso industrial al que estÃ¡ acoplado.","Quedan incluidos variadores de velocidad para controlar todo tipo de aplicaciones, ya sean bombas, ventiladores, compresores, motorreductores o cualquier tipo de aplicaciones en las que haya que controlar un motor elÃ©ctrico."]},{"sector":"A51_Industrial","grupo":"A5_Certificados_de_ahorro_energÃ©tico","cod":"IND290_RecuperaciÃ³n_de_calor_en_circuito_frigorifico","descripcion":["Instalaciones frigorÃ­ficas centralizadas o compactas existentes en las que se implante un sistema de recuperaciÃ³n de calor en la lÃ­nea de descarga del refrigerante o en el sistema de refrigeraciÃ³n de aceite de los compresores para uso en el propio establecimiento industrial (agua caliente sanitaria, limpieza y/o calefacciÃ³n, etc.)."]},{"sector":"A53_Terciario","grupo":"A5_Certificados_de_ahorro_energÃ©tico","cod":"TER280_SustituciÃ³n_de_bomba_por_otra_mÃ¡s_eficiente","descripcion":["SustituciÃ³n de una bomba por otra mÃ¡s eficiente, ambas sin regulaciÃ³n.","Las bombas deberÃ¡n dar servicio a una instalaciÃ³n que no haya experimentado cambios sustanciales en su velocidad, presiÃ³n y caudal de trabajo."]},{"sector":"A53_Terciario","grupo":"A5_Certificados_de_ahorro_energÃ©tico","cod":"TER260_SustituciÃ³n_de_un_Sistema_de_AlimentaciÃ³n_Ininterrumpida_SAI","descripcion":["SustituciÃ³n de uno o varios Sistema(s) de AlimentaciÃ³n Ininterrumpida (SAI) por uno o varios nuevo(s) mÃ¡s eficiente(s) para uso en actividades terciarias."]},{"sector":"A53_Terciario","grupo":"A5_Certificados_de_ahorro_energÃ©tico","cod":"TER040_SustituciÃ³n_de_generador_de_climatizaciÃ³n_por_bomba_de_calor_de_accionamiento_elÃ©ctrico","descripcion":["SustituciÃ³n total del equipo o los equipos de climatizaciÃ³n (calefacciÃ³n y/o refrigeraciÃ³n) y/o agua caliente sanitaria (ACS) y/o calentamiento de piscinas o similares en un edificio del sector terciario (hoteles, restaurantes, hospitales, centros educativos, bibliotecas, centros culturales, oficinas, centros comerciales etc.) por una bomba de calor tipo aire-aire, aire-agua o agua-agua, tierra-agua o tierra-aire accionada elÃ©ctricamente, no afectando la actuaciÃ³n a los elementos que configuran la instalaciÃ³n tÃ©rmica.","No son aplicables las bombas de calor cuyo compresor estÃ© accionado tÃ©rmicamente."]},{"sector":"A54_","grupo":"A5_Certificados_de_ahorro_energÃ©tico","cod":"AGR010_Pantallas_tÃ©rmicas_en_invernaderos","descripcion":["InstalaciÃ³n o sustituciÃ³n de pantallas tÃ©rmicas en invernaderos para cultivos agrÃ­colas, plantas ornamentales o cultivos de flor. ","Se considera pantalla tÃ©rmica al sistema pasivo de calefacciÃ³n formado por hilos o filamentos de material ","poliÃ©ster o acrÃ­lico transparente o aluminizado, tejido o conformado en lÃ¡minas continuas que actÃºan como ","barrera tÃ©rmica entre el ambiente interior del invernadero y el exterior regulando el intercambio de calor."]},{"sector":"A81_Simplificados","grupo":"A8_Estudios","cod":"A811_ESTUDIO_SIMPLIFICADO_DE_VIABILIDAD_ECONÃ“MICA_DE_UNA_INVERSIÃ“N","descripcion":["Este estudio simplificado analiza la viabilidad econÃ³mica de un proyecto considerando inversiÃ³n inicial, ingresos y gastos anuales, inflaciÃ³n y tasa de interÃ©s."]}]`),HomePage$6=({showAyuda:t=!1,showLanding:e=!0,showCarrusel:r=!0,showInicio:n=!0,showDescripcion:i=!0,showServicios:s=!0,showFaq:a=!0,showContacto:o=!0,showPrivacyPolicy:c=!0,showTermsOfUse:u=!0,showAboutUs:h=!0})=>{const f=useNavigate(),m="#1976d2",[E,g]=reactExports.useState(0);useTheme();const p=[{titulo:"Estudio y ConsultorÃ­a",icono:jsxRuntimeExports.jsx(EngineeringIcon,{}),color:"#4fc3f7",items:["Estudios de Viabilidad TÃ©cnico-EconÃ³mica","AuditorÃ­as EnergÃ©ticas y de Eficiencia","AnÃ¡lisis de Necesidades","Asesoramiento TÃ©cnico Especializado"]},{titulo:"ProyecciÃ³n y DiseÃ±o",icono:jsxRuntimeExports.jsx(DesignServicesIcon,{}),color:"#81c784",items:["Desarrollo de Proyectos Ejecutivos","CÃ¡lculos y Simulaciones","PlanificaciÃ³n de Proyectos","ObtenciÃ³n de Licencias y Permisos"]},{titulo:"InstalaciÃ³n e ImplementaciÃ³n",icono:jsxRuntimeExports.jsx(BuildIcon,{}),color:"#ffb74d",items:["DirecciÃ³n de Obra y EjecuciÃ³n","GestiÃ³n de Compras y Suministros","CoordinaciÃ³n de Subcontratas","Puesta en Marcha y Comisionado"]},{titulo:"Mantenimiento y Soporte",icono:jsxRuntimeExports.jsx(SettingsIcon,{}),color:"#ba68c8",items:["Planes de Mantenimiento Preventivo y Predictivo","Mantenimiento Correctivo","Monitoreo Remoto y TelemetrÃ­a","Servicio de Asistencia TÃ©cnica 24/7"]},{titulo:"GestiÃ³n y OptimizaciÃ³n",icono:jsxRuntimeExports.jsx(ManageAccountsIcon,{}),color:"#ff8a65",items:["GestiÃ³n Integral de Proyectos (Project Management)","GestiÃ³n de Activos","OptimizaciÃ³n de Procesos","GestiÃ³n Documental"]}],_=[{id:18,title_es:"Automatismos Industriales",description_es:"Sistemas de automatizaciÃ³n y control para procesos industriales.",full_description_es:"DiseÃ±o, implementaciÃ³n y mantenimiento de sistemas de automatizaciÃ³n industrial incluyendo control de procesos, robÃ³tica, SCADA, PLCs y sistemas de supervisiÃ³n para optimizar la producciÃ³n industrial.",icon:jsxRuntimeExports.jsx(PrecisionManufacturingIcon,{sx:{fontSize:60,color:m}}),link:"/Docs",image:"/img/ai01.png",group:"Automatizacion_Industrial",sector:"Industria",searchtext:"automatismos industriales PLC SCADA robÃ³tica control procesos"},{id:14,title_es:"GestiÃ³n y negociaciÃ³n de contratos de energÃ­a",description_es:"AnÃ¡lisis y gestiÃ³n de contratos energÃ©ticos para reducir costes y maximizar eficiencia.",full_description_es:"RevisiÃ³n de tarifas, anÃ¡lisis de consumo histÃ³rico, simulaciÃ³n de escenarios y recomendaciones para gestionar y       negociar de forma eficiente los contratos de suministro de energÃ­a (electricidad y        gas) necesarios en la industria, comercio o suministro residencial.",icon:jsxRuntimeExports.jsx(BoltIcon,{sx:{fontSize:60,color:m}}),link:"/Docs",image:"/img/OptimizaciÃ³n_de_contratos_de_energÃ­a.jpeg",group:"OptimizaciÃ³n_Contratos_EnergÃ­a",sector:"EnergÃ­a",searchtext:"contratos energÃ­a optimizaciÃ³n ahorro consumo"},{id:12,title_es:"Comunidades EnergÃ©ticas",description_es:"Estudio de diseÃ±o y viabilidad (tÃ©cnica, econÃ³mica y legal), creaciÃ³n y gestiÃ³n de comunidades ciudadanas de energÃ­a y comunidades de energÃ­as renovables.",full_description_es:"Estudio de diseÃ±o y viabilidad (tÃ©cnica, econÃ³mica y legal), creaciÃ³n y gestiÃ³n de comunidades ciudadanas de energÃ­a y comunidades de energÃ­as renovables.",icon:jsxRuntimeExports.jsx(GroupsIcon,{sx:{fontSize:60,color:m}}),link:"/Docs",image:"/img/ce01.png",group:"Control_Comunidades_Autoconsumo",sector:"EnergÃ­a",searchtext:"comunidades energÃ©ticas autoconsumo"},{id:17,title_es:"Mantenimiento Preventivo",description_es:"MonitorizaciÃ³n de maquinaria para prevenir fallos y optimizar su vida Ãºtil.",full_description_es:"Sensores, alertas tempranas de desgaste, anÃ¡lisis de rendimiento y reportes automÃ¡ticos para planificar mantenimientos preventivos y reducir paradas no programadas.",icon:jsxRuntimeExports.jsx(VibrationIcon,{sx:{fontSize:60,color:m}}),link:"/Docs",image:"/img/mp01.png",group:"Mantenimiento_Vibraciones",sector:"Mantenimiento / Industria",searchtext:"mantenimiento preventivo vibraciones maquinaria alertas"},{id:13,title_es:"AuditorÃ­as EnergÃ©ticas",description_es:"SupervisiÃ³n y validaciÃ³n de auditorÃ­as energÃ©ticas para optimizar el consumo.",full_description_es:"Mapeado energÃ©tico, anÃ¡lisis de consumo, propuesta de mejores energÃ©ticas, generaciÃ³n de informes, recomendaciones y seguimiento de medidas de eficiencia energÃ©tica.",icon:jsxRuntimeExports.jsx(SearchIcon,{sx:{fontSize:60,color:m}}),link:"/Docs",image:"/img/ae01.png",group:"Control_Auditorias_EnergÃ©ticas",sector:"Eficiencia EnergÃ©tica",searchtext:"auditorÃ­as energÃ©ticas eficiencia control"},{id:10,title_es:"Infraestructura de puntos de Recarga para VehÃ­culos ElÃ©ctricos (IRVE)",description_es:"instalaciÃ³n y gestiÃ³n de soluciones de carga para vehÃ­culos elÃ©ctricos.",full_description_es:"InstalaciÃ³n, mantenimiento y gestiÃ³n de Infraestructura de puntos de Recarga para VehÃ­culos ElÃ©ctricos (IRVE). Implementar los puntos de conexiÃ³n necesarios para suministrar energÃ­a a estos vehÃ­culos, permitiendo su recarga de forma segura y eficiente supervisiÃ³n de estaciones de recarga en parkings pÃºblicos, comunidades de vecinos y empresas.",icon:jsxRuntimeExports.jsx(EvStationIcon,{sx:{fontSize:60,color:m}}),link:"/Docs",image:"/img/Recarga_de_vehÃ­culos_elÃ©ctricos.jpeg",group:"Control_Recarga_EV",sector:"Movilidad",searchtext:"vehÃ­culos elÃ©ctricos recarga parkings empresas comunidades"},{id:11,title_es:"AutomatizaciÃ³n del control de invernaderos",description_es:"Monitoreo de riego, humedad del suelo, condiciones ambientales y consumos en agricultura.",full_description_es:"Incluye sensores de suelo, clima, control de riego automatizado e informes de eficiencia agrÃ­cola para maximizar el rendimiento.",icon:jsxRuntimeExports.jsx(AgricultureIcon,{sx:{fontSize:60,color:m}}),link:"/Docs",image:"/img/g01.png",group:"Control_Agricultura",sector:"Agricultura",searchtext:"agricultura riego humedad cultivo"},{id:15,title_es:"Tracking de Flotas y Animales",description_es:"Monitoreo en tiempo real de vehÃ­culos o ganado mediante dispositivos IoT.",full_description_es:"Incluye localizaciÃ³n GPS, geocercas, alertas de movimiento, historial de rutas y reportes de comportamiento para optimizar logÃ­stica o gestiÃ³n de animales.",icon:jsxRuntimeExports.jsx(GpsFixedIcon,{sx:{fontSize:60,color:m}}),link:"/Docs",image:"/img/tv01.png",group:"Tracking_Flotas_Animales",sector:"LogÃ­stica / Agricultura",searchtext:"tracking GPS vehÃ­culos animales flotas ganaderÃ­a logÃ­stica"}],A={dots:!0,infinite:!0,speed:500,slidesToShow:1,slidesToScroll:1,autoplay:!0,autoplaySpeed:4e3},H=(q,me)=>{sessionStorage.setItem("selectedGroup",q),f(me)},te=[{id:1,title_es:"Personalizar un documento",description_es:`
       Seleccionar el documento, desde la imagen o del menu superior.  
       Se carga con valores iniciales por defecto. 
       Personalizarlos clicando en el menu inferior Personalizar o sobre el propio documento. 
       Se abre un formulario con los parametros separados en hojas, similar a un libro excel. 
       Clicar en la celda para modificarla. 
       Clicar Recalcular en el menu inferior para obtener el documento personalizado.      `,video:"/img/1.mp4"},{id:2,title_es:"Exportar e importar a excel",description_es:`
       Los parametros del documento se pueden exportar a excel.  
       Se puedn modificar desde excel y volver a  importarlos para obtener el documento cuando lo desee. 
       La aplicacion no guarda sus datos. 
        `,video:"2.webm"}],[ne,j]=reactExports.useState(!1),[ee,x]=reactExports.useState(null),[M,T]=reactExports.useState(!1),O=q=>{x(q),j(!0)},R=()=>{j(!1),x(null)},Y=q=>(me,xe)=>{T(xe?q:!1)};return jsxRuntimeExports.jsxs(Box,{sx:{position:"relative",width:"100%",minHeight:"100vh",overflow:"hidden",backgroundColor:"white"},children:[jsxRuntimeExports.jsx(Box,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"white",zIndex:-2}}),jsxRuntimeExports.jsxs(Box,{sx:{position:"relative",zIndex:1},children:[t&&jsxRuntimeExports.jsxs(Container,{sx:{py:8},children:[jsxRuntimeExports.jsx(Typography,{variant:"h4",sx:{fontWeight:"bold",mb:4,color:"#000",textAlign:"center"},children:"Ayuda"}),te.map(q=>jsxRuntimeExports.jsxs(Accordion,{expanded:M===q.id,onChange:Y(q.id),sx:{background:"white",border:"2px solid rgba(0, 0, 0, 0.2)",borderRadius:"8px !important",color:"#000",mb:2,"&:before":{display:"none"},"&:hover":{border:"2px solid #ed6c02"}},children:[jsxRuntimeExports.jsx(AccordionSummary,{expandIcon:jsxRuntimeExports.jsx(ExpandMoreIcon,{sx:{color:"#000"}}),sx:{"& .MuiAccordionSummary-content":{alignItems:"center"}},children:jsxRuntimeExports.jsx(Typography,{sx:{fontWeight:"bold"},children:q.title_es})}),jsxRuntimeExports.jsxs(AccordionDetails,{children:[jsxRuntimeExports.jsx(Typography,{sx:{mb:2,whiteSpace:"pre-wrap"},children:q.description_es}),jsxRuntimeExports.jsx(Button,{variant:"contained",color:"primary",onClick:()=>O(q.video),children:"Ver video"})]})]},q.id)),jsxRuntimeExports.jsxs(Dialog,{open:ne,onClose:R,maxWidth:!1,PaperProps:{sx:{height:"100vh",aspectRatio:"9 / 18.3",borderRadius:"16px",overflow:"hidden",backgroundColor:"#000",display:"flex",justifyContent:"center",alignItems:"center",margin:"auto",boxShadow:8}},children:[ee&&jsxRuntimeExports.jsx("video",{src:ee,controls:!0,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,style:{width:"100%",height:"100%",objectFit:"cover",display:"block",backgroundColor:"#000"},onClick:q=>q.stopPropagation()}),jsxRuntimeExports.jsx(Box,{onClick:q=>{q.stopPropagation(),R()},sx:{position:"absolute",top:12,right:12,backgroundColor:"rgba(255, 0, 0, 0.9)",borderRadius:"50%",width:44,height:44,display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",zIndex:10,"&:hover":{backgroundColor:"rgba(200, 0, 0, 1)",transform:"scale(1.05)"}},children:jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),jsxRuntimeExports.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]}),e&&jsxRuntimeExports.jsxs(Container,{maxWidth:"lg",sx:{py:8,position:"relative",zIndex:1},children:[jsxRuntimeExports.jsxs(Box,{textAlign:"center",mb:6,children:[jsxRuntimeExports.jsx(Chip,{label:"Servicios Profesionales",color:"primary",sx:{mb:2,px:2,py:1,fontSize:"1rem",backgroundColor:"rgba(25, 118, 210, 0.9)",color:"white"}}),jsxRuntimeExports.jsx(Typography,{variant:"h3",component:"h1",gutterBottom:!0,sx:{color:"black",fontWeight:"bold"},children:"Servicios de IngenierÃ­a"}),jsxRuntimeExports.jsx(Typography,{variant:"h6",sx:{color:"rgba(0,0,0,0.8)",maxWidth:"600px",margin:"0 auto"},children:'"De la idea a la realidad: Soluciones de ingenierÃ­a integrales, llave en mano."'})]}),jsxRuntimeExports.jsx(Box,{textAlign:"center",mt:6,children:jsxRuntimeExports.jsx(Button,{variant:"contained",size:"large",sx:{px:4,py:1.5,fontSize:"1.1rem",background:"rgba(25, 118, 210, 0.9)",border:"1px solid rgba(0,0,0,0.1)","&:hover":{background:"rgba(21, 101, 192, 0.9)",transform:"translateY(-2px)"},transition:"all 0.3s ease"},onClick:()=>f("/contacto"),children:"Solicitar Propuesta Personalizada"})}),jsxRuntimeExports.jsx(Divider,{sx:{my:4,backgroundColor:"rgba(0,0,0,0.2)"}}),jsxRuntimeExports.jsx(Grid,{container:!0,spacing:4,children:p.map((q,me)=>jsxRuntimeExports.jsx(Grid,{item:!0,xs:12,md:6,children:jsxRuntimeExports.jsx(Card,{sx:{height:"100%",background:"white",border:"2px solid rgba(0, 0, 0, 0.2)",borderRadius:"12px",transition:"all 0.3s ease",position:"relative",overflow:"visible","&:hover":{transform:"translateY(-8px)",border:`2px solid ${q.color}`,boxShadow:`0 8px 32px ${q.color}60`,"&::before":{opacity:1}},"&::before":{content:'""',position:"absolute",top:"-3px",left:"-3px",right:"-3px",bottom:"-3px",background:`linear-gradient(45deg, transparent, ${q.color}20, transparent)`,borderRadius:"14px",zIndex:-1,opacity:0,transition:"opacity 0.3s ease"}},children:jsxRuntimeExports.jsxs(CardContent,{sx:{p:3},children:[jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",alignItems:"center",mb:3},children:[jsxRuntimeExports.jsx(Box,{sx:{color:q.color,mr:2,fontSize:"2.2rem"},children:q.icono}),jsxRuntimeExports.jsx(Typography,{variant:"h5",component:"h2",sx:{color:"black",fontWeight:"bold"},children:q.titulo})]}),jsxRuntimeExports.jsx(Box,{component:"ul",sx:{pl:2,mb:0},children:q.items.map((xe,Ee)=>jsxRuntimeExports.jsx(Typography,{component:"li",variant:"body1",sx:{mb:1.5,color:"rgba(0,0,0,0.9)",fontWeight:500,"&:before":{content:'"â–¸"',color:q.color,fontWeight:"bold",display:"inline-block",width:"1em",marginLeft:"-1em"}},children:xe},Ee))})]})})},me))}),jsxRuntimeExports.jsx(Box,{sx:{display:{xs:"block",md:"none"},mt:4},children:p.map((q,me)=>jsxRuntimeExports.jsxs(Accordion,{sx:{background:"white",border:"1px solid rgba(0, 0, 0, 0.2)",color:"black",mb:2,"&:before":{display:"none"}},children:[jsxRuntimeExports.jsx(AccordionSummary,{expandIcon:jsxRuntimeExports.jsx(ExpandMoreIcon,{sx:{color:q.color}}),sx:{"& .MuiAccordionSummary-content":{alignItems:"center"}},children:jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",alignItems:"center"},children:[jsxRuntimeExports.jsx(Box,{sx:{color:q.color,mr:2,fontSize:"1.8rem"},children:q.icono}),jsxRuntimeExports.jsx(Typography,{variant:"h6",sx:{color:"black"},children:q.titulo})]})}),jsxRuntimeExports.jsx(AccordionDetails,{children:jsxRuntimeExports.jsx(Box,{component:"ul",sx:{pl:2,mb:0},children:q.items.map((xe,Ee)=>jsxRuntimeExports.jsx(Typography,{component:"li",variant:"body1",sx:{mb:1.5,color:"rgba(0,0,0,0.9)","&:before":{content:'"â–¸"',color:q.color,fontWeight:"bold",display:"inline-block",width:"1em",marginLeft:"-1em"}},children:xe},Ee))})})]},me))})]}),r&&jsxRuntimeExports.jsx(Container,{sx:{py:8},children:jsxRuntimeExports.jsx(Slider,Br(Er({},A),{children:_.map(q=>jsxRuntimeExports.jsxs(Box,{sx:{position:"relative",borderRadius:3,overflow:"hidden",cursor:"pointer",border:"2px solid rgba(0, 0, 0, 0.2)",background:"white",transition:"all 0.3s ease","&:hover":{transform:"translateY(-4px)",boxShadow:"0 8px 25px rgba(25, 118, 210, 0.3)"}},onClick:()=>H(q.group,"/Blog"),children:[jsxRuntimeExports.jsx(CardMedia,{component:"img",src:q.image,alt:q.title_es,onError:me=>{me.target.src="/img/defecto.png"},sx:{width:"100%",height:"100%",objectFit:"cover"}}),jsxRuntimeExports.jsxs(Box,{sx:{position:"absolute",bottom:0,left:0,width:"100%",p:3,background:"linear-gradient(to top, rgba(0,0,0,0.8), transparent)",color:"#fff"},children:[jsxRuntimeExports.jsx(Typography,{variant:"h5",sx:{fontWeight:"bold",mb:1},children:q.title_es}),jsxRuntimeExports.jsx(Typography,{variant:"body1",children:q.description_es})]})]},q.id))}))}),n&&jsxRuntimeExports.jsx(Container,{sx:{py:8},children:jsxRuntimeExports.jsx(Box,{sx:{position:"relative",width:"100%",height:400,backgroundImage:"url('/img/banner-fondo.jpeg')",backgroundSize:"cover",backgroundPosition:"center",display:"flex",alignItems:"center",justifyContent:"center",color:"#000",textAlign:"center",border:"2px solid rgba(0, 0, 0, 0.2)",borderRadius:"12px",background:"white",overflow:"hidden"},children:jsxRuntimeExports.jsxs(Box,{sx:{position:"relative",zIndex:2,py:8,px:4},children:[jsxRuntimeExports.jsx(Typography,{variant:"h3",sx:{fontWeight:"bold",mb:2},children:"IngenierÃ­a"}),jsxRuntimeExports.jsx(Typography,{variant:"h6",sx:{mb:2},children:"Proyectos y estudios independientes de viabilidad de instalaciones . Control y SupervisiÃ³n de procesos"}),jsxRuntimeExports.jsx(Typography,{variant:"subtitle1",sx:{fontStyle:"italic",color:"#000"},children:"Viability studies and projects. Control and Supervision"}),jsxRuntimeExports.jsx(Divider,{sx:{my:3,borderColor:"rgba(0,0,0,0.3)"}})]})})}),i&&jsxRuntimeExports.jsx(Container,{sx:{py:8},children:jsxRuntimeExports.jsxs(Card,{sx:{p:3,borderRadius:"12px",background:"white",border:"2px solid rgba(0, 0, 0, 0.2)",color:"#000",transition:"all 0.3s ease","&:hover":{border:"2px solid #1976d2",boxShadow:"0 8px 25px rgba(25, 118, 210, 0.3)"}},children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",sx:{mb:2,fontWeight:"bold"},children:"Blog tÃ©cnico interactivo de uso libre y gratuito."}),jsxRuntimeExports.jsxs(Typography,{variant:"body2",sx:{display:"flex",alignItems:"center",gap:1},children:["Licencia Creative Commons con atribuciÃ³n requerida."," ",jsxRuntimeExports.jsx(Link$1,{href:"https://creativecommons.org/licenses/by/4.0/deed.es",target:"_blank",rel:"noopener noreferrer",underline:"hover",sx:{color:"#1976d2"},children:jsxRuntimeExports.jsx("img",{src:"https://licensebuttons.net/l/by/4.0/88x31.png",alt:"Creative Commons Attribution 4.0 License",style:{verticalAlign:"middle",height:20}})})]})]})}),s&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Container,{sx:{py:8},children:jsxRuntimeExports.jsxs(Card,{sx:{p:3,borderRadius:"12px",background:"white",border:"2px solid rgba(0, 0, 0, 0.2)",color:"#000",transition:"all 0.3s ease","&:hover":{border:"2px solid #2e7d32",boxShadow:"0 8px 25px rgba(46, 125, 50, 0.3)"}},children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",sx:{mb:2,fontWeight:"bold"},children:"Soluciones Integrales de IngenierÃ­a y Eficiencia EnergÃ©tica."}),jsxRuntimeExports.jsx(Typography,{variant:"body1",children:"Servicios de ingenierÃ­a para optimizar recursos, control de instalaciones industriales, supervisiÃ³n de procesos en energÃ­a, agua, agricultura, movilidad y medio ambiente. Mantenimiento predictivo, auditorÃ­as y proyectos con enfoque en eficiencia, sostenibilidad y reducciÃ³n de costes."})]})}),jsxRuntimeExports.jsx(Container,{sx:{py:1},children:jsxRuntimeExports.jsx(Grid,{container:!0,spacing:3,children:_.map(q=>jsxRuntimeExports.jsx(Grid,{item:!0,xs:12,sm:6,md:4,children:jsxRuntimeExports.jsx(Card,{sx:{borderRadius:"12px",overflow:"hidden",cursor:"pointer",background:"white",border:"2px solid rgba(0, 0, 0, 0.2)",transition:"all 0.3s ease",position:"relative","&:hover":{transform:"translateY(-8px)",border:"2px solid #1976d2",boxShadow:"0 12px 35px rgba(25, 118, 210, 0.4)"}},onClick:()=>H(q.group,"/Blog"),children:jsxRuntimeExports.jsxs(Box,{sx:{position:"relative",height:300},children:[jsxRuntimeExports.jsx(CardMedia,{component:"img",src:q.image,alt:q.title_es,onError:me=>{me.target.src="/img/defecto.png"},sx:{width:"100%",height:"100%",objectFit:"cover"}}),jsxRuntimeExports.jsxs(Box,{sx:{position:"absolute",bottom:0,left:0,width:"100%",height:"70%",p:2,background:"linear-gradient(to bottom, rgba(255,255,255,0) 0%, rgba(0,0,0,0.9) 100%)",color:"#fff",display:"flex",flexDirection:"column",gap:1,justifyContent:"flex-end"},children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",sx:{fontWeight:"bold"},children:q.title_es}),jsxRuntimeExports.jsx(Typography,{variant:"body2",children:q.full_description_es})]})]})})},q.id))})})]}),a&&jsxRuntimeExports.jsxs(Container,{sx:{py:8},children:[jsxRuntimeExports.jsx(Typography,{variant:"h4",sx:{fontWeight:"bold",mb:4,color:"#000",textAlign:"center"},children:"Preguntas frecuentes"}),_.map(q=>jsxRuntimeExports.jsxs(Accordion,{sx:{background:"white",border:"2px solid rgba(0, 0, 0, 0.2)",borderRadius:"8px !important",color:"#000",mb:2,"&:before":{display:"none"},"&:hover":{border:"2px solid #ed6c02"}},children:[jsxRuntimeExports.jsx(AccordionSummary,{expandIcon:jsxRuntimeExports.jsx(ExpandMoreIcon,{sx:{color:"#000"}}),sx:{"& .MuiAccordionSummary-content":{alignItems:"center"}},children:jsxRuntimeExports.jsx(Typography,{sx:{fontWeight:"bold"},children:q.title_es})}),jsxRuntimeExports.jsx(AccordionDetails,{children:jsxRuntimeExports.jsx(Typography,{children:q.description_es})})]},q.id))]}),c&&jsxRuntimeExports.jsx(Container,{sx:{py:8},children:jsxRuntimeExports.jsxs(Card,{sx:{p:4,borderRadius:"12px",background:"white",border:"2px solid rgba(0, 0, 0, 0.2)",color:"#000",transition:"all 0.3s ease","&:hover":{border:"2px solid #1976d2",boxShadow:"0 8px 25px rgba(25, 118, 210, 0.3)"}},children:[jsxRuntimeExports.jsx("h1",{children:"PolÃ­tica de Privacidad"}),jsxRuntimeExports.jsx("p",{children:jsxRuntimeExports.jsxs("strong",{children:["Ãšltima actualizaciÃ³n: ",new Date().getFullYear()]})}),jsxRuntimeExports.jsx("h2",{children:"1. InformaciÃ³n que Recopilamos"}),jsxRuntimeExports.jsx("p",{children:"Recopilamos informaciÃ³n que usted nos proporciona directamente, asÃ­ como informaciÃ³n sobre su uso de nuestros servicios:"}),jsxRuntimeExports.jsxs("ul",{children:[jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"InformaciÃ³n Personal"}),": Al registrarse, es posible que le solicitemos informaciÃ³n personal, como su nombre, direcciÃ³n de correo electrÃ³nico y otra informaciÃ³n relevante."]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"InformaciÃ³n de Uso"}),": Recopilamos informaciÃ³n sobre cÃ³mo interactÃºa con nuestros servicios, incluyendo la fecha y hora de su visita, la duraciÃ³n de la visita y las pÃ¡ginas que visita."]})]}),jsxRuntimeExports.jsx("h2",{children:"2. Uso de la InformaciÃ³n"}),jsxRuntimeExports.jsx("p",{children:"Utilizamos la informaciÃ³n que recopilamos para:"}),jsxRuntimeExports.jsxs("ul",{children:[jsxRuntimeExports.jsx("li",{children:"Proporcionar y mantener nuestros servicios."}),jsxRuntimeExports.jsx("li",{children:"Mejorar y personalizar su experiencia."}),jsxRuntimeExports.jsx("li",{children:"Comunicarnos con usted, incluyendo el envÃ­o de correos electrÃ³nicos sobre actualizaciones, ofertas y promociones."}),jsxRuntimeExports.jsx("li",{children:"Cumplir con nuestras obligaciones legales y resolver disputas."})]}),jsxRuntimeExports.jsx("h2",{children:"3. Almacenamiento de Datos"}),jsxRuntimeExports.jsx("p",{children:"Almacenamos su informaciÃ³n personal durante el tiempo que sea necesario para cumplir con los fines establecidos en esta polÃ­tica, y de acuerdo con nuestras obligaciones legales."}),jsxRuntimeExports.jsx("h2",{children:"4. Compartir InformaciÃ³n"}),jsxRuntimeExports.jsx("p",{children:"No compartimos su informaciÃ³n personal con terceros, excepto en las siguientes circunstancias:"}),jsxRuntimeExports.jsxs("ul",{children:[jsxRuntimeExports.jsx("li",{children:"Con su consentimiento explÃ­cito."}),jsxRuntimeExports.jsx("li",{children:"Con proveedores de servicios que nos ayudan a operar nuestro negocio y proporcionarle nuestros servicios (por ejemplo, servicios de correo electrÃ³nico)."}),jsxRuntimeExports.jsx("li",{children:"Para cumplir con la ley, responder a citaciones o solicitudes legales, o proteger nuestros derechos o los de otros."})]}),jsxRuntimeExports.jsx("h2",{children:"5. Sus Derechos"}),jsxRuntimeExports.jsx("p",{children:"Usted tiene los siguientes derechos respecto a su informaciÃ³n personal:"}),jsxRuntimeExports.jsxs("ul",{children:[jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Acceso"}),": Puede solicitar una copia de la informaciÃ³n que tenemos sobre usted."]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"RectificaciÃ³n"}),": Puede solicitar la correcciÃ³n de informaciÃ³n inexacta o incompleta."]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"EliminaciÃ³n"}),": Puede solicitar la eliminaciÃ³n de su informaciÃ³n personal bajo ciertas condiciones."]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"OposiciÃ³n"}),": Puede oponerse al tratamiento de su informaciÃ³n personal en determinadas circunstancias."]})]}),jsxRuntimeExports.jsx("h2",{children:"6. Seguridad de la InformaciÃ³n"}),jsxRuntimeExports.jsx("p",{children:"Tomamos medidas razonables para proteger su informaciÃ³n personal contra pÃ©rdida, robo y uso indebido. Sin embargo, ningÃºn mÃ©todo de transmisiÃ³n a travÃ©s de Internet o mÃ©todo de almacenamiento electrÃ³nico es 100% seguro. Por lo tanto, no podemos garantizar su seguridad absoluta."}),jsxRuntimeExports.jsx("h2",{children:"7. Cambios a Esta PolÃ­tica de Privacidad"}),jsxRuntimeExports.jsx("p",{children:"Podemos actualizar esta polÃ­tica de privacidad de vez en cuando. Le notificaremos sobre cambios significativos en la forma en que tratamos la informaciÃ³n personal enviÃ¡ndole un aviso a la direcciÃ³n de correo electrÃ³nico que nos proporcionÃ³."})]})}),u&&jsxRuntimeExports.jsx(Container,{sx:{py:8},children:jsxRuntimeExports.jsxs(Card,{sx:{p:4,borderRadius:"12px",background:"white",border:"2px solid rgba(0, 0, 0, 0.2)",color:"#000",transition:"all 0.3s ease","&:hover":{border:"2px solid #2e7d32",boxShadow:"0 8px 25px rgba(46, 125, 50, 0.3)"}},children:[jsxRuntimeExports.jsx(Typography,{variant:"h4",gutterBottom:!0,children:"TÃ©rminos de Uso"}),jsxRuntimeExports.jsx(Typography,{variant:"body1",gutterBottom:!0,children:jsxRuntimeExports.jsxs("strong",{children:["Ãšltima actualizaciÃ³n: ",new Date().getFullYear()]})}),jsxRuntimeExports.jsx(Typography,{variant:"h5",gutterBottom:!0,children:"1. AceptaciÃ³n de los TÃ©rminos"}),jsxRuntimeExports.jsx(Typography,{variant:"body1",paragraph:!0,children:"Al acceder y utilizar este sitio web, usted acepta estar sujeto a estos TÃ©rminos de Uso y a nuestra PolÃ­tica de Privacidad. Si no estÃ¡ de acuerdo con estos tÃ©rminos, le solicitamos que no utilice el sitio."}),jsxRuntimeExports.jsx(Typography,{variant:"h5",gutterBottom:!0,children:"2. Modificaciones a los TÃ©rminos"}),jsxRuntimeExports.jsx(Typography,{variant:"body1",paragraph:!0,children:"Vatiaco se reserva el derecho de modificar estos TÃ©rminos de Uso en cualquier momento. Los cambios entrarÃ¡n en vigor una vez que se publiquen en este sitio. Es su responsabilidad revisar periÃ³dicamente los tÃ©rminos para estar al tanto de cualquier modificaciÃ³n."}),jsxRuntimeExports.jsx(Typography,{variant:"h5",gutterBottom:!0,children:"3. Uso Permitido"}),jsxRuntimeExports.jsx(Typography,{variant:"body1",paragraph:!0,children:"Usted se compromete a utilizar este sitio solo con fines legales y de manera que no infrinja los derechos de otros. No podrÃ¡ utilizar este sitio de ninguna manera que pueda daÃ±ar, deshabilitar, sobrecargar o perjudicar el mismo, ni utilizarlo para realizar actividades fraudulentas, engaÃ±osas o malintencionadas."}),jsxRuntimeExports.jsx(Typography,{variant:"h5",gutterBottom:!0,children:"4. AutorizaciÃ³n para Ofertar Ahorros EnergÃ©ticos"}),jsxRuntimeExports.jsx(Typography,{variant:"body1",paragraph:!0,children:"Al utilizar esta plataforma, el propietario de los ahorros energÃ©ticos autoriza expresamente a Vatiaco a ofertar, exhibir y promocionar sus productos a travÃ©s del sitio. Esta autorizaciÃ³n incluye el derecho de Vatiaco a utilizar imÃ¡genes, descripciones y cualquier otro contenido proporcionado por el propietario para la promociÃ³n de los ahorros energÃ©ticos. El propietario garantiza que tiene todos los derechos necesarios para otorgar esta autorizaciÃ³n."}),jsxRuntimeExports.jsx(Typography,{variant:"h5",gutterBottom:!0,children:"5. Veracidad de la InformaciÃ³n Proporcionada"}),jsxRuntimeExports.jsx(Typography,{variant:"body1",paragraph:!0,children:"Los usuarios del sitio se comprometen a proporcionar informaciÃ³n veraz, precisa y completa en cualquier formulario, registro o interacciÃ³n con el sitio. Cualquier informaciÃ³n falsa, incompleta o engaÃ±osa proporcionada por el usuario podrÃ¡ resultar en la suspensiÃ³n o cancelaciÃ³n de su acceso al sitio sin previo aviso."}),jsxRuntimeExports.jsx(Typography,{variant:"h5",gutterBottom:!0,children:"6. Propiedad Intelectual"}),jsxRuntimeExports.jsx(Typography,{variant:"body1",paragraph:!0,children:"Todos los contenidos de este sitio, incluidos textos, grÃ¡ficos, logotipos, imÃ¡genes y software, son propiedad de Vatiaco o de sus licenciantes y estÃ¡n protegidos por las leyes de derechos de autor y propiedad intelectual. No se permite la reproducciÃ³n, distribuciÃ³n o modificaciÃ³n de ningÃºn contenido sin el consentimiento previo por escrito de Vatiaco."}),jsxRuntimeExports.jsx(Typography,{variant:"h5",gutterBottom:!0,children:"7. LimitaciÃ³n de Responsabilidad"}),jsxRuntimeExports.jsx(Typography,{variant:"body1",paragraph:!0,children:"En la mÃ¡xima medida permitida por la ley, Vatiaco no serÃ¡ responsable de ningÃºn daÃ±o directo, indirecto, incidental, especial, punitivo o consecuente que surja de su acceso o uso del sitio, incluyendo, pero no limitado a, la pÃ©rdida de beneficios o ingresos, o la interrupciÃ³n del negocio."}),jsxRuntimeExports.jsx(Typography,{variant:"h5",gutterBottom:!0,children:"8. Enlaces a Sitios de Terceros"}),jsxRuntimeExports.jsx(Typography,{variant:"body1",paragraph:!0,children:"Este sitio puede contener enlaces a otros sitios web que no son propiedad ni estÃ¡n controlados por Vatiaco. No somos responsables del contenido de dichos sitios y no asumimos ninguna responsabilidad por las prÃ¡cticas de privacidad de los mismos. Le recomendamos que revise los tÃ©rminos y polÃ­ticas de privacidad de cualquier sitio web de terceros que visite."}),jsxRuntimeExports.jsx(Typography,{variant:"h5",gutterBottom:!0,children:"9. Sanciones por Incumplimiento"}),jsxRuntimeExports.jsx(Typography,{variant:"body1",paragraph:!0,children:"En caso de que se descubra que ha proporcionado informaciÃ³n falsa, inexacta o engaÃ±osa, Vatiaco se reserva el derecho de suspender o eliminar su cuenta sin previo aviso. Dependiendo de la gravedad del caso, Vatiaco se reserva el derecho de tomar medidas legales adicionales para proteger sus derechos y los de otros usuarios."}),jsxRuntimeExports.jsx(Typography,{variant:"h5",gutterBottom:!0,children:"10. Ley Aplicable"}),jsxRuntimeExports.jsx(Typography,{variant:"body1",paragraph:!0,children:"Estos TÃ©rminos de Uso se rigen por las leyes de EspaÃ±a. Cualquier disputa relacionada con estos tÃ©rminos estarÃ¡ sujeta a la jurisdicciÃ³n exclusiva de los tribunales de MÃ¡laga."})]})}),h&&jsxRuntimeExports.jsx(Container,{sx:{py:8},children:jsxRuntimeExports.jsxs(Card,{sx:{p:4,borderRadius:"12px",background:"white",border:"2px solid rgba(0, 0, 0, 0.2)",color:"#000",transition:"all 0.3s ease","&:hover":{border:"2px solid #ed6c02",boxShadow:"0 8px 25px rgba(237, 108, 2, 0.3)"}},children:[jsxRuntimeExports.jsx(Typography,{variant:"h4",sx:{fontWeight:"bold",mb:3,textAlign:"center"},children:"Sobre Vatiaco"}),!1,!1,jsxRuntimeExports.jsxs(Grid,{container:!0,spacing:4,children:[jsxRuntimeExports.jsxs(Grid,{item:!0,xs:12,md:6,children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",sx:{mb:2,mt:3,fontWeight:"bold",color:"#007BFF"},children:"Â¿QuÃ© es?"}),jsxRuntimeExports.jsx(Typography,{variant:"body1",sx:{mb:2,lineHeight:1.6},children:"Un espacio en lÃ­nea donde se comparten documentos 'aplantillados' para recibir parÃ¡metros y adaptarse automÃ¡ticamente a distintos contextos o necesidades."}),jsxRuntimeExports.jsx(Typography,{variant:"h6",sx:{mb:2,fontWeight:"bold",color:"#007BFF"},children:"PasiÃ³n"}),jsxRuntimeExports.jsx(Typography,{variant:"body1",sx:{mb:3,fontStyle:"italic",lineHeight:1.6},children:"Este proyecto mantiene viva la pasiÃ³n por la ingenierÃ­a y por el aprendizaje constante. Cada documento refleja el aprecio por una disciplina que continÃºa inspirando curiosidad."})]}),jsxRuntimeExports.jsxs(Grid,{item:!0,xs:12,md:6,children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",sx:{mb:2,fontWeight:"bold",color:"#007BFF"},children:"PropÃ³sito"}),jsxRuntimeExports.jsx(Typography,{variant:"body1",sx:{mb:3,lineHeight:1.6},children:"El objetivo es que estos materiales resulten Ãºtiles y sirvan de inspiraciÃ³n. Que quienes lleguen aquÃ­ encuentren no solo herramientas tÃ©cnicas, sino tambiÃ©n la motivaciÃ³n para crear mas plantillas."}),jsxRuntimeExports.jsx(Typography,{variant:"h6",sx:{mb:2,fontWeight:"bold",color:"#1976d2"},children:"Principios que guÃ­an este proyecto"}),jsxRuntimeExports.jsxs(Box,{component:"ul",sx:{pl:2},children:[jsxRuntimeExports.jsx(Typography,{component:"li",variant:"body1",sx:{mb:1,fontStyle:"italic"},children:"ðŸ’ MÃ¡s que una simple actividad: una forma de bienestar integral."}),jsxRuntimeExports.jsx(Typography,{component:"li",variant:"body1",sx:{mb:1,fontStyle:"italic"},children:"ðŸŒ± Cultivar y mantener la curiosidad."}),jsxRuntimeExports.jsx(Typography,{component:"li",variant:"body1",sx:{mb:1,fontStyle:"italic"},children:"ðŸ”§ Preservar la esencia de la ingenierÃ­a prÃ¡ctica."}),jsxRuntimeExports.jsx(Typography,{component:"li",variant:"body1",sx:{mb:1,fontStyle:"italic"},children:"ðŸ¤ Contribuir con soluciones Ãºtiles y simples."}),jsxRuntimeExports.jsx(Typography,{component:"li",variant:"body1",sx:{mb:1,fontStyle:"italic"},children:"âœ¨ Disfrutar del aprendizaje continuo."})]}),jsxRuntimeExports.jsx(Box,{sx:{mt:3,p:2,backgroundColor:"rgba(0, 123, 255, 0.1)",borderRadius:2,border:"1px solid rgba(0, 123, 255, 0.3)"},children:jsxRuntimeExports.jsx(Typography,{variant:"body2",sx:{fontStyle:"italic",textAlign:"center"},children:'"Este blog, junto con su soporte de software a medida, es el resultado de la curiosidad y la dedicaciÃ³n."'})})]})]})]})}),o&&jsxRuntimeExports.jsx(Container,{sx:{py:8},children:jsxRuntimeExports.jsxs(Card,{sx:{p:4,borderRadius:"12px",background:"white",border:"2px solid rgba(0, 0, 0, 0.2)",color:"#000",transition:"all 0.3s ease","&:hover":{border:"2px solid #9c27b0",boxShadow:"0 8px 25px rgba(156, 39, 176, 0.3)"}},children:[jsxRuntimeExports.jsx(Typography,{variant:"h4",sx:{fontWeight:"bold",mb:3,textAlign:"center"},children:"ContÃ¡ctame"}),jsxRuntimeExports.jsxs(Box,{sx:{textAlign:"center"},children:[jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",flexDirection:"column",gap:2,maxWidth:"400px",margin:"0 auto"},children:[jsxRuntimeExports.jsxs(Typography,{variant:"body1",sx:{fontSize:"1.1rem"},children:["ðŸ“ž TelÃ©fono: ",jsxRuntimeExports.jsx("strong",{children:"600 366 211"})]}),jsxRuntimeExports.jsxs(Typography,{variant:"body1",sx:{fontSize:"1.1rem"},children:["âœ‰ï¸ Email: ",jsxRuntimeExports.jsx(Link$1,{href:"mailto:vatiacoblog@gmail.com",sx:{color:"#1976d2",fontWeight:"bold",textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"vatiacoblog@gmail.com"})]})]}),jsxRuntimeExports.jsx(Box,{sx:{mt:4,p:3,backgroundColor:"rgba(0,0,0,0.05)",borderRadius:"8px"},children:jsxRuntimeExports.jsx(Typography,{variant:"body2",sx:{fontStyle:"italic",color:"rgba(0,0,0,0.7)"}})})]})]})})]})]})},HomePage$5=()=>jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(HomePage$6,{showLanding:!1,showCarrusel:!1,showInicio:!1,showDescripcion:!1,showServicios:!1,showFaq:!1,showContacto:!1,showPrivacyPolicy:!0,showTermsOfUse:!1,showAboutUs:!1})}),HomePage$4=()=>jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(HomePage$6,{showLanding:!1,showCarrusel:!1,showInicio:!1,showDescripcion:!1,showServicios:!1,showFaq:!1,showContacto:!1,showPrivacyPolicy:!1,showTermsOfUse:!0,showAboutUs:!1})}),CookieConsent=({children:t})=>{const[e,r]=reactExports.useState(!1),[n,i]=reactExports.useState(!1),[s,a]=reactExports.useState(!1),[o,c]=reactExports.useState(!1);reactExports.useEffect(()=>{localStorage.getItem("cookieConsent")?c(!0):r(!0)},[]);const u=()=>{localStorage.setItem("cookieConsent","true"),r(!1),c(!0)},h=()=>{i(!n),a(!1)},f=()=>{a(!s),i(!1)},m=(E,g)=>{g!=="backdropClick"&&r(!1)};return jsxRuntimeExports.jsx("div",{children:o?jsxRuntimeExports.jsx("div",{children:t}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(Dialog,{open:e,onClose:m,children:[jsxRuntimeExports.jsx(DialogTitle,{children:"Aviso de Cookies"}),jsxRuntimeExports.jsxs(DialogContent,{children:[jsxRuntimeExports.jsxs(Typography,{children:["Este sitio utiliza cookies para mejorar tu experiencia. Al continuar navegando, aceptas el uso de cookies. Consulta nuestra"," ",jsxRuntimeExports.jsx(Button,{onClick:h,variant:"text",children:"PolÃ­tica de Privacidad"})," y los"," ",jsxRuntimeExports.jsx(Button,{onClick:f,variant:"text",children:"TÃ©rminos de Uso"}),"."]}),jsxRuntimeExports.jsx(Box,{sx:{mt:2,textAlign:"center"},children:jsxRuntimeExports.jsx(Button,{onClick:u,variant:"contained",color:"primary",children:"Aceptar"})})]})]}),jsxRuntimeExports.jsxs(Dialog,{open:n,onClose:h,children:[jsxRuntimeExports.jsx(DialogTitle,{children:"PolÃ­tica de Privacidad"}),jsxRuntimeExports.jsxs(DialogContent,{children:[jsxRuntimeExports.jsx(HomePage$5,{}),jsxRuntimeExports.jsx(Box,{sx:{mt:2,textAlign:"right"},children:jsxRuntimeExports.jsx(Button,{onClick:h,variant:"outlined",color:"error",children:"Cerrar"})})]})]}),jsxRuntimeExports.jsxs(Dialog,{open:s,onClose:f,children:[jsxRuntimeExports.jsx(DialogTitle,{children:"TÃ©rminos de Uso"}),jsxRuntimeExports.jsxs(DialogContent,{children:[jsxRuntimeExports.jsx(HomePage$4,{}),jsxRuntimeExports.jsx(Box,{sx:{mt:2,textAlign:"right"},children:jsxRuntimeExports.jsx(Button,{onClick:f,variant:"outlined",color:"error",children:"Cerrar"})})]})]})]})})},getDefaultsFromPostinstall=()=>{};var define_process_env_default$1={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CONSTANTS={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const assert=function(t,e){if(!t)throw assertionError(e)},assertionError=function(t){return new Error("Firebase Database ("+CONSTANTS.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const stringToByteArray$1=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},byteArrayToString=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],c=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,h=s>>2,f=(s&3)<<4|o>>4;let m=(o&15)<<2|u>>6,E=u&63;c||(E=64,a||(m=64)),n.push(r[h],r[f],r[m],r[E])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(stringToByteArray$1(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):byteArrayToString(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const u=i<t.length?r[t.charAt(i)]:64;++i;const f=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||u==null||f==null)throw new DecodeBase64StringError;const m=s<<2|o>>4;if(n.push(m),u!==64){const E=o<<4&240|u>>2;if(n.push(E),f!==64){const g=u<<6&192|f;n.push(g)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class DecodeBase64StringError extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const base64Encode=function(t){const e=stringToByteArray$1(t);return base64.encodeByteArray(e,!0)},base64urlEncodeWithoutPadding=function(t){return base64Encode(t).replace(/\./g,"")},base64Decode=function(t){try{return base64.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function deepCopy(t){return deepExtend(void 0,t)}function deepExtend(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const r=e;return new Date(r.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const r in e)!e.hasOwnProperty(r)||!isValidKey$1(r)||(t[r]=deepExtend(t[r],e[r]));return t}function isValidKey$1(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getGlobal(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const getDefaultsFromGlobal=()=>getGlobal().__FIREBASE_DEFAULTS__,getDefaultsFromEnvVariable=()=>{if(typeof process=="undefined"||typeof define_process_env_default$1=="undefined")return;const t=define_process_env_default$1.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},getDefaultsFromCookie=()=>{if(typeof document=="undefined")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(r){return}const e=t&&base64Decode(t[1]);return e&&JSON.parse(e)},getDefaults=()=>{try{return getDefaultsFromPostinstall()||getDefaultsFromGlobal()||getDefaultsFromEnvVariable()||getDefaultsFromCookie()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},getDefaultEmulatorHost=t=>{var e,r;return(r=(e=getDefaults())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},getDefaultAppConfig=()=>{var t;return(t=getDefaults())===null||t===void 0?void 0:t.config},getExperimentalSetting=t=>{var e;return(e=getDefaults())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Deferred{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getUA(){return typeof navigator!="undefined"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function isMobileCordova(){return typeof window!="undefined"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())}function isCloudflareWorker(){return typeof navigator!="undefined"&&navigator.userAgent==="Cloudflare-Workers"}function isBrowserExtension(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function isReactNative(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function isIE(){const t=getUA();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function isNodeSdk(){return CONSTANTS.NODE_ADMIN===!0}function isIndexedDBAvailable(){try{return typeof indexedDB=="object"}catch(t){return!1}}function validateIndexedDBOpenable(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}function areCookiesEnabled(){return!(typeof navigator=="undefined"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERROR_NAME="FirebaseError";class FirebaseError extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=ERROR_NAME,Object.setPrototypeOf(this,FirebaseError.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ErrorFactory.prototype.create)}}class ErrorFactory{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?replaceTemplate(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new FirebaseError(i,o,n)}}function replaceTemplate(t,e){return t.replace(PATTERN,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const PATTERN=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jsonEval(t){return JSON.parse(t)}function stringify(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const decode=function(t){let e={},r={},n={},i="";try{const s=t.split(".");e=jsonEval(base64Decode(s[0])||""),r=jsonEval(base64Decode(s[1])||""),i=s[2],n=r.d||{},delete r.d}catch(s){}return{header:e,claims:r,data:n,signature:i}},isValidFormat=function(t){const e=decode(t),r=e.claims;return!!r&&typeof r=="object"&&r.hasOwnProperty("iat")},isAdmin=function(t){const e=decode(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function contains(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function safeGet(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function isEmpty(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function map(t,e,r){const n={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=e.call(r,t[i],i,t));return n}function deepEqual(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(isObject$1(s)&&isObject$1(a)){if(!deepEqual(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function isObject$1(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function querystring(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sha1{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,r){r||(r=0);const n=this.W_;if(typeof e=="string")for(let f=0;f<16;f++)n[f]=e.charCodeAt(r)<<24|e.charCodeAt(r+1)<<16|e.charCodeAt(r+2)<<8|e.charCodeAt(r+3),r+=4;else for(let f=0;f<16;f++)n[f]=e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3],r+=4;for(let f=16;f<80;f++){const m=n[f-3]^n[f-8]^n[f-14]^n[f-16];n[f]=(m<<1|m>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],a=this.chain_[2],o=this.chain_[3],c=this.chain_[4],u,h;for(let f=0;f<80;f++){f<40?f<20?(u=o^s&(a^o),h=1518500249):(u=s^a^o,h=1859775393):f<60?(u=s&a|o&(s|a),h=2400959708):(u=s^a^o,h=3395469782);const m=(i<<5|i>>>27)+u+c+h+n[f]&4294967295;c=o,o=a,a=(s<<30|s>>>2)&4294967295,s=i,i=m}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+o&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,r){if(e==null)return;r===void 0&&(r=e.length);const n=r-this.blockSize;let i=0;const s=this.buf_;let a=this.inbuf_;for(;i<r;){if(a===0)for(;i<=n;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<r;)if(s[a]=e.charCodeAt(i),++a,++i,a===this.blockSize){this.compress_(s),a=0;break}}else for(;i<r;)if(s[a]=e[i],++a,++i,a===this.blockSize){this.compress_(s),a=0;break}}this.inbuf_=a,this.total_+=r}digest(){const e=[];let r=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=r&255,r/=256;this.compress_(this.buf_);let n=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[n]=this.chain_[i]>>s&255,++n;return e}}function createSubscribe(t,e){const r=new ObserverProxy(t,e);return r.subscribe.bind(r)}class ObserverProxy{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");implementsAnyMethods(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=noop$1),i.error===void 0&&(i.error=noop$1),i.complete===void 0&&(i.complete=noop$1);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(a){}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console!="undefined"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function implementsAnyMethods(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function noop$1(){}function errorPrefix(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const stringToByteArray=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);if(i>=55296&&i<=56319){const s=i-55296;n++,assert(n<t.length,"Surrogate pair missing trail surrogate.");const a=t.charCodeAt(n)-56320;i=65536+(s<<10)+a}i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):i<65536?(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},stringLength=function(t){let e=0;for(let r=0;r<t.length;r++){const n=t.charCodeAt(r);n<128?e++:n<2048?e+=2:n>=55296&&n<=56319?(e+=4,r++):e+=3}return e};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_INTERVAL_MILLIS=1e3,DEFAULT_BACKOFF_FACTOR=2,MAX_VALUE_MILLIS=4*60*60*1e3,RANDOM_FACTOR=.5;function calculateBackoffMillis(t,e=DEFAULT_INTERVAL_MILLIS,r=DEFAULT_BACKOFF_FACTOR){const n=e*Math.pow(r,t),i=Math.round(RANDOM_FACTOR*n*(Math.random()-.5)*2);return Math.min(MAX_VALUE_MILLIS,n+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getModularInstance(t){return t&&t._delegate?t._delegate:t}class Component{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME$1="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Provider{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new Deferred;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch(i){}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(isComponentEager(e))try{this.getOrInitializeService({instanceIdentifier:DEFAULT_ENTRY_NAME$1})}catch(r){}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch(s){}}}}clearInstance(e=DEFAULT_ENTRY_NAME$1){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return Ye(this,null,function*(){const e=Array.from(this.instances.values());yield Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=DEFAULT_ENTRY_NAME$1){return this.instances.has(e)}getOptions(e=DEFAULT_ENTRY_NAME$1){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch(s){}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:normalizeIdentifierForFactory(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(i){}return n||null}normalizeInstanceIdentifier(e=DEFAULT_ENTRY_NAME$1){return this.component?this.component.multipleInstances?e:DEFAULT_ENTRY_NAME$1:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function normalizeIdentifierForFactory(t){return t===DEFAULT_ENTRY_NAME$1?void 0:t}function isComponentEager(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ComponentContainer{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new Provider(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var LogLevel;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(LogLevel||(LogLevel={}));const levelStringToEnum={debug:LogLevel.DEBUG,verbose:LogLevel.VERBOSE,info:LogLevel.INFO,warn:LogLevel.WARN,error:LogLevel.ERROR,silent:LogLevel.SILENT},defaultLogLevel=LogLevel.INFO,ConsoleMethod={[LogLevel.DEBUG]:"log",[LogLevel.VERBOSE]:"log",[LogLevel.INFO]:"info",[LogLevel.WARN]:"warn",[LogLevel.ERROR]:"error"},defaultLogHandler=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=ConsoleMethod[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Logger{constructor(e){this.name=e,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in LogLevel))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?levelStringToEnum[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.DEBUG,...e),this._logHandler(this,LogLevel.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.VERBOSE,...e),this._logHandler(this,LogLevel.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.INFO,...e),this._logHandler(this,LogLevel.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.WARN,...e),this._logHandler(this,LogLevel.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.ERROR,...e),this._logHandler(this,LogLevel.ERROR,...e)}}const instanceOfAny=(t,e)=>e.some(r=>t instanceof r);let idbProxyableTypes,cursorAdvanceMethods;function getIdbProxyableTypes(){return idbProxyableTypes||(idbProxyableTypes=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function getCursorAdvanceMethods(){return cursorAdvanceMethods||(cursorAdvanceMethods=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cursorRequestMap=new WeakMap,transactionDoneMap=new WeakMap,transactionStoreNamesMap=new WeakMap,transformCache=new WeakMap,reverseTransformCache=new WeakMap;function promisifyRequest(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(wrap(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&cursorRequestMap.set(r,t)}).catch(()=>{}),reverseTransformCache.set(e,t),e}function cacheDonePromiseForTransaction(t){if(transactionDoneMap.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});transactionDoneMap.set(t,e)}let idbProxyTraps={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return transactionDoneMap.get(t);if(e==="objectStoreNames")return t.objectStoreNames||transactionStoreNamesMap.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return wrap(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function replaceTraps(t){idbProxyTraps=t(idbProxyTraps)}function wrapFunction(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(unwrap(this),e,...r);return transactionStoreNamesMap.set(n,e.sort?e.sort():[e]),wrap(n)}:getCursorAdvanceMethods().includes(t)?function(...e){return t.apply(unwrap(this),e),wrap(cursorRequestMap.get(this))}:function(...e){return wrap(t.apply(unwrap(this),e))}}function transformCachableValue(t){return typeof t=="function"?wrapFunction(t):(t instanceof IDBTransaction&&cacheDonePromiseForTransaction(t),instanceOfAny(t,getIdbProxyableTypes())?new Proxy(t,idbProxyTraps):t)}function wrap(t){if(t instanceof IDBRequest)return promisifyRequest(t);if(transformCache.has(t))return transformCache.get(t);const e=transformCachableValue(t);return e!==t&&(transformCache.set(t,e),reverseTransformCache.set(e,t)),e}const unwrap=t=>reverseTransformCache.get(t);function openDB(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=wrap(a);return n&&a.addEventListener("upgradeneeded",c=>{n(wrap(a.result),c.oldVersion,c.newVersion,wrap(a.transaction),c)}),r&&a.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),o.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const readMethods=["get","getKey","getAll","getAllKeys","count"],writeMethods=["put","add","delete","clear"],cachedMethods=new Map;function getMethod(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(cachedMethods.get(e))return cachedMethods.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=writeMethods.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||readMethods.includes(r)))return;const s=function(a,...o){return Ye(this,null,function*(){const c=this.transaction(a,i?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(o.shift())),(yield Promise.all([u[r](...o),i&&c.done]))[0]})};return cachedMethods.set(e,s),s}replaceTraps(t=>Br(Er({},t),{get:(e,r,n)=>getMethod(e,r)||t.get(e,r,n),has:(e,r)=>!!getMethod(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PlatformLoggerServiceImpl{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(isVersionServiceProvider(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function isVersionServiceProvider(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const name$q="@firebase/app",version$1$1="0.11.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logger$2=new Logger("@firebase/app"),name$p="@firebase/app-compat",name$o="@firebase/analytics-compat",name$n="@firebase/analytics",name$m="@firebase/app-check-compat",name$l="@firebase/app-check",name$k="@firebase/auth",name$j="@firebase/auth-compat",name$i="@firebase/database",name$h="@firebase/data-connect",name$g="@firebase/database-compat",name$f="@firebase/functions",name$e="@firebase/functions-compat",name$d="@firebase/installations",name$c="@firebase/installations-compat",name$b="@firebase/messaging",name$a="@firebase/messaging-compat",name$9="@firebase/performance",name$8="@firebase/performance-compat",name$7="@firebase/remote-config",name$6="@firebase/remote-config-compat",name$5$1="@firebase/storage",name$4$1="@firebase/storage-compat",name$3$1="@firebase/firestore",name$2$1="@firebase/vertexai",name$1$1="@firebase/firestore-compat",name$r="firebase",version$6="11.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME="[DEFAULT]",PLATFORM_LOG_STRING={[name$q]:"fire-core",[name$p]:"fire-core-compat",[name$n]:"fire-analytics",[name$o]:"fire-analytics-compat",[name$l]:"fire-app-check",[name$m]:"fire-app-check-compat",[name$k]:"fire-auth",[name$j]:"fire-auth-compat",[name$i]:"fire-rtdb",[name$h]:"fire-data-connect",[name$g]:"fire-rtdb-compat",[name$f]:"fire-fn",[name$e]:"fire-fn-compat",[name$d]:"fire-iid",[name$c]:"fire-iid-compat",[name$b]:"fire-fcm",[name$a]:"fire-fcm-compat",[name$9]:"fire-perf",[name$8]:"fire-perf-compat",[name$7]:"fire-rc",[name$6]:"fire-rc-compat",[name$5$1]:"fire-gcs",[name$4$1]:"fire-gcs-compat",[name$3$1]:"fire-fst",[name$1$1]:"fire-fst-compat",[name$2$1]:"fire-vertex","fire-js":"fire-js",[name$r]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _apps=new Map,_serverApps=new Map,_components=new Map;function _addComponent(t,e){try{t.container.addComponent(e)}catch(r){logger$2.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function _registerComponent(t){const e=t.name;if(_components.has(e))return logger$2.debug(`There were multiple attempts to register component ${e}.`),!1;_components.set(e,t);for(const r of _apps.values())_addComponent(r,t);for(const r of _serverApps.values())_addComponent(r,t);return!0}function _getProvider(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function _isFirebaseServerApp(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERRORS$1={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ERROR_FACTORY$2=new ErrorFactory("app","Firebase",ERRORS$1);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FirebaseAppImpl{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ERROR_FACTORY$2.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SDK_VERSION$1=version$6;function initializeApp(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:DEFAULT_ENTRY_NAME,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw ERROR_FACTORY$2.create("bad-app-name",{appName:String(i)});if(r||(r=getDefaultAppConfig()),!r)throw ERROR_FACTORY$2.create("no-options");const s=_apps.get(i);if(s){if(deepEqual(r,s.options)&&deepEqual(n,s.config))return s;throw ERROR_FACTORY$2.create("duplicate-app",{appName:i})}const a=new ComponentContainer(i);for(const c of _components.values())a.addComponent(c);const o=new FirebaseAppImpl(r,n,a);return _apps.set(i,o),o}function getApp(t=DEFAULT_ENTRY_NAME){const e=_apps.get(t);if(!e&&t===DEFAULT_ENTRY_NAME&&getDefaultAppConfig())return initializeApp();if(!e)throw ERROR_FACTORY$2.create("no-app",{appName:t});return e}function registerVersion(t,e,r){var n;let i=(n=PLATFORM_LOG_STRING[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),logger$2.warn(o.join(" "));return}_registerComponent(new Component(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME$1="firebase-heartbeat-database",DB_VERSION$1=1,STORE_NAME="firebase-heartbeat-store";let dbPromise$1=null;function getDbPromise$1(){return dbPromise$1||(dbPromise$1=openDB(DB_NAME$1,DB_VERSION$1,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(STORE_NAME)}catch(r){console.warn(r)}}}}).catch(t=>{throw ERROR_FACTORY$2.create("idb-open",{originalErrorMessage:t.message})})),dbPromise$1}function readHeartbeatsFromIndexedDB(t){return Ye(this,null,function*(){try{const r=(yield getDbPromise$1()).transaction(STORE_NAME),n=yield r.objectStore(STORE_NAME).get(computeKey(t));return yield r.done,n}catch(e){if(e instanceof FirebaseError)logger$2.warn(e.message);else{const r=ERROR_FACTORY$2.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});logger$2.warn(r.message)}}})}function writeHeartbeatsToIndexedDB(t,e){return Ye(this,null,function*(){try{const n=(yield getDbPromise$1()).transaction(STORE_NAME,"readwrite");yield n.objectStore(STORE_NAME).put(e,computeKey(t)),yield n.done}catch(r){if(r instanceof FirebaseError)logger$2.warn(r.message);else{const n=ERROR_FACTORY$2.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});logger$2.warn(n.message)}}})}function computeKey(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MAX_HEADER_BYTES=1024,MAX_NUM_STORED_HEARTBEATS=30;class HeartbeatServiceImpl{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new HeartbeatStorageImpl(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}triggerHeartbeat(){return Ye(this,null,function*(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=getUTCDateString();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>MAX_NUM_STORED_HEARTBEATS){const a=getEarliestHeartbeatIdx(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){logger$2.warn(n)}})}getHeartbeatsHeader(){return Ye(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=getUTCDateString(),{heartbeatsToSend:n,unsentEntries:i}=extractHeartbeatsForHeader(this._heartbeatsCache.heartbeats),s=base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return logger$2.warn(r),""}})}}function getUTCDateString(){return new Date().toISOString().substring(0,10)}function extractHeartbeatsForHeader(t,e=MAX_HEADER_BYTES){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),countBytes(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),countBytes(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class HeartbeatStorageImpl{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return Ye(this,null,function*(){return isIndexedDBAvailable()?validateIndexedDBOpenable().then(()=>!0).catch(()=>!1):!1})}read(){return Ye(this,null,function*(){if(yield this._canUseIndexedDBPromise){const r=yield readHeartbeatsFromIndexedDB(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return Ye(this,null,function*(){var r;if(yield this._canUseIndexedDBPromise){const i=yield this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return Ye(this,null,function*(){var r;if(yield this._canUseIndexedDBPromise){const i=yield this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}}function countBytes(t){return base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:t})).length}function getEarliestHeartbeatIdx(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerCoreComponents(t){_registerComponent(new Component("platform-logger",e=>new PlatformLoggerServiceImpl(e),"PRIVATE")),_registerComponent(new Component("heartbeat",e=>new HeartbeatServiceImpl(e),"PRIVATE")),registerVersion(name$q,version$1$1,t),registerVersion(name$q,version$1$1,"esm2017"),registerVersion("fire-js","")}registerCoreComponents("");function __rest(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}typeof SuppressedError=="function"&&SuppressedError;function _prodErrorMap(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const prodErrorMap=_prodErrorMap,_DEFAULT_AUTH_ERROR_FACTORY=new ErrorFactory("auth","Firebase",_prodErrorMap());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logClient$1=new Logger("@firebase/auth");function _logWarn(t,...e){logClient$1.logLevel<=LogLevel.WARN&&logClient$1.warn(`Auth (${SDK_VERSION$1}): ${t}`,...e)}function _logError(t,...e){logClient$1.logLevel<=LogLevel.ERROR&&logClient$1.error(`Auth (${SDK_VERSION$1}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _fail(t,...e){throw createErrorInternal(t,...e)}function _createError(t,...e){return createErrorInternal(t,...e)}function _errorWithCustomMessage(t,e,r){const n=Object.assign(Object.assign({},prodErrorMap()),{[e]:r});return new ErrorFactory("auth","Firebase",n).create(e,{appName:t.name})}function _serverAppCurrentUserOperationNotSupportedError(t){return _errorWithCustomMessage(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function createErrorInternal(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return _DEFAULT_AUTH_ERROR_FACTORY.create(t,...e)}function _assert(t,e,...r){if(!t)throw createErrorInternal(e,...r)}function debugFail(t){const e="INTERNAL ASSERTION FAILED: "+t;throw _logError(e),new Error(e)}function debugAssert(t,e){t||debugFail(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getCurrentUrl(){var t;return typeof self!="undefined"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function _isHttpOrHttps(){return _getCurrentScheme()==="http:"||_getCurrentScheme()==="https:"}function _getCurrentScheme(){var t;return typeof self!="undefined"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isOnline(){return typeof navigator!="undefined"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(_isHttpOrHttps()||isBrowserExtension()||"connection"in navigator)?navigator.onLine:!0}function _getUserLanguage(){if(typeof navigator=="undefined")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Delay{constructor(e,r){this.shortDelay=e,this.longDelay=r,debugAssert(r>e,"Short delay should be less than long delay!"),this.isMobile=isMobileCordova()||isReactNative()}get(){return _isOnline()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _emulatorUrl(t,e){debugAssert(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FetchProvider{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self!="undefined"&&"fetch"in self)return self.fetch;if(typeof globalThis!="undefined"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch!="undefined")return fetch;debugFail("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self!="undefined"&&"Headers"in self)return self.Headers;if(typeof globalThis!="undefined"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers!="undefined")return Headers;debugFail("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self!="undefined"&&"Response"in self)return self.Response;if(typeof globalThis!="undefined"&&globalThis.Response)return globalThis.Response;if(typeof Response!="undefined")return Response;debugFail("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SERVER_ERROR_MAP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_API_TIMEOUT_MS=new Delay(3e4,6e4);function _addTidIfNecessary(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}function _performApiRequest(s,a,o,c){return Ye(this,arguments,function*(t,e,r,n,i={}){return _performFetchWithErrorHandling(t,i,()=>Ye(this,null,function*(){let u={},h={};n&&(e==="GET"?h=n:u={body:JSON.stringify(n)});const f=querystring(Object.assign({key:t.config.apiKey},h)).slice(1),m=yield t._getAdditionalHeaders();m["Content-Type"]="application/json",t.languageCode&&(m["X-Firebase-Locale"]=t.languageCode);const E=Object.assign({method:e,headers:m},u);return isCloudflareWorker()||(E.referrerPolicy="no-referrer"),FetchProvider.fetch()(_getFinalTarget(t,t.config.apiHost,r,f),E)}))})}function _performFetchWithErrorHandling(t,e,r){return Ye(this,null,function*(){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},SERVER_ERROR_MAP),e);try{const i=new NetworkTimeout(t),s=yield Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=yield s.json();if("needConfirmation"in a)throw _makeTaggedError(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[c,u]=o.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw _makeTaggedError(t,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw _makeTaggedError(t,"email-already-in-use",a);if(c==="USER_DISABLED")throw _makeTaggedError(t,"user-disabled",a);const h=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw _errorWithCustomMessage(t,h,u);_fail(t,h)}}catch(i){if(i instanceof FirebaseError)throw i;_fail(t,"network-request-failed",{message:String(i)})}})}function _performSignInRequest(s,a,o,c){return Ye(this,arguments,function*(t,e,r,n,i={}){const u=yield _performApiRequest(t,e,r,n,i);return"mfaPendingCredential"in u&&_fail(t,"multi-factor-auth-required",{_serverResponse:u}),u})}function _getFinalTarget(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?_emulatorUrl(t.config,i):`${t.config.apiScheme}://${i}`}function _parseEnforcementState(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class NetworkTimeout{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(_createError(this.auth,"network-request-failed")),DEFAULT_API_TIMEOUT_MS.get())})}}function _makeTaggedError(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=_createError(t,e,n);return i.customData._tokenResponse=r,i}function isEnterprise(t){return t!==void 0&&t.enterprise!==void 0}class RecaptchaConfig{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return _parseEnforcementState(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}function getRecaptchaConfig(t,e){return Ye(this,null,function*(){return _performApiRequest(t,"GET","/v2/recaptchaConfig",_addTidIfNecessary(t,e))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function deleteAccount(t,e){return Ye(this,null,function*(){return _performApiRequest(t,"POST","/v1/accounts:delete",e)})}function getAccountInfo(t,e){return Ye(this,null,function*(){return _performApiRequest(t,"POST","/v1/accounts:lookup",e)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function utcTimestampToDateString(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(e){}}function getIdTokenResult(t,e=!1){return Ye(this,null,function*(){const r=getModularInstance(t),n=yield r.getIdToken(e),i=_parseToken(n);_assert(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:utcTimestampToDateString(secondsStringToMilliseconds(i.auth_time)),issuedAtTime:utcTimestampToDateString(secondsStringToMilliseconds(i.iat)),expirationTime:utcTimestampToDateString(secondsStringToMilliseconds(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}})}function secondsStringToMilliseconds(t){return Number(t)*1e3}function _parseToken(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return _logError("JWT malformed, contained fewer than 3 sections"),null;try{const i=base64Decode(r);return i?JSON.parse(i):(_logError("Failed to decode base64 JWT payload"),null)}catch(i){return _logError("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function _tokenExpiresIn(t){const e=_parseToken(t);return _assert(e,"internal-error"),_assert(typeof e.exp!="undefined","internal-error"),_assert(typeof e.iat!="undefined","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _logoutIfInvalidated(t,e,r=!1){return Ye(this,null,function*(){if(r)return e;try{return yield e}catch(n){throw n instanceof FirebaseError&&isUserInvalidated(n)&&t.auth.currentUser===t&&(yield t.auth.signOut()),n}})}function isUserInvalidated({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ProactiveRefresh{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(()=>Ye(this,null,function*(){yield this.iteration()}),r)}iteration(){return Ye(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UserMetadata{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=utcTimestampToDateString(this.lastLoginAt),this.creationTime=utcTimestampToDateString(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _reloadWithoutSaving(t){return Ye(this,null,function*(){var e;const r=t.auth,n=yield t.getIdToken(),i=yield _logoutIfInvalidated(t,getAccountInfo(r,{idToken:n}));_assert(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?extractProviderData(s.providerUserInfo):[],o=mergeProviderData(t.providerData,a),c=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),h=c?u:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new UserMetadata(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(t,f)})}function reload(t){return Ye(this,null,function*(){const e=getModularInstance(t);yield _reloadWithoutSaving(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function mergeProviderData(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function extractProviderData(t){return t.map(e=>{var{providerId:r}=e,n=__rest(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function requestStsToken(t,e){return Ye(this,null,function*(){const r=yield _performFetchWithErrorHandling(t,{},()=>Ye(this,null,function*(){const n=querystring({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=_getFinalTarget(t,i,"/v1/token",`key=${s}`),o=yield t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",FetchProvider.fetch()(a,{method:"POST",headers:o,body:n})}));return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}})}function revokeToken(t,e){return Ye(this,null,function*(){return _performApiRequest(t,"POST","/v2/accounts:revokeToken",_addTidIfNecessary(t,e))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StsTokenManager{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_assert(e.idToken,"internal-error"),_assert(typeof e.idToken!="undefined","internal-error"),_assert(typeof e.refreshToken!="undefined","internal-error");const r="expiresIn"in e&&typeof e.expiresIn!="undefined"?Number(e.expiresIn):_tokenExpiresIn(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){_assert(e.length!==0,"internal-error");const r=_tokenExpiresIn(e);this.updateTokensAndExpiration(e,null,r)}getToken(e,r=!1){return Ye(this,null,function*(){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(_assert(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,r){return Ye(this,null,function*(){const{accessToken:n,refreshToken:i,expiresIn:s}=yield requestStsToken(e,r);this.updateTokensAndExpiration(n,i,Number(s))})}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new StsTokenManager;return n&&(_assert(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(_assert(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(_assert(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new StsTokenManager,this.toJSON())}_performRefresh(){return debugFail("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function assertStringOrUndefined(t,e){_assert(typeof t=="string"||typeof t=="undefined","internal-error",{appName:e})}class UserImpl{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=__rest(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ProactiveRefresh(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new UserMetadata(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return Ye(this,null,function*(){const r=yield _logoutIfInvalidated(this,this.stsTokenManager.getToken(this.auth,e));return _assert(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r})}getIdTokenResult(e){return getIdTokenResult(this,e)}reload(){return reload(this)}_assign(e){this!==e&&(_assert(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new UserImpl(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){_assert(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,r=!1){return Ye(this,null,function*(){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&(yield _reloadWithoutSaving(this)),yield this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)})}delete(){return Ye(this,null,function*(){if(_isFirebaseServerApp(this.auth.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this.auth));const e=yield this.getIdToken();return yield _logoutIfInvalidated(this,deleteAccount(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,c,u,h;const f=(n=r.displayName)!==null&&n!==void 0?n:void 0,m=(i=r.email)!==null&&i!==void 0?i:void 0,E=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,g=(a=r.photoURL)!==null&&a!==void 0?a:void 0,p=(o=r.tenantId)!==null&&o!==void 0?o:void 0,_=(c=r._redirectEventId)!==null&&c!==void 0?c:void 0,A=(u=r.createdAt)!==null&&u!==void 0?u:void 0,H=(h=r.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:te,emailVerified:ne,isAnonymous:j,providerData:ee,stsTokenManager:x}=r;_assert(te&&x,e,"internal-error");const M=StsTokenManager.fromJSON(this.name,x);_assert(typeof te=="string",e,"internal-error"),assertStringOrUndefined(f,e.name),assertStringOrUndefined(m,e.name),_assert(typeof ne=="boolean",e,"internal-error"),_assert(typeof j=="boolean",e,"internal-error"),assertStringOrUndefined(E,e.name),assertStringOrUndefined(g,e.name),assertStringOrUndefined(p,e.name),assertStringOrUndefined(_,e.name),assertStringOrUndefined(A,e.name),assertStringOrUndefined(H,e.name);const T=new UserImpl({uid:te,auth:e,email:m,emailVerified:ne,displayName:f,isAnonymous:j,photoURL:g,phoneNumber:E,tenantId:p,stsTokenManager:M,createdAt:A,lastLoginAt:H});return ee&&Array.isArray(ee)&&(T.providerData=ee.map(O=>Object.assign({},O))),_&&(T._redirectEventId=_),T}static _fromIdTokenResponse(e,r,n=!1){return Ye(this,null,function*(){const i=new StsTokenManager;i.updateFromServerResponse(r);const s=new UserImpl({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return yield _reloadWithoutSaving(s),s})}static _fromGetAccountInfoResponse(e,r,n){return Ye(this,null,function*(){const i=r.users[0];_assert(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?extractProviderData(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new StsTokenManager;o.updateFromIdToken(n);const c=new UserImpl({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new UserMetadata(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,u),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const instanceCache=new Map;function _getInstance(t){debugAssert(t instanceof Function,"Expected a class definition");let e=instanceCache.get(t);return e?(debugAssert(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,instanceCache.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class InMemoryPersistence{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return Ye(this,null,function*(){return!0})}_set(e,r){return Ye(this,null,function*(){this.storage[e]=r})}_get(e){return Ye(this,null,function*(){const r=this.storage[e];return r===void 0?null:r})}_remove(e){return Ye(this,null,function*(){delete this.storage[e]})}_addListener(e,r){}_removeListener(e,r){}}InMemoryPersistence.type="NONE";const inMemoryPersistence=InMemoryPersistence;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _persistenceKeyName(t,e,r){return`firebase:${t}:${e}:${r}`}class PersistenceUserManager{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=_persistenceKeyName(this.userKey,i.apiKey,s),this.fullPersistenceKey=_persistenceKeyName("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return Ye(this,null,function*(){const e=yield this.persistence._get(this.fullUserKey);return e?UserImpl._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return Ye(this,null,function*(){if(this.persistence===e)return;const r=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,r,n="authUser"){return Ye(this,null,function*(){if(!r.length)return new PersistenceUserManager(_getInstance(inMemoryPersistence),e,n);const i=(yield Promise.all(r.map(u=>Ye(this,null,function*(){if(yield u._isAvailable())return u})))).filter(u=>u);let s=i[0]||_getInstance(inMemoryPersistence);const a=_persistenceKeyName(n,e.config.apiKey,e.name);let o=null;for(const u of r)try{const h=yield u._get(a);if(h){const f=UserImpl._fromJSON(e,h);u!==s&&(o=f),s=u;break}}catch(h){}const c=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new PersistenceUserManager(s,e,n):(s=c[0],o&&(yield s._set(a,o.toJSON())),yield Promise.all(r.map(u=>Ye(this,null,function*(){if(u!==s)try{yield u._remove(a)}catch(h){}}))),new PersistenceUserManager(s,e,n))})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getBrowserName(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(_isIEMobile(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(_isFirefox(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_isBlackBerry(e))return"Blackberry";if(_isWebOS(e))return"Webos";if(_isSafari(e))return"Safari";if((e.includes("chrome/")||_isChromeIOS(e))&&!e.includes("edge/"))return"Chrome";if(_isAndroid(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function _isFirefox(t=getUA()){return/firefox\//i.test(t)}function _isSafari(t=getUA()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function _isChromeIOS(t=getUA()){return/crios\//i.test(t)}function _isIEMobile(t=getUA()){return/iemobile/i.test(t)}function _isAndroid(t=getUA()){return/android/i.test(t)}function _isBlackBerry(t=getUA()){return/blackberry/i.test(t)}function _isWebOS(t=getUA()){return/webos/i.test(t)}function _isIOS(t=getUA()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function _isIOSStandalone(t=getUA()){var e;return _isIOS(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function _isIE10(){return isIE()&&document.documentMode===10}function _isMobileBrowser(t=getUA()){return _isIOS(t)||_isAndroid(t)||_isWebOS(t)||_isBlackBerry(t)||/windows phone/i.test(t)||_isIEMobile(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getClientVersion(t,e=[]){let r;switch(t){case"Browser":r=_getBrowserName(getUA());break;case"Worker":r=`${_getBrowserName(getUA())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${SDK_VERSION$1}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthMiddlewareQueue{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((a,o)=>{try{const c=e(s);a(c)}catch(c){o(c)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return Ye(this,null,function*(){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)yield n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch(s){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}})}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getPasswordPolicy(r){return Ye(this,arguments,function*(t,e={}){return _performApiRequest(t,"GET","/v2/passwordPolicy",_addTidIfNecessary(t,e))})}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MINIMUM_MIN_PASSWORD_LENGTH=6;class PasswordPolicyImpl{constructor(e){var r,n,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:MINIMUM_MIN_PASSWORD_LENGTH,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(r=c.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(n=c.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(a=c.containsNumericCharacter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(o=c.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),c}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthImpl{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Subscription(this),this.idTokenSubscription=new Subscription(this),this.beforeStateQueue=new AuthMiddlewareQueue(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=_DEFAULT_AUTH_ERROR_FACTORY,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=_getInstance(r)),this._initializationPromise=this.queue(()=>Ye(this,null,function*(){var n,i;if(!this._deleted&&(this.persistenceManager=yield PersistenceUserManager.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch(s){}yield this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return Ye(this,null,function*(){if(this._deleted)return;const e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return Ye(this,null,function*(){try{const r=yield getAccountInfo(this,{idToken:e}),n=yield UserImpl._fromGetAccountInfoResponse(this,r,e);yield this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return Ye(this,null,function*(){var r;if(_isFirebaseServerApp(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=yield this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,c=yield this.tryRedirectSignIn(e);(!a||a===o)&&(c!=null&&c.user)&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return _assert(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return Ye(this,null,function*(){let r=null;try{r=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){yield this._setRedirectUser(null)}return r})}reloadAndSetCurrentUserOrClear(e){return Ye(this,null,function*(){try{yield _reloadWithoutSaving(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=_getUserLanguage()}_delete(){return Ye(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return Ye(this,null,function*(){if(_isFirebaseServerApp(this.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this));const r=e?getModularInstance(e):null;return r&&_assert(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))})}_updateCurrentUser(e,r=!1){return Ye(this,null,function*(){if(!this._deleted)return e&&_assert(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>Ye(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return Ye(this,null,function*(){return _isFirebaseServerApp(this.app)?Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return _isFirebaseServerApp(this.app)?Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this)):this.queue(()=>Ye(this,null,function*(){yield this.assertedPersistence.setPersistence(_getInstance(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return Ye(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return Ye(this,null,function*(){const e=yield _getPasswordPolicy(this),r=new PasswordPolicyImpl(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ErrorFactory("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}revokeAccessToken(e){return Ye(this,null,function*(){if(this.currentUser){const r=yield this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),yield revokeToken(this,n)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,r){return Ye(this,null,function*(){const n=yield this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return Ye(this,null,function*(){if(!this.redirectPersistenceManager){const r=e&&_getInstance(e)||this._popupRedirectResolver;_assert(r,this,"argument-error"),this.redirectPersistenceManager=yield PersistenceUserManager.create(this,[_getInstance(r._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return Ye(this,null,function*(){var r,n;return this._isInitialized&&(yield this.queue(()=>Ye(this,null,function*(){}))),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return Ye(this,null,function*(){if(e===this.currentUser)return this.queue(()=>Ye(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(_assert(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,i);return()=>{a=!0,c()}}else{const c=e.addObserver(r);return()=>{a=!0,c()}}}directlySetCurrentUser(e){return Ye(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _assert(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_getClientVersion(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return Ye(this,null,function*(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();n&&(r["X-Firebase-Client"]=n);const i=yield this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r})}_getAppCheckToken(){return Ye(this,null,function*(){var e;if(_isFirebaseServerApp(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const r=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return r!=null&&r.error&&_logWarn(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token})}}function _castAuth(t){return getModularInstance(t)}class Subscription{constructor(e){this.auth=e,this.observer=null,this.addObserver=createSubscribe(r=>this.observer=r)}get next(){return _assert(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let externalJSProvider={loadJS(){return Ye(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _setExternalJSProvider(t){externalJSProvider=t}function _loadJS(t){return externalJSProvider.loadJS(t)}function _recaptchaEnterpriseScriptUrl(){return externalJSProvider.recaptchaEnterpriseScript}function _gapiScriptUrl(){return externalJSProvider.gapiScript}function _generateCallbackName(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class MockGreCAPTCHATopLevel{constructor(){this.enterprise=new MockGreCAPTCHA}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class MockGreCAPTCHA{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const RECAPTCHA_ENTERPRISE_VERIFIER_TYPE="recaptcha-enterprise",FAKE_TOKEN="NO_RECAPTCHA";class RecaptchaEnterpriseVerifier{constructor(e){this.type=RECAPTCHA_ENTERPRISE_VERIFIER_TYPE,this.auth=_castAuth(e)}verify(e="verify",r=!1){return Ye(this,null,function*(){function n(s){return Ye(this,null,function*(){if(!r){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((a,o)=>Ye(this,null,function*(){getRecaptchaConfig(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const u=new RecaptchaConfig(c);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,a(u.siteKey)}}).catch(c=>{o(c)})}))})}function i(s,a,o){const c=window.grecaptcha;isEnterprise(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(u=>{a(u)}).catch(()=>{a(FAKE_TOKEN)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new MockGreCAPTCHATopLevel().execute("siteKey",{action:"verify"}):new Promise((s,a)=>{n(this.auth).then(o=>{if(!r&&isEnterprise(window.grecaptcha))i(o,s,a);else{if(typeof window=="undefined"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let c=_recaptchaEnterpriseScriptUrl();c.length!==0&&(c+=o),_loadJS(c).then(()=>{i(o,s,a)}).catch(u=>{a(u)})}}).catch(o=>{a(o)})})})}}function injectRecaptchaFields(t,e,r,n=!1,i=!1){return Ye(this,null,function*(){const s=new RecaptchaEnterpriseVerifier(t);let a;if(i)a=FAKE_TOKEN;else try{a=yield s.verify(r)}catch(c){a=yield s.verify(r,!0)}const o=Object.assign({},e);if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const c=o.phoneEnrollmentInfo.phoneNumber,u=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const c=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o})}function handleRecaptchaFlow(t,e,r,n,i){return Ye(this,null,function*(){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=yield injectRecaptchaFields(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(a=>Ye(this,null,function*(){if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=yield injectRecaptchaFields(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(a)}))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function initializeAuth(t,e){const r=_getProvider(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(deepEqual(s,e!=null?e:{}))return i;_fail(i,"already-initialized")}return r.initialize({options:e})}function _initializeAuthInstance(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(_getInstance);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function connectAuthEmulator(t,e,r){const n=_castAuth(t);_assert(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=extractProtocol(e),{host:a,port:o}=extractHostAndPort(e),c=o===null?"":`:${o}`,u={url:`${s}//${a}${c}/`},h=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){_assert(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),_assert(deepEqual(u,n.config.emulator)&&deepEqual(h,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=u,n.emulatorConfig=h,n.settings.appVerificationDisabledForTesting=!0,emitEmulatorWarning()}function extractProtocol(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function extractHostAndPort(t){const e=extractProtocol(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:parsePort(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:parsePort(a)}}}function parsePort(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function emitEmulatorWarning(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console!="undefined"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window!="undefined"&&typeof document!="undefined"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthCredential{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return debugFail("not implemented")}_getIdTokenResponse(e){return debugFail("not implemented")}_linkToIdToken(e,r){return debugFail("not implemented")}_getReauthenticationResolver(e){return debugFail("not implemented")}}function sendOobCode(t,e){return Ye(this,null,function*(){return _performApiRequest(t,"POST","/v1/accounts:sendOobCode",_addTidIfNecessary(t,e))})}function sendEmailVerification$1(t,e){return Ye(this,null,function*(){return sendOobCode(t,e)})}function sendPasswordResetEmail$1(t,e){return Ye(this,null,function*(){return sendOobCode(t,e)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function signInWithIdp(t,e){return Ye(this,null,function*(){return _performSignInRequest(t,"POST","/v1/accounts:signInWithIdp",_addTidIfNecessary(t,e))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IDP_REQUEST_URI$1="http://localhost";class OAuthCredential extends AuthCredential{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new OAuthCredential(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):_fail("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,s=__rest(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new OAuthCredential(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return signInWithIdp(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,signInWithIdp(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,signInWithIdp(e,r)}buildRequest(){const e={requestUri:IDP_REQUEST_URI$1,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=querystring(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FederatedAuthProvider{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BaseOAuthProvider extends FederatedAuthProvider{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FacebookAuthProvider extends BaseOAuthProvider{constructor(){super("facebook.com")}static credential(e){return OAuthCredential._fromParams({providerId:FacebookAuthProvider.PROVIDER_ID,signInMethod:FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return FacebookAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return FacebookAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return FacebookAuthProvider.credential(e.oauthAccessToken)}catch(r){return null}}}FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD="facebook.com";FacebookAuthProvider.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GoogleAuthProvider extends BaseOAuthProvider{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return OAuthCredential._fromParams({providerId:GoogleAuthProvider.PROVIDER_ID,signInMethod:GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return GoogleAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return GoogleAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return GoogleAuthProvider.credential(r,n)}catch(i){return null}}}GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD="google.com";GoogleAuthProvider.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GithubAuthProvider extends BaseOAuthProvider{constructor(){super("github.com")}static credential(e){return OAuthCredential._fromParams({providerId:GithubAuthProvider.PROVIDER_ID,signInMethod:GithubAuthProvider.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return GithubAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return GithubAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return GithubAuthProvider.credential(e.oauthAccessToken)}catch(r){return null}}}GithubAuthProvider.GITHUB_SIGN_IN_METHOD="github.com";GithubAuthProvider.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TwitterAuthProvider extends BaseOAuthProvider{constructor(){super("twitter.com")}static credential(e,r){return OAuthCredential._fromParams({providerId:TwitterAuthProvider.PROVIDER_ID,signInMethod:TwitterAuthProvider.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return TwitterAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return TwitterAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return TwitterAuthProvider.credential(r,n)}catch(i){return null}}}TwitterAuthProvider.TWITTER_SIGN_IN_METHOD="twitter.com";TwitterAuthProvider.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function signUp(t,e){return Ye(this,null,function*(){return _performSignInRequest(t,"POST","/v1/accounts:signUp",_addTidIfNecessary(t,e))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UserCredentialImpl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,r,n,i=!1){return Ye(this,null,function*(){const s=yield UserImpl._fromIdTokenResponse(e,n,i),a=providerIdForResponse(n);return new UserCredentialImpl({user:s,providerId:a,_tokenResponse:n,operationType:r})})}static _forOperation(e,r,n){return Ye(this,null,function*(){yield e._updateTokensIfNecessary(n,!0);const i=providerIdForResponse(n);return new UserCredentialImpl({user:e,providerId:i,_tokenResponse:n,operationType:r})})}}function providerIdForResponse(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MultiFactorError extends FirebaseError{constructor(e,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,MultiFactorError.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new MultiFactorError(e,r,n,i)}}function _processCredentialSavingMfaContextIfNecessary(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?MultiFactorError._fromErrorAndOperation(t,s,e,n):s})}function _link$1(t,e,r=!1){return Ye(this,null,function*(){const n=yield _logoutIfInvalidated(t,e._linkToIdToken(t.auth,yield t.getIdToken()),r);return UserCredentialImpl._forOperation(t,"link",n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _reauthenticate(t,e,r=!1){return Ye(this,null,function*(){const{auth:n}=t;if(_isFirebaseServerApp(n.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(n));const i="reauthenticate";try{const s=yield _logoutIfInvalidated(t,_processCredentialSavingMfaContextIfNecessary(n,i,e,t),r);_assert(s.idToken,n,"internal-error");const a=_parseToken(s.idToken);_assert(a,n,"internal-error");const{sub:o}=a;return _assert(t.uid===o,n,"user-mismatch"),UserCredentialImpl._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&_fail(n,"user-mismatch"),s}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _signInWithCredential(t,e,r=!1){return Ye(this,null,function*(){if(_isFirebaseServerApp(t.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(t));const n="signIn",i=yield _processCredentialSavingMfaContextIfNecessary(t,n,e),s=yield UserCredentialImpl._fromIdTokenResponse(t,n,i);return r||(yield t._updateCurrentUser(s.user)),s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function recachePasswordPolicy(t){return Ye(this,null,function*(){const e=_castAuth(t);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function sendPasswordResetEmail(t,e,r){return Ye(this,null,function*(){const n=_castAuth(t);yield handleRecaptchaFlow(n,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",sendPasswordResetEmail$1)})}function createUserWithEmailAndPassword(t,e,r){return Ye(this,null,function*(){if(_isFirebaseServerApp(t.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(t));const n=_castAuth(t),a=yield handleRecaptchaFlow(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",signUp).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&recachePasswordPolicy(t),c}),o=yield UserCredentialImpl._fromIdTokenResponse(n,"signIn",a);return yield n._updateCurrentUser(o.user),o})}function sendEmailVerification(t,e){return Ye(this,null,function*(){const r=getModularInstance(t),i={requestType:"VERIFY_EMAIL",idToken:yield t.getIdToken()},{email:s}=yield sendEmailVerification$1(r.auth,i);s!==t.email&&(yield t.reload())})}function onIdTokenChanged(t,e,r,n){return getModularInstance(t).onIdTokenChanged(e,r,n)}function beforeAuthStateChanged(t,e,r){return getModularInstance(t).beforeAuthStateChanged(e,r)}function onAuthStateChanged(t,e,r,n){return getModularInstance(t).onAuthStateChanged(e,r,n)}function signOut(t){return getModularInstance(t).signOut()}const STORAGE_AVAILABLE_KEY="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BrowserPersistenceClass{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(STORAGE_AVAILABLE_KEY,"1"),this.storage.removeItem(STORAGE_AVAILABLE_KEY),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _POLLING_INTERVAL_MS$1=1e3,IE10_LOCAL_STORAGE_SYNC_DELAY=10;class BrowserLocalPersistence extends BrowserPersistenceClass{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_isMobileBrowser(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,c)=>{this.notifyListeners(a,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);_isIE10()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,IE10_LOCAL_STORAGE_SYNC_DELAY):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},_POLLING_INTERVAL_MS$1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(e,r){return Ye(this,null,function*(){yield Qn(BrowserLocalPersistence.prototype,this,"_set").call(this,e,r),this.localCache[e]=JSON.stringify(r)})}_get(e){return Ye(this,null,function*(){const r=yield Qn(BrowserLocalPersistence.prototype,this,"_get").call(this,e);return this.localCache[e]=JSON.stringify(r),r})}_remove(e){return Ye(this,null,function*(){yield Qn(BrowserLocalPersistence.prototype,this,"_remove").call(this,e),delete this.localCache[e]})}}BrowserLocalPersistence.type="LOCAL";const browserLocalPersistence=BrowserLocalPersistence;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BrowserSessionPersistence extends BrowserPersistenceClass{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}BrowserSessionPersistence.type="SESSION";const browserSessionPersistence=BrowserSessionPersistence;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _allSettled(t){return Promise.all(t.map(e=>Ye(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(r){return{fulfilled:!1,reason:r}}})))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Receiver{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new Receiver(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}handleEvent(e){return Ye(this,null,function*(){const r=e,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(u=>Ye(this,null,function*(){return u(r.origin,s)})),c=yield _allSettled(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:c})})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Receiver.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _generateEventId(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sender{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,r,n=50){return Ye(this,null,function*(){const i=typeof MessageChannel!="undefined"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,c)=>{const u=_generateEventId("",20);i.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(f){const m=f;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(m.data.response);break;default:clearTimeout(h),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _window(){return window}function _setWindowLocation(t){_window().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isWorker(){return typeof _window().WorkerGlobalScope!="undefined"&&typeof _window().importScripts=="function"}function _getActiveServiceWorker(){return Ye(this,null,function*(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(yield navigator.serviceWorker.ready).active}catch(t){return null}})}function _getServiceWorkerController(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function _getWorkerGlobalScope(){return _isWorker()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME="firebaseLocalStorageDb",DB_VERSION=1,DB_OBJECTSTORE_NAME="firebaseLocalStorage",DB_DATA_KEYPATH="fbase_key";class DBPromise{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function getObjectStore(t,e){return t.transaction([DB_OBJECTSTORE_NAME],e?"readwrite":"readonly").objectStore(DB_OBJECTSTORE_NAME)}function _deleteDatabase(){const t=indexedDB.deleteDatabase(DB_NAME);return new DBPromise(t).toPromise()}function _openDatabase(){const t=indexedDB.open(DB_NAME,DB_VERSION);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(DB_OBJECTSTORE_NAME,{keyPath:DB_DATA_KEYPATH})}catch(i){r(i)}}),t.addEventListener("success",()=>Ye(this,null,function*(){const n=t.result;n.objectStoreNames.contains(DB_OBJECTSTORE_NAME)?e(n):(n.close(),yield _deleteDatabase(),e(yield _openDatabase()))}))})}function _putObject(t,e,r){return Ye(this,null,function*(){const n=getObjectStore(t,!0).put({[DB_DATA_KEYPATH]:e,value:r});return new DBPromise(n).toPromise()})}function getObject(t,e){return Ye(this,null,function*(){const r=getObjectStore(t,!1).get(e),n=yield new DBPromise(r).toPromise();return n===void 0?null:n.value})}function _deleteObject(t,e){const r=getObjectStore(t,!0).delete(e);return new DBPromise(r).toPromise()}const _POLLING_INTERVAL_MS=800,_TRANSACTION_RETRY_COUNT=3;class IndexedDBLocalPersistence{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return Ye(this,null,function*(){return this.db?this.db:(this.db=yield _openDatabase(),this.db)})}_withRetries(e){return Ye(this,null,function*(){let r=0;for(;;)try{const n=yield this._openDb();return yield e(n)}catch(n){if(r++>_TRANSACTION_RETRY_COUNT)throw n;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return Ye(this,null,function*(){return _isWorker()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return Ye(this,null,function*(){this.receiver=Receiver._getInstance(_getWorkerGlobalScope()),this.receiver._subscribe("keyChanged",(e,r)=>Ye(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(e,r)=>Ye(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return Ye(this,null,function*(){var e,r;if(this.activeServiceWorker=yield _getActiveServiceWorker(),!this.activeServiceWorker)return;this.sender=new Sender(this.activeServiceWorker);const n=yield this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(e){return Ye(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||_getServiceWorkerController()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(r){}})}_isAvailable(){return Ye(this,null,function*(){try{if(!indexedDB)return!1;const e=yield _openDatabase();return yield _putObject(e,STORAGE_AVAILABLE_KEY,"1"),yield _deleteObject(e,STORAGE_AVAILABLE_KEY),!0}catch(e){}return!1})}_withPendingWrite(e){return Ye(this,null,function*(){this.pendingWrites++;try{yield e()}finally{this.pendingWrites--}})}_set(e,r){return Ye(this,null,function*(){return this._withPendingWrite(()=>Ye(this,null,function*(){return yield this._withRetries(n=>_putObject(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)}))})}_get(e){return Ye(this,null,function*(){const r=yield this._withRetries(n=>getObject(n,e));return this.localCache[e]=r,r})}_remove(e){return Ye(this,null,function*(){return this._withPendingWrite(()=>Ye(this,null,function*(){return yield this._withRetries(r=>_deleteObject(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)}))})}_poll(){return Ye(this,null,function*(){const e=yield this._withRetries(i=>{const s=getObjectStore(i,!1).getAll();return new DBPromise(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r})}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>Ye(this,null,function*(){return this._poll()}),_POLLING_INTERVAL_MS)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}IndexedDBLocalPersistence.type="LOCAL";const indexedDBLocalPersistence=IndexedDBLocalPersistence;new Delay(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _withDefaultResolver(t,e){return e?_getInstance(e):(_assert(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IdpCredential extends AuthCredential{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return signInWithIdp(e,this._buildIdpRequest())}_linkToIdToken(e,r){return signInWithIdp(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return signInWithIdp(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function _signIn(t){return _signInWithCredential(t.auth,new IdpCredential(t),t.bypassAuthState)}function _reauth(t){const{auth:e,user:r}=t;return _assert(r,e,"internal-error"),_reauthenticate(r,new IdpCredential(t),t.bypassAuthState)}function _link(t){return Ye(this,null,function*(){const{auth:e,user:r}=t;return _assert(r,e,"internal-error"),_link$1(r,new IdpCredential(t),t.bypassAuthState)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AbstractPopupRedirectOperation{constructor(e,r,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise((e,r)=>Ye(this,null,function*(){this.pendingPromise={resolve:e,reject:r};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}}))}onAuthEvent(e){return Ye(this,null,function*(){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(o)(c))}catch(u){this.reject(u)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return _signIn;case"linkViaPopup":case"linkViaRedirect":return _link;case"reauthViaPopup":case"reauthViaRedirect":return _reauth;default:_fail(this.auth,"internal-error")}}resolve(e){debugAssert(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){debugAssert(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _POLL_WINDOW_CLOSE_TIMEOUT=new Delay(2e3,1e4);class PopupOperation extends AbstractPopupRedirectOperation{constructor(e,r,n,i,s){super(e,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction&&PopupOperation.currentPopupAction.cancel(),PopupOperation.currentPopupAction=this}executeNotNull(){return Ye(this,null,function*(){const e=yield this.execute();return _assert(e,this.auth,"internal-error"),e})}onExecution(){return Ye(this,null,function*(){debugAssert(this.filter.length===1,"Popup operations only handle one event");const e=_generateEventId();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(_createError(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(_createError(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_createError(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,_POLL_WINDOW_CLOSE_TIMEOUT.get())};e()}}PopupOperation.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PENDING_REDIRECT_KEY="pendingRedirect",redirectOutcomeMap=new Map;class RedirectAction extends AbstractPopupRedirectOperation{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}execute(){return Ye(this,null,function*(){let e=redirectOutcomeMap.get(this.auth._key());if(!e){try{const n=(yield _getAndClearPendingRedirectStatus(this.resolver,this.auth))?yield Qn(RedirectAction.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}redirectOutcomeMap.set(this.auth._key(),e)}return this.bypassAuthState||redirectOutcomeMap.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return Ye(this,null,function*(){if(e.type==="signInViaRedirect")return Qn(RedirectAction.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=yield this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,Qn(RedirectAction.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return Ye(this,null,function*(){})}cleanUp(){}}function _getAndClearPendingRedirectStatus(t,e){return Ye(this,null,function*(){const r=pendingRedirectKey(e),n=resolverPersistence(t);if(!(yield n._isAvailable()))return!1;const i=(yield n._get(r))==="true";return yield n._remove(r),i})}function _overrideRedirectResult(t,e){redirectOutcomeMap.set(t._key(),e)}function resolverPersistence(t){return _getInstance(t._redirectPersistence)}function pendingRedirectKey(t){return _persistenceKeyName(PENDING_REDIRECT_KEY,t.config.apiKey,t.name)}function _getRedirectResult(t,e,r=!1){return Ye(this,null,function*(){if(_isFirebaseServerApp(t.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(t));const n=_castAuth(t),i=_withDefaultResolver(n,e),a=yield new RedirectAction(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,yield n._persistUserIfCurrent(a.user),yield n._setRedirectUser(null,e)),a})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EVENT_DUPLICATION_CACHE_DURATION_MS=10*60*1e3;class AuthEventManager{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!isRedirectEvent(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!isNullRedirectEvent(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(_createError(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=EVENT_DUPLICATION_CACHE_DURATION_MS&&this.cachedEventUids.clear(),this.cachedEventUids.has(eventUid(e))}saveEventToCache(e){this.cachedEventUids.add(eventUid(e)),this.lastProcessedEventTime=Date.now()}}function eventUid(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function isNullRedirectEvent({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function isRedirectEvent(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return isNullRedirectEvent(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getProjectConfig(r){return Ye(this,arguments,function*(t,e={}){return _performApiRequest(t,"GET","/v1/projects",e)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IP_ADDRESS_REGEX=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,HTTP_REGEX=/^https?/;function _validateOrigin(t){return Ye(this,null,function*(){if(t.config.emulator)return;const{authorizedDomains:e}=yield _getProjectConfig(t);for(const r of e)try{if(matchDomain(r))return}catch(n){}_fail(t,"unauthorized-domain")})}function matchDomain(t){const e=_getCurrentUrl(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!HTTP_REGEX.test(r))return!1;if(IP_ADDRESS_REGEX.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NETWORK_TIMEOUT=new Delay(3e4,6e4);function resetUnloadedGapiModules(){const t=_window().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function loadGapi(t){return new Promise((e,r)=>{var n,i,s;function a(){resetUnloadedGapiModules(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{resetUnloadedGapiModules(),r(_createError(t,"network-request-failed"))},timeout:NETWORK_TIMEOUT.get()})}if(!((i=(n=_window().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=_window().gapi)===null||s===void 0)&&s.load)a();else{const o=_generateCallbackName("iframefcb");return _window()[o]=()=>{gapi.load?a():r(_createError(t,"network-request-failed"))},_loadJS(`${_gapiScriptUrl()}?onload=${o}`).catch(c=>r(c))}}).catch(e=>{throw cachedGApiLoader=null,e})}let cachedGApiLoader=null;function _loadGapi(t){return cachedGApiLoader=cachedGApiLoader||loadGapi(t),cachedGApiLoader}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PING_TIMEOUT=new Delay(5e3,15e3),IFRAME_PATH="__/auth/iframe",EMULATED_IFRAME_PATH="emulator/auth/iframe",IFRAME_ATTRIBUTES={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},EID_FROM_APIHOST=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function getIframeUrl(t){const e=t.config;_assert(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?_emulatorUrl(e,EMULATED_IFRAME_PATH):`https://${t.config.authDomain}/${IFRAME_PATH}`,n={apiKey:e.apiKey,appName:t.name,v:SDK_VERSION$1},i=EID_FROM_APIHOST.get(t.config.apiHost);i&&(n.eid=i);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${querystring(n).slice(1)}`}function _openIframe(t){return Ye(this,null,function*(){const e=yield _loadGapi(t),r=_window().gapi;return _assert(r,t,"internal-error"),e.open({where:document.body,url:getIframeUrl(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:IFRAME_ATTRIBUTES,dontclear:!0},n=>new Promise((i,s)=>Ye(this,null,function*(){yield n.restyle({setHideOnLeave:!1});const a=_createError(t,"network-request-failed"),o=_window().setTimeout(()=>{s(a)},PING_TIMEOUT.get());function c(){_window().clearTimeout(o),i(n)}n.ping(c).then(c,()=>{s(a)})})))})}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BASE_POPUP_OPTIONS={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},DEFAULT_WIDTH=500,DEFAULT_HEIGHT=600,TARGET_BLANK="_blank",FIREFOX_EMPTY_URL="http://localhost";class AuthPopup{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function _open(t,e,r,n=DEFAULT_WIDTH,i=DEFAULT_HEIGHT){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const c=Object.assign(Object.assign({},BASE_POPUP_OPTIONS),{width:n.toString(),height:i.toString(),top:s,left:a}),u=getUA().toLowerCase();r&&(o=_isChromeIOS(u)?TARGET_BLANK:r),_isFirefox(u)&&(e=e||FIREFOX_EMPTY_URL,c.scrollbars="yes");const h=Object.entries(c).reduce((m,[E,g])=>`${m}${E}=${g},`,"");if(_isIOSStandalone(u)&&o!=="_self")return openAsNewWindowIOS(e||"",o),new AuthPopup(null);const f=window.open(e||"",o,h);_assert(f,t,"popup-blocked");try{f.focus()}catch(m){}return new AuthPopup(f)}function openAsNewWindowIOS(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WIDGET_PATH="__/auth/handler",EMULATOR_WIDGET_PATH="emulator/auth/handler",FIREBASE_APP_CHECK_FRAGMENT_ID=encodeURIComponent("fac");function _getRedirectUrl(t,e,r,n,i,s){return Ye(this,null,function*(){_assert(t.config.authDomain,t,"auth-domain-config-required"),_assert(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:SDK_VERSION$1,eventId:i};if(e instanceof FederatedAuthProvider){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",isEmpty(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))a[h]=f}if(e instanceof BaseOAuthProvider){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(a.scopes=h.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const h of Object.keys(o))o[h]===void 0&&delete o[h];const c=yield t._getAppCheckToken(),u=c?`#${FIREBASE_APP_CHECK_FRAGMENT_ID}=${encodeURIComponent(c)}`:"";return`${getHandlerBase(t)}?${querystring(o).slice(1)}${u}`})}function getHandlerBase({config:t}){return t.emulator?_emulatorUrl(t,EMULATOR_WIDGET_PATH):`https://${t.authDomain}/${WIDGET_PATH}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WEB_STORAGE_SUPPORT_KEY="webStorageSupport";class BrowserPopupRedirectResolver{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=browserSessionPersistence,this._completeRedirectFn=_getRedirectResult,this._overrideRedirectResult=_overrideRedirectResult}_openPopup(e,r,n,i){return Ye(this,null,function*(){var s;debugAssert((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=yield _getRedirectUrl(e,r,n,_getCurrentUrl(),i);return _open(e,a,_generateEventId())})}_openRedirect(e,r,n,i){return Ye(this,null,function*(){yield this._originValidation(e);const s=yield _getRedirectUrl(e,r,n,_getCurrentUrl(),i);return _setWindowLocation(s),new Promise(()=>{})})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(debugAssert(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}initAndGetManager(e){return Ye(this,null,function*(){const r=yield _openIframe(e),n=new AuthEventManager(e);return r.register("authEvent",i=>(_assert(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n})}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(WEB_STORAGE_SUPPORT_KEY,{type:WEB_STORAGE_SUPPORT_KEY},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[WEB_STORAGE_SUPPORT_KEY];a!==void 0&&r(!!a),_fail(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=_validateOrigin(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return _isMobileBrowser()||_isSafari()||_isIOS()}}const browserPopupRedirectResolver=BrowserPopupRedirectResolver;var name$5="@firebase/auth",version$5="1.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthInterop{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return Ye(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){_assert(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getVersionForPlatform(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function registerAuth(t){_registerComponent(new Component("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;_assert(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_getClientVersion(t)},u=new AuthImpl(n,i,s,c);return _initializeAuthInstance(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),_registerComponent(new Component("auth-internal",e=>{const r=_castAuth(e.getProvider("auth").getImmediate());return(n=>new AuthInterop(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),registerVersion(name$5,version$5,getVersionForPlatform(t)),registerVersion(name$5,version$5,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ID_TOKEN_MAX_AGE=5*60,authIdTokenMaxAge=getExperimentalSetting("authIdTokenMaxAge")||DEFAULT_ID_TOKEN_MAX_AGE;let lastPostedIdToken=null;const mintCookieFactory=t=>e=>Ye(void 0,null,function*(){const r=e&&(yield e.getIdTokenResult()),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>authIdTokenMaxAge)return;const i=r==null?void 0:r.token;lastPostedIdToken!==i&&(lastPostedIdToken=i,yield fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function getAuth(t=getApp()){const e=_getProvider(t,"auth");if(e.isInitialized())return e.getImmediate();const r=initializeAuth(t,{popupRedirectResolver:browserPopupRedirectResolver,persistence:[indexedDBLocalPersistence,browserLocalPersistence,browserSessionPersistence]}),n=getExperimentalSetting("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=mintCookieFactory(s.toString());beforeAuthStateChanged(r,a,()=>a(r.currentUser)),onIdTokenChanged(r,o=>a(o))}}const i=getDefaultEmulatorHost("auth");return i&&connectAuthEmulator(r,`http://${i}`),r}function getScriptParentElement(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}_setExternalJSProvider({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const s=_createError("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",getScriptParentElement().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});registerAuth("Browser");/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function __awaiter(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(h){try{u(n.next(h))}catch(f){a(f)}}function c(h){try{u(n.throw(h))}catch(f){a(f)}}function u(h){h.done?s(h.value):i(h.value).then(o,c)}u((n=n.apply(t,[])).next())})}function __generator(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(u){return function(h){return c([u,h])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(h){u=[6,h],i=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var __assign=function(){return __assign=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},__assign.apply(this,arguments)},defaultState=function(t){return{loading:t==null,value:t}},reducer=function(){return function(t,e){switch(e.type){case"error":return __assign(__assign({},t),{error:e.error,loading:!1,value:void 0});case"reset":return defaultState(e.defaultValue);case"value":return __assign(__assign({},t),{error:void 0,loading:!1,value:e.value});default:return t}}},useLoadingValue=function(t){var e=t?t():void 0,r=reactExports.useReducer(reducer(),defaultState(e)),n=r[0],i=r[1],s=reactExports.useCallback(function(){var c=t?t():void 0;i({type:"reset",defaultValue:c})},[t]),a=reactExports.useCallback(function(c){i({type:"error",error:c})},[]),o=reactExports.useCallback(function(c){i({type:"value",value:c})},[]);return reactExports.useMemo(function(){return{error:n.error,loading:n.loading,reset:s,setError:a,setValue:o,value:n.value}},[n.error,n.loading,s,a,o,n.value])},useAuthState=function(t,e){var r=useLoadingValue(function(){return t.currentUser}),n=r.error,i=r.loading,s=r.setError,a=r.setValue,o=r.value;return reactExports.useEffect(function(){var c=onAuthStateChanged(t,function(u){return __awaiter(void 0,void 0,void 0,function(){var h;return __generator(this,function(f){switch(f.label){case 0:return[3,4];case 1:return f.trys.push([1,3,,4]),[4,e.onUserChanged(u)];case 2:return f.sent(),[3,4];case 3:return h=f.sent(),s(h),[3,4];case 4:return a(u),[2]}})})},s);return function(){c()}},[t]),[o,i,n]},name$4="firebase",version$4="11.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */registerVersion(name$4,version$4,"app");var commonjsGlobal$1=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Integer;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(x,M){function T(){}T.prototype=M.prototype,x.D=M.prototype,x.prototype=new T,x.prototype.constructor=x,x.C=function(O,R,Y){for(var q=Array(arguments.length-2),me=2;me<arguments.length;me++)q[me-2]=arguments[me];return M.prototype[R].apply(O,q)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(x,M,T){T||(T=0);var O=Array(16);if(typeof M=="string")for(var R=0;16>R;++R)O[R]=M.charCodeAt(T++)|M.charCodeAt(T++)<<8|M.charCodeAt(T++)<<16|M.charCodeAt(T++)<<24;else for(R=0;16>R;++R)O[R]=M[T++]|M[T++]<<8|M[T++]<<16|M[T++]<<24;M=x.g[0],T=x.g[1],R=x.g[2];var Y=x.g[3],q=M+(Y^T&(R^Y))+O[0]+3614090360&4294967295;M=T+(q<<7&4294967295|q>>>25),q=Y+(R^M&(T^R))+O[1]+3905402710&4294967295,Y=M+(q<<12&4294967295|q>>>20),q=R+(T^Y&(M^T))+O[2]+606105819&4294967295,R=Y+(q<<17&4294967295|q>>>15),q=T+(M^R&(Y^M))+O[3]+3250441966&4294967295,T=R+(q<<22&4294967295|q>>>10),q=M+(Y^T&(R^Y))+O[4]+4118548399&4294967295,M=T+(q<<7&4294967295|q>>>25),q=Y+(R^M&(T^R))+O[5]+1200080426&4294967295,Y=M+(q<<12&4294967295|q>>>20),q=R+(T^Y&(M^T))+O[6]+2821735955&4294967295,R=Y+(q<<17&4294967295|q>>>15),q=T+(M^R&(Y^M))+O[7]+4249261313&4294967295,T=R+(q<<22&4294967295|q>>>10),q=M+(Y^T&(R^Y))+O[8]+1770035416&4294967295,M=T+(q<<7&4294967295|q>>>25),q=Y+(R^M&(T^R))+O[9]+2336552879&4294967295,Y=M+(q<<12&4294967295|q>>>20),q=R+(T^Y&(M^T))+O[10]+4294925233&4294967295,R=Y+(q<<17&4294967295|q>>>15),q=T+(M^R&(Y^M))+O[11]+2304563134&4294967295,T=R+(q<<22&4294967295|q>>>10),q=M+(Y^T&(R^Y))+O[12]+1804603682&4294967295,M=T+(q<<7&4294967295|q>>>25),q=Y+(R^M&(T^R))+O[13]+4254626195&4294967295,Y=M+(q<<12&4294967295|q>>>20),q=R+(T^Y&(M^T))+O[14]+2792965006&4294967295,R=Y+(q<<17&4294967295|q>>>15),q=T+(M^R&(Y^M))+O[15]+1236535329&4294967295,T=R+(q<<22&4294967295|q>>>10),q=M+(R^Y&(T^R))+O[1]+4129170786&4294967295,M=T+(q<<5&4294967295|q>>>27),q=Y+(T^R&(M^T))+O[6]+3225465664&4294967295,Y=M+(q<<9&4294967295|q>>>23),q=R+(M^T&(Y^M))+O[11]+643717713&4294967295,R=Y+(q<<14&4294967295|q>>>18),q=T+(Y^M&(R^Y))+O[0]+3921069994&4294967295,T=R+(q<<20&4294967295|q>>>12),q=M+(R^Y&(T^R))+O[5]+3593408605&4294967295,M=T+(q<<5&4294967295|q>>>27),q=Y+(T^R&(M^T))+O[10]+38016083&4294967295,Y=M+(q<<9&4294967295|q>>>23),q=R+(M^T&(Y^M))+O[15]+3634488961&4294967295,R=Y+(q<<14&4294967295|q>>>18),q=T+(Y^M&(R^Y))+O[4]+3889429448&4294967295,T=R+(q<<20&4294967295|q>>>12),q=M+(R^Y&(T^R))+O[9]+568446438&4294967295,M=T+(q<<5&4294967295|q>>>27),q=Y+(T^R&(M^T))+O[14]+3275163606&4294967295,Y=M+(q<<9&4294967295|q>>>23),q=R+(M^T&(Y^M))+O[3]+4107603335&4294967295,R=Y+(q<<14&4294967295|q>>>18),q=T+(Y^M&(R^Y))+O[8]+1163531501&4294967295,T=R+(q<<20&4294967295|q>>>12),q=M+(R^Y&(T^R))+O[13]+2850285829&4294967295,M=T+(q<<5&4294967295|q>>>27),q=Y+(T^R&(M^T))+O[2]+4243563512&4294967295,Y=M+(q<<9&4294967295|q>>>23),q=R+(M^T&(Y^M))+O[7]+1735328473&4294967295,R=Y+(q<<14&4294967295|q>>>18),q=T+(Y^M&(R^Y))+O[12]+2368359562&4294967295,T=R+(q<<20&4294967295|q>>>12),q=M+(T^R^Y)+O[5]+4294588738&4294967295,M=T+(q<<4&4294967295|q>>>28),q=Y+(M^T^R)+O[8]+2272392833&4294967295,Y=M+(q<<11&4294967295|q>>>21),q=R+(Y^M^T)+O[11]+1839030562&4294967295,R=Y+(q<<16&4294967295|q>>>16),q=T+(R^Y^M)+O[14]+4259657740&4294967295,T=R+(q<<23&4294967295|q>>>9),q=M+(T^R^Y)+O[1]+2763975236&4294967295,M=T+(q<<4&4294967295|q>>>28),q=Y+(M^T^R)+O[4]+1272893353&4294967295,Y=M+(q<<11&4294967295|q>>>21),q=R+(Y^M^T)+O[7]+4139469664&4294967295,R=Y+(q<<16&4294967295|q>>>16),q=T+(R^Y^M)+O[10]+3200236656&4294967295,T=R+(q<<23&4294967295|q>>>9),q=M+(T^R^Y)+O[13]+681279174&4294967295,M=T+(q<<4&4294967295|q>>>28),q=Y+(M^T^R)+O[0]+3936430074&4294967295,Y=M+(q<<11&4294967295|q>>>21),q=R+(Y^M^T)+O[3]+3572445317&4294967295,R=Y+(q<<16&4294967295|q>>>16),q=T+(R^Y^M)+O[6]+76029189&4294967295,T=R+(q<<23&4294967295|q>>>9),q=M+(T^R^Y)+O[9]+3654602809&4294967295,M=T+(q<<4&4294967295|q>>>28),q=Y+(M^T^R)+O[12]+3873151461&4294967295,Y=M+(q<<11&4294967295|q>>>21),q=R+(Y^M^T)+O[15]+530742520&4294967295,R=Y+(q<<16&4294967295|q>>>16),q=T+(R^Y^M)+O[2]+3299628645&4294967295,T=R+(q<<23&4294967295|q>>>9),q=M+(R^(T|~Y))+O[0]+4096336452&4294967295,M=T+(q<<6&4294967295|q>>>26),q=Y+(T^(M|~R))+O[7]+1126891415&4294967295,Y=M+(q<<10&4294967295|q>>>22),q=R+(M^(Y|~T))+O[14]+2878612391&4294967295,R=Y+(q<<15&4294967295|q>>>17),q=T+(Y^(R|~M))+O[5]+4237533241&4294967295,T=R+(q<<21&4294967295|q>>>11),q=M+(R^(T|~Y))+O[12]+1700485571&4294967295,M=T+(q<<6&4294967295|q>>>26),q=Y+(T^(M|~R))+O[3]+2399980690&4294967295,Y=M+(q<<10&4294967295|q>>>22),q=R+(M^(Y|~T))+O[10]+4293915773&4294967295,R=Y+(q<<15&4294967295|q>>>17),q=T+(Y^(R|~M))+O[1]+2240044497&4294967295,T=R+(q<<21&4294967295|q>>>11),q=M+(R^(T|~Y))+O[8]+1873313359&4294967295,M=T+(q<<6&4294967295|q>>>26),q=Y+(T^(M|~R))+O[15]+4264355552&4294967295,Y=M+(q<<10&4294967295|q>>>22),q=R+(M^(Y|~T))+O[6]+2734768916&4294967295,R=Y+(q<<15&4294967295|q>>>17),q=T+(Y^(R|~M))+O[13]+1309151649&4294967295,T=R+(q<<21&4294967295|q>>>11),q=M+(R^(T|~Y))+O[4]+4149444226&4294967295,M=T+(q<<6&4294967295|q>>>26),q=Y+(T^(M|~R))+O[11]+3174756917&4294967295,Y=M+(q<<10&4294967295|q>>>22),q=R+(M^(Y|~T))+O[2]+718787259&4294967295,R=Y+(q<<15&4294967295|q>>>17),q=T+(Y^(R|~M))+O[9]+3951481745&4294967295,x.g[0]=x.g[0]+M&4294967295,x.g[1]=x.g[1]+(R+(q<<21&4294967295|q>>>11))&4294967295,x.g[2]=x.g[2]+R&4294967295,x.g[3]=x.g[3]+Y&4294967295}n.prototype.u=function(x,M){M===void 0&&(M=x.length);for(var T=M-this.blockSize,O=this.B,R=this.h,Y=0;Y<M;){if(R==0)for(;Y<=T;)i(this,x,Y),Y+=this.blockSize;if(typeof x=="string"){for(;Y<M;)if(O[R++]=x.charCodeAt(Y++),R==this.blockSize){i(this,O),R=0;break}}else for(;Y<M;)if(O[R++]=x[Y++],R==this.blockSize){i(this,O),R=0;break}}this.h=R,this.o+=M},n.prototype.v=function(){var x=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);x[0]=128;for(var M=1;M<x.length-8;++M)x[M]=0;var T=8*this.o;for(M=x.length-8;M<x.length;++M)x[M]=T&255,T/=256;for(this.u(x),x=Array(16),M=T=0;4>M;++M)for(var O=0;32>O;O+=8)x[T++]=this.g[M]>>>O&255;return x};function s(x,M){var T=o;return Object.prototype.hasOwnProperty.call(T,x)?T[x]:T[x]=M(x)}function a(x,M){this.h=M;for(var T=[],O=!0,R=x.length-1;0<=R;R--){var Y=x[R]|0;O&&Y==M||(T[R]=Y,O=!1)}this.g=T}var o={};function c(x){return-128<=x&&128>x?s(x,function(M){return new a([M|0],0>M?-1:0)}):new a([x|0],0>x?-1:0)}function u(x){if(isNaN(x)||!isFinite(x))return f;if(0>x)return _(u(-x));for(var M=[],T=1,O=0;x>=T;O++)M[O]=x/T|0,T*=4294967296;return new a(M,0)}function h(x,M){if(x.length==0)throw Error("number format error: empty string");if(M=M||10,2>M||36<M)throw Error("radix out of range: "+M);if(x.charAt(0)=="-")return _(h(x.substring(1),M));if(0<=x.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=u(Math.pow(M,8)),O=f,R=0;R<x.length;R+=8){var Y=Math.min(8,x.length-R),q=parseInt(x.substring(R,R+Y),M);8>Y?(Y=u(Math.pow(M,Y)),O=O.j(Y).add(u(q))):(O=O.j(T),O=O.add(u(q)))}return O}var f=c(0),m=c(1),E=c(16777216);t=a.prototype,t.m=function(){if(p(this))return-_(this).m();for(var x=0,M=1,T=0;T<this.g.length;T++){var O=this.i(T);x+=(0<=O?O:4294967296+O)*M,M*=4294967296}return x},t.toString=function(x){if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(g(this))return"0";if(p(this))return"-"+_(this).toString(x);for(var M=u(Math.pow(x,6)),T=this,O="";;){var R=ne(T,M).g;T=A(T,R.j(M));var Y=((0<T.g.length?T.g[0]:T.h)>>>0).toString(x);if(T=R,g(T))return Y+O;for(;6>Y.length;)Y="0"+Y;O=Y+O}},t.i=function(x){return 0>x?0:x<this.g.length?this.g[x]:this.h};function g(x){if(x.h!=0)return!1;for(var M=0;M<x.g.length;M++)if(x.g[M]!=0)return!1;return!0}function p(x){return x.h==-1}t.l=function(x){return x=A(this,x),p(x)?-1:g(x)?0:1};function _(x){for(var M=x.g.length,T=[],O=0;O<M;O++)T[O]=~x.g[O];return new a(T,~x.h).add(m)}t.abs=function(){return p(this)?_(this):this},t.add=function(x){for(var M=Math.max(this.g.length,x.g.length),T=[],O=0,R=0;R<=M;R++){var Y=O+(this.i(R)&65535)+(x.i(R)&65535),q=(Y>>>16)+(this.i(R)>>>16)+(x.i(R)>>>16);O=q>>>16,Y&=65535,q&=65535,T[R]=q<<16|Y}return new a(T,T[T.length-1]&-2147483648?-1:0)};function A(x,M){return x.add(_(M))}t.j=function(x){if(g(this)||g(x))return f;if(p(this))return p(x)?_(this).j(_(x)):_(_(this).j(x));if(p(x))return _(this.j(_(x)));if(0>this.l(E)&&0>x.l(E))return u(this.m()*x.m());for(var M=this.g.length+x.g.length,T=[],O=0;O<2*M;O++)T[O]=0;for(O=0;O<this.g.length;O++)for(var R=0;R<x.g.length;R++){var Y=this.i(O)>>>16,q=this.i(O)&65535,me=x.i(R)>>>16,xe=x.i(R)&65535;T[2*O+2*R]+=q*xe,H(T,2*O+2*R),T[2*O+2*R+1]+=Y*xe,H(T,2*O+2*R+1),T[2*O+2*R+1]+=q*me,H(T,2*O+2*R+1),T[2*O+2*R+2]+=Y*me,H(T,2*O+2*R+2)}for(O=0;O<M;O++)T[O]=T[2*O+1]<<16|T[2*O];for(O=M;O<2*M;O++)T[O]=0;return new a(T,0)};function H(x,M){for(;(x[M]&65535)!=x[M];)x[M+1]+=x[M]>>>16,x[M]&=65535,M++}function te(x,M){this.g=x,this.h=M}function ne(x,M){if(g(M))throw Error("division by zero");if(g(x))return new te(f,f);if(p(x))return M=ne(_(x),M),new te(_(M.g),_(M.h));if(p(M))return M=ne(x,_(M)),new te(_(M.g),M.h);if(30<x.g.length){if(p(x)||p(M))throw Error("slowDivide_ only works with positive integers.");for(var T=m,O=M;0>=O.l(x);)T=j(T),O=j(O);var R=ee(T,1),Y=ee(O,1);for(O=ee(O,2),T=ee(T,2);!g(O);){var q=Y.add(O);0>=q.l(x)&&(R=R.add(T),Y=q),O=ee(O,1),T=ee(T,1)}return M=A(x,R.j(M)),new te(R,M)}for(R=f;0<=x.l(M);){for(T=Math.max(1,Math.floor(x.m()/M.m())),O=Math.ceil(Math.log(T)/Math.LN2),O=48>=O?1:Math.pow(2,O-48),Y=u(T),q=Y.j(M);p(q)||0<q.l(x);)T-=O,Y=u(T),q=Y.j(M);g(Y)&&(Y=m),R=R.add(Y),x=A(x,q)}return new te(R,x)}t.A=function(x){return ne(this,x).h},t.and=function(x){for(var M=Math.max(this.g.length,x.g.length),T=[],O=0;O<M;O++)T[O]=this.i(O)&x.i(O);return new a(T,this.h&x.h)},t.or=function(x){for(var M=Math.max(this.g.length,x.g.length),T=[],O=0;O<M;O++)T[O]=this.i(O)|x.i(O);return new a(T,this.h|x.h)},t.xor=function(x){for(var M=Math.max(this.g.length,x.g.length),T=[],O=0;O<M;O++)T[O]=this.i(O)^x.i(O);return new a(T,this.h^x.h)};function j(x){for(var M=x.g.length+1,T=[],O=0;O<M;O++)T[O]=x.i(O)<<1|x.i(O-1)>>>31;return new a(T,x.h)}function ee(x,M){var T=M>>5;M%=32;for(var O=x.g.length-T,R=[],Y=0;Y<O;Y++)R[Y]=0<M?x.i(Y+T)>>>M|x.i(Y+T+1)<<32-M:x.i(Y+T);return new a(R,x.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=h,Integer=a}).apply(typeof commonjsGlobal$1!="undefined"?commonjsGlobal$1:typeof self!="undefined"?self:typeof window!="undefined"?window:{});var commonjsGlobal=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(w,he,we){return w==Array.prototype||w==Object.prototype||(w[he]=we.value),w};function r(w){w=[typeof globalThis=="object"&&globalThis,w,typeof window=="object"&&window,typeof self=="object"&&self,typeof commonjsGlobal=="object"&&commonjsGlobal];for(var he=0;he<w.length;++he){var we=w[he];if(we&&we.Math==Math)return we}throw Error("Cannot find global object")}var n=r(this);function i(w,he){if(he)e:{var we=n;w=w.split(".");for(var Be=0;Be<w.length-1;Be++){var Ft=w[Be];if(!(Ft in we))break e;we=we[Ft]}w=w[w.length-1],Be=we[w],he=he(Be),he!=Be&&he!=null&&e(we,w,{configurable:!0,writable:!0,value:he})}}function s(w,he){w instanceof String&&(w+="");var we=0,Be=!1,Ft={next:function(){if(!Be&&we<w.length){var rr=we++;return{value:he(rr,w[rr]),done:!1}}return Be=!0,{done:!0,value:void 0}}};return Ft[Symbol.iterator]=function(){return Ft},Ft}i("Array.prototype.values",function(w){return w||function(){return s(this,function(he,we){return we})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function c(w){var he=typeof w;return he=he!="object"?he:w?Array.isArray(w)?"array":he:"null",he=="array"||he=="object"&&typeof w.length=="number"}function u(w){var he=typeof w;return he=="object"&&w!=null||he=="function"}function h(w,he,we){return w.call.apply(w.bind,arguments)}function f(w,he,we){if(!w)throw Error();if(2<arguments.length){var Be=Array.prototype.slice.call(arguments,2);return function(){var Ft=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Ft,Be),w.apply(he,Ft)}}return function(){return w.apply(he,arguments)}}function m(w,he,we){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:f,m.apply(null,arguments)}function E(w,he){var we=Array.prototype.slice.call(arguments,1);return function(){var Be=we.slice();return Be.push.apply(Be,arguments),w.apply(this,Be)}}function g(w,he){function we(){}we.prototype=he.prototype,w.aa=he.prototype,w.prototype=new we,w.prototype.constructor=w,w.Qb=function(Be,Ft,rr){for(var yr=Array(arguments.length-2),Wr=2;Wr<arguments.length;Wr++)yr[Wr-2]=arguments[Wr];return he.prototype[Ft].apply(Be,yr)}}function p(w){const he=w.length;if(0<he){const we=Array(he);for(let Be=0;Be<he;Be++)we[Be]=w[Be];return we}return[]}function _(w,he){for(let we=1;we<arguments.length;we++){const Be=arguments[we];if(c(Be)){const Ft=w.length||0,rr=Be.length||0;w.length=Ft+rr;for(let yr=0;yr<rr;yr++)w[Ft+yr]=Be[yr]}else w.push(Be)}}class A{constructor(he,we){this.i=he,this.j=we,this.h=0,this.g=null}get(){let he;return 0<this.h?(this.h--,he=this.g,this.g=he.next,he.next=null):he=this.i(),he}}function H(w){return/^[\s\xa0]*$/.test(w)}function te(){var w=o.navigator;return w&&(w=w.userAgent)?w:""}function ne(w){return ne[" "](w),w}ne[" "]=function(){};var j=te().indexOf("Gecko")!=-1&&!(te().toLowerCase().indexOf("webkit")!=-1&&te().indexOf("Edge")==-1)&&!(te().indexOf("Trident")!=-1||te().indexOf("MSIE")!=-1)&&te().indexOf("Edge")==-1;function ee(w,he,we){for(const Be in w)he.call(we,w[Be],Be,w)}function x(w,he){for(const we in w)he.call(void 0,w[we],we,w)}function M(w){const he={};for(const we in w)he[we]=w[we];return he}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(w,he){let we,Be;for(let Ft=1;Ft<arguments.length;Ft++){Be=arguments[Ft];for(we in Be)w[we]=Be[we];for(let rr=0;rr<T.length;rr++)we=T[rr],Object.prototype.hasOwnProperty.call(Be,we)&&(w[we]=Be[we])}}function R(w){var he=1;w=w.split(":");const we=[];for(;0<he&&w.length;)we.push(w.shift()),he--;return w.length&&we.push(w.join(":")),we}function Y(w){o.setTimeout(()=>{throw w},0)}function q(){var w=ue;let he=null;return w.g&&(he=w.g,w.g=w.g.next,w.g||(w.h=null),he.next=null),he}class me{constructor(){this.h=this.g=null}add(he,we){const Be=xe.get();Be.set(he,we),this.h?this.h.next=Be:this.g=Be,this.h=Be}}var xe=new A(()=>new Ee,w=>w.reset());class Ee{constructor(){this.next=this.g=this.h=null}set(he,we){this.h=he,this.g=we,this.next=null}reset(){this.next=this.g=this.h=null}}let se,Fe=!1,ue=new me,ae=()=>{const w=o.Promise.resolve(void 0);se=()=>{w.then(_e)}};var _e=()=>{for(var w;w=q();){try{w.h.call(w.g)}catch(we){Y(we)}var he=xe;he.j(w),100>he.h&&(he.h++,w.next=he.g,he.g=w)}Fe=!1};function oe(){this.s=this.s,this.C=this.C}oe.prototype.s=!1,oe.prototype.ma=function(){this.s||(this.s=!0,this.N())},oe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ie(w,he){this.type=w,this.g=this.target=he,this.defaultPrevented=!1}ie.prototype.h=function(){this.defaultPrevented=!0};var re=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var w=!1,he=Object.defineProperty({},"passive",{get:function(){w=!0}});try{const we=()=>{};o.addEventListener("test",we,he),o.removeEventListener("test",we,he)}catch(we){}return w}();function ce(w,he){if(ie.call(this,w?w.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,w){var we=this.type=w.type,Be=w.changedTouches&&w.changedTouches.length?w.changedTouches[0]:null;if(this.target=w.target||w.srcElement,this.g=he,he=w.relatedTarget){if(j){e:{try{ne(he.nodeName);var Ft=!0;break e}catch(rr){}Ft=!1}Ft||(he=null)}}else we=="mouseover"?he=w.fromElement:we=="mouseout"&&(he=w.toElement);this.relatedTarget=he,Be?(this.clientX=Be.clientX!==void 0?Be.clientX:Be.pageX,this.clientY=Be.clientY!==void 0?Be.clientY:Be.pageY,this.screenX=Be.screenX||0,this.screenY=Be.screenY||0):(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0),this.button=w.button,this.key=w.key||"",this.ctrlKey=w.ctrlKey,this.altKey=w.altKey,this.shiftKey=w.shiftKey,this.metaKey=w.metaKey,this.pointerId=w.pointerId||0,this.pointerType=typeof w.pointerType=="string"?w.pointerType:fe[w.pointerType]||"",this.state=w.state,this.i=w,w.defaultPrevented&&ce.aa.h.call(this)}}g(ce,ie);var fe={2:"touch",3:"pen",4:"mouse"};ce.prototype.h=function(){ce.aa.h.call(this);var w=this.i;w.preventDefault?w.preventDefault():w.returnValue=!1};var pe="closure_listenable_"+(1e6*Math.random()|0),ve=0;function Ae(w,he,we,Be,Ft){this.listener=w,this.proxy=null,this.src=he,this.type=we,this.capture=!!Be,this.ha=Ft,this.key=++ve,this.da=this.fa=!1}function be(w){w.da=!0,w.listener=null,w.proxy=null,w.src=null,w.ha=null}function je(w){this.src=w,this.g={},this.h=0}je.prototype.add=function(w,he,we,Be,Ft){var rr=w.toString();w=this.g[rr],w||(w=this.g[rr]=[],this.h++);var yr=Xe(w,he,Be,Ft);return-1<yr?(he=w[yr],we||(he.fa=!1)):(he=new Ae(he,this.src,rr,!!Be,Ft),he.fa=we,w.push(he)),he};function Se(w,he){var we=he.type;if(we in w.g){var Be=w.g[we],Ft=Array.prototype.indexOf.call(Be,he,void 0),rr;(rr=0<=Ft)&&Array.prototype.splice.call(Be,Ft,1),rr&&(be(he),w.g[we].length==0&&(delete w.g[we],w.h--))}}function Xe(w,he,we,Be){for(var Ft=0;Ft<w.length;++Ft){var rr=w[Ft];if(!rr.da&&rr.listener==he&&rr.capture==!!we&&rr.ha==Be)return Ft}return-1}var qe="closure_lm_"+(1e6*Math.random()|0),Je={};function We(w,he,we,Be,Ft){if(Array.isArray(he)){for(var rr=0;rr<he.length;rr++)We(w,he[rr],we,Be,Ft);return null}return we=Ze(we),w&&w[pe]?w.K(he,we,u(Be)?!!Be.capture:!1,Ft):Ue(w,he,we,!1,Be,Ft)}function Ue(w,he,we,Be,Ft,rr){if(!he)throw Error("Invalid event type");var yr=u(Ft)?!!Ft.capture:!!Ft,Wr=Jt(w);if(Wr||(w[qe]=Wr=new je(w)),we=Wr.add(he,we,Be,yr,rr),we.proxy)return we;if(Be=Ce(),we.proxy=Be,Be.src=w,Be.listener=we,w.addEventListener)re||(Ft=yr),Ft===void 0&&(Ft=!1),w.addEventListener(he.toString(),Be,Ft);else if(w.attachEvent)w.attachEvent(Ge(he.toString()),Be);else if(w.addListener&&w.removeListener)w.addListener(Be);else throw Error("addEventListener and attachEvent are unavailable.");return we}function Ce(){function w(we){return he.call(w.src,w.listener,we)}const he=ut;return w}function Le(w,he,we,Be,Ft){if(Array.isArray(he))for(var rr=0;rr<he.length;rr++)Le(w,he[rr],we,Be,Ft);else Be=u(Be)?!!Be.capture:!!Be,we=Ze(we),w&&w[pe]?(w=w.i,he=String(he).toString(),he in w.g&&(rr=w.g[he],we=Xe(rr,we,Be,Ft),-1<we&&(be(rr[we]),Array.prototype.splice.call(rr,we,1),rr.length==0&&(delete w.g[he],w.h--)))):w&&(w=Jt(w))&&(he=w.g[he.toString()],w=-1,he&&(w=Xe(he,we,Be,Ft)),(we=-1<w?he[w]:null)&&Ve(we))}function Ve(w){if(typeof w!="number"&&w&&!w.da){var he=w.src;if(he&&he[pe])Se(he.i,w);else{var we=w.type,Be=w.proxy;he.removeEventListener?he.removeEventListener(we,Be,w.capture):he.detachEvent?he.detachEvent(Ge(we),Be):he.addListener&&he.removeListener&&he.removeListener(Be),(we=Jt(he))?(Se(we,w),we.h==0&&(we.src=null,he[qe]=null)):be(w)}}}function Ge(w){return w in Je?Je[w]:Je[w]="on"+w}function ut(w,he){if(w.da)w=!0;else{he=new ce(he,this);var we=w.listener,Be=w.ha||w.src;w.fa&&Ve(w),w=we.call(Be,he)}return w}function Jt(w){return w=w[qe],w instanceof je?w:null}var Kt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ze(w){return typeof w=="function"?w:(w[Kt]||(w[Kt]=function(he){return w.handleEvent(he)}),w[Kt])}function tr(){oe.call(this),this.i=new je(this),this.M=this,this.F=null}g(tr,oe),tr.prototype[pe]=!0,tr.prototype.removeEventListener=function(w,he,we,Be){Le(this,w,he,we,Be)};function nr(w,he){var we,Be=w.F;if(Be)for(we=[];Be;Be=Be.F)we.push(Be);if(w=w.M,Be=he.type||he,typeof he=="string")he=new ie(he,w);else if(he instanceof ie)he.target=he.target||w;else{var Ft=he;he=new ie(Be,w),O(he,Ft)}if(Ft=!0,we)for(var rr=we.length-1;0<=rr;rr--){var yr=he.g=we[rr];Ft=xr(yr,Be,!0,he)&&Ft}if(yr=he.g=w,Ft=xr(yr,Be,!0,he)&&Ft,Ft=xr(yr,Be,!1,he)&&Ft,we)for(rr=0;rr<we.length;rr++)yr=he.g=we[rr],Ft=xr(yr,Be,!1,he)&&Ft}tr.prototype.N=function(){if(tr.aa.N.call(this),this.i){var w=this.i,he;for(he in w.g){for(var we=w.g[he],Be=0;Be<we.length;Be++)be(we[Be]);delete w.g[he],w.h--}}this.F=null},tr.prototype.K=function(w,he,we,Be){return this.i.add(String(w),he,!1,we,Be)},tr.prototype.L=function(w,he,we,Be){return this.i.add(String(w),he,!0,we,Be)};function xr(w,he,we,Be){if(he=w.i.g[String(he)],!he)return!0;he=he.concat();for(var Ft=!0,rr=0;rr<he.length;++rr){var yr=he[rr];if(yr&&!yr.da&&yr.capture==we){var Wr=yr.listener,Jr=yr.ha||yr.src;yr.fa&&Se(w.i,yr),Ft=Wr.call(Jr,Be)!==!1&&Ft}}return Ft&&!Be.defaultPrevented}function pr(w,he,we){if(typeof w=="function")we&&(w=m(w,we));else if(w&&typeof w.handleEvent=="function")w=m(w.handleEvent,w);else throw Error("Invalid listener argument");return 2147483647<Number(he)?-1:o.setTimeout(w,he||0)}function vr(w){w.g=pr(()=>{w.g=null,w.i&&(w.i=!1,vr(w))},w.l);const he=w.h;w.h=null,w.m.apply(null,he)}class lr extends oe{constructor(he,we){super(),this.m=he,this.l=we,this.h=null,this.i=!1,this.g=null}j(he){this.h=arguments,this.g?this.i=!0:vr(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function mr(w){oe.call(this),this.h=w,this.g={}}g(mr,oe);var wr=[];function Cr(w){ee(w.g,function(he,we){this.g.hasOwnProperty(we)&&Ve(he)},w),w.g={}}mr.prototype.N=function(){mr.aa.N.call(this),Cr(this)},mr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Rr=o.JSON.stringify,ar=o.JSON.parse,it=class{stringify(w){return o.JSON.stringify(w,void 0)}parse(w){return o.JSON.parse(w,void 0)}};function ot(){}ot.prototype.h=null;function gr(w){return w.h||(w.h=w.i())}function Tr(){}var Te={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ze(){ie.call(this,"d")}g(ze,ie);function zt(){ie.call(this,"c")}g(zt,ie);var ir={},cr=null;function or(){return cr=cr||new tr}ir.La="serverreachability";function ke(w){ie.call(this,ir.La,w)}g(ke,ie);function Oe(w){const he=or();nr(he,new ke(he))}ir.STAT_EVENT="statevent";function He(w,he){ie.call(this,ir.STAT_EVENT,w),this.stat=he}g(He,ie);function $e(w){const he=or();nr(he,new He(he,w))}ir.Ma="timingevent";function St(w,he){ie.call(this,ir.Ma,w),this.size=he}g(St,ie);function $t(w,he){if(typeof w!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){w()},he)}function Yt(){this.g=!0}Yt.prototype.xa=function(){this.g=!1};function _r(w,he,we,Be,Ft,rr){w.info(function(){if(w.g)if(rr)for(var yr="",Wr=rr.split("&"),Jr=0;Jr<Wr.length;Jr++){var Nr=Wr[Jr].split("=");if(1<Nr.length){var Qr=Nr[0];Nr=Nr[1];var Vr=Qr.split("_");yr=2<=Vr.length&&Vr[1]=="type"?yr+(Qr+"="+Nr+"&"):yr+(Qr+"=redacted&")}}else yr=null;else yr=rr;return"XMLHTTP REQ ("+Be+") [attempt "+Ft+"]: "+he+`
`+we+`
`+yr})}function sr(w,he,we,Be,Ft,rr,yr){w.info(function(){return"XMLHTTP RESP ("+Be+") [ attempt "+Ft+"]: "+he+`
`+we+`
`+rr+" "+yr})}function ye(w,he,we,Be){w.info(function(){return"XMLHTTP TEXT ("+he+"): "+Re(w,we)+(Be?" "+Be:"")})}function De(w,he){w.info(function(){return"TIMEOUT: "+he})}Yt.prototype.info=function(){};function Re(w,he){if(!w.g)return he;if(!he)return null;try{var we=JSON.parse(he);if(we){for(w=0;w<we.length;w++)if(Array.isArray(we[w])){var Be=we[w];if(!(2>Be.length)){var Ft=Be[1];if(Array.isArray(Ft)&&!(1>Ft.length)){var rr=Ft[0];if(rr!="noop"&&rr!="stop"&&rr!="close")for(var yr=1;yr<Ft.length;yr++)Ft[yr]=""}}}}return Rr(we)}catch(Wr){return he}}var Ie={NO_ERROR:0,TIMEOUT:8},Me={},Ne;function et(){}g(et,ot),et.prototype.g=function(){return new XMLHttpRequest},et.prototype.i=function(){return{}},Ne=new et;function kt(w,he,we,Be){this.j=w,this.i=he,this.l=we,this.R=Be||1,this.U=new mr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Rt}function Rt(){this.i=null,this.g="",this.h=!1}var Tt={},Ut={};function ur(w,he,we){w.L=1,w.v=yn(qr(he)),w.m=we,w.P=!0,fr(w,null)}function fr(w,he){w.F=Date.now(),br(w),w.A=qr(w.v);var we=w.A,Be=w.R;Array.isArray(Be)||(Be=[String(Be)]),ts(we.i,"t",Be),w.C=0,we=w.j.J,w.h=new Rt,w.g=ls(w.j,we?he:null,!w.m),0<w.O&&(w.M=new lr(m(w.Y,w,w.g),w.O)),he=w.U,we=w.g,Be=w.ca;var Ft="readystatechange";Array.isArray(Ft)||(Ft&&(wr[0]=Ft.toString()),Ft=wr);for(var rr=0;rr<Ft.length;rr++){var yr=We(we,Ft[rr],Be||he.handleEvent,!1,he.h||he);if(!yr)break;he.g[yr.key]=yr}he=w.H?M(w.H):{},w.m?(w.u||(w.u="POST"),he["Content-Type"]="application/x-www-form-urlencoded",w.g.ea(w.A,w.u,w.m,he)):(w.u="GET",w.g.ea(w.A,w.u,null,he)),Oe(),_r(w.i,w.u,w.A,w.l,w.R,w.m)}kt.prototype.ca=function(w){w=w.target;const he=this.M;he&&nn(w)==3?he.j():this.Y(w)},kt.prototype.Y=function(w){try{if(w==this.g)e:{const Vr=nn(this.g);var he=this.g.Ba();const gn=this.g.Z();if(!(3>Vr)&&(Vr!=3||this.g&&(this.h.h||this.g.oa()||Ni(this.g)))){this.J||Vr!=4||he==7||(he==8||0>=gn?Oe(3):Oe(2)),jr(this);var we=this.g.Z();this.X=we;t:if(Sr(this)){var Be=Ni(this.g);w="";var Ft=Be.length,rr=nn(this.g)==4;if(!this.h.i){if(typeof TextDecoder=="undefined"){Gr(this),Ur(this);var yr="";break t}this.h.i=new o.TextDecoder}for(he=0;he<Ft;he++)this.h.h=!0,w+=this.h.i.decode(Be[he],{stream:!(rr&&he==Ft-1)});Be.length=0,this.h.g+=w,this.C=0,yr=this.h.g}else yr=this.g.oa();if(this.o=we==200,sr(this.i,this.u,this.A,this.l,this.R,Vr,we),this.o){if(this.T&&!this.K){t:{if(this.g){var Wr,Jr=this.g;if((Wr=Jr.g?Jr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(Wr)){var Nr=Wr;break t}}Nr=null}if(we=Nr)ye(this.i,this.l,we,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,un(this,we);else{this.o=!1,this.s=3,$e(12),Gr(this),Ur(this);break e}}if(this.P){we=!0;let _n;for(;!this.J&&this.C<yr.length;)if(_n=dr(this,yr),_n==Ut){Vr==4&&(this.s=4,$e(14),we=!1),ye(this.i,this.l,null,"[Incomplete Response]");break}else if(_n==Tt){this.s=4,$e(15),ye(this.i,this.l,yr,"[Invalid Chunk]"),we=!1;break}else ye(this.i,this.l,_n,null),un(this,_n);if(Sr(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Vr!=4||yr.length!=0||this.h.h||(this.s=1,$e(16),we=!1),this.o=this.o&&we,!we)ye(this.i,this.l,yr,"[Invalid Chunked Response]"),Gr(this),Ur(this);else if(0<yr.length&&!this.W){this.W=!0;var Qr=this.j;Qr.g==this&&Qr.ba&&!Qr.M&&(Qr.j.info("Great, no buffering proxy detected. Bytes received: "+yr.length),ui(Qr),Qr.M=!0,$e(11))}}else ye(this.i,this.l,yr,null),un(this,yr);Vr==4&&Gr(this),this.o&&!this.J&&(Vr==4?Ui(this.j,this):(this.o=!1,br(this)))}else Ds(this.g),we==400&&0<yr.indexOf("Unknown SID")?(this.s=3,$e(12)):(this.s=0,$e(13)),Gr(this),Ur(this)}}}catch(Vr){}finally{}};function Sr(w){return w.g?w.u=="GET"&&w.L!=2&&w.j.Ca:!1}function dr(w,he){var we=w.C,Be=he.indexOf(`
`,we);return Be==-1?Ut:(we=Number(he.substring(we,Be)),isNaN(we)?Tt:(Be+=1,Be+we>he.length?Ut:(he=he.slice(Be,Be+we),w.C=Be+we,he)))}kt.prototype.cancel=function(){this.J=!0,Gr(this)};function br(w){w.S=Date.now()+w.I,Pr(w,w.I)}function Pr(w,he){if(w.B!=null)throw Error("WatchDog timer not null");w.B=$t(m(w.ba,w),he)}function jr(w){w.B&&(o.clearTimeout(w.B),w.B=null)}kt.prototype.ba=function(){this.B=null;const w=Date.now();0<=w-this.S?(De(this.i,this.A),this.L!=2&&(Oe(),$e(17)),Gr(this),this.s=2,Ur(this)):Pr(this,this.S-w)};function Ur(w){w.j.G==0||w.J||Ui(w.j,w)}function Gr(w){jr(w);var he=w.M;he&&typeof he.ma=="function"&&he.ma(),w.M=null,Cr(w.U),w.g&&(he=w.g,w.g=null,he.abort(),he.ma())}function un(w,he){try{var we=w.j;if(we.G!=0&&(we.g==w||Or(we.h,w))){if(!w.K&&Or(we.h,w)&&we.G==3){try{var Be=we.Da.g.parse(he)}catch(Nr){Be=null}if(Array.isArray(Be)&&Be.length==3){var Ft=Be;if(Ft[0]==0){e:if(!we.u){if(we.g)if(we.g.F+3e3<w.F)di(we),li(we);else break e;ci(we),$e(18)}}else we.za=Ft[1],0<we.za-we.T&&37500>Ft[2]&&we.F&&we.v==0&&!we.C&&(we.C=$t(m(we.Za,we),6e3));if(1>=vn(we.h)&&we.ca){try{we.ca()}catch(Nr){}we.ca=void 0}}else Nn(we,11)}else if((w.K||we.g==w)&&di(we),!H(he))for(Ft=we.Da.g.parse(he),he=0;he<Ft.length;he++){let Nr=Ft[he];if(we.T=Nr[0],Nr=Nr[1],we.G==2)if(Nr[0]=="c"){we.K=Nr[1],we.ia=Nr[2];const Qr=Nr[3];Qr!=null&&(we.la=Qr,we.j.info("VER="+we.la));const Vr=Nr[4];Vr!=null&&(we.Aa=Vr,we.j.info("SVER="+we.Aa));const gn=Nr[5];gn!=null&&typeof gn=="number"&&0<gn&&(Be=1.5*gn,we.L=Be,we.j.info("backChannelRequestTimeoutMs_="+Be)),Be=we;const _n=w.g;if(_n){const ln=_n.g?_n.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ln){var rr=Be.h;rr.g||ln.indexOf("spdy")==-1&&ln.indexOf("quic")==-1&&ln.indexOf("h2")==-1||(rr.j=rr.l,rr.g=new Set,rr.h&&($r(rr,rr.h),rr.h=null))}if(Be.D){const Hi=_n.g?_n.g.getResponseHeader("X-HTTP-Session-Id"):null;Hi&&(Be.ya=Hi,Fr(Be.I,Be.D,Hi))}}we.G=3,we.l&&we.l.ua(),we.ba&&(we.R=Date.now()-w.F,we.j.info("Handshake RTT: "+we.R+"ms")),Be=we;var yr=w;if(Be.qa=fi(Be,Be.J?Be.ia:null,Be.W),yr.K){Yn(Be.h,yr);var Wr=yr,Jr=Be.L;Jr&&(Wr.I=Jr),Wr.B&&(jr(Wr),br(Wr)),Be.g=yr}else kn(Be);0<we.i.length&&Gn(we)}else Nr[0]!="stop"&&Nr[0]!="close"||Nn(we,7);else we.G==3&&(Nr[0]=="stop"||Nr[0]=="close"?Nr[0]=="stop"?Nn(we,7):oi(we):Nr[0]!="noop"&&we.l&&we.l.ta(Nr),we.v=0)}}Oe(4)}catch(Nr){}}var hn=class{constructor(w,he){this.g=w,this.map=he}};function An(w){this.l=w||10,o.PerformanceNavigationTiming?(w=o.performance.getEntriesByType("navigation"),w=0<w.length&&(w[0].nextHopProtocol=="hq"||w[0].nextHopProtocol=="h2")):w=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=w?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function dn(w){return w.h?!0:w.g?w.g.size>=w.j:!1}function vn(w){return w.h?1:w.g?w.g.size:0}function Or(w,he){return w.h?w.h==he:w.g?w.g.has(he):!1}function $r(w,he){w.g?w.g.add(he):w.h=he}function Yn(w,he){w.h&&w.h==he?w.h=null:w.g&&w.g.has(he)&&w.g.delete(he)}An.prototype.cancel=function(){if(this.i=Fn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const w of this.g.values())w.cancel();this.g.clear()}};function Fn(w){if(w.h!=null)return w.i.concat(w.h.D);if(w.g!=null&&w.g.size!==0){let he=w.i;for(const we of w.g.values())he=he.concat(we.D);return he}return p(w.i)}function Hn(w){if(w.V&&typeof w.V=="function")return w.V();if(typeof Map!="undefined"&&w instanceof Map||typeof Set!="undefined"&&w instanceof Set)return Array.from(w.values());if(typeof w=="string")return w.split("");if(c(w)){for(var he=[],we=w.length,Be=0;Be<we;Be++)he.push(w[Be]);return he}he=[],we=0;for(Be in w)he[we++]=w[Be];return he}function Ti(w){if(w.na&&typeof w.na=="function")return w.na();if(!w.V||typeof w.V!="function"){if(typeof Map!="undefined"&&w instanceof Map)return Array.from(w.keys());if(!(typeof Set!="undefined"&&w instanceof Set)){if(c(w)||typeof w=="string"){var he=[];w=w.length;for(var we=0;we<w;we++)he.push(we);return he}he=[],we=0;for(const Be in w)he[we++]=Be;return he}}}function Lr(w,he){if(w.forEach&&typeof w.forEach=="function")w.forEach(he,void 0);else if(c(w)||typeof w=="string")Array.prototype.forEach.call(w,he,void 0);else for(var we=Ti(w),Be=Hn(w),Ft=Be.length,rr=0;rr<Ft;rr++)he.call(void 0,Be[rr],we&&we[rr],w)}var Xr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ai(w,he){if(w){w=w.split("&");for(var we=0;we<w.length;we++){var Be=w[we].indexOf("="),Ft=null;if(0<=Be){var rr=w[we].substring(0,Be);Ft=w[we].substring(Be+1)}else rr=w[we];he(rr,Ft?decodeURIComponent(Ft.replace(/\+/g," ")):"")}}}function xn(w){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,w instanceof xn){this.h=w.h,ri(this,w.j),this.o=w.o,this.g=w.g,Ln(this,w.s),this.l=w.l;var he=w.i,we=new Dn;we.i=he.i,he.g&&(we.g=new Map(he.g),we.h=he.h),In(this,we),this.m=w.m}else w&&(he=String(w).match(Xr))?(this.h=!1,ri(this,he[1]||"",!0),this.o=Cn(he[2]||""),this.g=Cn(he[3]||"",!0),Ln(this,he[4]),this.l=Cn(he[5]||"",!0),In(this,he[6]||"",!0),this.m=Cn(he[7]||"")):(this.h=!1,this.i=new Dn(null,this.h))}xn.prototype.toString=function(){var w=[],he=this.j;he&&w.push(Rn(he,zn,!0),":");var we=this.g;return(we||he=="file")&&(w.push("//"),(he=this.o)&&w.push(Rn(he,zn,!0),"@"),w.push(encodeURIComponent(String(we)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),we=this.s,we!=null&&w.push(":",String(we))),(we=this.l)&&(this.g&&we.charAt(0)!="/"&&w.push("/"),w.push(Rn(we,we.charAt(0)=="/"?ki:Ri,!0))),(we=this.i.toString())&&w.push("?",we),(we=this.m)&&w.push("#",Rn(we,Ii)),w.join("")};function qr(w){return new xn(w)}function ri(w,he,we){w.j=we?Cn(he,!0):he,w.j&&(w.j=w.j.replace(/:$/,""))}function Ln(w,he){if(he){if(he=Number(he),isNaN(he)||0>he)throw Error("Bad port number "+he);w.s=he}else w.s=null}function In(w,he,we){he instanceof Dn?(w.i=he,En(w.i,w.h)):(we||(he=Rn(he,ni)),w.i=new Dn(he,w.h))}function Fr(w,he,we){w.i.set(he,we)}function yn(w){return Fr(w,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),w}function Cn(w,he){return w?he?decodeURI(w.replace(/%25/g,"%2525")):decodeURIComponent(w):""}function Rn(w,he,we){return typeof w=="string"?(w=encodeURI(w).replace(he,Ci),we&&(w=w.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w):null}function Ci(w){return w=w.charCodeAt(0),"%"+(w>>4&15).toString(16)+(w&15).toString(16)}var zn=/[#\/\?@]/g,Ri=/[#\?:]/g,ki=/[#\?]/g,ni=/[#\?@]/g,Ii=/#/g;function Dn(w,he){this.h=this.g=null,this.i=w||null,this.j=!!he}function fn(w){w.g||(w.g=new Map,w.h=0,w.i&&Ai(w.i,function(he,we){w.add(decodeURIComponent(he.replace(/\+/g," ")),we)}))}t=Dn.prototype,t.add=function(w,he){fn(this),this.i=null,w=kr(this,w);var we=this.g.get(w);return we||this.g.set(w,we=[]),we.push(he),this.h+=1,this};function Pi(w,he){fn(w),he=kr(w,he),w.g.has(he)&&(w.i=null,w.h-=w.g.get(he).length,w.g.delete(he))}function ii(w,he){return fn(w),he=kr(w,he),w.g.has(he)}t.forEach=function(w,he){fn(this),this.g.forEach(function(we,Be){we.forEach(function(Ft){w.call(he,Ft,Be,this)},this)},this)},t.na=function(){fn(this);const w=Array.from(this.g.values()),he=Array.from(this.g.keys()),we=[];for(let Be=0;Be<he.length;Be++){const Ft=w[Be];for(let rr=0;rr<Ft.length;rr++)we.push(he[Be])}return we},t.V=function(w){fn(this);let he=[];if(typeof w=="string")ii(this,w)&&(he=he.concat(this.g.get(kr(this,w))));else{w=Array.from(this.g.values());for(let we=0;we<w.length;we++)he=he.concat(w[we])}return he},t.set=function(w,he){return fn(this),this.i=null,w=kr(this,w),ii(this,w)&&(this.h-=this.g.get(w).length),this.g.set(w,[he]),this.h+=1,this},t.get=function(w,he){return w?(w=this.V(w),0<w.length?String(w[0]):he):he};function ts(w,he,we){Pi(w,he),0<we.length&&(w.i=null,w.g.set(kr(w,he),p(we)),w.h+=we.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const w=[],he=Array.from(this.g.keys());for(var we=0;we<he.length;we++){var Be=he[we];const rr=encodeURIComponent(String(Be)),yr=this.V(Be);for(Be=0;Be<yr.length;Be++){var Ft=rr;yr[Be]!==""&&(Ft+="="+encodeURIComponent(String(yr[Be]))),w.push(Ft)}}return this.i=w.join("&")};function kr(w,he){return he=String(he),w.j&&(he=he.toLowerCase()),he}function En(w,he){he&&!w.j&&(fn(w),w.i=null,w.g.forEach(function(we,Be){var Ft=Be.toLowerCase();Be!=Ft&&(Pi(this,Be),ts(this,Ft,we))},w)),w.j=he}function zr(w,he){const we=new Yt;if(o.Image){const Be=new Image;Be.onload=E(wn,we,"TestLoadImage: loaded",!0,he,Be),Be.onerror=E(wn,we,"TestLoadImage: error",!1,he,Be),Be.onabort=E(wn,we,"TestLoadImage: abort",!1,he,Be),Be.ontimeout=E(wn,we,"TestLoadImage: timeout",!1,he,Be),o.setTimeout(function(){Be.ontimeout&&Be.ontimeout()},1e4),Be.src=w}else he(!1)}function rs(w,he){const we=new Yt,Be=new AbortController,Ft=setTimeout(()=>{Be.abort(),wn(we,"TestPingServer: timeout",!1,he)},1e4);fetch(w,{signal:Be.signal}).then(rr=>{clearTimeout(Ft),rr.ok?wn(we,"TestPingServer: ok",!0,he):wn(we,"TestPingServer: server error",!1,he)}).catch(()=>{clearTimeout(Ft),wn(we,"TestPingServer: error",!1,he)})}function wn(w,he,we,Be,Ft){try{Ft&&(Ft.onload=null,Ft.onerror=null,Ft.onabort=null,Ft.ontimeout=null),Be(we)}catch(rr){}}function Oi(){this.g=new it}function Fi(w,he,we){const Be=we||"";try{Lr(w,function(Ft,rr){let yr=Ft;u(Ft)&&(yr=Rr(Ft)),he.push(Be+rr+"="+encodeURIComponent(yr))})}catch(Ft){throw he.push(Be+"type="+encodeURIComponent("_badmap")),Ft}}function bn(w){this.l=w.Ub||null,this.j=w.eb||!1}g(bn,ot),bn.prototype.g=function(){return new Vn(this.l,this.j)},bn.prototype.i=function(w){return function(){return w}}({});function Vn(w,he){tr.call(this),this.D=w,this.o=he,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(Vn,tr),t=Vn.prototype,t.open=function(w,he){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=w,this.A=he,this.readyState=1,pn(this)},t.send=function(w){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const he={headers:this.u,method:this.B,credentials:this.m,cache:void 0};w&&(he.body=w),(this.D||o).fetch(new Request(this.A,he)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Kr(this)),this.readyState=0},t.Sa=function(w){if(this.g&&(this.l=w,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=w.headers,this.readyState=2,pn(this)),this.g&&(this.readyState=3,pn(this),this.g)))if(this.responseType==="arraybuffer")w.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream!="undefined"&&"body"in w){if(this.j=w.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;$n(this)}else w.text().then(this.Ra.bind(this),this.ga.bind(this))};function $n(w){w.j.read().then(w.Pa.bind(w)).catch(w.ga.bind(w))}t.Pa=function(w){if(this.g){if(this.o&&w.value)this.response.push(w.value);else if(!this.o){var he=w.value?w.value:new Uint8Array(0);(he=this.v.decode(he,{stream:!w.done}))&&(this.response=this.responseText+=he)}w.done?Kr(this):pn(this),this.readyState==3&&$n(this)}},t.Ra=function(w){this.g&&(this.response=this.responseText=w,Kr(this))},t.Qa=function(w){this.g&&(this.response=w,Kr(this))},t.ga=function(){this.g&&Kr(this)};function Kr(w){w.readyState=4,w.l=null,w.j=null,w.v=null,pn(w)}t.setRequestHeader=function(w,he){this.u.append(w,he)},t.getResponseHeader=function(w){return this.h&&this.h.get(w.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const w=[],he=this.h.entries();for(var we=he.next();!we.done;)we=we.value,w.push(we[0]+": "+we[1]),we=he.next();return w.join(`\r
`)};function pn(w){w.onreadystatechange&&w.onreadystatechange.call(w)}Object.defineProperty(Vn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(w){this.m=w?"include":"same-origin"}});function Li(w){let he="";return ee(w,function(we,Be){he+=Be,he+=":",he+=we,he+=`\r
`}),he}function si(w,he,we){e:{for(Be in we){var Be=!1;break e}Be=!0}Be||(we=Li(we),typeof w=="string"?we!=null&&encodeURIComponent(String(we)):Fr(w,he,we))}function Yr(w){tr.call(this),this.headers=new Map,this.o=w||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(Yr,tr);var ns=/^https?$/i,Di=["POST","PUT"];t=Yr.prototype,t.Ha=function(w){this.J=w},t.ea=function(w,he,we,Be){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+w);he=he?he.toUpperCase():"GET",this.D=w,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ne.g(),this.v=this.o?gr(this.o):gr(Ne),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(he,String(w),!0),this.B=!1}catch(rr){is(this,rr);return}if(w=we||"",we=new Map(this.headers),Be)if(Object.getPrototypeOf(Be)===Object.prototype)for(var Ft in Be)we.set(Ft,Be[Ft]);else if(typeof Be.keys=="function"&&typeof Be.get=="function")for(const rr of Be.keys())we.set(rr,Be.get(rr));else throw Error("Unknown input type for opt_headers: "+String(Be));Be=Array.from(we.keys()).find(rr=>rr.toLowerCase()=="content-type"),Ft=o.FormData&&w instanceof o.FormData,!(0<=Array.prototype.indexOf.call(Di,he,void 0))||Be||Ft||we.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[rr,yr]of we)this.g.setRequestHeader(rr,yr);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{on(this),this.u=!0,this.g.send(w),this.u=!1}catch(rr){is(this,rr)}};function is(w,he){w.h=!1,w.g&&(w.j=!0,w.g.abort(),w.j=!1),w.l=he,w.m=5,Mi(w),ai(w)}function Mi(w){w.A||(w.A=!0,nr(w,"complete"),nr(w,"error"))}t.abort=function(w){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=w||7,nr(this,"complete"),nr(this,"abort"),ai(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ai(this,!0)),Yr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Mr(this):this.bb())},t.bb=function(){Mr(this)};function Mr(w){if(w.h&&typeof a!="undefined"&&(!w.v[1]||nn(w)!=4||w.Z()!=2)){if(w.u&&nn(w)==4)pr(w.Ea,0,w);else if(nr(w,"readystatechange"),nn(w)==4){w.h=!1;try{const yr=w.Z();e:switch(yr){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var he=!0;break e;default:he=!1}var we;if(!(we=he)){var Be;if(Be=yr===0){var Ft=String(w.D).match(Xr)[1]||null;!Ft&&o.self&&o.self.location&&(Ft=o.self.location.protocol.slice(0,-1)),Be=!ns.test(Ft?Ft.toLowerCase():"")}we=Be}if(we)nr(w,"complete"),nr(w,"success");else{w.m=6;try{var rr=2<nn(w)?w.g.statusText:""}catch(Wr){rr=""}w.l=rr+" ["+w.Z()+"]",Mi(w)}}finally{ai(w)}}}}function ai(w,he){if(w.g){on(w);const we=w.g,Be=w.v[0]?()=>{}:null;w.g=null,w.v=null,he||nr(w,"ready");try{we.onreadystatechange=Be}catch(Ft){}}}function on(w){w.I&&(o.clearTimeout(w.I),w.I=null)}t.isActive=function(){return!!this.g};function nn(w){return w.g?w.g.readyState:0}t.Z=function(){try{return 2<nn(this)?this.g.status:-1}catch(w){return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch(w){return""}},t.Oa=function(w){if(this.g){var he=this.g.responseText;return w&&he.indexOf(w)==0&&(he=he.substring(w.length)),ar(he)}};function Ni(w){try{if(!w.g)return null;if("response"in w.g)return w.g.response;switch(w.H){case"":case"text":return w.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in w.g)return w.g.mozResponseArrayBuffer}return null}catch(he){return null}}function Ds(w){const he={};w=(w.g&&2<=nn(w)&&w.g.getAllResponseHeaders()||"").split(`\r
`);for(let Be=0;Be<w.length;Be++){if(H(w[Be]))continue;var we=R(w[Be]);const Ft=we[0];if(we=we[1],typeof we!="string")continue;we=we.trim();const rr=he[Ft]||[];he[Ft]=rr,rr.push(we)}x(he,function(Be){return Be.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Mn(w,he,we){return we&&we.internalChannelParams&&we.internalChannelParams[w]||he}function ss(w){this.Aa=0,this.i=[],this.j=new Yt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Mn("failFast",!1,w),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Mn("baseRetryDelayMs",5e3,w),this.cb=Mn("retryDelaySeedMs",1e4,w),this.Wa=Mn("forwardChannelMaxRetries",2,w),this.wa=Mn("forwardChannelRequestTimeoutMs",2e4,w),this.pa=w&&w.xmlHttpFactory||void 0,this.Xa=w&&w.Tb||void 0,this.Ca=w&&w.useFetchStreams||!1,this.L=void 0,this.J=w&&w.supportsCrossDomainXhr||!1,this.K="",this.h=new An(w&&w.concurrentRequestLimit),this.Da=new Oi,this.P=w&&w.fastHandshake||!1,this.O=w&&w.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=w&&w.Rb||!1,w&&w.xa&&this.j.xa(),w&&w.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&w&&w.detectBufferingProxy||!1,this.ja=void 0,w&&w.longPollingTimeout&&0<w.longPollingTimeout&&(this.ja=w.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=ss.prototype,t.la=8,t.G=1,t.connect=function(w,he,we,Be){$e(0),this.W=w,this.H=he||{},we&&Be!==void 0&&(this.H.OSID=we,this.H.OAID=Be),this.F=this.X,this.I=fi(this,null,this.W),Gn(this)};function oi(w){if(as(w),w.G==3){var he=w.U++,we=qr(w.I);if(Fr(we,"SID",w.K),Fr(we,"RID",he),Fr(we,"TYPE","terminate"),qn(w,we),he=new kt(w,w.j,he),he.L=2,he.v=yn(qr(we)),we=!1,o.navigator&&o.navigator.sendBeacon)try{we=o.navigator.sendBeacon(he.v.toString(),"")}catch(Be){}!we&&o.Image&&(new Image().src=he.v,we=!0),we||(he.g=ls(he.j,null),he.g.ea(he.v)),he.F=Date.now(),br(he)}os(w)}function li(w){w.g&&(ui(w),w.g.cancel(),w.g=null)}function as(w){li(w),w.u&&(o.clearTimeout(w.u),w.u=null),di(w),w.h.cancel(),w.s&&(typeof w.s=="number"&&o.clearTimeout(w.s),w.s=null)}function Gn(w){if(!dn(w.h)&&!w.s){w.s=!0;var he=w.Ga;se||ae(),Fe||(se(),Fe=!0),ue.add(he,w),w.B=0}}function Ms(w,he){return vn(w.h)>=w.h.j-(w.s?1:0)?!1:w.s?(w.i=he.D.concat(w.i),!0):w.G==1||w.G==2||w.B>=(w.Va?0:w.Wa)?!1:(w.s=$t(m(w.Ga,w,he),ji(w,w.B)),w.B++,!0)}t.Ga=function(w){if(this.s)if(this.s=null,this.G==1){if(!w){this.U=Math.floor(1e5*Math.random()),w=this.U++;const Ft=new kt(this,this.j,w);let rr=this.o;if(this.S&&(rr?(rr=M(rr),O(rr,this.S)):rr=this.S),this.m!==null||this.O||(Ft.H=rr,rr=null),this.P)e:{for(var he=0,we=0;we<this.i.length;we++){t:{var Be=this.i[we];if("__data__"in Be.map&&(Be=Be.map.__data__,typeof Be=="string")){Be=Be.length;break t}Be=void 0}if(Be===void 0)break;if(he+=Be,4096<he){he=we;break e}if(he===4096||we===this.i.length-1){he=we+1;break e}}he=1e3}else he=1e3;he=Bi(this,Ft,he),we=qr(this.I),Fr(we,"RID",w),Fr(we,"CVER",22),this.D&&Fr(we,"X-HTTP-Session-Id",this.D),qn(this,we),rr&&(this.O?he="headers="+encodeURIComponent(String(Li(rr)))+"&"+he:this.m&&si(we,this.m,rr)),$r(this.h,Ft),this.Ua&&Fr(we,"TYPE","init"),this.P?(Fr(we,"$req",he),Fr(we,"SID","null"),Ft.T=!0,ur(Ft,we,null)):ur(Ft,we,he),this.G=2}}else this.G==3&&(w?mn(this,w):this.i.length==0||dn(this.h)||mn(this))};function mn(w,he){var we;he?we=he.l:we=w.U++;const Be=qr(w.I);Fr(Be,"SID",w.K),Fr(Be,"RID",we),Fr(Be,"AID",w.T),qn(w,Be),w.m&&w.o&&si(Be,w.m,w.o),we=new kt(w,w.j,we,w.B+1),w.m===null&&(we.H=w.o),he&&(w.i=he.D.concat(w.i)),he=Bi(w,we,1e3),we.I=Math.round(.5*w.wa)+Math.round(.5*w.wa*Math.random()),$r(w.h,we),ur(we,Be,he)}function qn(w,he){w.H&&ee(w.H,function(we,Be){Fr(he,Be,we)}),w.l&&Lr({},function(we,Be){Fr(he,Be,we)})}function Bi(w,he,we){we=Math.min(w.i.length,we);var Be=w.l?m(w.l.Na,w.l,w):null;e:{var Ft=w.i;let rr=-1;for(;;){const yr=["count="+we];rr==-1?0<we?(rr=Ft[0].g,yr.push("ofs="+rr)):rr=0:yr.push("ofs="+rr);let Wr=!0;for(let Jr=0;Jr<we;Jr++){let Nr=Ft[Jr].g;const Qr=Ft[Jr].map;if(Nr-=rr,0>Nr)rr=Math.max(0,Ft[Jr].g-100),Wr=!1;else try{Fi(Qr,yr,"req"+Nr+"_")}catch(Vr){Be&&Be(Qr)}}if(Wr){Be=yr.join("&");break e}}}return w=w.i.splice(0,we),he.D=w,Be}function kn(w){if(!w.g&&!w.u){w.Y=1;var he=w.Fa;se||ae(),Fe||(se(),Fe=!0),ue.add(he,w),w.v=0}}function ci(w){return w.g||w.u||3<=w.v?!1:(w.Y++,w.u=$t(m(w.Fa,w),ji(w,w.v)),w.v++,!0)}t.Fa=function(){if(this.u=null,hi(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var w=2*this.R;this.j.info("BP detection timer enabled: "+w),this.A=$t(m(this.ab,this),w)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,$e(10),li(this),hi(this))};function ui(w){w.A!=null&&(o.clearTimeout(w.A),w.A=null)}function hi(w){w.g=new kt(w,w.j,"rpc",w.Y),w.m===null&&(w.g.H=w.o),w.g.O=0;var he=qr(w.qa);Fr(he,"RID","rpc"),Fr(he,"SID",w.K),Fr(he,"AID",w.T),Fr(he,"CI",w.F?"0":"1"),!w.F&&w.ja&&Fr(he,"TO",w.ja),Fr(he,"TYPE","xmlhttp"),qn(w,he),w.m&&w.o&&si(he,w.m,w.o),w.L&&(w.g.I=w.L);var we=w.g;w=w.ia,we.L=1,we.v=yn(qr(he)),we.m=null,we.P=!0,fr(we,w)}t.Za=function(){this.C!=null&&(this.C=null,li(this),ci(this),$e(19))};function di(w){w.C!=null&&(o.clearTimeout(w.C),w.C=null)}function Ui(w,he){var we=null;if(w.g==he){di(w),ui(w),w.g=null;var Be=2}else if(Or(w.h,he))we=he.D,Yn(w.h,he),Be=1;else return;if(w.G!=0){if(he.o)if(Be==1){we=he.m?he.m.length:0,he=Date.now()-he.F;var Ft=w.B;Be=or(),nr(Be,new St(Be,we)),Gn(w)}else kn(w);else if(Ft=he.s,Ft==3||Ft==0&&0<he.X||!(Be==1&&Ms(w,he)||Be==2&&ci(w)))switch(we&&0<we.length&&(he=w.h,he.i=he.i.concat(we)),Ft){case 1:Nn(w,5);break;case 4:Nn(w,10);break;case 3:Nn(w,6);break;default:Nn(w,2)}}}function ji(w,he){let we=w.Ta+Math.floor(Math.random()*w.cb);return w.isActive()||(we*=2),we*he}function Nn(w,he){if(w.j.info("Error code "+he),he==2){var we=m(w.fb,w),Be=w.Xa;const Ft=!Be;Be=new xn(Be||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ri(Be,"https"),yn(Be),Ft?zr(Be.toString(),we):rs(Be.toString(),we)}else $e(2);w.G=0,w.l&&w.l.sa(he),os(w),as(w)}t.fb=function(w){w?(this.j.info("Successfully pinged google.com"),$e(2)):(this.j.info("Failed to ping google.com"),$e(1))};function os(w){if(w.G=0,w.ka=[],w.l){const he=Fn(w.h);(he.length!=0||w.i.length!=0)&&(_(w.ka,he),_(w.ka,w.i),w.h.i.length=0,p(w.i),w.i.length=0),w.l.ra()}}function fi(w,he,we){var Be=we instanceof xn?qr(we):new xn(we);if(Be.g!="")he&&(Be.g=he+"."+Be.g),Ln(Be,Be.s);else{var Ft=o.location;Be=Ft.protocol,he=he?he+"."+Ft.hostname:Ft.hostname,Ft=+Ft.port;var rr=new xn(null);Be&&ri(rr,Be),he&&(rr.g=he),Ft&&Ln(rr,Ft),we&&(rr.l=we),Be=rr}return we=w.D,he=w.ya,we&&he&&Fr(Be,we,he),Fr(Be,"VER",w.la),qn(w,Be),Be}function ls(w,he,we){if(he&&!w.J)throw Error("Can't create secondary domain capable XhrIo object.");return he=w.Ca&&!w.pa?new Yr(new bn({eb:we})):new Yr(w.pa),he.Ha(w.J),he}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Wi(){}t=Wi.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function sn(w,he){tr.call(this),this.g=new ss(he),this.l=w,this.h=he&&he.messageUrlParams||null,w=he&&he.messageHeaders||null,he&&he.clientProtocolHeaderRequired&&(w?w["X-Client-Protocol"]="webchannel":w={"X-Client-Protocol":"webchannel"}),this.g.o=w,w=he&&he.initMessageHeaders||null,he&&he.messageContentType&&(w?w["X-WebChannel-Content-Type"]=he.messageContentType:w={"X-WebChannel-Content-Type":he.messageContentType}),he&&he.va&&(w?w["X-WebChannel-Client-Profile"]=he.va:w={"X-WebChannel-Client-Profile":he.va}),this.g.S=w,(w=he&&he.Sb)&&!H(w)&&(this.g.m=w),this.v=he&&he.supportsCrossDomainXhr||!1,this.u=he&&he.sendRawJson||!1,(he=he&&he.httpSessionIdParam)&&!H(he)&&(this.g.D=he,w=this.h,w!==null&&he in w&&(w=this.h,he in w&&delete w[he])),this.j=new Xn(this)}g(sn,tr),sn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},sn.prototype.close=function(){oi(this.g)},sn.prototype.o=function(w){var he=this.g;if(typeof w=="string"){var we={};we.__data__=w,w=we}else this.u&&(we={},we.__data__=Rr(w),w=we);he.i.push(new hn(he.Ya++,w)),he.G==3&&Gn(he)},sn.prototype.N=function(){this.g.l=null,delete this.j,oi(this.g),delete this.g,sn.aa.N.call(this)};function Zn(w){ze.call(this),w.__headers__&&(this.headers=w.__headers__,this.statusCode=w.__status__,delete w.__headers__,delete w.__status__);var he=w.__sm__;if(he){e:{for(const we in he){w=we;break e}w=void 0}(this.i=w)&&(w=this.i,he=he!==null&&w in he?he[w]:void 0),this.data=he}else this.data=w}g(Zn,ze);function Pn(){zt.call(this),this.status=1}g(Pn,zt);function Xn(w){this.g=w}g(Xn,Wi),Xn.prototype.ua=function(){nr(this.g,"a")},Xn.prototype.ta=function(w){nr(this.g,new Zn(w))},Xn.prototype.sa=function(w){nr(this.g,new Pn)},Xn.prototype.ra=function(){nr(this.g,"b")},sn.prototype.send=sn.prototype.o,sn.prototype.open=sn.prototype.m,sn.prototype.close=sn.prototype.close,Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,Me.COMPLETE="complete",Tr.EventType=Te,Te.OPEN="a",Te.CLOSE="b",Te.ERROR="c",Te.MESSAGE="d",tr.prototype.listen=tr.prototype.K,Yr.prototype.listenOnce=Yr.prototype.L,Yr.prototype.getLastError=Yr.prototype.Ka,Yr.prototype.getLastErrorCode=Yr.prototype.Ba,Yr.prototype.getStatus=Yr.prototype.Z,Yr.prototype.getResponseJson=Yr.prototype.Oa,Yr.prototype.getResponseText=Yr.prototype.oa,Yr.prototype.send=Yr.prototype.ea,Yr.prototype.setWithCredentials=Yr.prototype.Ha}).apply(typeof commonjsGlobal!="undefined"?commonjsGlobal:typeof self!="undefined"?self:typeof window!="undefined"?window:{});const b="@firebase/firestore",S="4.7.9";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class User{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}User.UNAUTHENTICATED=new User(null),User.GOOGLE_CREDENTIALS=new User("google-credentials-uid"),User.FIRST_PARTY=new User("first-party-uid"),User.MOCK_USER=new User("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let D="11.4.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v=new Logger("@firebase/firestore");function __PRIVATE_logDebug(t,...e){if(v.logLevel<=LogLevel.DEBUG){const r=e.map(__PRIVATE_argToString);v.debug(`Firestore (${D}): ${t}`,...r)}}function __PRIVATE_logError(t,...e){if(v.logLevel<=LogLevel.ERROR){const r=e.map(__PRIVATE_argToString);v.error(`Firestore (${D}): ${t}`,...r)}}function __PRIVATE_argToString(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch(e){return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fail(t="Unexpected state"){const e=`FIRESTORE (${D}) INTERNAL ASSERTION FAILED: `+t;throw __PRIVATE_logError(e),new Error(e)}function __PRIVATE_hardAssert(t,e){t||fail()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C={CANCELLED:"cancelled",INVALID_ARGUMENT:"invalid-argument",FAILED_PRECONDITION:"failed-precondition"};class FirestoreError extends FirebaseError{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_Deferred{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_OAuthToken{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class __PRIVATE_EmptyAuthCredentialsProvider{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(User.UNAUTHENTICATED))}shutdown(){}}class __PRIVATE_FirebaseAuthCredentialsProvider{constructor(e){this.t=e,this.currentUser=User.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){__PRIVATE_hardAssert(this.o===void 0);let n=this.i;const i=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let s=new __PRIVATE_Deferred;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new __PRIVATE_Deferred,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const c=s;e.enqueueRetryable(()=>Ye(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},o=c=>{__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(c=>o(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?o(c):(__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new __PRIVATE_Deferred)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(__PRIVATE_hardAssert(typeof n.accessToken=="string"),new __PRIVATE_OAuthToken(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return __PRIVATE_hardAssert(e===null||typeof e=="string"),new User(e)}}class __PRIVATE_FirstPartyToken{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=User.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class __PRIVATE_FirstPartyAuthCredentialsProvider{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new __PRIVATE_FirstPartyToken(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(User.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class AppCheckToken{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class __PRIVATE_FirebaseAppCheckTokenProvider{constructor(e,r){this.A=r,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,_isFirebaseServerApp(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,r){__PRIVATE_hardAssert(this.o===void 0);const n=s=>{s.error!=null&&__PRIVATE_logDebug("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,__PRIVATE_logDebug("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{__PRIVATE_logDebug("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):__PRIVATE_logDebug("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new AppCheckToken(this.V));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(__PRIVATE_hardAssert(typeof r.token=="string"),this.R=r.token,new AppCheckToken(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function __PRIVATE_isIndexedDbTransactionError(t){return t.name==="IndexedDbTransactionError"}const rt$1="(default)";class DatabaseId{constructor(e,r){this.projectId=e,this.database=r||rt$1}static empty(){return new DatabaseId("","")}get isDefaultDatabase(){return this.database===rt$1}isEqual(e){return e instanceof DatabaseId&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Et$1,dt;(dt=Et$1||(Et$1={}))[dt.OK=0]="OK",dt[dt.CANCELLED=1]="CANCELLED",dt[dt.UNKNOWN=2]="UNKNOWN",dt[dt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",dt[dt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",dt[dt.NOT_FOUND=5]="NOT_FOUND",dt[dt.ALREADY_EXISTS=6]="ALREADY_EXISTS",dt[dt.PERMISSION_DENIED=7]="PERMISSION_DENIED",dt[dt.UNAUTHENTICATED=16]="UNAUTHENTICATED",dt[dt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",dt[dt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",dt[dt.ABORTED=10]="ABORTED",dt[dt.OUT_OF_RANGE=11]="OUT_OF_RANGE",dt[dt.UNIMPLEMENTED=12]="UNIMPLEMENTED",dt[dt.INTERNAL=13]="INTERNAL",dt[dt.UNAVAILABLE=14]="UNAVAILABLE",dt[dt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new Integer([4294967295,4294967295],0);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bt$1=41943040;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dt=1048576;function getDocument(){return typeof document!="undefined"?document:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_ExponentialBackoff{constructor(e,r,n=1e3,i=1.5,s=6e4){this.Ti=e,this.timerId=r,this.Go=n,this.zo=i,this.jo=s,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();const r=Math.floor(this.Ho+this.e_()),n=Math.max(0,Date.now()-this.Yo),i=Math.max(0,r-n);i>0&&__PRIVATE_logDebug("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ho} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,i,()=>(this.Yo=Date.now(),e())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DelayedOperation{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new __PRIVATE_Deferred,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new DelayedOperation(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new FirestoreError(C.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}var jt,Ht;(Ht=jt||(jt={}))._a="default",Ht.Cache="cache";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_cloneLongPollingOptions(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zt=new Map;function __PRIVATE_validateIsNotUsedTogether(t,e,r,n){if(e===!0&&n===!0)throw new FirestoreError(C.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xt$1="firestore.googleapis.com",en=!0;class FirestoreSettingsImpl{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new FirestoreError(C.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Xt$1,this.ssl=en}else this.host=e.host,this.ssl=(r=e.ssl)!==null&&r!==void 0?r:en;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=bt$1;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Dt)throw new FirestoreError(C.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}__PRIVATE_validateIsNotUsedTogether("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=__PRIVATE_cloneLongPollingOptions((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new FirestoreError(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new FirestoreError(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new FirestoreError(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Firestore$1{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new FirestoreSettingsImpl({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new FirestoreError(C.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new FirestoreError(C.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new FirestoreSettingsImpl(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new __PRIVATE_EmptyAuthCredentialsProvider;switch(n.type){case"firstParty":return new __PRIVATE_FirstPartyAuthCredentialsProvider(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new FirestoreError(C.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return Ye(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=Zt.get(r);n&&(__PRIVATE_logDebug("ComponentProvider","Removing Datastore"),Zt.delete(r),n.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tn="AsyncQueue";class __PRIVATE_AsyncQueueImpl{constructor(e=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new __PRIVATE_ExponentialBackoff(this,"async_queue_retry"),this.bu=()=>{const n=getDocument();n&&__PRIVATE_logDebug(tn,"Visibility state changed to "+n.visibilityState),this.a_.t_()},this.Su=e;const r=getDocument();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.bu)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;const r=getDocument();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.bu)}}enqueue(e){if(this.Du(),this.mu)return new Promise(()=>{});const r=new __PRIVATE_Deferred;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Vu.push(e),this.Cu()))}Cu(){return Ye(this,null,function*(){if(this.Vu.length!==0){try{yield this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!__PRIVATE_isIndexedDbTransactionError(e))throw e;__PRIVATE_logDebug(tn,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}})}vu(e){const r=this.Su.then(()=>(this.pu=!0,e().catch(n=>{this.gu=n,this.pu=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw __PRIVATE_logError("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.pu=!1,n))));return this.Su=r,r}enqueueAfterDelay(e,r,n){this.Du(),this.wu.indexOf(e)>-1&&(r=0);const i=DelayedOperation.createAndSchedule(this,e,r,n,s=>this.Fu(s));return this.fu.push(i),i}Du(){this.gu&&fail()}verifyOperationInProgress(){}Mu(){return Ye(this,null,function*(){let e;do e=this.Su,yield e;while(e!==this.Su)})}xu(e){for(const r of this.fu)if(r.timerId===e)return!0;return!1}Ou(e){return this.Mu().then(()=>{this.fu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.fu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Mu()})}Nu(e){this.wu.push(e)}Fu(e){const r=this.fu.indexOf(e);this.fu.splice(r,1)}}class Firestore extends Firestore$1{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new __PRIVATE_AsyncQueueImpl,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return Ye(this,null,function*(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new __PRIVATE_AsyncQueueImpl(e),this._firestoreClient=void 0,yield e}})}}(function(e,r=!0){(function(i){D=i})(SDK_VERSION$1),_registerComponent(new Component("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new Firestore(new __PRIVATE_FirebaseAuthCredentialsProvider(n.getProvider("auth-internal")),new __PRIVATE_FirebaseAppCheckTokenProvider(a,n.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new FirestoreError(C.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new DatabaseId(u.options.projectId,h)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),registerVersion(b,S,e),registerVersion(b,S,"esm2017")})();var define_process_env_default={};const name$3="@firebase/database",version$3="1.0.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let SDK_VERSION="";function setSDKVersion(t){SDK_VERSION=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DOMStorageWrapper{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,r){r==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),stringify(r))}get(e){const r=this.domStorage_.getItem(this.prefixedName_(e));return r==null?null:jsonEval(r)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MemoryStorage{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,r){r==null?delete this.cache_[e]:this.cache_[e]=r}get(e){return contains(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const createStoragefor=function(t){try{if(typeof window!="undefined"&&typeof window[t]!="undefined"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new DOMStorageWrapper(e)}}catch(e){}return new MemoryStorage},PersistentStorage=createStoragefor("localStorage"),SessionStorage=createStoragefor("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logClient=new Logger("@firebase/database"),LUIDGenerator=function(){let t=1;return function(){return t++}}(),sha1=function(t){const e=stringToByteArray(t),r=new Sha1;r.update(e);const n=r.digest();return base64.encodeByteArray(n)},buildLogMessage_=function(...t){let e="";for(let r=0;r<t.length;r++){const n=t[r];Array.isArray(n)||n&&typeof n=="object"&&typeof n.length=="number"?e+=buildLogMessage_.apply(null,n):typeof n=="object"?e+=stringify(n):e+=n,e+=" "}return e};let logger$1=null,firstLog_=!0;const enableLogging$1=function(t,e){assert(!0,"Can't turn on custom loggers persistently."),logClient.logLevel=LogLevel.VERBOSE,logger$1=logClient.log.bind(logClient)},log=function(...t){if(firstLog_===!0&&(firstLog_=!1,logger$1===null&&SessionStorage.get("logging_enabled")===!0&&enableLogging$1()),logger$1){const e=buildLogMessage_.apply(null,t);logger$1(e)}},logWrapper=function(t){return function(...e){log(t,...e)}},error=function(...t){const e="FIREBASE INTERNAL ERROR: "+buildLogMessage_(...t);logClient.error(e)},fatal=function(...t){const e=`FIREBASE FATAL ERROR: ${buildLogMessage_(...t)}`;throw logClient.error(e),new Error(e)},warn=function(...t){const e="FIREBASE WARNING: "+buildLogMessage_(...t);logClient.warn(e)},warnIfPageIsSecure=function(){typeof window!="undefined"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&warn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},isInvalidJSONNumber=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},executeWhenDOMReady=function(t){if(document.readyState==="complete")t();else{let e=!1;const r=function(){if(!document.body){setTimeout(r,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&r()}),window.attachEvent("onload",r))}},MIN_NAME="[MIN_NAME]",MAX_NAME="[MAX_NAME]",nameCompare=function(t,e){if(t===e)return 0;if(t===MIN_NAME||e===MAX_NAME)return-1;if(e===MIN_NAME||t===MAX_NAME)return 1;{const r=tryParseInt(t),n=tryParseInt(e);return r!==null?n!==null?r-n===0?t.length-e.length:r-n:-1:n!==null?1:t<e?-1:1}},stringCompare=function(t,e){return t===e?0:t<e?-1:1},requireKey=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+stringify(e))},ObjectToUniqueKey=function(t){if(typeof t!="object"||t===null)return stringify(t);const e=[];for(const n in t)e.push(n);e.sort();let r="{";for(let n=0;n<e.length;n++)n!==0&&(r+=","),r+=stringify(e[n]),r+=":",r+=ObjectToUniqueKey(t[e[n]]);return r+="}",r},splitStringBySize=function(t,e){const r=t.length;if(r<=e)return[t];const n=[];for(let i=0;i<r;i+=e)i+e>r?n.push(t.substring(i,r)):n.push(t.substring(i,i+e));return n};function each(t,e){for(const r in t)t.hasOwnProperty(r)&&e(r,t[r])}const doubleToIEEE754String=function(t){assert(!isInvalidJSONNumber(t),"Invalid JSON number");const e=11,r=52,n=(1<<e-1)-1;let i,s,a,o,c;t===0?(s=0,a=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-n)?(o=Math.min(Math.floor(Math.log(t)/Math.LN2),n),s=o+n,a=Math.round(t*Math.pow(2,r-o)-Math.pow(2,r))):(s=0,a=Math.round(t/Math.pow(2,1-n-r))));const u=[];for(c=r;c;c-=1)u.push(a%2?1:0),a=Math.floor(a/2);for(c=e;c;c-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(i?1:0),u.reverse();const h=u.join("");let f="";for(c=0;c<64;c+=8){let m=parseInt(h.substr(c,8),2).toString(16);m.length===1&&(m="0"+m),f=f+m}return f.toLowerCase()},isChromeExtensionContentScript=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},isWindowsStoreApp=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"},INTEGER_REGEXP_=new RegExp("^-?(0*)\\d{1,10}$"),INTEGER_32_MIN=-2147483648,INTEGER_32_MAX=2147483647,tryParseInt=function(t){if(INTEGER_REGEXP_.test(t)){const e=Number(t);if(e>=INTEGER_32_MIN&&e<=INTEGER_32_MAX)return e}return null},exceptionGuard=function(t){try{t()}catch(e){setTimeout(()=>{const r=e.stack||"";throw warn("Exception was thrown by user callback.",r),e},Math.floor(0))}},beingCrawled=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},setTimeoutNonBlocking=function(t,e){const r=setTimeout(t,e);return typeof r=="number"&&typeof Deno!="undefined"&&Deno.unrefTimer?Deno.unrefTimer(r):typeof r=="object"&&r.unref&&r.unref(),r};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AppCheckTokenProvider{constructor(e,r){this.appCheckProvider=r,this.appName=e.name,_isFirebaseServerApp(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=r==null?void 0:r.getImmediate({optional:!0}),this.appCheck||r==null||r.get().then(n=>this.appCheck=n)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((r,n)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(r,n):r(null)},0)})}addTokenChangeListener(e){var r;(r=this.appCheckProvider)===null||r===void 0||r.get().then(n=>n.addTokenListener(e))}notifyForInvalidToken(){warn(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FirebaseAuthTokenProvider{constructor(e,r,n){this.appName_=e,this.firebaseOptions_=r,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(r=>r&&r.code==="auth/token-not-initialized"?(log("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(r)):new Promise((r,n)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(r,n):r(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(r=>r.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(r=>r.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',warn(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PROTOCOL_VERSION="5",VERSION_PARAM="v",TRANSPORT_SESSION_PARAM="s",REFERER_PARAM="r",FORGE_REF="f",FORGE_DOMAIN_RE=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,LAST_SESSION_PARAM="ls",APPLICATION_ID_PARAM="p",APP_CHECK_TOKEN_PARAM="ac",WEBSOCKET="websocket",LONG_POLLING="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RepoInfo{constructor(e,r,n,i,s=!1,a="",o=!1,c=!1,u=null){this.secure=r,this.namespace=n,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=a,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=c,this.emulatorOptions=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=PersistentStorage.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&PersistentStorage.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",r=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${r}`}}function repoInfoNeedsQueryParam(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function repoInfoConnectionURL(t,e,r){assert(typeof e=="string","typeof type must == string"),assert(typeof r=="object","typeof params must == object");let n;if(e===WEBSOCKET)n=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===LONG_POLLING)n=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);repoInfoNeedsQueryParam(t)&&(r.ns=t.namespace);const i=[];return each(r,(s,a)=>{i.push(s+"="+a)}),n+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StatsCollection{constructor(){this.counters_={}}incrementCounter(e,r=1){contains(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=r}get(){return deepCopy(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const collections={},reporters={};function statsManagerGetCollection(t){const e=t.toString();return collections[e]||(collections[e]=new StatsCollection),collections[e]}function statsManagerGetOrCreateReporter(t,e){const r=t.toString();return reporters[r]||(reporters[r]=e()),reporters[r]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PacketReceiver{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,r){this.closeAfterResponse=e,this.onClose=r,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,r){for(this.pendingResponses[e]=r;this.pendingResponses[this.currentResponseNum];){const n=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<n.length;++i)n[i]&&exceptionGuard(()=>{this.onMessage_(n[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FIREBASE_LONGPOLL_START_PARAM="start",FIREBASE_LONGPOLL_CLOSE_COMMAND="close",FIREBASE_LONGPOLL_COMMAND_CB_NAME="pLPCommand",FIREBASE_LONGPOLL_DATA_CB_NAME="pRTLPCB",FIREBASE_LONGPOLL_ID_PARAM="id",FIREBASE_LONGPOLL_PW_PARAM="pw",FIREBASE_LONGPOLL_SERIAL_PARAM="ser",FIREBASE_LONGPOLL_CALLBACK_ID_PARAM="cb",FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM="seg",FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET="ts",FIREBASE_LONGPOLL_DATA_PARAM="d",FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM="dframe",MAX_URL_DATA_SIZE=1870,SEG_HEADER_SIZE=30,MAX_PAYLOAD_SIZE=MAX_URL_DATA_SIZE-SEG_HEADER_SIZE,KEEPALIVE_REQUEST_INTERVAL=25e3,LP_CONNECT_TIMEOUT=3e4;class BrowserPollConnection{constructor(e,r,n,i,s,a,o){this.connId=e,this.repoInfo=r,this.applicationId=n,this.appCheckToken=i,this.authToken=s,this.transportSessionId=a,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=logWrapper(e),this.stats_=statsManagerGetCollection(r),this.urlFn=c=>(this.appCheckToken&&(c[APP_CHECK_TOKEN_PARAM]=this.appCheckToken),repoInfoConnectionURL(r,LONG_POLLING,c))}open(e,r){this.curSegmentNum=0,this.onDisconnect_=r,this.myPacketOrderer=new PacketReceiver(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(LP_CONNECT_TIMEOUT)),executeWhenDOMReady(()=>{if(this.isClosed_)return;this.scriptTagHolder=new FirebaseIFrameScriptHolder((...s)=>{const[a,o,c,u,h]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,a===FIREBASE_LONGPOLL_START_PARAM)this.id=o,this.password=c;else if(a===FIREBASE_LONGPOLL_CLOSE_COMMAND)o?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(o,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+a)},(...s)=>{const[a,o]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(a,o)},()=>{this.onClosed_()},this.urlFn);const n={};n[FIREBASE_LONGPOLL_START_PARAM]="t",n[FIREBASE_LONGPOLL_SERIAL_PARAM]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(n[FIREBASE_LONGPOLL_CALLBACK_ID_PARAM]=this.scriptTagHolder.uniqueCallbackIdentifier),n[VERSION_PARAM]=PROTOCOL_VERSION,this.transportSessionId&&(n[TRANSPORT_SESSION_PARAM]=this.transportSessionId),this.lastSessionId&&(n[LAST_SESSION_PARAM]=this.lastSessionId),this.applicationId&&(n[APPLICATION_ID_PARAM]=this.applicationId),this.appCheckToken&&(n[APP_CHECK_TOKEN_PARAM]=this.appCheckToken),typeof location!="undefined"&&location.hostname&&FORGE_DOMAIN_RE.test(location.hostname)&&(n[REFERER_PARAM]=FORGE_REF);const i=this.urlFn(n);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){BrowserPollConnection.forceAllow_=!0}static forceDisallow(){BrowserPollConnection.forceDisallow_=!0}static isAvailable(){return BrowserPollConnection.forceAllow_?!0:!BrowserPollConnection.forceDisallow_&&typeof document!="undefined"&&document.createElement!=null&&!isChromeExtensionContentScript()&&!isWindowsStoreApp()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const r=stringify(e);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const n=base64Encode(r),i=splitStringBySize(n,MAX_PAYLOAD_SIZE);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,r){this.myDisconnFrame=document.createElement("iframe");const n={};n[FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM]="t",n[FIREBASE_LONGPOLL_ID_PARAM]=e,n[FIREBASE_LONGPOLL_PW_PARAM]=r,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const r=stringify(e).length;this.bytesReceived+=r,this.stats_.incrementCounter("bytes_received",r)}}class FirebaseIFrameScriptHolder{constructor(e,r,n,i){this.onDisconnect=n,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=LUIDGenerator(),window[FIREBASE_LONGPOLL_COMMAND_CB_NAME+this.uniqueCallbackIdentifier]=e,window[FIREBASE_LONGPOLL_DATA_CB_NAME+this.uniqueCallbackIdentifier]=r,this.myIFrame=FirebaseIFrameScriptHolder.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const a="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(o){log("frame writing exception"),o.stack&&log(o.stack),log(o)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||log("No IE domain setting required")}catch(r){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,r){for(this.myID=e,this.myPW=r,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[FIREBASE_LONGPOLL_ID_PARAM]=this.myID,e[FIREBASE_LONGPOLL_PW_PARAM]=this.myPW,e[FIREBASE_LONGPOLL_SERIAL_PARAM]=this.currentSerial;let r=this.urlFn(e),n="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+SEG_HEADER_SIZE+n.length<=MAX_URL_DATA_SIZE;){const a=this.pendingSegs.shift();n=n+"&"+FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM+i+"="+a.seg+"&"+FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET+i+"="+a.ts+"&"+FIREBASE_LONGPOLL_DATA_PARAM+i+"="+a.d,i++}return r=r+n,this.addLongPollTag_(r,this.currentSerial),!0}else return!1}enqueueSegment(e,r,n){this.pendingSegs.push({seg:e,ts:r,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,r){this.outstandingRequests.add(r);const n=()=>{this.outstandingRequests.delete(r),this.newRequest_()},i=setTimeout(n,Math.floor(KEEPALIVE_REQUEST_INTERVAL)),s=()=>{clearTimeout(i),n()};this.addTag(e,s)}addTag(e,r){setTimeout(()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const i=n.readyState;(!i||i==="loaded"||i==="complete")&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),r())},n.onerror=()=>{log("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(n){}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WEBSOCKET_MAX_FRAME_SIZE=16384,WEBSOCKET_KEEPALIVE_INTERVAL=45e3;let WebSocketImpl=null;typeof MozWebSocket!="undefined"?WebSocketImpl=MozWebSocket:typeof WebSocket!="undefined"&&(WebSocketImpl=WebSocket);class WebSocketConnection{constructor(e,r,n,i,s,a,o){this.connId=e,this.applicationId=n,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=logWrapper(this.connId),this.stats_=statsManagerGetCollection(r),this.connURL=WebSocketConnection.connectionURL_(r,a,o,i,n),this.nodeAdmin=r.nodeAdmin}static connectionURL_(e,r,n,i,s){const a={};return a[VERSION_PARAM]=PROTOCOL_VERSION,typeof location!="undefined"&&location.hostname&&FORGE_DOMAIN_RE.test(location.hostname)&&(a[REFERER_PARAM]=FORGE_REF),r&&(a[TRANSPORT_SESSION_PARAM]=r),n&&(a[LAST_SESSION_PARAM]=n),i&&(a[APP_CHECK_TOKEN_PARAM]=i),s&&(a[APPLICATION_ID_PARAM]=s),repoInfoConnectionURL(e,WEBSOCKET,a)}open(e,r){this.onDisconnect=r,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,PersistentStorage.set("previous_websocket_failure",!0);try{let n;isNodeSdk(),this.mySock=new WebSocketImpl(this.connURL,[],n)}catch(n){this.log_("Error instantiating WebSocket.");const i=n.message||n.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=n=>{this.handleIncomingFrame(n)},this.mySock.onerror=n=>{this.log_("WebSocket error.  Closing connection.");const i=n.message||n.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){WebSocketConnection.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator!="undefined"&&navigator.userAgent){const r=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(r);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&WebSocketImpl!==null&&!WebSocketConnection.forceDisallow_}static previouslyFailed(){return PersistentStorage.isInMemoryStorage||PersistentStorage.get("previous_websocket_failure")===!0}markConnectionHealthy(){PersistentStorage.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const n=jsonEval(r);this.onMessage(n)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(assert(this.frames===null,"We already have a frame buffer"),e.length<=6){const r=Number(e);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const r=e.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{const n=this.extractFrameCount_(r);n!==null&&this.appendFrame_(n)}}send(e){this.resetKeepAlive();const r=stringify(e);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const n=splitStringBySize(r,WEBSOCKET_MAX_FRAME_SIZE);n.length>1&&this.sendString_(String(n.length));for(let i=0;i<n.length;i++)this.sendString_(n[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(WEBSOCKET_KEEPALIVE_INTERVAL))}sendString_(e){try{this.mySock.send(e)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}WebSocketConnection.responsesRequiredToBeHealthy=2;WebSocketConnection.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TransportManager{static get ALL_TRANSPORTS(){return[BrowserPollConnection,WebSocketConnection]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const r=WebSocketConnection&&WebSocketConnection.isAvailable();let n=r&&!WebSocketConnection.previouslyFailed();if(e.webSocketOnly&&(r||warn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[WebSocketConnection];else{const i=this.transports_=[];for(const s of TransportManager.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);TransportManager.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}TransportManager.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UPGRADE_TIMEOUT=6e4,DELAY_BEFORE_SENDING_EXTRA_REQUESTS=5e3,BYTES_SENT_HEALTHY_OVERRIDE=10*1024,BYTES_RECEIVED_HEALTHY_OVERRIDE=100*1024,MESSAGE_TYPE="t",MESSAGE_DATA="d",CONTROL_SHUTDOWN="s",CONTROL_RESET="r",CONTROL_ERROR="e",CONTROL_PONG="o",SWITCH_ACK="a",END_TRANSMISSION="n",PING="p",SERVER_HELLO="h";class Connection{constructor(e,r,n,i,s,a,o,c,u,h){this.id=e,this.repoInfo_=r,this.applicationId_=n,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=a,this.onReady_=o,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=logWrapper("c:"+this.id+":"),this.transportManager_=new TransportManager(r),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(r,n)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=setTimeoutNonBlocking(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>BYTES_RECEIVED_HEALTHY_OVERRIDE?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>BYTES_SENT_HEALTHY_OVERRIDE?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return r=>{e===this.conn_?this.onConnectionLost_(r):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return r=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(r):e===this.secondaryConn_?this.onSecondaryMessageReceived_(r):this.log_("message on old connection"))}}sendRequest(e){const r={t:"d",d:e};this.sendData_(r)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(MESSAGE_TYPE in e){const r=e[MESSAGE_TYPE];r===SWITCH_ACK?this.upgradeIfSecondaryHealthy_():r===CONTROL_RESET?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):r===CONTROL_PONG&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const r=requireKey("t",e),n=requireKey("d",e);if(r==="c")this.onSecondaryControl_(n);else if(r==="d")this.pendingDataMessages.push(n);else throw new Error("Unknown protocol layer: "+r)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:PING,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:SWITCH_ACK,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:END_TRANSMISSION,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const r=requireKey("t",e),n=requireKey("d",e);r==="c"?this.onControl_(n):r==="d"&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const r=requireKey(MESSAGE_TYPE,e);if(MESSAGE_DATA in e){const n=e[MESSAGE_DATA];if(r===SERVER_HELLO){const i=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(r===END_TRANSMISSION){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else r===CONTROL_SHUTDOWN?this.onConnectionShutdown_(n):r===CONTROL_RESET?this.onReset_(n):r===CONTROL_ERROR?error("Server Error: "+n):r===CONTROL_PONG?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):error("Unknown control packet command: "+r)}}onHandshake_(e){const r=e.ts,n=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,r),PROTOCOL_VERSION!==n&&warn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(r,n),setTimeoutNonBlocking(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(UPGRADE_TIMEOUT))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,r){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(r,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):setTimeoutNonBlocking(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(DELAY_BEFORE_SENDING_EXTRA_REQUESTS))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:PING,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(PersistentStorage.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ServerActions{put(e,r,n,i){}merge(e,r,n,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,r,n){}onDisconnectMerge(e,r,n){}onDisconnectCancel(e,r){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EventEmitter{constructor(e){this.allowedEvents_=e,this.listeners_={},assert(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...r){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let i=0;i<n.length;i++)n[i].callback.apply(n[i].context,r)}}on(e,r,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:r,context:n});const i=this.getInitialEvent(e);i&&r.apply(n,i)}off(e,r,n){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===r&&(!n||n===i[s].context)){i.splice(s,1);return}}validateEventType_(e){assert(this.allowedEvents_.find(r=>r===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OnlineMonitor extends EventEmitter{static getInstance(){return new OnlineMonitor}constructor(){super(["online"]),this.online_=!0,typeof window!="undefined"&&typeof window.addEventListener!="undefined"&&!isMobileCordova()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return assert(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MAX_PATH_DEPTH=32,MAX_PATH_LENGTH_BYTES=768;class Path{constructor(e,r){if(r===void 0){this.pieces_=e.split("/");let n=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[n]=this.pieces_[i],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=r}toString(){let e="";for(let r=this.pieceNum_;r<this.pieces_.length;r++)this.pieces_[r]!==""&&(e+="/"+this.pieces_[r]);return e||"/"}}function newEmptyPath(){return new Path("")}function pathGetFront(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function pathGetLength(t){return t.pieces_.length-t.pieceNum_}function pathPopFront(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Path(t.pieces_,e)}function pathGetBack(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function pathToUrlEncodedString(t){let e="";for(let r=t.pieceNum_;r<t.pieces_.length;r++)t.pieces_[r]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[r])));return e||"/"}function pathSlice(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function pathParent(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let r=t.pieceNum_;r<t.pieces_.length-1;r++)e.push(t.pieces_[r]);return new Path(e,0)}function pathChild(t,e){const r=[];for(let n=t.pieceNum_;n<t.pieces_.length;n++)r.push(t.pieces_[n]);if(e instanceof Path)for(let n=e.pieceNum_;n<e.pieces_.length;n++)r.push(e.pieces_[n]);else{const n=e.split("/");for(let i=0;i<n.length;i++)n[i].length>0&&r.push(n[i])}return new Path(r,0)}function pathIsEmpty(t){return t.pieceNum_>=t.pieces_.length}function newRelativePath(t,e){const r=pathGetFront(t),n=pathGetFront(e);if(r===null)return e;if(r===n)return newRelativePath(pathPopFront(t),pathPopFront(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function pathEquals(t,e){if(pathGetLength(t)!==pathGetLength(e))return!1;for(let r=t.pieceNum_,n=e.pieceNum_;r<=t.pieces_.length;r++,n++)if(t.pieces_[r]!==e.pieces_[n])return!1;return!0}function pathContains(t,e){let r=t.pieceNum_,n=e.pieceNum_;if(pathGetLength(t)>pathGetLength(e))return!1;for(;r<t.pieces_.length;){if(t.pieces_[r]!==e.pieces_[n])return!1;++r,++n}return!0}class ValidationPath{constructor(e,r){this.errorPrefix_=r,this.parts_=pathSlice(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=stringLength(this.parts_[n]);validationPathCheckValid(this)}}function validationPathPush(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=stringLength(e),validationPathCheckValid(t)}function validationPathPop(t){const e=t.parts_.pop();t.byteLength_-=stringLength(e),t.parts_.length>0&&(t.byteLength_-=1)}function validationPathCheckValid(t){if(t.byteLength_>MAX_PATH_LENGTH_BYTES)throw new Error(t.errorPrefix_+"has a key path longer than "+MAX_PATH_LENGTH_BYTES+" bytes ("+t.byteLength_+").");if(t.parts_.length>MAX_PATH_DEPTH)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+MAX_PATH_DEPTH+") or object contains a cycle "+validationPathToErrorString(t))}function validationPathToErrorString(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VisibilityMonitor extends EventEmitter{static getInstance(){return new VisibilityMonitor}constructor(){super(["visible"]);let e,r;typeof document!="undefined"&&typeof document.addEventListener!="undefined"&&(typeof document.hidden!="undefined"?(r="visibilitychange",e="hidden"):typeof document.mozHidden!="undefined"?(r="mozvisibilitychange",e="mozHidden"):typeof document.msHidden!="undefined"?(r="msvisibilitychange",e="msHidden"):typeof document.webkitHidden!="undefined"&&(r="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,r&&document.addEventListener(r,()=>{const n=!document[e];n!==this.visible_&&(this.visible_=n,this.trigger("visible",n))},!1)}getInitialEvent(e){return assert(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RECONNECT_MIN_DELAY=1e3,RECONNECT_MAX_DELAY_DEFAULT=60*5*1e3,RECONNECT_MAX_DELAY_FOR_ADMINS=30*1e3,RECONNECT_DELAY_MULTIPLIER=1.3,RECONNECT_DELAY_RESET_TIMEOUT=3e4,SERVER_KILL_INTERRUPT_REASON="server_kill",INVALID_TOKEN_THRESHOLD=3;class PersistentConnection extends ServerActions{constructor(e,r,n,i,s,a,o,c){if(super(),this.repoInfo_=e,this.applicationId_=r,this.onDataUpdate_=n,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=a,this.appCheckTokenProvider_=o,this.authOverride_=c,this.id=PersistentConnection.nextPersistentConnectionId_++,this.log_=logWrapper("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=RECONNECT_MIN_DELAY,this.maxReconnectDelay_=RECONNECT_MAX_DELAY_DEFAULT,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");VisibilityMonitor.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&OnlineMonitor.getInstance().on("online",this.onOnline_,this)}sendRequest(e,r,n){const i=++this.requestNumber_,s={r:i,a:e,b:r};this.log_(stringify(s)),assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),n&&(this.requestCBHash_[i]=n)}get(e){this.initConnection_();const r=new Deferred,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:a=>{const o=a.d;a.s==="ok"?r.resolve(o):r.reject(o)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),r.promise}listen(e,r,n,i){this.initConnection_();const s=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+s),this.listens.has(a)||this.listens.set(a,new Map),assert(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),assert(!this.listens.get(a).has(s),"listen() called twice for same path/queryId.");const o={onComplete:i,hashFn:r,query:e,tag:n};this.listens.get(a).set(s,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const r=this.outstandingGets_[e];this.sendRequest("g",r.request,n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(n)})}sendListen_(e){const r=e.query,n=r._path.toString(),i=r._queryIdentifier;this.log_("Listen on "+n+" for "+i);const s={p:n},a="q";e.tag&&(s.q=r._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(a,s,o=>{const c=o.d,u=o.s;PersistentConnection.warnOnListenWarnings_(c,r),(this.listens.get(n)&&this.listens.get(n).get(i))===e&&(this.log_("listen response",o),u!=="ok"&&this.removeListen_(n,i),e.onComplete&&e.onComplete(u,c))})}static warnOnListenWarnings_(e,r){if(e&&typeof e=="object"&&contains(e,"w")){const n=safeGet(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const i='".indexOn": "'+r._queryParams.getIndex().toString()+'"',s=r._path.toString();warn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||isAdmin(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=RECONNECT_MAX_DELAY_FOR_ADMINS)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,r=isValidFormat(e)?"auth":"gauth",n={cred:e};this.authOverride_===null?n.noauth=!0:typeof this.authOverride_=="object"&&(n.authvar=this.authOverride_),this.sendRequest(r,n,i=>{const s=i.s,a=i.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const r=e.s,n=e.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,n)})}unlisten(e,r){const n=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+i),assert(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,i)&&this.connected_&&this.sendUnlisten_(n,i,e._queryObject,r)}sendUnlisten_(e,r,n,i){this.log_("Unlisten on "+e+" for "+r);const s={p:e},a="n";i&&(s.q=n,s.t=i),this.sendRequest(a,s)}onDisconnectPut(e,r,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,r,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:r,onComplete:n})}onDisconnectMerge(e,r,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,r,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:r,onComplete:n})}onDisconnectCancel(e,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(e,r,n,i){const s={p:r,d:n};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,a=>{i&&setTimeout(()=>{i(a.s,a.d)},Math.floor(0))})}put(e,r,n,i){this.putInternal("p",e,r,n,i)}merge(e,r,n,i){this.putInternal("m",e,r,n,i)}putInternal(e,r,n,i,s){this.initConnection_();const a={p:r,d:n};s!==void 0&&(a.h=s),this.outstandingPuts_.push({action:e,request:a,onComplete:i}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+r)}sendPut_(e){const r=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(r,n,s=>{this.log_(r+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(e){if(this.connected_){const r={c:e};this.log_("reportStats",r),this.sendRequest("s",r,n=>{if(n.s!=="ok"){const s=n.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+stringify(e));const r=e.r,n=this.requestCBHash_[r];n&&(delete this.requestCBHash_[r],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,r){this.log_("handleServerMessage",e,r),e==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):e==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):e==="c"?this.onListenRevoked_(r.p,r.q):e==="ac"?this.onAuthRevoked_(r.s,r.d):e==="apc"?this.onAppCheckRevoked_(r.s,r.d):e==="sd"?this.onSecurityDebugPacket_(r):error("Unrecognized action received from server: "+stringify(e)+`
Are you using the latest client?`)}onReady_(e,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>RECONNECT_DELAY_RESET_TIMEOUT&&(this.reconnectDelay_=RECONNECT_MIN_DELAY),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let r=Math.max(0,this.reconnectDelay_-e);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*RECONNECT_DELAY_MULTIPLIER)}this.onConnectStatus_(!1)}establishConnection_(){return Ye(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+PersistentConnection.nextConnectionId_++,s=this.lastSessionId;let a=!1,o=null;const c=function(){o?o.close():(a=!0,n())},u=function(f){assert(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(f)};this.realtime_={close:c,sendRequest:u};const h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[f,m]=yield Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);a?log("getToken() completed but was canceled"):(log("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=m&&m.token,o=new Connection(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,r,n,E=>{warn(E+" ("+this.repoInfo_.toString()+")"),this.interrupt(SERVER_KILL_INTERRUPT_REASON)},s))}catch(f){this.log_("Failed to get token: "+f),a||(this.repoInfo_.nodeAdmin&&warn(f),c())}}})}interrupt(e){log("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){log("Resuming connection for reason: "+e),delete this.interruptReasons_[e],isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const r=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const r=this.outstandingPuts_[e];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,r){let n;r?n=r.map(s=>ObjectToUniqueKey(s)).join("$"):n="default";const i=this.removeListen_(e,n);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,r){const n=new Path(e).toString();let i;if(this.listens.has(n)){const s=this.listens.get(n);i=s.get(r),s.delete(r),s.size===0&&this.listens.delete(n)}else i=void 0;return i}onAuthRevoked_(e,r){log("Auth token revoked: "+e+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=INVALID_TOKEN_THRESHOLD&&(this.reconnectDelay_=RECONNECT_MAX_DELAY_FOR_ADMINS,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,r){log("App check token revoked: "+e+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=INVALID_TOKEN_THRESHOLD&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const r of e.values())this.sendListen_(r);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let r="js";e["sdk."+r+"."+SDK_VERSION.replace(/\./g,"-")]=1,isMobileCordova()?e["framework.cordova"]=1:isReactNative()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=OnlineMonitor.getInstance().currentlyOnline();return isEmpty(this.interruptReasons_)&&e}}PersistentConnection.nextPersistentConnectionId_=0;PersistentConnection.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NamedNode{constructor(e,r){this.name=e,this.node=r}static Wrap(e,r){return new NamedNode(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Index{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,r){const n=new NamedNode(MIN_NAME,e),i=new NamedNode(MIN_NAME,r);return this.compare(n,i)!==0}minPost(){return NamedNode.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __EMPTY_NODE;class KeyIndex extends Index{static get __EMPTY_NODE(){return __EMPTY_NODE}static set __EMPTY_NODE(e){__EMPTY_NODE=e}compare(e,r){return nameCompare(e.name,r.name)}isDefinedOn(e){throw assertionError("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,r){return!1}minPost(){return NamedNode.MIN}maxPost(){return new NamedNode(MAX_NAME,__EMPTY_NODE)}makePost(e,r){return assert(typeof e=="string","KeyIndex indexValue must always be a string."),new NamedNode(e,__EMPTY_NODE)}toString(){return".key"}}const KEY_INDEX=new KeyIndex;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SortedMapIterator{constructor(e,r,n,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let a=1;for(;!e.isEmpty();)if(e=e,a=r?n(e.key,r):1,i&&(a*=-1),a<0)this.isReverse_?e=e.left:e=e.right;else if(a===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),r;if(this.resultGenerator_?r=this.resultGenerator_(e.key,e.value):r={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return r}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class LLRBNode{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n!=null?n:LLRBNode.RED,this.left=i!=null?i:SortedMap.EMPTY_NODE,this.right=s!=null?s:SortedMap.EMPTY_NODE}copy(e,r,n,i,s){return new LLRBNode(e!=null?e:this.key,r!=null?r:this.value,n!=null?n:this.color,i!=null?i:this.left,s!=null?s:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i=i.copy(null,r,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return SortedMap.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,r){let n,i;if(n=this,r(e,n.key)<0)!n.left.isEmpty()&&!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,r),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),!n.right.isEmpty()&&!n.right.isRed_()&&!n.right.left.isRed_()&&(n=n.moveRedRight_()),r(e,n.key)===0){if(n.right.isEmpty())return SortedMap.EMPTY_NODE;i=n.right.min_(),n=n.copy(i.key,i.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,r))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,LLRBNode.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,LLRBNode.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}LLRBNode.RED=!0;LLRBNode.BLACK=!1;class LLRBEmptyNode{copy(e,r,n,i,s){return this}insert(e,r,n){return new LLRBNode(e,r,null)}remove(e,r){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class SortedMap{constructor(e,r=SortedMap.EMPTY_NODE){this.comparator_=e,this.root_=r}insert(e,r){return new SortedMap(this.comparator_,this.root_.insert(e,r,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))}remove(e){return new SortedMap(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))}get(e){let r,n=this.root_;for(;!n.isEmpty();){if(r=this.comparator_(e,n.key),r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}getPredecessorKey(e){let r,n=this.root_,i=null;for(;!n.isEmpty();)if(r=this.comparator_(e,n.key),r===0){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}else r<0?n=n.left:r>0&&(i=n,n=n.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new SortedMapIterator(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,r){return new SortedMapIterator(this.root_,e,this.comparator_,!1,r)}getReverseIteratorFrom(e,r){return new SortedMapIterator(this.root_,e,this.comparator_,!0,r)}getReverseIterator(e){return new SortedMapIterator(this.root_,null,this.comparator_,!0,e)}}SortedMap.EMPTY_NODE=new LLRBEmptyNode;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NAME_ONLY_COMPARATOR(t,e){return nameCompare(t.name,e.name)}function NAME_COMPARATOR(t,e){return nameCompare(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let MAX_NODE$2;function setMaxNode$1(t){MAX_NODE$2=t}const priorityHashText=function(t){return typeof t=="number"?"number:"+doubleToIEEE754String(t):"string:"+t},validatePriorityNode=function(t){if(t.isLeafNode()){const e=t.val();assert(typeof e=="string"||typeof e=="number"||typeof e=="object"&&contains(e,".sv"),"Priority must be a string or number.")}else assert(t===MAX_NODE$2||t.isEmpty(),"priority of unexpected type.");assert(t===MAX_NODE$2||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __childrenNodeConstructor;class LeafNode{static set __childrenNodeConstructor(e){__childrenNodeConstructor=e}static get __childrenNodeConstructor(){return __childrenNodeConstructor}constructor(e,r=LeafNode.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=r,this.lazyHash_=null,assert(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),validatePriorityNode(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new LeafNode(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:LeafNode.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return pathIsEmpty(e)?this:pathGetFront(e)===".priority"?this.priorityNode_:LeafNode.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,r){return null}updateImmediateChild(e,r){return e===".priority"?this.updatePriority(r):r.isEmpty()&&e!==".priority"?this:LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,r).updatePriority(this.priorityNode_)}updateChild(e,r){const n=pathGetFront(e);return n===null?r:r.isEmpty()&&n!==".priority"?this:(assert(n!==".priority"||pathGetLength(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(n,LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateChild(pathPopFront(e),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,r){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+priorityHashText(this.priorityNode_.val())+":");const r=typeof this.value_;e+=r+":",r==="number"?e+=doubleToIEEE754String(this.value_):e+=this.value_,this.lazyHash_=sha1(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===LeafNode.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof LeafNode.__childrenNodeConstructor?-1:(assert(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const r=typeof e.value_,n=typeof this.value_,i=LeafNode.VALUE_TYPE_ORDER.indexOf(r),s=LeafNode.VALUE_TYPE_ORDER.indexOf(n);return assert(i>=0,"Unknown leaf type: "+r),assert(s>=0,"Unknown leaf type: "+n),i===s?n==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const r=e;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}LeafNode.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nodeFromJSON$1,MAX_NODE$1;function setNodeFromJSON(t){nodeFromJSON$1=t}function setMaxNode(t){MAX_NODE$1=t}class PriorityIndex extends Index{compare(e,r){const n=e.node.getPriority(),i=r.node.getPriority(),s=n.compareTo(i);return s===0?nameCompare(e.name,r.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,r){return!e.getPriority().equals(r.getPriority())}minPost(){return NamedNode.MIN}maxPost(){return new NamedNode(MAX_NAME,new LeafNode("[PRIORITY-POST]",MAX_NODE$1))}makePost(e,r){const n=nodeFromJSON$1(e);return new NamedNode(r,new LeafNode("[PRIORITY-POST]",n))}toString(){return".priority"}}const PRIORITY_INDEX=new PriorityIndex;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LOG_2=Math.log(2);class Base12Num{constructor(e){const r=s=>parseInt(Math.log(s)/LOG_2,10),n=s=>parseInt(Array(s+1).join("1"),2);this.count=r(e+1),this.current_=this.count-1;const i=n(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const buildChildSet=function(t,e,r,n){t.sort(e);const i=function(c,u){const h=u-c;let f,m;if(h===0)return null;if(h===1)return f=t[c],m=r?r(f):f,new LLRBNode(m,f.node,LLRBNode.BLACK,null,null);{const E=parseInt(h/2,10)+c,g=i(c,E),p=i(E+1,u);return f=t[E],m=r?r(f):f,new LLRBNode(m,f.node,LLRBNode.BLACK,g,p)}},s=function(c){let u=null,h=null,f=t.length;const m=function(g,p){const _=f-g,A=f;f-=g;const H=i(_+1,A),te=t[_],ne=r?r(te):te;E(new LLRBNode(ne,te.node,p,null,H))},E=function(g){u?(u.left=g,u=g):(h=g,u=g)};for(let g=0;g<c.count;++g){const p=c.nextBitIsOne(),_=Math.pow(2,c.count-(g+1));p?m(_,LLRBNode.BLACK):(m(_,LLRBNode.BLACK),m(_,LLRBNode.RED))}return h},a=new Base12Num(t.length),o=s(a);return new SortedMap(n||e,o)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _defaultIndexMap;const fallbackObject={};class IndexMap{static get Default(){return assert(fallbackObject&&PRIORITY_INDEX,"ChildrenNode.ts has not been loaded"),_defaultIndexMap=_defaultIndexMap||new IndexMap({".priority":fallbackObject},{".priority":PRIORITY_INDEX}),_defaultIndexMap}constructor(e,r){this.indexes_=e,this.indexSet_=r}get(e){const r=safeGet(this.indexes_,e);if(!r)throw new Error("No index defined for "+e);return r instanceof SortedMap?r:null}hasIndex(e){return contains(this.indexSet_,e.toString())}addIndex(e,r){assert(e!==KEY_INDEX,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let i=!1;const s=r.getIterator(NamedNode.Wrap);let a=s.getNext();for(;a;)i=i||e.isDefinedOn(a.node),n.push(a),a=s.getNext();let o;i?o=buildChildSet(n,e.getCompare()):o=fallbackObject;const c=e.toString(),u=Object.assign({},this.indexSet_);u[c]=e;const h=Object.assign({},this.indexes_);return h[c]=o,new IndexMap(h,u)}addToIndexes(e,r){const n=map(this.indexes_,(i,s)=>{const a=safeGet(this.indexSet_,s);if(assert(a,"Missing index implementation for "+s),i===fallbackObject)if(a.isDefinedOn(e.node)){const o=[],c=r.getIterator(NamedNode.Wrap);let u=c.getNext();for(;u;)u.name!==e.name&&o.push(u),u=c.getNext();return o.push(e),buildChildSet(o,a.getCompare())}else return fallbackObject;else{const o=r.get(e.name);let c=i;return o&&(c=c.remove(new NamedNode(e.name,o))),c.insert(e,e.node)}});return new IndexMap(n,this.indexSet_)}removeFromIndexes(e,r){const n=map(this.indexes_,i=>{if(i===fallbackObject)return i;{const s=r.get(e.name);return s?i.remove(new NamedNode(e.name,s)):i}});return new IndexMap(n,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let EMPTY_NODE;class ChildrenNode{static get EMPTY_NODE(){return EMPTY_NODE||(EMPTY_NODE=new ChildrenNode(new SortedMap(NAME_COMPARATOR),null,IndexMap.Default))}constructor(e,r,n){this.children_=e,this.priorityNode_=r,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&validatePriorityNode(this.priorityNode_),this.children_.isEmpty()&&assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||EMPTY_NODE}updatePriority(e){return this.children_.isEmpty()?this:new ChildrenNode(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const r=this.children_.get(e);return r===null?EMPTY_NODE:r}}getChild(e){const r=pathGetFront(e);return r===null?this:this.getImmediateChild(r).getChild(pathPopFront(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,r){if(assert(r,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(r);{const n=new NamedNode(e,r);let i,s;r.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(n,this.children_)):(i=this.children_.insert(e,r),s=this.indexMap_.addToIndexes(n,this.children_));const a=i.isEmpty()?EMPTY_NODE:this.priorityNode_;return new ChildrenNode(i,a,s)}}updateChild(e,r){const n=pathGetFront(e);if(n===null)return r;{assert(pathGetFront(e)!==".priority"||pathGetLength(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(n).updateChild(pathPopFront(e),r);return this.updateImmediateChild(n,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const r={};let n=0,i=0,s=!0;if(this.forEachChild(PRIORITY_INDEX,(a,o)=>{r[a]=o.val(e),n++,s&&ChildrenNode.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):s=!1}),!e&&s&&i<2*n){const a=[];for(const o in r)a[o]=r[o];return a}else return e&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+priorityHashText(this.getPriority().val())+":"),this.forEachChild(PRIORITY_INDEX,(r,n)=>{const i=n.hash();i!==""&&(e+=":"+r+":"+i)}),this.lazyHash_=e===""?"":sha1(e)}return this.lazyHash_}getPredecessorChildName(e,r,n){const i=this.resolveIndex_(n);if(i){const s=i.getPredecessorKey(new NamedNode(e,r));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const r=this.resolveIndex_(e);if(r){const n=r.minKey();return n&&n.name}else return this.children_.minKey()}getFirstChild(e){const r=this.getFirstChildName(e);return r?new NamedNode(r,this.children_.get(r)):null}getLastChildName(e){const r=this.resolveIndex_(e);if(r){const n=r.maxKey();return n&&n.name}else return this.children_.maxKey()}getLastChild(e){const r=this.getLastChildName(e);return r?new NamedNode(r,this.children_.get(r)):null}forEachChild(e,r){const n=this.resolveIndex_(e);return n?n.inorderTraversal(i=>r(i.name,i.node)):this.children_.inorderTraversal(r)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,r){const n=this.resolveIndex_(r);if(n)return n.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,NamedNode.Wrap);let s=i.peek();for(;s!=null&&r.compare(s,e)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,r){const n=this.resolveIndex_(r);if(n)return n.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,NamedNode.Wrap);let s=i.peek();for(;s!=null&&r.compare(s,e)>0;)i.getNext(),s=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===MAX_NODE?-1:0}withIndex(e){if(e===KEY_INDEX||this.indexMap_.hasIndex(e))return this;{const r=this.indexMap_.addIndex(e,this.children_);return new ChildrenNode(this.children_,this.priorityNode_,r)}}isIndexed(e){return e===KEY_INDEX||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const r=e;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){const n=this.getIterator(PRIORITY_INDEX),i=r.getIterator(PRIORITY_INDEX);let s=n.getNext(),a=i.getNext();for(;s&&a;){if(s.name!==a.name||!s.node.equals(a.node))return!1;s=n.getNext(),a=i.getNext()}return s===null&&a===null}else return!1;else return!1}}resolveIndex_(e){return e===KEY_INDEX?null:this.indexMap_.get(e.toString())}}ChildrenNode.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class MaxNode extends ChildrenNode{constructor(){super(new SortedMap(NAME_COMPARATOR),ChildrenNode.EMPTY_NODE,IndexMap.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ChildrenNode.EMPTY_NODE}isEmpty(){return!1}}const MAX_NODE=new MaxNode;Object.defineProperties(NamedNode,{MIN:{value:new NamedNode(MIN_NAME,ChildrenNode.EMPTY_NODE)},MAX:{value:new NamedNode(MAX_NAME,MAX_NODE)}});KeyIndex.__EMPTY_NODE=ChildrenNode.EMPTY_NODE;LeafNode.__childrenNodeConstructor=ChildrenNode;setMaxNode$1(MAX_NODE);setMaxNode(MAX_NODE);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const USE_HINZE=!0;function nodeFromJSON(t,e=null){if(t===null)return ChildrenNode.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),assert(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const r=t;return new LeafNode(r,nodeFromJSON(e))}if(!(t instanceof Array)&&USE_HINZE){const r=[];let n=!1;if(each(t,(a,o)=>{if(a.substring(0,1)!=="."){const c=nodeFromJSON(o);c.isEmpty()||(n=n||!c.getPriority().isEmpty(),r.push(new NamedNode(a,c)))}}),r.length===0)return ChildrenNode.EMPTY_NODE;const s=buildChildSet(r,NAME_ONLY_COMPARATOR,a=>a.name,NAME_COMPARATOR);if(n){const a=buildChildSet(r,PRIORITY_INDEX.getCompare());return new ChildrenNode(s,nodeFromJSON(e),new IndexMap({".priority":a},{".priority":PRIORITY_INDEX}))}else return new ChildrenNode(s,nodeFromJSON(e),IndexMap.Default)}else{let r=ChildrenNode.EMPTY_NODE;return each(t,(n,i)=>{if(contains(t,n)&&n.substring(0,1)!=="."){const s=nodeFromJSON(i);(s.isLeafNode()||!s.isEmpty())&&(r=r.updateImmediateChild(n,s))}}),r.updatePriority(nodeFromJSON(e))}}setNodeFromJSON(nodeFromJSON);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PathIndex extends Index{constructor(e){super(),this.indexPath_=e,assert(!pathIsEmpty(e)&&pathGetFront(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,r){const n=this.extractChild(e.node),i=this.extractChild(r.node),s=n.compareTo(i);return s===0?nameCompare(e.name,r.name):s}makePost(e,r){const n=nodeFromJSON(e),i=ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,n);return new NamedNode(r,i)}maxPost(){const e=ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,MAX_NODE);return new NamedNode(MAX_NAME,e)}toString(){return pathSlice(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ValueIndex extends Index{compare(e,r){const n=e.node.compareTo(r.node);return n===0?nameCompare(e.name,r.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,r){return!e.equals(r)}minPost(){return NamedNode.MIN}maxPost(){return NamedNode.MAX}makePost(e,r){const n=nodeFromJSON(e);return new NamedNode(r,n)}toString(){return".value"}}const VALUE_INDEX=new ValueIndex;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function changeValue(t){return{type:"value",snapshotNode:t}}function changeChildAdded(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function changeChildRemoved(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function changeChildChanged(t,e,r){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:r}}function changeChildMoved(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QueryParams{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=PRIORITY_INDEX}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:MIN_NAME}hasEnd(){return this.endSet_}getIndexEndValue(){return assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:MAX_NAME}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return assert(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===PRIORITY_INDEX}copy(){const e=new QueryParams;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function queryParamsToRestQueryStringParameters(t){const e={};if(t.isDefault())return e;let r;if(t.index_===PRIORITY_INDEX?r="$priority":t.index_===VALUE_INDEX?r="$value":t.index_===KEY_INDEX?r="$key":(assert(t.index_ instanceof PathIndex,"Unrecognized index type!"),r=t.index_.toString()),e.orderBy=stringify(r),t.startSet_){const n=t.startAfterSet_?"startAfter":"startAt";e[n]=stringify(t.indexStartValue_),t.startNameSet_&&(e[n]+=","+stringify(t.indexStartName_))}if(t.endSet_){const n=t.endBeforeSet_?"endBefore":"endAt";e[n]=stringify(t.indexEndValue_),t.endNameSet_&&(e[n]+=","+stringify(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function queryParamsGetQueryObject(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let r=t.viewFrom_;r===""&&(t.isViewFromLeft()?r="l":r="r"),e.vf=r}return t.index_!==PRIORITY_INDEX&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ReadonlyRestClient extends ServerActions{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,r){return r!==void 0?"tag$"+r:(assert(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,r,n,i){super(),this.repoInfo_=e,this.onDataUpdate_=r,this.authTokenProvider_=n,this.appCheckTokenProvider_=i,this.log_=logWrapper("p:rest:"),this.listens_={}}listen(e,r,n,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const a=ReadonlyRestClient.getListenId_(e,n),o={};this.listens_[a]=o;const c=queryParamsToRestQueryStringParameters(e._queryParams);this.restRequest_(s+".json",c,(u,h)=>{let f=h;if(u===404&&(f=null,u=null),u===null&&this.onDataUpdate_(s,f,!1,n),safeGet(this.listens_,a)===o){let m;u?u===401?m="permission_denied":m="rest_error:"+u:m="ok",i(m,null)}})}unlisten(e,r){const n=ReadonlyRestClient.getListenId_(e,r);delete this.listens_[n]}get(e){const r=queryParamsToRestQueryStringParameters(e._queryParams),n=e._path.toString(),i=new Deferred;return this.restRequest_(n+".json",r,(s,a)=>{let o=a;s===404&&(o=null,s=null),s===null?(this.onDataUpdate_(n,o,!1,null),i.resolve(o)):i.reject(new Error(o))}),i.promise}refreshAuthToken(e){}restRequest_(e,r={},n){return r.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(r.auth=i.accessToken),s&&s.token&&(r.ac=s.token);const a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+querystring(r);this.log_("Sending REST request for "+a);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(n&&o.readyState===4){this.log_("REST Response for "+a+" received. status:",o.status,"response:",o.responseText);let c=null;if(o.status>=200&&o.status<300){try{c=jsonEval(o.responseText)}catch(u){warn("Failed to parse JSON response for "+a+": "+o.responseText)}n(null,c)}else o.status!==401&&o.status!==404&&warn("Got unsuccessful REST response for "+a+" Status: "+o.status),n(o.status);n=null}},o.open("GET",a,!0),o.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SnapshotHolder{constructor(){this.rootNode_=ChildrenNode.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,r){this.rootNode_=this.rootNode_.updateChild(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function newSparseSnapshotTree(){return{value:null,children:new Map}}function sparseSnapshotTreeRemember(t,e,r){if(pathIsEmpty(e))t.value=r,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,r);else{const n=pathGetFront(e);t.children.has(n)||t.children.set(n,newSparseSnapshotTree());const i=t.children.get(n);e=pathPopFront(e),sparseSnapshotTreeRemember(i,e,r)}}function sparseSnapshotTreeForEachTree(t,e,r){t.value!==null?r(e,t.value):sparseSnapshotTreeForEachChild(t,(n,i)=>{const s=new Path(e.toString()+"/"+n);sparseSnapshotTreeForEachTree(i,s,r)})}function sparseSnapshotTreeForEachChild(t,e){t.children.forEach((r,n)=>{e(n,r)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StatsListener{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),r=Object.assign({},e);return this.last_&&each(this.last_,(n,i)=>{r[n]=r[n]-i}),this.last_=e,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FIRST_STATS_MIN_TIME=10*1e3,FIRST_STATS_MAX_TIME=30*1e3,REPORT_STATS_INTERVAL=5*60*1e3;class StatsReporter{constructor(e,r){this.server_=r,this.statsToReport_={},this.statsListener_=new StatsListener(e);const n=FIRST_STATS_MIN_TIME+(FIRST_STATS_MAX_TIME-FIRST_STATS_MIN_TIME)*Math.random();setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),r={};let n=!1;each(e,(i,s)=>{s>0&&contains(this.statsToReport_,i)&&(r[i]=s,n=!0)}),n&&this.server_.reportStats(r),setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(Math.random()*2*REPORT_STATS_INTERVAL))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var OperationType;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(OperationType||(OperationType={}));function newOperationSourceUser(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function newOperationSourceServer(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function newOperationSourceServerTaggedQuery(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AckUserWrite{constructor(e,r,n){this.path=e,this.affectedTree=r,this.revert=n,this.type=OperationType.ACK_USER_WRITE,this.source=newOperationSourceUser()}operationForChild(e){if(pathIsEmpty(this.path)){if(this.affectedTree.value!=null)return assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const r=this.affectedTree.subtree(new Path(e));return new AckUserWrite(newEmptyPath(),r,this.revert)}}else return assert(pathGetFront(this.path)===e,"operationForChild called for unrelated child."),new AckUserWrite(pathPopFront(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Overwrite{constructor(e,r,n){this.source=e,this.path=r,this.snap=n,this.type=OperationType.OVERWRITE}operationForChild(e){return pathIsEmpty(this.path)?new Overwrite(this.source,newEmptyPath(),this.snap.getImmediateChild(e)):new Overwrite(this.source,pathPopFront(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Merge{constructor(e,r,n){this.source=e,this.path=r,this.children=n,this.type=OperationType.MERGE}operationForChild(e){if(pathIsEmpty(this.path)){const r=this.children.subtree(new Path(e));return r.isEmpty()?null:r.value?new Overwrite(this.source,newEmptyPath(),r.value):new Merge(this.source,newEmptyPath(),r)}else return assert(pathGetFront(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Merge(this.source,pathPopFront(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CacheNode{constructor(e,r,n){this.node_=e,this.fullyInitialized_=r,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(pathIsEmpty(e))return this.isFullyInitialized()&&!this.filtered_;const r=pathGetFront(e);return this.isCompleteForChild(r)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}function eventGeneratorGenerateEventsForChanges(t,e,r,n){const i=[],s=[];return e.forEach(a=>{a.type==="child_changed"&&t.index_.indexedValueChanged(a.oldSnap,a.snapshotNode)&&s.push(changeChildMoved(a.childName,a.snapshotNode))}),eventGeneratorGenerateEventsForType(t,i,"child_removed",e,n,r),eventGeneratorGenerateEventsForType(t,i,"child_added",e,n,r),eventGeneratorGenerateEventsForType(t,i,"child_moved",s,n,r),eventGeneratorGenerateEventsForType(t,i,"child_changed",e,n,r),eventGeneratorGenerateEventsForType(t,i,"value",e,n,r),i}function eventGeneratorGenerateEventsForType(t,e,r,n,i,s){const a=n.filter(o=>o.type===r);a.sort((o,c)=>eventGeneratorCompareChanges(t,o,c)),a.forEach(o=>{const c=eventGeneratorMaterializeSingleChange(t,o,s);i.forEach(u=>{u.respondsTo(o.type)&&e.push(u.createEvent(c,t.query_))})})}function eventGeneratorMaterializeSingleChange(t,e,r){return e.type==="value"||e.type==="child_removed"||(e.prevName=r.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function eventGeneratorCompareChanges(t,e,r){if(e.childName==null||r.childName==null)throw assertionError("Should only compare child_ events.");const n=new NamedNode(e.childName,e.snapshotNode),i=new NamedNode(r.childName,r.snapshotNode);return t.index_.compare(n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function newViewCache(t,e){return{eventCache:t,serverCache:e}}function viewCacheUpdateEventSnap(t,e,r,n){return newViewCache(new CacheNode(e,r,n),t.serverCache)}function viewCacheUpdateServerSnap(t,e,r,n){return newViewCache(t.eventCache,new CacheNode(e,r,n))}function viewCacheGetCompleteEventSnap(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function viewCacheGetCompleteServerSnap(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let emptyChildrenSingleton;const EmptyChildren=()=>(emptyChildrenSingleton||(emptyChildrenSingleton=new SortedMap(stringCompare)),emptyChildrenSingleton);class ImmutableTree{static fromObject(e){let r=new ImmutableTree(null);return each(e,(n,i)=>{r=r.set(new Path(n),i)}),r}constructor(e,r=EmptyChildren()){this.value=e,this.children=r}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,r){if(this.value!=null&&r(this.value))return{path:newEmptyPath(),value:this.value};if(pathIsEmpty(e))return null;{const n=pathGetFront(e),i=this.children.get(n);if(i!==null){const s=i.findRootMostMatchingPathAndValue(pathPopFront(e),r);return s!=null?{path:pathChild(new Path(n),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(pathIsEmpty(e))return this;{const r=pathGetFront(e),n=this.children.get(r);return n!==null?n.subtree(pathPopFront(e)):new ImmutableTree(null)}}set(e,r){if(pathIsEmpty(e))return new ImmutableTree(r,this.children);{const n=pathGetFront(e),s=(this.children.get(n)||new ImmutableTree(null)).set(pathPopFront(e),r),a=this.children.insert(n,s);return new ImmutableTree(this.value,a)}}remove(e){if(pathIsEmpty(e))return this.children.isEmpty()?new ImmutableTree(null):new ImmutableTree(null,this.children);{const r=pathGetFront(e),n=this.children.get(r);if(n){const i=n.remove(pathPopFront(e));let s;return i.isEmpty()?s=this.children.remove(r):s=this.children.insert(r,i),this.value===null&&s.isEmpty()?new ImmutableTree(null):new ImmutableTree(this.value,s)}else return this}}get(e){if(pathIsEmpty(e))return this.value;{const r=pathGetFront(e),n=this.children.get(r);return n?n.get(pathPopFront(e)):null}}setTree(e,r){if(pathIsEmpty(e))return r;{const n=pathGetFront(e),s=(this.children.get(n)||new ImmutableTree(null)).setTree(pathPopFront(e),r);let a;return s.isEmpty()?a=this.children.remove(n):a=this.children.insert(n,s),new ImmutableTree(this.value,a)}}fold(e){return this.fold_(newEmptyPath(),e)}fold_(e,r){const n={};return this.children.inorderTraversal((i,s)=>{n[i]=s.fold_(pathChild(e,i),r)}),r(e,this.value,n)}findOnPath(e,r){return this.findOnPath_(e,newEmptyPath(),r)}findOnPath_(e,r,n){const i=this.value?n(r,this.value):!1;if(i)return i;if(pathIsEmpty(e))return null;{const s=pathGetFront(e),a=this.children.get(s);return a?a.findOnPath_(pathPopFront(e),pathChild(r,s),n):null}}foreachOnPath(e,r){return this.foreachOnPath_(e,newEmptyPath(),r)}foreachOnPath_(e,r,n){if(pathIsEmpty(e))return this;{this.value&&n(r,this.value);const i=pathGetFront(e),s=this.children.get(i);return s?s.foreachOnPath_(pathPopFront(e),pathChild(r,i),n):new ImmutableTree(null)}}foreach(e){this.foreach_(newEmptyPath(),e)}foreach_(e,r){this.children.inorderTraversal((n,i)=>{i.foreach_(pathChild(e,n),r)}),this.value&&r(e,this.value)}foreachChild(e){this.children.inorderTraversal((r,n)=>{n.value&&e(r,n.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CompoundWrite{constructor(e){this.writeTree_=e}static empty(){return new CompoundWrite(new ImmutableTree(null))}}function compoundWriteAddWrite(t,e,r){if(pathIsEmpty(e))return new CompoundWrite(new ImmutableTree(r));{const n=t.writeTree_.findRootMostValueAndPath(e);if(n!=null){const i=n.path;let s=n.value;const a=newRelativePath(i,e);return s=s.updateChild(a,r),new CompoundWrite(t.writeTree_.set(i,s))}else{const i=new ImmutableTree(r),s=t.writeTree_.setTree(e,i);return new CompoundWrite(s)}}}function compoundWriteAddWrites(t,e,r){let n=t;return each(r,(i,s)=>{n=compoundWriteAddWrite(n,pathChild(e,i),s)}),n}function compoundWriteRemoveWrite(t,e){if(pathIsEmpty(e))return CompoundWrite.empty();{const r=t.writeTree_.setTree(e,new ImmutableTree(null));return new CompoundWrite(r)}}function compoundWriteHasCompleteWrite(t,e){return compoundWriteGetCompleteNode(t,e)!=null}function compoundWriteGetCompleteNode(t,e){const r=t.writeTree_.findRootMostValueAndPath(e);return r!=null?t.writeTree_.get(r.path).getChild(newRelativePath(r.path,e)):null}function compoundWriteGetCompleteChildren(t){const e=[],r=t.writeTree_.value;return r!=null?r.isLeafNode()||r.forEachChild(PRIORITY_INDEX,(n,i)=>{e.push(new NamedNode(n,i))}):t.writeTree_.children.inorderTraversal((n,i)=>{i.value!=null&&e.push(new NamedNode(n,i.value))}),e}function compoundWriteChildCompoundWrite(t,e){if(pathIsEmpty(e))return t;{const r=compoundWriteGetCompleteNode(t,e);return r!=null?new CompoundWrite(new ImmutableTree(r)):new CompoundWrite(t.writeTree_.subtree(e))}}function compoundWriteIsEmpty(t){return t.writeTree_.isEmpty()}function compoundWriteApply(t,e){return applySubtreeWrite(newEmptyPath(),t.writeTree_,e)}function applySubtreeWrite(t,e,r){if(e.value!=null)return r.updateChild(t,e.value);{let n=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(assert(s.value!==null,"Priority writes must always be leaf nodes"),n=s.value):r=applySubtreeWrite(pathChild(t,i),s,r)}),!r.getChild(t).isEmpty()&&n!==null&&(r=r.updateChild(pathChild(t,".priority"),n)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function writeTreeChildWrites(t,e){return newWriteTreeRef(e,t)}function writeTreeAddOverwrite(t,e,r,n,i){assert(n>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:r,writeId:n,visible:i}),i&&(t.visibleWrites=compoundWriteAddWrite(t.visibleWrites,e,r)),t.lastWriteId=n}function writeTreeGetWrite(t,e){for(let r=0;r<t.allWrites.length;r++){const n=t.allWrites[r];if(n.writeId===e)return n}return null}function writeTreeRemoveWrite(t,e){const r=t.allWrites.findIndex(o=>o.writeId===e);assert(r>=0,"removeWrite called with nonexistent writeId.");const n=t.allWrites[r];t.allWrites.splice(r,1);let i=n.visible,s=!1,a=t.allWrites.length-1;for(;i&&a>=0;){const o=t.allWrites[a];o.visible&&(a>=r&&writeTreeRecordContainsPath_(o,n.path)?i=!1:pathContains(n.path,o.path)&&(s=!0)),a--}if(i){if(s)return writeTreeResetTree_(t),!0;if(n.snap)t.visibleWrites=compoundWriteRemoveWrite(t.visibleWrites,n.path);else{const o=n.children;each(o,c=>{t.visibleWrites=compoundWriteRemoveWrite(t.visibleWrites,pathChild(n.path,c))})}return!0}else return!1}function writeTreeRecordContainsPath_(t,e){if(t.snap)return pathContains(t.path,e);for(const r in t.children)if(t.children.hasOwnProperty(r)&&pathContains(pathChild(t.path,r),e))return!0;return!1}function writeTreeResetTree_(t){t.visibleWrites=writeTreeLayerTree_(t.allWrites,writeTreeDefaultFilter_,newEmptyPath()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function writeTreeDefaultFilter_(t){return t.visible}function writeTreeLayerTree_(t,e,r){let n=CompoundWrite.empty();for(let i=0;i<t.length;++i){const s=t[i];if(e(s)){const a=s.path;let o;if(s.snap)pathContains(r,a)?(o=newRelativePath(r,a),n=compoundWriteAddWrite(n,o,s.snap)):pathContains(a,r)&&(o=newRelativePath(a,r),n=compoundWriteAddWrite(n,newEmptyPath(),s.snap.getChild(o)));else if(s.children){if(pathContains(r,a))o=newRelativePath(r,a),n=compoundWriteAddWrites(n,o,s.children);else if(pathContains(a,r))if(o=newRelativePath(a,r),pathIsEmpty(o))n=compoundWriteAddWrites(n,newEmptyPath(),s.children);else{const c=safeGet(s.children,pathGetFront(o));if(c){const u=c.getChild(pathPopFront(o));n=compoundWriteAddWrite(n,newEmptyPath(),u)}}}else throw assertionError("WriteRecord should have .snap or .children")}}return n}function writeTreeCalcCompleteEventCache(t,e,r,n,i){if(!n&&!i){const s=compoundWriteGetCompleteNode(t.visibleWrites,e);if(s!=null)return s;{const a=compoundWriteChildCompoundWrite(t.visibleWrites,e);if(compoundWriteIsEmpty(a))return r;if(r==null&&!compoundWriteHasCompleteWrite(a,newEmptyPath()))return null;{const o=r||ChildrenNode.EMPTY_NODE;return compoundWriteApply(a,o)}}}else{const s=compoundWriteChildCompoundWrite(t.visibleWrites,e);if(!i&&compoundWriteIsEmpty(s))return r;if(!i&&r==null&&!compoundWriteHasCompleteWrite(s,newEmptyPath()))return null;{const a=function(u){return(u.visible||i)&&(!n||!~n.indexOf(u.writeId))&&(pathContains(u.path,e)||pathContains(e,u.path))},o=writeTreeLayerTree_(t.allWrites,a,e),c=r||ChildrenNode.EMPTY_NODE;return compoundWriteApply(o,c)}}}function writeTreeCalcCompleteEventChildren(t,e,r){let n=ChildrenNode.EMPTY_NODE;const i=compoundWriteGetCompleteNode(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(PRIORITY_INDEX,(s,a)=>{n=n.updateImmediateChild(s,a)}),n;if(r){const s=compoundWriteChildCompoundWrite(t.visibleWrites,e);return r.forEachChild(PRIORITY_INDEX,(a,o)=>{const c=compoundWriteApply(compoundWriteChildCompoundWrite(s,new Path(a)),o);n=n.updateImmediateChild(a,c)}),compoundWriteGetCompleteChildren(s).forEach(a=>{n=n.updateImmediateChild(a.name,a.node)}),n}else{const s=compoundWriteChildCompoundWrite(t.visibleWrites,e);return compoundWriteGetCompleteChildren(s).forEach(a=>{n=n.updateImmediateChild(a.name,a.node)}),n}}function writeTreeCalcEventCacheAfterServerOverwrite(t,e,r,n,i){assert(n||i,"Either existingEventSnap or existingServerSnap must exist");const s=pathChild(e,r);if(compoundWriteHasCompleteWrite(t.visibleWrites,s))return null;{const a=compoundWriteChildCompoundWrite(t.visibleWrites,s);return compoundWriteIsEmpty(a)?i.getChild(r):compoundWriteApply(a,i.getChild(r))}}function writeTreeCalcCompleteChild(t,e,r,n){const i=pathChild(e,r),s=compoundWriteGetCompleteNode(t.visibleWrites,i);if(s!=null)return s;if(n.isCompleteForChild(r)){const a=compoundWriteChildCompoundWrite(t.visibleWrites,i);return compoundWriteApply(a,n.getNode().getImmediateChild(r))}else return null}function writeTreeShadowingWrite(t,e){return compoundWriteGetCompleteNode(t.visibleWrites,e)}function writeTreeCalcIndexedSlice(t,e,r,n,i,s,a){let o;const c=compoundWriteChildCompoundWrite(t.visibleWrites,e),u=compoundWriteGetCompleteNode(c,newEmptyPath());if(u!=null)o=u;else if(r!=null)o=compoundWriteApply(c,r);else return[];if(o=o.withIndex(a),!o.isEmpty()&&!o.isLeafNode()){const h=[],f=a.getCompare(),m=s?o.getReverseIteratorFrom(n,a):o.getIteratorFrom(n,a);let E=m.getNext();for(;E&&h.length<i;)f(E,n)!==0&&h.push(E),E=m.getNext();return h}else return[]}function newWriteTree(){return{visibleWrites:CompoundWrite.empty(),allWrites:[],lastWriteId:-1}}function writeTreeRefCalcCompleteEventCache(t,e,r,n){return writeTreeCalcCompleteEventCache(t.writeTree,t.treePath,e,r,n)}function writeTreeRefCalcCompleteEventChildren(t,e){return writeTreeCalcCompleteEventChildren(t.writeTree,t.treePath,e)}function writeTreeRefCalcEventCacheAfterServerOverwrite(t,e,r,n){return writeTreeCalcEventCacheAfterServerOverwrite(t.writeTree,t.treePath,e,r,n)}function writeTreeRefShadowingWrite(t,e){return writeTreeShadowingWrite(t.writeTree,pathChild(t.treePath,e))}function writeTreeRefCalcIndexedSlice(t,e,r,n,i,s){return writeTreeCalcIndexedSlice(t.writeTree,t.treePath,e,r,n,i,s)}function writeTreeRefCalcCompleteChild(t,e,r){return writeTreeCalcCompleteChild(t.writeTree,t.treePath,e,r)}function writeTreeRefChild(t,e){return newWriteTreeRef(pathChild(t.treePath,e),t.writeTree)}function newWriteTreeRef(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ChildChangeAccumulator{constructor(){this.changeMap=new Map}trackChildChange(e){const r=e.type,n=e.childName;assert(r==="child_added"||r==="child_changed"||r==="child_removed","Only child changes supported for tracking"),assert(n!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(n);if(i){const s=i.type;if(r==="child_added"&&s==="child_removed")this.changeMap.set(n,changeChildChanged(n,e.snapshotNode,i.snapshotNode));else if(r==="child_removed"&&s==="child_added")this.changeMap.delete(n);else if(r==="child_removed"&&s==="child_changed")this.changeMap.set(n,changeChildRemoved(n,i.oldSnap));else if(r==="child_changed"&&s==="child_added")this.changeMap.set(n,changeChildAdded(n,e.snapshotNode));else if(r==="child_changed"&&s==="child_changed")this.changeMap.set(n,changeChildChanged(n,e.snapshotNode,i.oldSnap));else throw assertionError("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NoCompleteChildSource_{getCompleteChild(e){return null}getChildAfterChild(e,r,n){return null}}const NO_COMPLETE_CHILD_SOURCE=new NoCompleteChildSource_;class WriteTreeCompleteChildSource{constructor(e,r,n=null){this.writes_=e,this.viewCache_=r,this.optCompleteServerCache_=n}getCompleteChild(e){const r=this.viewCache_.eventCache;if(r.isCompleteForChild(e))return r.getNode().getImmediateChild(e);{const n=this.optCompleteServerCache_!=null?new CacheNode(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return writeTreeRefCalcCompleteChild(this.writes_,e,n)}}getChildAfterChild(e,r,n){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:viewCacheGetCompleteServerSnap(this.viewCache_),s=writeTreeRefCalcIndexedSlice(this.writes_,i,r,1,n,e);return s.length===0?null:s[0]}}function viewProcessorAssertIndexed(t,e){assert(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),assert(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function viewProcessorApplyOperation(t,e,r,n,i){const s=new ChildChangeAccumulator;let a,o;if(r.type===OperationType.OVERWRITE){const u=r;u.source.fromUser?a=viewProcessorApplyUserOverwrite(t,e,u.path,u.snap,n,i,s):(assert(u.source.fromServer,"Unknown source."),o=u.source.tagged||e.serverCache.isFiltered()&&!pathIsEmpty(u.path),a=viewProcessorApplyServerOverwrite(t,e,u.path,u.snap,n,i,o,s))}else if(r.type===OperationType.MERGE){const u=r;u.source.fromUser?a=viewProcessorApplyUserMerge(t,e,u.path,u.children,n,i,s):(assert(u.source.fromServer,"Unknown source."),o=u.source.tagged||e.serverCache.isFiltered(),a=viewProcessorApplyServerMerge(t,e,u.path,u.children,n,i,o,s))}else if(r.type===OperationType.ACK_USER_WRITE){const u=r;u.revert?a=viewProcessorRevertUserWrite(t,e,u.path,n,i,s):a=viewProcessorAckUserWrite(t,e,u.path,u.affectedTree,n,i,s)}else if(r.type===OperationType.LISTEN_COMPLETE)a=viewProcessorListenComplete(t,e,r.path,n,s);else throw assertionError("Unknown operation type: "+r.type);const c=s.getChanges();return viewProcessorMaybeAddValueEvent(e,a,c),{viewCache:a,changes:c}}function viewProcessorMaybeAddValueEvent(t,e,r){const n=e.eventCache;if(n.isFullyInitialized()){const i=n.getNode().isLeafNode()||n.getNode().isEmpty(),s=viewCacheGetCompleteEventSnap(t);(r.length>0||!t.eventCache.isFullyInitialized()||i&&!n.getNode().equals(s)||!n.getNode().getPriority().equals(s.getPriority()))&&r.push(changeValue(viewCacheGetCompleteEventSnap(e)))}}function viewProcessorGenerateEventCacheAfterServerEvent(t,e,r,n,i,s){const a=e.eventCache;if(writeTreeRefShadowingWrite(n,r)!=null)return e;{let o,c;if(pathIsEmpty(r))if(assert(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=viewCacheGetCompleteServerSnap(e),h=u instanceof ChildrenNode?u:ChildrenNode.EMPTY_NODE,f=writeTreeRefCalcCompleteEventChildren(n,h);o=t.filter.updateFullNode(e.eventCache.getNode(),f,s)}else{const u=writeTreeRefCalcCompleteEventCache(n,viewCacheGetCompleteServerSnap(e));o=t.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{const u=pathGetFront(r);if(u===".priority"){assert(pathGetLength(r)===1,"Can't have a priority with additional path components");const h=a.getNode();c=e.serverCache.getNode();const f=writeTreeRefCalcEventCacheAfterServerOverwrite(n,r,h,c);f!=null?o=t.filter.updatePriority(h,f):o=a.getNode()}else{const h=pathPopFront(r);let f;if(a.isCompleteForChild(u)){c=e.serverCache.getNode();const m=writeTreeRefCalcEventCacheAfterServerOverwrite(n,r,a.getNode(),c);m!=null?f=a.getNode().getImmediateChild(u).updateChild(h,m):f=a.getNode().getImmediateChild(u)}else f=writeTreeRefCalcCompleteChild(n,u,e.serverCache);f!=null?o=t.filter.updateChild(a.getNode(),u,f,h,i,s):o=a.getNode()}}return viewCacheUpdateEventSnap(e,o,a.isFullyInitialized()||pathIsEmpty(r),t.filter.filtersNodes())}}function viewProcessorApplyServerOverwrite(t,e,r,n,i,s,a,o){const c=e.serverCache;let u;const h=a?t.filter:t.filter.getIndexedFilter();if(pathIsEmpty(r))u=h.updateFullNode(c.getNode(),n,null);else if(h.filtersNodes()&&!c.isFiltered()){const E=c.getNode().updateChild(r,n);u=h.updateFullNode(c.getNode(),E,null)}else{const E=pathGetFront(r);if(!c.isCompleteForPath(r)&&pathGetLength(r)>1)return e;const g=pathPopFront(r),_=c.getNode().getImmediateChild(E).updateChild(g,n);E===".priority"?u=h.updatePriority(c.getNode(),_):u=h.updateChild(c.getNode(),E,_,g,NO_COMPLETE_CHILD_SOURCE,null)}const f=viewCacheUpdateServerSnap(e,u,c.isFullyInitialized()||pathIsEmpty(r),h.filtersNodes()),m=new WriteTreeCompleteChildSource(i,f,s);return viewProcessorGenerateEventCacheAfterServerEvent(t,f,r,i,m,o)}function viewProcessorApplyUserOverwrite(t,e,r,n,i,s,a){const o=e.eventCache;let c,u;const h=new WriteTreeCompleteChildSource(i,e,s);if(pathIsEmpty(r))u=t.filter.updateFullNode(e.eventCache.getNode(),n,a),c=viewCacheUpdateEventSnap(e,u,!0,t.filter.filtersNodes());else{const f=pathGetFront(r);if(f===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),n),c=viewCacheUpdateEventSnap(e,u,o.isFullyInitialized(),o.isFiltered());else{const m=pathPopFront(r),E=o.getNode().getImmediateChild(f);let g;if(pathIsEmpty(m))g=n;else{const p=h.getCompleteChild(f);p!=null?pathGetBack(m)===".priority"&&p.getChild(pathParent(m)).isEmpty()?g=p:g=p.updateChild(m,n):g=ChildrenNode.EMPTY_NODE}if(E.equals(g))c=e;else{const p=t.filter.updateChild(o.getNode(),f,g,m,h,a);c=viewCacheUpdateEventSnap(e,p,o.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function viewProcessorCacheHasChild(t,e){return t.eventCache.isCompleteForChild(e)}function viewProcessorApplyUserMerge(t,e,r,n,i,s,a){let o=e;return n.foreach((c,u)=>{const h=pathChild(r,c);viewProcessorCacheHasChild(e,pathGetFront(h))&&(o=viewProcessorApplyUserOverwrite(t,o,h,u,i,s,a))}),n.foreach((c,u)=>{const h=pathChild(r,c);viewProcessorCacheHasChild(e,pathGetFront(h))||(o=viewProcessorApplyUserOverwrite(t,o,h,u,i,s,a))}),o}function viewProcessorApplyMerge(t,e,r){return r.foreach((n,i)=>{e=e.updateChild(n,i)}),e}function viewProcessorApplyServerMerge(t,e,r,n,i,s,a,o){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;pathIsEmpty(r)?u=n:u=new ImmutableTree(null).setTree(r,n);const h=e.serverCache.getNode();return u.children.inorderTraversal((f,m)=>{if(h.hasChild(f)){const E=e.serverCache.getNode().getImmediateChild(f),g=viewProcessorApplyMerge(t,E,m);c=viewProcessorApplyServerOverwrite(t,c,new Path(f),g,i,s,a,o)}}),u.children.inorderTraversal((f,m)=>{const E=!e.serverCache.isCompleteForChild(f)&&m.value===null;if(!h.hasChild(f)&&!E){const g=e.serverCache.getNode().getImmediateChild(f),p=viewProcessorApplyMerge(t,g,m);c=viewProcessorApplyServerOverwrite(t,c,new Path(f),p,i,s,a,o)}}),c}function viewProcessorAckUserWrite(t,e,r,n,i,s,a){if(writeTreeRefShadowingWrite(i,r)!=null)return e;const o=e.serverCache.isFiltered(),c=e.serverCache;if(n.value!=null){if(pathIsEmpty(r)&&c.isFullyInitialized()||c.isCompleteForPath(r))return viewProcessorApplyServerOverwrite(t,e,r,c.getNode().getChild(r),i,s,o,a);if(pathIsEmpty(r)){let u=new ImmutableTree(null);return c.getNode().forEachChild(KEY_INDEX,(h,f)=>{u=u.set(new Path(h),f)}),viewProcessorApplyServerMerge(t,e,r,u,i,s,o,a)}else return e}else{let u=new ImmutableTree(null);return n.foreach((h,f)=>{const m=pathChild(r,h);c.isCompleteForPath(m)&&(u=u.set(h,c.getNode().getChild(m)))}),viewProcessorApplyServerMerge(t,e,r,u,i,s,o,a)}}function viewProcessorListenComplete(t,e,r,n,i){const s=e.serverCache,a=viewCacheUpdateServerSnap(e,s.getNode(),s.isFullyInitialized()||pathIsEmpty(r),s.isFiltered());return viewProcessorGenerateEventCacheAfterServerEvent(t,a,r,n,NO_COMPLETE_CHILD_SOURCE,i)}function viewProcessorRevertUserWrite(t,e,r,n,i,s){let a;if(writeTreeRefShadowingWrite(n,r)!=null)return e;{const o=new WriteTreeCompleteChildSource(n,e,i),c=e.eventCache.getNode();let u;if(pathIsEmpty(r)||pathGetFront(r)===".priority"){let h;if(e.serverCache.isFullyInitialized())h=writeTreeRefCalcCompleteEventCache(n,viewCacheGetCompleteServerSnap(e));else{const f=e.serverCache.getNode();assert(f instanceof ChildrenNode,"serverChildren would be complete if leaf node"),h=writeTreeRefCalcCompleteEventChildren(n,f)}h=h,u=t.filter.updateFullNode(c,h,s)}else{const h=pathGetFront(r);let f=writeTreeRefCalcCompleteChild(n,h,e.serverCache);f==null&&e.serverCache.isCompleteForChild(h)&&(f=c.getImmediateChild(h)),f!=null?u=t.filter.updateChild(c,h,f,pathPopFront(r),o,s):e.eventCache.getNode().hasChild(h)?u=t.filter.updateChild(c,h,ChildrenNode.EMPTY_NODE,pathPopFront(r),o,s):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(a=writeTreeRefCalcCompleteEventCache(n,viewCacheGetCompleteServerSnap(e)),a.isLeafNode()&&(u=t.filter.updateFullNode(u,a,s)))}return a=e.serverCache.isFullyInitialized()||writeTreeRefShadowingWrite(n,newEmptyPath())!=null,viewCacheUpdateEventSnap(e,u,a,t.filter.filtersNodes())}}function viewGetCompleteServerCache(t,e){const r=viewCacheGetCompleteServerSnap(t.viewCache_);return r&&(t.query._queryParams.loadsAllData()||!pathIsEmpty(e)&&!r.getImmediateChild(pathGetFront(e)).isEmpty())?r.getChild(e):null}function viewApplyOperation(t,e,r,n){e.type===OperationType.MERGE&&e.source.queryId!==null&&(assert(viewCacheGetCompleteServerSnap(t.viewCache_),"We should always have a full cache before handling merges"),assert(viewCacheGetCompleteEventSnap(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,s=viewProcessorApplyOperation(t.processor_,i,e,r,n);return viewProcessorAssertIndexed(t.processor_,s.viewCache),assert(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,viewGenerateEventsForChanges_(t,s.changes,s.viewCache.eventCache.getNode())}function viewGenerateEventsForChanges_(t,e,r,n){const i=t.eventRegistrations_;return eventGeneratorGenerateEventsForChanges(t.eventGenerator_,e,r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let referenceConstructor$1;function syncPointSetReferenceConstructor(t){assert(!referenceConstructor$1,"__referenceConstructor has already been defined"),referenceConstructor$1=t}function syncPointApplyOperation(t,e,r,n){const i=e.source.queryId;if(i!==null){const s=t.views.get(i);return assert(s!=null,"SyncTree gave us an op for an invalid query."),viewApplyOperation(s,e,r,n)}else{let s=[];for(const a of t.views.values())s=s.concat(viewApplyOperation(a,e,r,n));return s}}function syncPointGetCompleteServerCache(t,e){let r=null;for(const n of t.views.values())r=r||viewGetCompleteServerCache(n,e);return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let referenceConstructor;function syncTreeSetReferenceConstructor(t){assert(!referenceConstructor,"__referenceConstructor has already been defined"),referenceConstructor=t}class SyncTree{constructor(e){this.listenProvider_=e,this.syncPointTree_=new ImmutableTree(null),this.pendingWriteTree_=newWriteTree(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function syncTreeApplyUserOverwrite(t,e,r,n,i){return writeTreeAddOverwrite(t.pendingWriteTree_,e,r,n,i),i?syncTreeApplyOperationToSyncPoints_(t,new Overwrite(newOperationSourceUser(),e,r)):[]}function syncTreeAckUserWrite(t,e,r=!1){const n=writeTreeGetWrite(t.pendingWriteTree_,e);if(writeTreeRemoveWrite(t.pendingWriteTree_,e)){let s=new ImmutableTree(null);return n.snap!=null?s=s.set(newEmptyPath(),!0):each(n.children,a=>{s=s.set(new Path(a),!0)}),syncTreeApplyOperationToSyncPoints_(t,new AckUserWrite(n.path,s,r))}else return[]}function syncTreeApplyServerOverwrite(t,e,r){return syncTreeApplyOperationToSyncPoints_(t,new Overwrite(newOperationSourceServer(),e,r))}function syncTreeApplyServerMerge(t,e,r){const n=ImmutableTree.fromObject(r);return syncTreeApplyOperationToSyncPoints_(t,new Merge(newOperationSourceServer(),e,n))}function syncTreeApplyTaggedQueryOverwrite(t,e,r,n){const i=syncTreeQueryKeyForTag_(t,n);if(i!=null){const s=syncTreeParseQueryKey_(i),a=s.path,o=s.queryId,c=newRelativePath(a,e),u=new Overwrite(newOperationSourceServerTaggedQuery(o),c,r);return syncTreeApplyTaggedOperation_(t,a,u)}else return[]}function syncTreeApplyTaggedQueryMerge(t,e,r,n){const i=syncTreeQueryKeyForTag_(t,n);if(i){const s=syncTreeParseQueryKey_(i),a=s.path,o=s.queryId,c=newRelativePath(a,e),u=ImmutableTree.fromObject(r),h=new Merge(newOperationSourceServerTaggedQuery(o),c,u);return syncTreeApplyTaggedOperation_(t,a,h)}else return[]}function syncTreeCalcCompleteEventCache(t,e,r){const i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(a,o)=>{const c=newRelativePath(a,e),u=syncPointGetCompleteServerCache(o,c);if(u)return u});return writeTreeCalcCompleteEventCache(i,e,s,r,!0)}function syncTreeApplyOperationToSyncPoints_(t,e){return syncTreeApplyOperationHelper_(e,t.syncPointTree_,null,writeTreeChildWrites(t.pendingWriteTree_,newEmptyPath()))}function syncTreeApplyOperationHelper_(t,e,r,n){if(pathIsEmpty(t.path))return syncTreeApplyOperationDescendantsHelper_(t,e,r,n);{const i=e.get(newEmptyPath());r==null&&i!=null&&(r=syncPointGetCompleteServerCache(i,newEmptyPath()));let s=[];const a=pathGetFront(t.path),o=t.operationForChild(a),c=e.children.get(a);if(c&&o){const u=r?r.getImmediateChild(a):null,h=writeTreeRefChild(n,a);s=s.concat(syncTreeApplyOperationHelper_(o,c,u,h))}return i&&(s=s.concat(syncPointApplyOperation(i,t,n,r))),s}}function syncTreeApplyOperationDescendantsHelper_(t,e,r,n){const i=e.get(newEmptyPath());r==null&&i!=null&&(r=syncPointGetCompleteServerCache(i,newEmptyPath()));let s=[];return e.children.inorderTraversal((a,o)=>{const c=r?r.getImmediateChild(a):null,u=writeTreeRefChild(n,a),h=t.operationForChild(a);h&&(s=s.concat(syncTreeApplyOperationDescendantsHelper_(h,o,c,u)))}),i&&(s=s.concat(syncPointApplyOperation(i,t,n,r))),s}function syncTreeQueryKeyForTag_(t,e){return t.tagToQueryMap.get(e)}function syncTreeParseQueryKey_(t){const e=t.indexOf("$");return assert(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Path(t.substr(0,e))}}function syncTreeApplyTaggedOperation_(t,e,r){const n=t.syncPointTree_.get(e);assert(n,"Missing sync point for query tag that we're tracking");const i=writeTreeChildWrites(t.pendingWriteTree_,e);return syncPointApplyOperation(n,r,i,null)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ExistingValueProvider{constructor(e){this.node_=e}getImmediateChild(e){const r=this.node_.getImmediateChild(e);return new ExistingValueProvider(r)}node(){return this.node_}}class DeferredValueProvider{constructor(e,r){this.syncTree_=e,this.path_=r}getImmediateChild(e){const r=pathChild(this.path_,e);return new DeferredValueProvider(this.syncTree_,r)}node(){return syncTreeCalcCompleteEventCache(this.syncTree_,this.path_)}}const generateWithValues=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},resolveDeferredLeafValue=function(t,e,r){if(!t||typeof t!="object")return t;if(assert(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return resolveScalarDeferredValue(t[".sv"],e,r);if(typeof t[".sv"]=="object")return resolveComplexDeferredValue(t[".sv"],e);assert(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},resolveScalarDeferredValue=function(t,e,r){switch(t){case"timestamp":return r.timestamp;default:assert(!1,"Unexpected server value: "+t)}},resolveComplexDeferredValue=function(t,e,r){t.hasOwnProperty("increment")||assert(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const n=t.increment;typeof n!="number"&&assert(!1,"Unexpected increment value: "+n);const i=e.node();if(assert(i!==null&&typeof i!="undefined","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return n;const a=i.getValue();return typeof a!="number"?n:a+n},resolveDeferredValueTree=function(t,e,r,n){return resolveDeferredValue(e,new DeferredValueProvider(r,t),n)},resolveDeferredValueSnapshot=function(t,e,r){return resolveDeferredValue(t,new ExistingValueProvider(e),r)};function resolveDeferredValue(t,e,r){const n=t.getPriority().val(),i=resolveDeferredLeafValue(n,e.getImmediateChild(".priority"),r);let s;if(t.isLeafNode()){const a=t,o=resolveDeferredLeafValue(a.getValue(),e,r);return o!==a.getValue()||i!==a.getPriority().val()?new LeafNode(o,nodeFromJSON(i)):t}else{const a=t;return s=a,i!==a.getPriority().val()&&(s=s.updatePriority(new LeafNode(i))),a.forEachChild(PRIORITY_INDEX,(o,c)=>{const u=resolveDeferredValue(c,e.getImmediateChild(o),r);u!==c&&(s=s.updateImmediateChild(o,u))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tree{constructor(e="",r=null,n={children:{},childCount:0}){this.name=e,this.parent=r,this.node=n}}function treeSubTree(t,e){let r=e instanceof Path?e:new Path(e),n=t,i=pathGetFront(r);for(;i!==null;){const s=safeGet(n.node.children,i)||{children:{},childCount:0};n=new Tree(i,n,s),r=pathPopFront(r),i=pathGetFront(r)}return n}function treeGetValue(t){return t.node.value}function treeSetValue(t,e){t.node.value=e,treeUpdateParents(t)}function treeHasChildren(t){return t.node.childCount>0}function treeIsEmpty(t){return treeGetValue(t)===void 0&&!treeHasChildren(t)}function treeForEachChild(t,e){each(t.node.children,(r,n)=>{e(new Tree(r,t,n))})}function treeForEachDescendant(t,e,r,n){r&&e(t),treeForEachChild(t,i=>{treeForEachDescendant(i,e,!0)})}function treeForEachAncestor(t,e,r){let n=t.parent;for(;n!==null;){if(e(n))return!0;n=n.parent}return!1}function treeGetPath(t){return new Path(t.parent===null?t.name:treeGetPath(t.parent)+"/"+t.name)}function treeUpdateParents(t){t.parent!==null&&treeUpdateChild(t.parent,t.name,t)}function treeUpdateChild(t,e,r){const n=treeIsEmpty(r),i=contains(t.node.children,e);n&&i?(delete t.node.children[e],t.node.childCount--,treeUpdateParents(t)):!n&&!i&&(t.node.children[e]=r.node,t.node.childCount++,treeUpdateParents(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const INVALID_KEY_REGEX_=/[\[\].#$\/\u0000-\u001F\u007F]/,INVALID_PATH_REGEX_=/[\[\].#$\u0000-\u001F\u007F]/,MAX_LEAF_SIZE_=10*1024*1024,isValidKey=function(t){return typeof t=="string"&&t.length!==0&&!INVALID_KEY_REGEX_.test(t)},isValidPathString=function(t){return typeof t=="string"&&t.length!==0&&!INVALID_PATH_REGEX_.test(t)},isValidRootPathString=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),isValidPathString(t)},validateFirebaseData=function(t,e,r){const n=r instanceof Path?new ValidationPath(r,t):r;if(e===void 0)throw new Error(t+"contains undefined "+validationPathToErrorString(n));if(typeof e=="function")throw new Error(t+"contains a function "+validationPathToErrorString(n)+" with contents = "+e.toString());if(isInvalidJSONNumber(e))throw new Error(t+"contains "+e.toString()+" "+validationPathToErrorString(n));if(typeof e=="string"&&e.length>MAX_LEAF_SIZE_/3&&stringLength(e)>MAX_LEAF_SIZE_)throw new Error(t+"contains a string greater than "+MAX_LEAF_SIZE_+" utf8 bytes "+validationPathToErrorString(n)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(each(e,(a,o)=>{if(a===".value")i=!0;else if(a!==".priority"&&a!==".sv"&&(s=!0,!isValidKey(a)))throw new Error(t+" contains an invalid key ("+a+") "+validationPathToErrorString(n)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);validationPathPush(n,a),validateFirebaseData(t,o,n),validationPathPop(n)}),i&&s)throw new Error(t+' contains ".value" child '+validationPathToErrorString(n)+" in addition to actual children.")}},validateUrl=function(t,e){const r=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!isValidKey(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||r.length!==0&&!isValidRootPathString(r))throw new Error(errorPrefix(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EventQueue{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function eventQueueQueueEvents(t,e){let r=null;for(let n=0;n<e.length;n++){const i=e[n],s=i.getPath();r!==null&&!pathEquals(s,r.path)&&(t.eventLists_.push(r),r=null),r===null&&(r={events:[],path:s}),r.events.push(i)}r&&t.eventLists_.push(r)}function eventQueueRaiseEventsForChangedPath(t,e,r){eventQueueQueueEvents(t,r),eventQueueRaiseQueuedEventsMatchingPredicate(t,n=>pathContains(n,e)||pathContains(e,n))}function eventQueueRaiseQueuedEventsMatchingPredicate(t,e){t.recursionDepth_++;let r=!0;for(let n=0;n<t.eventLists_.length;n++){const i=t.eventLists_[n];if(i){const s=i.path;e(s)?(eventListRaise(t.eventLists_[n]),t.eventLists_[n]=null):r=!1}}r&&(t.eventLists_=[]),t.recursionDepth_--}function eventListRaise(t){for(let e=0;e<t.events.length;e++){const r=t.events[e];if(r!==null){t.events[e]=null;const n=r.getEventRunner();logger$1&&log("event: "+r.toString()),exceptionGuard(n)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const INTERRUPT_REASON="repo_interrupt",MAX_TRANSACTION_RETRIES=25;class Repo{constructor(e,r,n,i){this.repoInfo_=e,this.forceRestClient_=r,this.authTokenProvider_=n,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new EventQueue,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=newSparseSnapshotTree(),this.transactionQueueTree_=new Tree,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function repoStart(t,e,r){if(t.stats_=statsManagerGetCollection(t.repoInfo_),t.forceRestClient_||beingCrawled())t.server_=new ReadonlyRestClient(t.repoInfo_,(n,i,s,a)=>{repoOnDataUpdate(t,n,i,s,a)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>repoOnConnectStatus(t,!0),0);else{if(typeof r!="undefined"&&r!==null){if(typeof r!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{stringify(r)}catch(n){throw new Error("Invalid authOverride provided: "+n)}}t.persistentConnection_=new PersistentConnection(t.repoInfo_,e,(n,i,s,a)=>{repoOnDataUpdate(t,n,i,s,a)},n=>{repoOnConnectStatus(t,n)},n=>{repoOnServerInfoUpdate(t,n)},t.authTokenProvider_,t.appCheckProvider_,r),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(n=>{t.server_.refreshAuthToken(n)}),t.appCheckProvider_.addTokenChangeListener(n=>{t.server_.refreshAppCheckToken(n.token)}),t.statsReporter_=statsManagerGetOrCreateReporter(t.repoInfo_,()=>new StatsReporter(t.stats_,t.server_)),t.infoData_=new SnapshotHolder,t.infoSyncTree_=new SyncTree({startListening:(n,i,s,a)=>{let o=[];const c=t.infoData_.getNode(n._path);return c.isEmpty()||(o=syncTreeApplyServerOverwrite(t.infoSyncTree_,n._path,c),setTimeout(()=>{a("ok")},0)),o},stopListening:()=>{}}),repoUpdateInfo(t,"connected",!1),t.serverSyncTree_=new SyncTree({startListening:(n,i,s,a)=>(t.server_.listen(n,s,i,(o,c)=>{const u=a(o,c);eventQueueRaiseEventsForChangedPath(t.eventQueue_,n._path,u)}),[]),stopListening:(n,i)=>{t.server_.unlisten(n,i)}})}function repoServerTime(t){const r=t.infoData_.getNode(new Path(".info/serverTimeOffset")).val()||0;return new Date().getTime()+r}function repoGenerateServerValues(t){return generateWithValues({timestamp:repoServerTime(t)})}function repoOnDataUpdate(t,e,r,n,i){t.dataUpdateCount++;const s=new Path(e);r=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,r):r;let a=[];if(i)if(n){const c=map(r,u=>nodeFromJSON(u));a=syncTreeApplyTaggedQueryMerge(t.serverSyncTree_,s,c,i)}else{const c=nodeFromJSON(r);a=syncTreeApplyTaggedQueryOverwrite(t.serverSyncTree_,s,c,i)}else if(n){const c=map(r,u=>nodeFromJSON(u));a=syncTreeApplyServerMerge(t.serverSyncTree_,s,c)}else{const c=nodeFromJSON(r);a=syncTreeApplyServerOverwrite(t.serverSyncTree_,s,c)}let o=s;a.length>0&&(o=repoRerunTransactions(t,s)),eventQueueRaiseEventsForChangedPath(t.eventQueue_,o,a)}function repoOnConnectStatus(t,e){repoUpdateInfo(t,"connected",e),e===!1&&repoRunOnDisconnectEvents(t)}function repoOnServerInfoUpdate(t,e){each(e,(r,n)=>{repoUpdateInfo(t,r,n)})}function repoUpdateInfo(t,e,r){const n=new Path("/.info/"+e),i=nodeFromJSON(r);t.infoData_.updateSnapshot(n,i);const s=syncTreeApplyServerOverwrite(t.infoSyncTree_,n,i);eventQueueRaiseEventsForChangedPath(t.eventQueue_,n,s)}function repoGetNextWriteId(t){return t.nextWriteId_++}function repoRunOnDisconnectEvents(t){repoLog(t,"onDisconnectEvents");const e=repoGenerateServerValues(t),r=newSparseSnapshotTree();sparseSnapshotTreeForEachTree(t.onDisconnect_,newEmptyPath(),(i,s)=>{const a=resolveDeferredValueTree(i,s,t.serverSyncTree_,e);sparseSnapshotTreeRemember(r,i,a)});let n=[];sparseSnapshotTreeForEachTree(r,newEmptyPath(),(i,s)=>{n=n.concat(syncTreeApplyServerOverwrite(t.serverSyncTree_,i,s));const a=repoAbortTransactions(t,i);repoRerunTransactions(t,a)}),t.onDisconnect_=newSparseSnapshotTree(),eventQueueRaiseEventsForChangedPath(t.eventQueue_,newEmptyPath(),n)}function repoInterrupt(t){t.persistentConnection_&&t.persistentConnection_.interrupt(INTERRUPT_REASON)}function repoLog(t,...e){let r="";t.persistentConnection_&&(r=t.persistentConnection_.id+":"),log(r,...e)}function repoGetLatestState(t,e,r){return syncTreeCalcCompleteEventCache(t.serverSyncTree_,e,r)||ChildrenNode.EMPTY_NODE}function repoSendReadyTransactions(t,e=t.transactionQueueTree_){if(e||repoPruneCompletedTransactionsBelowNode(t,e),treeGetValue(e)){const r=repoBuildTransactionQueue(t,e);assert(r.length>0,"Sending zero length transaction queue"),r.every(i=>i.status===0)&&repoSendTransactionQueue(t,treeGetPath(e),r)}else treeHasChildren(e)&&treeForEachChild(e,r=>{repoSendReadyTransactions(t,r)})}function repoSendTransactionQueue(t,e,r){const n=r.map(u=>u.currentWriteId),i=repoGetLatestState(t,e,n);let s=i;const a=i.hash();for(let u=0;u<r.length;u++){const h=r[u];assert(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;const f=newRelativePath(e,h.path);s=s.updateChild(f,h.currentOutputSnapshotRaw)}const o=s.val(!0),c=e;t.server_.put(c.toString(),o,u=>{repoLog(t,"transaction put response",{path:c.toString(),status:u});let h=[];if(u==="ok"){const f=[];for(let m=0;m<r.length;m++)r[m].status=2,h=h.concat(syncTreeAckUserWrite(t.serverSyncTree_,r[m].currentWriteId)),r[m].onComplete&&f.push(()=>r[m].onComplete(null,!0,r[m].currentOutputSnapshotResolved)),r[m].unwatcher();repoPruneCompletedTransactionsBelowNode(t,treeSubTree(t.transactionQueueTree_,e)),repoSendReadyTransactions(t,t.transactionQueueTree_),eventQueueRaiseEventsForChangedPath(t.eventQueue_,e,h);for(let m=0;m<f.length;m++)exceptionGuard(f[m])}else{if(u==="datastale")for(let f=0;f<r.length;f++)r[f].status===3?r[f].status=4:r[f].status=0;else{warn("transaction at "+c.toString()+" failed: "+u);for(let f=0;f<r.length;f++)r[f].status=4,r[f].abortReason=u}repoRerunTransactions(t,e)}},a)}function repoRerunTransactions(t,e){const r=repoGetAncestorTransactionNode(t,e),n=treeGetPath(r),i=repoBuildTransactionQueue(t,r);return repoRerunTransactionQueue(t,i,n),n}function repoRerunTransactionQueue(t,e,r){if(e.length===0)return;const n=[];let i=[];const a=e.filter(o=>o.status===0).map(o=>o.currentWriteId);for(let o=0;o<e.length;o++){const c=e[o],u=newRelativePath(r,c.path);let h=!1,f;if(assert(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)h=!0,f=c.abortReason,i=i.concat(syncTreeAckUserWrite(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=MAX_TRANSACTION_RETRIES)h=!0,f="maxretry",i=i.concat(syncTreeAckUserWrite(t.serverSyncTree_,c.currentWriteId,!0));else{const m=repoGetLatestState(t,c.path,a);c.currentInputSnapshot=m;const E=e[o].update(m.val());if(E!==void 0){validateFirebaseData("transaction failed: Data returned ",E,c.path);let g=nodeFromJSON(E);typeof E=="object"&&E!=null&&contains(E,".priority")||(g=g.updatePriority(m.getPriority()));const _=c.currentWriteId,A=repoGenerateServerValues(t),H=resolveDeferredValueSnapshot(g,m,A);c.currentOutputSnapshotRaw=g,c.currentOutputSnapshotResolved=H,c.currentWriteId=repoGetNextWriteId(t),a.splice(a.indexOf(_),1),i=i.concat(syncTreeApplyUserOverwrite(t.serverSyncTree_,c.path,H,c.currentWriteId,c.applyLocally)),i=i.concat(syncTreeAckUserWrite(t.serverSyncTree_,_,!0))}else h=!0,f="nodata",i=i.concat(syncTreeAckUserWrite(t.serverSyncTree_,c.currentWriteId,!0))}eventQueueRaiseEventsForChangedPath(t.eventQueue_,r,i),i=[],h&&(e[o].status=2,function(m){setTimeout(m,Math.floor(0))}(e[o].unwatcher),e[o].onComplete&&(f==="nodata"?n.push(()=>e[o].onComplete(null,!1,e[o].currentInputSnapshot)):n.push(()=>e[o].onComplete(new Error(f),!1,null))))}repoPruneCompletedTransactionsBelowNode(t,t.transactionQueueTree_);for(let o=0;o<n.length;o++)exceptionGuard(n[o]);repoSendReadyTransactions(t,t.transactionQueueTree_)}function repoGetAncestorTransactionNode(t,e){let r,n=t.transactionQueueTree_;for(r=pathGetFront(e);r!==null&&treeGetValue(n)===void 0;)n=treeSubTree(n,r),e=pathPopFront(e),r=pathGetFront(e);return n}function repoBuildTransactionQueue(t,e){const r=[];return repoAggregateTransactionQueuesForNode(t,e,r),r.sort((n,i)=>n.order-i.order),r}function repoAggregateTransactionQueuesForNode(t,e,r){const n=treeGetValue(e);if(n)for(let i=0;i<n.length;i++)r.push(n[i]);treeForEachChild(e,i=>{repoAggregateTransactionQueuesForNode(t,i,r)})}function repoPruneCompletedTransactionsBelowNode(t,e){const r=treeGetValue(e);if(r){let n=0;for(let i=0;i<r.length;i++)r[i].status!==2&&(r[n]=r[i],n++);r.length=n,treeSetValue(e,r.length>0?r:void 0)}treeForEachChild(e,n=>{repoPruneCompletedTransactionsBelowNode(t,n)})}function repoAbortTransactions(t,e){const r=treeGetPath(repoGetAncestorTransactionNode(t,e)),n=treeSubTree(t.transactionQueueTree_,e);return treeForEachAncestor(n,i=>{repoAbortTransactionsOnNode(t,i)}),repoAbortTransactionsOnNode(t,n),treeForEachDescendant(n,i=>{repoAbortTransactionsOnNode(t,i)}),r}function repoAbortTransactionsOnNode(t,e){const r=treeGetValue(e);if(r){const n=[];let i=[],s=-1;for(let a=0;a<r.length;a++)r[a].status===3||(r[a].status===1?(assert(s===a-1,"All SENT items should be at beginning of queue."),s=a,r[a].status=3,r[a].abortReason="set"):(assert(r[a].status===0,"Unexpected transaction status in abort"),r[a].unwatcher(),i=i.concat(syncTreeAckUserWrite(t.serverSyncTree_,r[a].currentWriteId,!0)),r[a].onComplete&&n.push(r[a].onComplete.bind(null,new Error("set"),!1,null))));s===-1?treeSetValue(e,void 0):r.length=s+1,eventQueueRaiseEventsForChangedPath(t.eventQueue_,treeGetPath(e),i);for(let a=0;a<n.length;a++)exceptionGuard(n[a])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function decodePath(t){let e="";const r=t.split("/");for(let n=0;n<r.length;n++)if(r[n].length>0){let i=r[n];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(s){}e+="/"+i}return e}function decodeQuery(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const r of t.split("&")){if(r.length===0)continue;const n=r.split("=");n.length===2?e[decodeURIComponent(n[0])]=decodeURIComponent(n[1]):warn(`Invalid query segment '${r}' in query '${t}'`)}return e}const parseRepoInfo=function(t,e){const r=parseDatabaseURL(t),n=r.namespace;r.domain==="firebase.com"&&fatal(r.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!n||n==="undefined")&&r.domain!=="localhost"&&fatal("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),r.secure||warnIfPageIsSecure();const i=r.scheme==="ws"||r.scheme==="wss";return{repoInfo:new RepoInfo(r.host,r.secure,n,i,e,"",n!==r.subdomain),path:new Path(r.pathString)}},parseDatabaseURL=function(t){let e="",r="",n="",i="",s="",a=!0,o="https",c=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(o=t.substring(0,u-1),t=t.substring(u+2));let h=t.indexOf("/");h===-1&&(h=t.length);let f=t.indexOf("?");f===-1&&(f=t.length),e=t.substring(0,Math.min(h,f)),h<f&&(i=decodePath(t.substring(h,f)));const m=decodeQuery(t.substring(Math.min(t.length,f)));u=e.indexOf(":"),u>=0?(a=o==="https"||o==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;const E=e.slice(0,u);if(E.toLowerCase()==="localhost")r="localhost";else if(E.split(".").length<=2)r=E;else{const g=e.indexOf(".");n=e.substring(0,g).toLowerCase(),r=e.substring(g+1),s=n}"ns"in m&&(s=m.ns)}return{host:e,port:c,domain:r,subdomain:n,secure:a,scheme:o,pathString:i,namespace:s}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QueryImpl{constructor(e,r,n,i){this._repo=e,this._path=r,this._queryParams=n,this._orderByCalled=i}get key(){return pathIsEmpty(this._path)?null:pathGetBack(this._path)}get ref(){return new ReferenceImpl(this._repo,this._path)}get _queryIdentifier(){const e=queryParamsGetQueryObject(this._queryParams),r=ObjectToUniqueKey(e);return r==="{}"?"default":r}get _queryObject(){return queryParamsGetQueryObject(this._queryParams)}isEqual(e){if(e=getModularInstance(e),!(e instanceof QueryImpl))return!1;const r=this._repo===e._repo,n=pathEquals(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return r&&n&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+pathToUrlEncodedString(this._path)}}class ReferenceImpl extends QueryImpl{constructor(e,r){super(e,r,new QueryParams,!1)}get parent(){const e=pathParent(this._path);return e===null?null:new ReferenceImpl(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}syncPointSetReferenceConstructor(ReferenceImpl);syncTreeSetReferenceConstructor(ReferenceImpl);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FIREBASE_DATABASE_EMULATOR_HOST_VAR="FIREBASE_DATABASE_EMULATOR_HOST",repos={};let useRestClient=!1;function repoManagerDatabaseFromApp(t,e,r,n,i){let s=n||t.options.databaseURL;s===void 0&&(t.options.projectId||fatal("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),log("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let a=parseRepoInfo(s,i),o=a.repoInfo,c;typeof process!="undefined"&&define_process_env_default&&(c=define_process_env_default[FIREBASE_DATABASE_EMULATOR_HOST_VAR]),c?(s=`http://${c}?ns=${o.namespace}`,a=parseRepoInfo(s,i),o=a.repoInfo):a.repoInfo.secure;const u=new FirebaseAuthTokenProvider(t.name,t.options,e);validateUrl("Invalid Firebase Database URL",a),pathIsEmpty(a.path)||fatal("Database URL must point to the root of a Firebase Database (not including a child path).");const h=repoManagerCreateRepo(o,t,u,new AppCheckTokenProvider(t,r));return new Database(h,t)}function repoManagerDeleteRepo(t,e){const r=repos[e];(!r||r[t.key]!==t)&&fatal(`Database ${e}(${t.repoInfo_}) has already been deleted.`),repoInterrupt(t),delete r[t.key]}function repoManagerCreateRepo(t,e,r,n){let i=repos[e.name];i||(i={},repos[e.name]=i);let s=i[t.toURLString()];return s&&fatal("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Repo(t,useRestClient,r,n),i[t.toURLString()]=s,s}class Database{constructor(e,r){this._repoInternal=e,this.app=r,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(repoStart(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ReferenceImpl(this._repo,newEmptyPath())),this._rootInternal}_delete(){return this._rootInternal!==null&&(repoManagerDeleteRepo(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&fatal("Cannot call "+e+" on a deleted database.")}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerDatabase(t){setSDKVersion(SDK_VERSION$1),_registerComponent(new Component("database",(e,{instanceIdentifier:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return repoManagerDatabaseFromApp(n,i,s,r)},"PUBLIC").setMultipleInstances(!0)),registerVersion(name$3,version$3,t),registerVersion(name$3,version$3,"esm2017")}PersistentConnection.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};PersistentConnection.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};registerDatabase();const name$2="@firebase/installations",version$2="0.6.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PENDING_TIMEOUT_MS=1e4,PACKAGE_VERSION=`w:${version$2}`,INTERNAL_AUTH_VERSION="FIS_v2",INSTALLATIONS_API_URL="https://firebaseinstallations.googleapis.com/v1",TOKEN_EXPIRATION_BUFFER=60*60*1e3,SERVICE="installations",SERVICE_NAME="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERROR_DESCRIPTION_MAP={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},ERROR_FACTORY$1=new ErrorFactory(SERVICE,SERVICE_NAME,ERROR_DESCRIPTION_MAP);function isServerError(t){return t instanceof FirebaseError&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getInstallationsEndpoint({projectId:t}){return`${INSTALLATIONS_API_URL}/projects/${t}/installations`}function extractAuthTokenInfoFromResponse(t){return{token:t.token,requestStatus:2,expiresIn:getExpiresInFromResponseExpiresIn(t.expiresIn),creationTime:Date.now()}}function getErrorFromResponse(t,e){return Ye(this,null,function*(){const n=(yield e.json()).error;return ERROR_FACTORY$1.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})})}function getHeaders$1({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function getHeadersWithAuth(t,{refreshToken:e}){const r=getHeaders$1(t);return r.append("Authorization",getAuthorizationHeader(e)),r}function retryIfServerError(t){return Ye(this,null,function*(){const e=yield t();return e.status>=500&&e.status<600?t():e})}function getExpiresInFromResponseExpiresIn(t){return Number(t.replace("s","000"))}function getAuthorizationHeader(t){return`${INTERNAL_AUTH_VERSION} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function createInstallationRequest(n,i){return Ye(this,arguments,function*({appConfig:t,heartbeatServiceProvider:e},{fid:r}){const s=getInstallationsEndpoint(t),a=getHeaders$1(t),o=e.getImmediate({optional:!0});if(o){const f=yield o.getHeartbeatsHeader();f&&a.append("x-firebase-client",f)}const c={fid:r,authVersion:INTERNAL_AUTH_VERSION,appId:t.appId,sdkVersion:PACKAGE_VERSION},u={method:"POST",headers:a,body:JSON.stringify(c)},h=yield retryIfServerError(()=>fetch(s,u));if(h.ok){const f=yield h.json();return{fid:f.fid||r,registrationStatus:2,refreshToken:f.refreshToken,authToken:extractAuthTokenInfoFromResponse(f.authToken)}}else throw yield getErrorFromResponse("Create Installation",h)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sleep(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bufferToBase64UrlSafe(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VALID_FID_PATTERN=/^[cdef][\w-]{21}$/,INVALID_FID="";function generateFid(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const r=encode$2(t);return VALID_FID_PATTERN.test(r)?r:INVALID_FID}catch(t){return INVALID_FID}}function encode$2(t){return bufferToBase64UrlSafe(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getKey(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fidChangeCallbacks=new Map;function fidChanged(t,e){const r=getKey(t);callFidChangeCallbacks(r,e),broadcastFidChange(r,e)}function callFidChangeCallbacks(t,e){const r=fidChangeCallbacks.get(t);if(r)for(const n of r)n(e)}function broadcastFidChange(t,e){const r=getBroadcastChannel();r&&r.postMessage({key:t,fid:e}),closeBroadcastChannel()}let broadcastChannel=null;function getBroadcastChannel(){return!broadcastChannel&&"BroadcastChannel"in self&&(broadcastChannel=new BroadcastChannel("[Firebase] FID Change"),broadcastChannel.onmessage=t=>{callFidChangeCallbacks(t.data.key,t.data.fid)}),broadcastChannel}function closeBroadcastChannel(){fidChangeCallbacks.size===0&&broadcastChannel&&(broadcastChannel.close(),broadcastChannel=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DATABASE_NAME="firebase-installations-database",DATABASE_VERSION=1,OBJECT_STORE_NAME="firebase-installations-store";let dbPromise=null;function getDbPromise(){return dbPromise||(dbPromise=openDB(DATABASE_NAME,DATABASE_VERSION,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(OBJECT_STORE_NAME)}}})),dbPromise}function set(t,e){return Ye(this,null,function*(){const r=getKey(t),i=(yield getDbPromise()).transaction(OBJECT_STORE_NAME,"readwrite"),s=i.objectStore(OBJECT_STORE_NAME),a=yield s.get(r);return yield s.put(e,r),yield i.done,(!a||a.fid!==e.fid)&&fidChanged(t,e.fid),e})}function remove(t){return Ye(this,null,function*(){const e=getKey(t),n=(yield getDbPromise()).transaction(OBJECT_STORE_NAME,"readwrite");yield n.objectStore(OBJECT_STORE_NAME).delete(e),yield n.done})}function update(t,e){return Ye(this,null,function*(){const r=getKey(t),i=(yield getDbPromise()).transaction(OBJECT_STORE_NAME,"readwrite"),s=i.objectStore(OBJECT_STORE_NAME),a=yield s.get(r),o=e(a);return o===void 0?yield s.delete(r):yield s.put(o,r),yield i.done,o&&(!a||a.fid!==o.fid)&&fidChanged(t,o.fid),o})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getInstallationEntry(t){return Ye(this,null,function*(){let e;const r=yield update(t.appConfig,n=>{const i=updateOrCreateInstallationEntry(n),s=triggerRegistrationIfNecessary(t,i);return e=s.registrationPromise,s.installationEntry});return r.fid===INVALID_FID?{installationEntry:yield e}:{installationEntry:r,registrationPromise:e}})}function updateOrCreateInstallationEntry(t){const e=t||{fid:generateFid(),registrationStatus:0};return clearTimedOutRequest(e)}function triggerRegistrationIfNecessary(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(ERROR_FACTORY$1.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const r={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=registerInstallation(t,r);return{installationEntry:r,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:waitUntilFidRegistration(t)}:{installationEntry:e}}function registerInstallation(t,e){return Ye(this,null,function*(){try{const r=yield createInstallationRequest(t,e);return set(t.appConfig,r)}catch(r){throw isServerError(r)&&r.customData.serverCode===409?yield remove(t.appConfig):yield set(t.appConfig,{fid:e.fid,registrationStatus:0}),r}})}function waitUntilFidRegistration(t){return Ye(this,null,function*(){let e=yield updateInstallationRequest(t.appConfig);for(;e.registrationStatus===1;)yield sleep(100),e=yield updateInstallationRequest(t.appConfig);if(e.registrationStatus===0){const{installationEntry:r,registrationPromise:n}=yield getInstallationEntry(t);return n||r}return e})}function updateInstallationRequest(t){return update(t,e=>{if(!e)throw ERROR_FACTORY$1.create("installation-not-found");return clearTimedOutRequest(e)})}function clearTimedOutRequest(t){return hasInstallationRequestTimedOut(t)?{fid:t.fid,registrationStatus:0}:t}function hasInstallationRequestTimedOut(t){return t.registrationStatus===1&&t.registrationTime+PENDING_TIMEOUT_MS<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function generateAuthTokenRequest(n,i){return Ye(this,arguments,function*({appConfig:t,heartbeatServiceProvider:e},r){const s=getGenerateAuthTokenEndpoint(t,r),a=getHeadersWithAuth(t,r),o=e.getImmediate({optional:!0});if(o){const f=yield o.getHeartbeatsHeader();f&&a.append("x-firebase-client",f)}const c={installation:{sdkVersion:PACKAGE_VERSION,appId:t.appId}},u={method:"POST",headers:a,body:JSON.stringify(c)},h=yield retryIfServerError(()=>fetch(s,u));if(h.ok){const f=yield h.json();return extractAuthTokenInfoFromResponse(f)}else throw yield getErrorFromResponse("Generate Auth Token",h)})}function getGenerateAuthTokenEndpoint(t,{fid:e}){return`${getInstallationsEndpoint(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function refreshAuthToken(t,e=!1){return Ye(this,null,function*(){let r;const n=yield update(t.appConfig,s=>{if(!isEntryRegistered(s))throw ERROR_FACTORY$1.create("not-registered");const a=s.authToken;if(!e&&isAuthTokenValid(a))return s;if(a.requestStatus===1)return r=waitUntilAuthTokenRequest(t,e),s;{if(!navigator.onLine)throw ERROR_FACTORY$1.create("app-offline");const o=makeAuthTokenRequestInProgressEntry(s);return r=fetchAuthTokenFromServer(t,o),o}});return r?yield r:n.authToken})}function waitUntilAuthTokenRequest(t,e){return Ye(this,null,function*(){let r=yield updateAuthTokenRequest(t.appConfig);for(;r.authToken.requestStatus===1;)yield sleep(100),r=yield updateAuthTokenRequest(t.appConfig);const n=r.authToken;return n.requestStatus===0?refreshAuthToken(t,e):n})}function updateAuthTokenRequest(t){return update(t,e=>{if(!isEntryRegistered(e))throw ERROR_FACTORY$1.create("not-registered");const r=e.authToken;return hasAuthTokenRequestTimedOut(r)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function fetchAuthTokenFromServer(t,e){return Ye(this,null,function*(){try{const r=yield generateAuthTokenRequest(t,e),n=Object.assign(Object.assign({},e),{authToken:r});return yield set(t.appConfig,n),r}catch(r){if(isServerError(r)&&(r.customData.serverCode===401||r.customData.serverCode===404))yield remove(t.appConfig);else{const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});yield set(t.appConfig,n)}throw r}})}function isEntryRegistered(t){return t!==void 0&&t.registrationStatus===2}function isAuthTokenValid(t){return t.requestStatus===2&&!isAuthTokenExpired(t)}function isAuthTokenExpired(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+TOKEN_EXPIRATION_BUFFER}function makeAuthTokenRequestInProgressEntry(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function hasAuthTokenRequestTimedOut(t){return t.requestStatus===1&&t.requestTime+PENDING_TIMEOUT_MS<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getId(t){return Ye(this,null,function*(){const e=t,{installationEntry:r,registrationPromise:n}=yield getInstallationEntry(e);return n?n.catch(console.error):refreshAuthToken(e).catch(console.error),r.fid})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getToken(t,e=!1){return Ye(this,null,function*(){const r=t;return yield completeInstallationRegistration(r),(yield refreshAuthToken(r,e)).token})}function completeInstallationRegistration(t){return Ye(this,null,function*(){const{registrationPromise:e}=yield getInstallationEntry(t);e&&(yield e)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function extractAppConfig(t){if(!t||!t.options)throw getMissingValueError("App Configuration");if(!t.name)throw getMissingValueError("App Name");const e=["projectId","apiKey","appId"];for(const r of e)if(!t.options[r])throw getMissingValueError(r);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function getMissingValueError(t){return ERROR_FACTORY$1.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const INSTALLATIONS_NAME="installations",INSTALLATIONS_NAME_INTERNAL="installations-internal",publicFactory=t=>{const e=t.getProvider("app").getImmediate(),r=extractAppConfig(e),n=_getProvider(e,"heartbeat");return{app:e,appConfig:r,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},internalFactory=t=>{const e=t.getProvider("app").getImmediate(),r=_getProvider(e,INSTALLATIONS_NAME).getImmediate();return{getId:()=>getId(r),getToken:i=>getToken(r,i)}};function registerInstallations(){_registerComponent(new Component(INSTALLATIONS_NAME,publicFactory,"PUBLIC")),_registerComponent(new Component(INSTALLATIONS_NAME_INTERNAL,internalFactory,"PRIVATE"))}registerInstallations();registerVersion(name$2,version$2);registerVersion(name$2,version$2,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ANALYTICS_TYPE="analytics",GA_FID_KEY="firebase_id",ORIGIN_KEY="origin",FETCH_TIMEOUT_MILLIS=60*1e3,DYNAMIC_CONFIG_URL="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",GTAG_URL="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logger=new Logger("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERRORS={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},ERROR_FACTORY=new ErrorFactory("analytics","Analytics",ERRORS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function createGtagTrustedTypesScriptURL(t){if(!t.startsWith(GTAG_URL)){const e=ERROR_FACTORY.create("invalid-gtag-resource",{gtagURL:t});return logger.warn(e.message),""}return t}function promiseAllSettled(t){return Promise.all(t.map(e=>e.catch(r=>r)))}function createTrustedTypesPolicy(t,e){let r;return window.trustedTypes&&(r=window.trustedTypes.createPolicy(t,e)),r}function insertScriptTag(t,e){const r=createTrustedTypesPolicy("firebase-js-sdk-policy",{createScriptURL:createGtagTrustedTypesScriptURL}),n=document.createElement("script"),i=`${GTAG_URL}?l=${t}&id=${e}`;n.src=r?r==null?void 0:r.createScriptURL(i):i,n.async=!0,document.head.appendChild(n)}function getOrCreateDataLayer(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}function gtagOnConfig(t,e,r,n,i,s){return Ye(this,null,function*(){const a=n[i];try{if(a)yield e[a];else{const c=(yield promiseAllSettled(r)).find(u=>u.measurementId===i);c&&(yield e[c.appId])}}catch(o){logger.error(o)}t("config",i,s)})}function gtagOnEvent(t,e,r,n,i){return Ye(this,null,function*(){try{let s=[];if(i&&i.send_to){let a=i.send_to;Array.isArray(a)||(a=[a]);const o=yield promiseAllSettled(r);for(const c of a){const u=o.find(f=>f.measurementId===c),h=u&&e[u.appId];if(h)s.push(h);else{s=[];break}}}s.length===0&&(s=Object.values(e)),yield Promise.all(s),t("event",n,i||{})}catch(s){logger.error(s)}})}function wrapGtag(t,e,r,n){function i(s,...a){return Ye(this,null,function*(){try{if(s==="event"){const[o,c]=a;yield gtagOnEvent(t,e,r,o,c)}else if(s==="config"){const[o,c]=a;yield gtagOnConfig(t,e,r,n,o,c)}else if(s==="consent"){const[o,c]=a;t("consent",o,c)}else if(s==="get"){const[o,c,u]=a;t("get",o,c,u)}else if(s==="set"){const[o]=a;t("set",o)}else t(s,...a)}catch(o){logger.error(o)}})}return i}function wrapOrCreateGtag(t,e,r,n,i){let s=function(...a){window[n].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=wrapGtag(s,t,e,r),{gtagCore:s,wrappedGtag:window[i]}}function findGtagScriptOnPage(t){const e=window.document.getElementsByTagName("script");for(const r of Object.values(e))if(r.src&&r.src.includes(GTAG_URL)&&r.src.includes(t))return r;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LONG_RETRY_FACTOR=30,BASE_INTERVAL_MILLIS=1e3;class RetryData{constructor(e={},r=BASE_INTERVAL_MILLIS){this.throttleMetadata=e,this.intervalMillis=r}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,r){this.throttleMetadata[e]=r}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const defaultRetryData=new RetryData;function getHeaders(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}function fetchDynamicConfig(t){return Ye(this,null,function*(){var e;const{appId:r,apiKey:n}=t,i={method:"GET",headers:getHeaders(n)},s=DYNAMIC_CONFIG_URL.replace("{app-id}",r),a=yield fetch(s,i);if(a.status!==200&&a.status!==304){let o="";try{const c=yield a.json();!((e=c.error)===null||e===void 0)&&e.message&&(o=c.error.message)}catch(c){}throw ERROR_FACTORY.create("config-fetch-failed",{httpStatus:a.status,responseMessage:o})}return a.json()})}function fetchDynamicConfigWithRetry(n){return Ye(this,arguments,function*(t,e=defaultRetryData,r){const{appId:i,apiKey:s,measurementId:a}=t.options;if(!i)throw ERROR_FACTORY.create("no-app-id");if(!s){if(a)return{measurementId:a,appId:i};throw ERROR_FACTORY.create("no-api-key")}const o=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new AnalyticsAbortSignal;return setTimeout(()=>Ye(this,null,function*(){c.abort()}),FETCH_TIMEOUT_MILLIS),attemptFetchDynamicConfigWithRetry({appId:i,apiKey:s,measurementId:a},o,c,e)})}function attemptFetchDynamicConfigWithRetry(s,a,o){return Ye(this,arguments,function*(t,{throttleEndTimeMillis:e,backoffCount:r},n,i=defaultRetryData){var c;const{appId:u,measurementId:h}=t;try{yield setAbortableTimeout(n,e)}catch(f){if(h)return logger.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${h} provided in the "measurementId" field in the local Firebase config. [${f==null?void 0:f.message}]`),{appId:u,measurementId:h};throw f}try{const f=yield fetchDynamicConfig(t);return i.deleteThrottleMetadata(u),f}catch(f){const m=f;if(!isRetriableError(m)){if(i.deleteThrottleMetadata(u),h)return logger.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${h} provided in the "measurementId" field in the local Firebase config. [${m==null?void 0:m.message}]`),{appId:u,measurementId:h};throw f}const E=Number((c=m==null?void 0:m.customData)===null||c===void 0?void 0:c.httpStatus)===503?calculateBackoffMillis(r,i.intervalMillis,LONG_RETRY_FACTOR):calculateBackoffMillis(r,i.intervalMillis),g={throttleEndTimeMillis:Date.now()+E,backoffCount:r+1};return i.setThrottleMetadata(u,g),logger.debug(`Calling attemptFetch again in ${E} millis`),attemptFetchDynamicConfigWithRetry(t,g,n,i)}})}function setAbortableTimeout(t,e){return new Promise((r,n)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(r,i);t.addEventListener(()=>{clearTimeout(s),n(ERROR_FACTORY.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function isRetriableError(t){if(!(t instanceof FirebaseError)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class AnalyticsAbortSignal{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}function logEvent$1(t,e,r,n,i){return Ye(this,null,function*(){if(i&&i.global){t("event",r,n);return}else{const s=yield e,a=Object.assign(Object.assign({},n),{send_to:s});t("event",r,a)}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function validateIndexedDB(){return Ye(this,null,function*(){if(isIndexedDBAvailable())try{yield validateIndexedDBOpenable()}catch(t){return logger.warn(ERROR_FACTORY.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return logger.warn(ERROR_FACTORY.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0})}function _initializeAnalytics(t,e,r,n,i,s,a){return Ye(this,null,function*(){var o;const c=fetchDynamicConfigWithRetry(t);c.then(E=>{r[E.measurementId]=E.appId,t.options.measurementId&&E.measurementId!==t.options.measurementId&&logger.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${E.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(E=>logger.error(E)),e.push(c);const u=validateIndexedDB().then(E=>{if(E)return n.getId()}),[h,f]=yield Promise.all([c,u]);findGtagScriptOnPage(s)||insertScriptTag(s,h.measurementId),i("js",new Date);const m=(o=a==null?void 0:a.config)!==null&&o!==void 0?o:{};return m[ORIGIN_KEY]="firebase",m.update=!0,f!=null&&(m[GA_FID_KEY]=f),i("config",h.measurementId,m),h.measurementId})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AnalyticsService{constructor(e){this.app=e}_delete(){return delete initializationPromisesMap[this.app.options.appId],Promise.resolve()}}let initializationPromisesMap={},dynamicConfigPromisesList=[];const measurementIdToAppId={};let dataLayerName="dataLayer",gtagName="gtag",gtagCoreFunction,wrappedGtagFunction,globalInitDone=!1;function warnOnBrowserContextMismatch(){const t=[];if(isBrowserExtension()&&t.push("This is a browser extension environment."),areCookiesEnabled()||t.push("Cookies are not available."),t.length>0){const e=t.map((n,i)=>`(${i+1}) ${n}`).join(" "),r=ERROR_FACTORY.create("invalid-analytics-context",{errorInfo:e});logger.warn(r.message)}}function factory$1(t,e,r){warnOnBrowserContextMismatch();const n=t.options.appId;if(!n)throw ERROR_FACTORY.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)logger.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw ERROR_FACTORY.create("no-api-key");if(initializationPromisesMap[n]!=null)throw ERROR_FACTORY.create("already-exists",{id:n});if(!globalInitDone){getOrCreateDataLayer(dataLayerName);const{wrappedGtag:s,gtagCore:a}=wrapOrCreateGtag(initializationPromisesMap,dynamicConfigPromisesList,measurementIdToAppId,dataLayerName,gtagName);wrappedGtagFunction=s,gtagCoreFunction=a,globalInitDone=!0}return initializationPromisesMap[n]=_initializeAnalytics(t,dynamicConfigPromisesList,measurementIdToAppId,e,gtagCoreFunction,dataLayerName,r),new AnalyticsService(t)}function getAnalytics(t=getApp()){t=getModularInstance(t);const e=_getProvider(t,ANALYTICS_TYPE);return e.isInitialized()?e.getImmediate():initializeAnalytics(t)}function initializeAnalytics(t,e={}){const r=_getProvider(t,ANALYTICS_TYPE);if(r.isInitialized()){const i=r.getImmediate();if(deepEqual(e,r.getOptions()))return i;throw ERROR_FACTORY.create("already-initialized")}return r.initialize({options:e})}function logEvent(t,e,r,n){t=getModularInstance(t),logEvent$1(wrappedGtagFunction,initializationPromisesMap[t.app.options.appId],e,r,n).catch(i=>logger.error(i))}const name$1="@firebase/analytics",version$1="0.10.12";function registerAnalytics(){_registerComponent(new Component(ANALYTICS_TYPE,(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return factory$1(n,i,r)},"PUBLIC")),_registerComponent(new Component("analytics-internal",t,"PRIVATE")),registerVersion(name$1,version$1),registerVersion(name$1,version$1,"esm2017");function t(e){try{const r=e.getProvider(ANALYTICS_TYPE).getImmediate();return{logEvent:(n,i,s)=>logEvent(r,n,i,s)}}catch(r){throw ERROR_FACTORY.create("interop-component-reg-failed",{reason:r})}}}registerAnalytics();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_HOST="firebasestorage.googleapis.com",CONFIG_STORAGE_BUCKET_KEY="storageBucket",DEFAULT_MAX_OPERATION_RETRY_TIME=2*60*1e3,DEFAULT_MAX_UPLOAD_RETRY_TIME=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StorageError extends FirebaseError{constructor(e,r,n=0){super(prependCode(e),`Firebase Storage: ${r} (${prependCode(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,StorageError.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return prependCode(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var StorageErrorCode;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(StorageErrorCode||(StorageErrorCode={}));function prependCode(t){return"storage/"+t}function unknown(){const t="An unknown error occurred, please check the error payload for server response.";return new StorageError(StorageErrorCode.UNKNOWN,t)}function retryLimitExceeded(){return new StorageError(StorageErrorCode.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function canceled(){return new StorageError(StorageErrorCode.CANCELED,"User canceled the upload/download.")}function invalidUrl(t){return new StorageError(StorageErrorCode.INVALID_URL,"Invalid URL '"+t+"'.")}function invalidDefaultBucket(t){return new StorageError(StorageErrorCode.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function invalidArgument(t){return new StorageError(StorageErrorCode.INVALID_ARGUMENT,t)}function appDeleted(){return new StorageError(StorageErrorCode.APP_DELETED,"The Firebase app was deleted.")}function invalidRootOperation(t){return new StorageError(StorageErrorCode.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Location{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=Location.makeFromUrl(e,r)}catch(i){return new Location(e,"")}if(n.path==="")return n;throw invalidDefaultBucket(e)}static makeFromUrl(e,r){let n=null;const i="([A-Za-z0-9.\\-_]+)";function s(ne){ne.path.charAt(ne.path.length-1)==="/"&&(ne.path_=ne.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),c={bucket:1,path:3};function u(ne){ne.path_=decodeURIComponent(ne.path)}const h="v[A-Za-z0-9_]+",f=r.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",E=new RegExp(`^https?://${f}/${h}/b/${i}/o${m}`,"i"),g={bucket:1,path:3},p=r===DEFAULT_HOST?"(?:storage.googleapis.com|storage.cloud.google.com)":r,_="([^?#]*)",A=new RegExp(`^https?://${p}/${i}/${_}`,"i"),te=[{regex:o,indices:c,postModify:s},{regex:E,indices:g,postModify:u},{regex:A,indices:{bucket:1,path:2},postModify:u}];for(let ne=0;ne<te.length;ne++){const j=te[ne],ee=j.regex.exec(e);if(ee){const x=ee[j.indices.bucket];let M=ee[j.indices.path];M||(M=""),n=new Location(x,M),j.postModify(n);break}}if(n==null)throw invalidUrl(e);return n}}class FailRequest{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function start(t,e,r){let n=1,i=null,s=null,a=!1,o=0;function c(){return o===2}let u=!1;function h(..._){u||(u=!0,e.apply(null,_))}function f(_){i=setTimeout(()=>{i=null,t(E,c())},_)}function m(){s&&clearTimeout(s)}function E(_,...A){if(u){m();return}if(_){m(),h.call(null,_,...A);return}if(c()||a){m(),h.call(null,_,...A);return}n<64&&(n*=2);let te;o===1?(o=2,te=0):te=(n+Math.random())*1e3,f(te)}let g=!1;function p(_){g||(g=!0,m(),!u&&(i!==null?(_||(o=2),clearTimeout(i),f(0)):_||(o=1)))}return f(0),s=setTimeout(()=>{a=!0,p(!0)},r),p}function stop(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isJustDef(t){return t!==void 0}function validateNumber(t,e,r,n){if(n<e)throw invalidArgument(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw invalidArgument(`Invalid value for '${t}'. Expected ${r} or less.`)}function makeQueryString(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const i=e(n)+"="+e(t[n]);r=r+i+"&"}return r=r.slice(0,-1),r}var ErrorCode;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(ErrorCode||(ErrorCode={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isRetryStatusCode(t,e){const r=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return r||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NetworkRequest{constructor(e,r,n,i,s,a,o,c,u,h,f,m=!0){this.url_=e,this.method_=r,this.headers_=n,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=h,this.connectionFactory_=f,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((E,g)=>{this.resolve_=E,this.reject_=g,this.start_()})}start_(){const e=(n,i)=>{if(i){n(!1,new RequestEndStatus(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const c=o.loaded,u=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===ErrorCode.NO_ERROR,c=s.getStatus();if(!o||isRetryStatusCode(c,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===ErrorCode.ABORT;n(!1,new RequestEndStatus(!1,null,h));return}const u=this.successCodes_.indexOf(c)!==-1;n(!0,new RequestEndStatus(u,s))})},r=(n,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const c=this.callback_(o,o.getResponse());isJustDef(c)?s(c):s()}catch(c){a(c)}else if(o!==null){const c=unknown();c.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,c)):a(c)}else if(i.canceled){const c=this.appDelete_?appDeleted():canceled();a(c)}else{const c=retryLimitExceeded();a(c)}};this.canceled_?r(!1,new RequestEndStatus(!1,null,!0)):this.backoffId_=start(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&stop(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class RequestEndStatus{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function addAuthHeader_(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function addVersionHeader_(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e!=null?e:"AppManager")}function addGmpidHeader_(t,e){e&&(t["X-Firebase-GMPID"]=e)}function addAppCheckHeader_(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function makeRequest(t,e,r,n,i,s,a=!0){const o=makeQueryString(t.urlParams),c=t.url+o,u=Object.assign({},t.headers);return addGmpidHeader_(u,e),addAuthHeader_(u,r),addVersionHeader_(u,s),addAppCheckHeader_(u,n),new NetworkRequest(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function parent(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function lastComponent(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Reference{constructor(e,r){this._service=e,r instanceof Location?this._location=r:this._location=Location.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new Reference(e,r)}get root(){const e=new Location(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return lastComponent(this._location.path)}get storage(){return this._service}get parent(){const e=parent(this._location.path);if(e===null)return null;const r=new Location(this._location.bucket,e);return new Reference(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw invalidRootOperation(e)}}function extractBucket(t,e){const r=e==null?void 0:e[CONFIG_STORAGE_BUCKET_KEY];return r==null?null:Location.makeFromBucketSpec(r,t)}class FirebaseStorageImpl{constructor(e,r,n,i,s){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=DEFAULT_HOST,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=DEFAULT_MAX_OPERATION_RETRY_TIME,this._maxUploadRetryTime=DEFAULT_MAX_UPLOAD_RETRY_TIME,this._requests=new Set,i!=null?this._bucket=Location.makeFromBucketSpec(i,this._host):this._bucket=extractBucket(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Location.makeFromBucketSpec(this._url,e):this._bucket=extractBucket(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){validateNumber("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){validateNumber("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return Ye(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=yield e.getToken();if(r!==null)return r.accessToken}return null})}_getAppCheckToken(){return Ye(this,null,function*(){if(_isFirebaseServerApp(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Reference(this,e)}_makeRequest(e,r,n,i,s=!0){if(this._deleted)return new FailRequest(appDeleted());{const a=makeRequest(e,this._appId,n,i,r,this._firebaseVersion,s);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}makeRequestWithTokens(e,r){return Ye(this,null,function*(){const[n,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,i).getPromise()})}}const name="@firebase/storage",version="0.13.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const STORAGE_TYPE="storage";function factory(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new FirebaseStorageImpl(r,n,i,e,SDK_VERSION$1)}function registerStorage(){_registerComponent(new Component(STORAGE_TYPE,factory,"PUBLIC").setMultipleInstances(!0)),registerVersion(name,version,""),registerVersion(name,version,"esm2017")}registerStorage();const firebaseConfig={apiKey:"AIzaSyCVbe_HdaWJEkDAVBfwehi9EyGFLrirTsw",authDomain:"calcae.firebaseapp.com",projectId:"calcae",storageBucket:"calcae.firebasestorage.app",messagingSenderId:"95476953005",appId:"1:95476953005:web:412135c76d49b45965bb24",measurementId:"G-YR4H8LHQB3"},app=initializeApp(firebaseConfig),auth=getAuth(app);getAnalytics(app);function bind(t,e){return function(){return t.apply(e,arguments)}}const{toString}=Object.prototype,{getPrototypeOf}=Object,kindOf=(t=>e=>{const r=toString.call(e);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=t=>(t=t.toLowerCase(),e=>kindOf(e)===t),typeOfTest=t=>e=>typeof e===t,{isArray}=Array,isUndefined=typeOfTest("undefined");function isBuffer(t){return t!==null&&!isUndefined(t)&&t.constructor!==null&&!isUndefined(t.constructor)&&isFunction(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(t){let e;return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&isArrayBuffer(t.buffer),e}const isString=typeOfTest("string"),isFunction=typeOfTest("function"),isNumber=typeOfTest("number"),isObject=t=>t!==null&&typeof t=="object",isBoolean=t=>t===!0||t===!1,isPlainObject=t=>{if(kindOf(t)!=="object")return!1;const e=getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=t=>isObject(t)&&isFunction(t.pipe),isFormData=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||isFunction(t.append)&&((e=kindOf(t))==="formdata"||e==="object"&&isFunction(t.toString)&&t.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),[isReadableStream,isRequest,isResponse,isHeaders]=["ReadableStream","Request","Response","Headers"].map(kindOfTest),trim=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(t,e,{allOwnKeys:r=!1}={}){if(t===null||typeof t=="undefined")return;let n,i;if(typeof t!="object"&&(t=[t]),isArray(t))for(n=0,i=t.length;n<i;n++)e.call(null,t[n],n,t);else{const s=r?Object.getOwnPropertyNames(t):Object.keys(t),a=s.length;let o;for(n=0;n<a;n++)o=s[n],e.call(null,t[o],o,t)}}function findKey(t,e){e=e.toLowerCase();const r=Object.keys(t);let n=r.length,i;for(;n-- >0;)if(i=r[n],e===i.toLowerCase())return i;return null}const _global=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:global,isContextDefined=t=>!isUndefined(t)&&t!==_global;function merge(){const{caseless:t}=isContextDefined(this)&&this||{},e={},r=(n,i)=>{const s=t&&findKey(e,i)||i;isPlainObject(e[s])&&isPlainObject(n)?e[s]=merge(e[s],n):isPlainObject(n)?e[s]=merge({},n):isArray(n)?e[s]=n.slice():e[s]=n};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&forEach(arguments[n],r);return e}const extend=(t,e,r,{allOwnKeys:n}={})=>(forEach(e,(i,s)=>{r&&isFunction(i)?t[s]=bind(i,r):t[s]=i},{allOwnKeys:n}),t),stripBOM=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),inherits=(t,e,r,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},toFlatObject=(t,e,r,n)=>{let i,s,a;const o={};if(e=e||{},t==null)return e;do{for(i=Object.getOwnPropertyNames(t),s=i.length;s-- >0;)a=i[s],(!n||n(a,t,e))&&!o[a]&&(e[a]=t[a],o[a]=!0);t=r!==!1&&getPrototypeOf(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},endsWith=(t,e,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=e.length;const n=t.indexOf(e,r);return n!==-1&&n===r},toArray=t=>{if(!t)return null;if(isArray(t))return t;let e=t.length;if(!isNumber(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},isTypedArray=(t=>e=>t&&e instanceof t)(typeof Uint8Array!="undefined"&&getPrototypeOf(Uint8Array)),forEachEntry=(t,e)=>{const n=(t&&t[Symbol.iterator]).call(t);let i;for(;(i=n.next())&&!i.done;){const s=i.value;e.call(t,s[0],s[1])}},matchAll=(t,e)=>{let r;const n=[];for(;(r=t.exec(e))!==null;)n.push(r);return n},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,i){return n.toUpperCase()+i}),hasOwnProperty=(({hasOwnProperty:t})=>(e,r)=>t.call(e,r))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t),n={};forEach(r,(i,s)=>{let a;(a=e(i,s,t))!==!1&&(n[s]=a||i)}),Object.defineProperties(t,n)},freezeMethods=t=>{reduceDescriptors(t,(e,r)=>{if(isFunction(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=t[r];if(isFunction(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},toObjectSet=(t,e)=>{const r={},n=i=>{i.forEach(s=>{r[s]=!0})};return isArray(t)?n(t):n(String(t).split(e)),r},noop=()=>{},toFiniteNumber=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function isSpecCompliantForm(t){return!!(t&&isFunction(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const toJSONObject=t=>{const e=new Array(10),r=(n,i)=>{if(isObject(n)){if(e.indexOf(n)>=0)return;if(!("toJSON"in n)){e[i]=n;const s=isArray(n)?[]:{};return forEach(n,(a,o)=>{const c=r(a,i+1);!isUndefined(c)&&(s[o]=c)}),e[i]=void 0,s}}return n};return r(t,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=t=>t&&(isObject(t)||isFunction(t))&&isFunction(t.then)&&isFunction(t.catch),_setImmediate=((t,e)=>t?setImmediate:e?((r,n)=>(_global.addEventListener("message",({source:i,data:s})=>{i===_global&&s===r&&n.length&&n.shift()()},!1),i=>{n.push(i),_global.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",isFunction(_global.postMessage)),asap=typeof queueMicrotask!="undefined"?queueMicrotask.bind(_global):typeof process!="undefined"&&process.nextTick||_setImmediate,utils$2={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber,isBoolean,isObject,isPlainObject,isReadableStream,isRequest,isResponse,isHeaders,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction,isStream,isURLSearchParams,isTypedArray,isFileList,forEach,merge,extend,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray,forEachEntry,matchAll,isHTMLForm,hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop,toFiniteNumber,findKey,global:_global,isContextDefined,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable,setImmediate:_setImmediate,asap};function AxiosError$1(t,e,r,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),n&&(this.request=n),i&&(this.response=i,this.status=i.status?i.status:null)}utils$2.inherits(AxiosError$1,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$2.toJSONObject(this.config),code:this.code,status:this.status}}});const prototype$1=AxiosError$1.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{descriptors[t]={value:t}});Object.defineProperties(AxiosError$1,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError$1.from=(t,e,r,n,i,s)=>{const a=Object.create(prototype$1);return utils$2.toFlatObject(t,a,function(c){return c!==Error.prototype},o=>o!=="isAxiosError"),AxiosError$1.call(a,t.message,e,r,n,i),a.cause=t,a.name=t.name,s&&Object.assign(a,s),a};const httpAdapter=null;function isVisitable(t){return utils$2.isPlainObject(t)||utils$2.isArray(t)}function removeBrackets(t){return utils$2.endsWith(t,"[]")?t.slice(0,-2):t}function renderKey(t,e,r){return t?t.concat(e).map(function(i,s){return i=removeBrackets(i),!r&&s?"["+i+"]":i}).join(r?".":""):e}function isFlatArray(t){return utils$2.isArray(t)&&!t.some(isVisitable)}const predicates=utils$2.toFlatObject(utils$2,{},null,function(e){return/^is[A-Z]/.test(e)});function toFormData$1(t,e,r){if(!utils$2.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,r=utils$2.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,_){return!utils$2.isUndefined(_[p])});const n=r.metaTokens,i=r.visitor||h,s=r.dots,a=r.indexes,c=(r.Blob||typeof Blob!="undefined"&&Blob)&&utils$2.isSpecCompliantForm(e);if(!utils$2.isFunction(i))throw new TypeError("visitor must be a function");function u(g){if(g===null)return"";if(utils$2.isDate(g))return g.toISOString();if(!c&&utils$2.isBlob(g))throw new AxiosError$1("Blob is not supported. Use a Buffer instead.");return utils$2.isArrayBuffer(g)||utils$2.isTypedArray(g)?c&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function h(g,p,_){let A=g;if(g&&!_&&typeof g=="object"){if(utils$2.endsWith(p,"{}"))p=n?p:p.slice(0,-2),g=JSON.stringify(g);else if(utils$2.isArray(g)&&isFlatArray(g)||(utils$2.isFileList(g)||utils$2.endsWith(p,"[]"))&&(A=utils$2.toArray(g)))return p=removeBrackets(p),A.forEach(function(te,ne){!(utils$2.isUndefined(te)||te===null)&&e.append(a===!0?renderKey([p],ne,s):a===null?p:p+"[]",u(te))}),!1}return isVisitable(g)?!0:(e.append(renderKey(_,p,s),u(g)),!1)}const f=[],m=Object.assign(predicates,{defaultVisitor:h,convertValue:u,isVisitable});function E(g,p){if(!utils$2.isUndefined(g)){if(f.indexOf(g)!==-1)throw Error("Circular reference detected in "+p.join("."));f.push(g),utils$2.forEach(g,function(A,H){(!(utils$2.isUndefined(A)||A===null)&&i.call(e,A,utils$2.isString(H)?H.trim():H,p,m))===!0&&E(A,p?p.concat(H):[H])}),f.pop()}}if(!utils$2.isObject(t))throw new TypeError("data must be an object");return E(t),e}function encode$1(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function AxiosURLSearchParams(t,e){this._pairs=[],t&&toFormData$1(t,this,e)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(e,r){this._pairs.push([e,r])};prototype.toString=function(e){const r=e?function(n){return e.call(this,n,encode$1)}:encode$1;return this._pairs.map(function(i){return r(i[0])+"="+r(i[1])},"").join("&")};function encode(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(t,e,r){if(!e)return t;const n=r&&r.encode||encode;utils$2.isFunction(r)&&(r={serialize:r});const i=r&&r.serialize;let s;if(i?s=i(e,r):s=utils$2.isURLSearchParams(e)?e.toString():new AxiosURLSearchParams(e,r).toString(n),s){const a=t.indexOf("#");a!==-1&&(t=t.slice(0,a)),t+=(t.indexOf("?")===-1?"?":"&")+s}return t}class InterceptorManager{constructor(){this.handlers=[]}use(e,r,n){return this.handlers.push({fulfilled:e,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){utils$2.forEach(this.handlers,function(n){n!==null&&e(n)})}}const transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams!="undefined"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData!="undefined"?FormData:null,Blob$1=typeof Blob!="undefined"?Blob:null,platform$1={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window!="undefined"&&typeof document!="undefined",_navigator=typeof navigator=="object"&&navigator||void 0,hasStandardBrowserEnv=hasBrowserEnv&&(!_navigator||["ReactNative","NativeScript","NS"].indexOf(_navigator.product)<0),hasStandardBrowserWebWorkerEnv=typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",origin=hasBrowserEnv&&window.location.href||"http://localhost",utils$1=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv,navigator:_navigator,origin},Symbol.toStringTag,{value:"Module"})),platform=Er(Er({},utils$1),platform$1);function toURLEncodedForm(t,e){return toFormData$1(t,new platform.classes.URLSearchParams,Object.assign({visitor:function(r,n,i,s){return platform.isNode&&utils$2.isBuffer(r)?(this.append(n,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},e))}function parsePropPath(t){return utils$2.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function arrayToObject(t){const e={},r=Object.keys(t);let n;const i=r.length;let s;for(n=0;n<i;n++)s=r[n],e[s]=t[s];return e}function formDataToJSON(t){function e(r,n,i,s){let a=r[s++];if(a==="__proto__")return!0;const o=Number.isFinite(+a),c=s>=r.length;return a=!a&&utils$2.isArray(i)?i.length:a,c?(utils$2.hasOwnProp(i,a)?i[a]=[i[a],n]:i[a]=n,!o):((!i[a]||!utils$2.isObject(i[a]))&&(i[a]=[]),e(r,n,i[a],s)&&utils$2.isArray(i[a])&&(i[a]=arrayToObject(i[a])),!o)}if(utils$2.isFormData(t)&&utils$2.isFunction(t.entries)){const r={};return utils$2.forEachEntry(t,(n,i)=>{e(parsePropPath(n),i,r,0)}),r}return null}function stringifySafely(t,e,r){if(utils$2.isString(t))try{return(e||JSON.parse)(t),utils$2.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(t)}const defaults={transitional:transitionalDefaults,adapter:["xhr","http","fetch"],transformRequest:[function(e,r){const n=r.getContentType()||"",i=n.indexOf("application/json")>-1,s=utils$2.isObject(e);if(s&&utils$2.isHTMLForm(e)&&(e=new FormData(e)),utils$2.isFormData(e))return i?JSON.stringify(formDataToJSON(e)):e;if(utils$2.isArrayBuffer(e)||utils$2.isBuffer(e)||utils$2.isStream(e)||utils$2.isFile(e)||utils$2.isBlob(e)||utils$2.isReadableStream(e))return e;if(utils$2.isArrayBufferView(e))return e.buffer;if(utils$2.isURLSearchParams(e))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(e,this.formSerializer).toString();if((o=utils$2.isFileList(e))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return toFormData$1(o?{"files[]":e}:e,c&&new c,this.formSerializer)}}return s||i?(r.setContentType("application/json",!1),stringifySafely(e)):e}],transformResponse:[function(e){const r=this.transitional||defaults.transitional,n=r&&r.forcedJSONParsing,i=this.responseType==="json";if(utils$2.isResponse(e)||utils$2.isReadableStream(e))return e;if(e&&utils$2.isString(e)&&(n&&!this.responseType||i)){const a=!(r&&r.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(o){if(a)throw o.name==="SyntaxError"?AxiosError$1.from(o,AxiosError$1.ERR_BAD_RESPONSE,this,null,this.response):o}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$2.forEach(["delete","get","head","post","put","patch"],t=>{defaults.headers[t]={}});const ignoreDuplicateOf=utils$2.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=t=>{const e={};let r,n,i;return t&&t.split(`
`).forEach(function(a){i=a.indexOf(":"),r=a.substring(0,i).trim().toLowerCase(),n=a.substring(i+1).trim(),!(!r||e[r]&&ignoreDuplicateOf[r])&&(r==="set-cookie"?e[r]?e[r].push(n):e[r]=[n]:e[r]=e[r]?e[r]+", "+n:n)}),e},$internals=Symbol("internals");function normalizeHeader(t){return t&&String(t).trim().toLowerCase()}function normalizeValue(t){return t===!1||t==null?t:utils$2.isArray(t)?t.map(normalizeValue):String(t)}function parseTokens(t){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(t);)e[n[1]]=n[2];return e}const isValidHeaderName=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function matchHeaderValue(t,e,r,n,i){if(utils$2.isFunction(n))return n.call(this,e,r);if(i&&(e=r),!!utils$2.isString(e)){if(utils$2.isString(n))return e.indexOf(n)!==-1;if(utils$2.isRegExp(n))return n.test(e)}}function formatHeader(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,r,n)=>r.toUpperCase()+n)}function buildAccessors(t,e){const r=utils$2.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+r,{value:function(i,s,a){return this[n].call(this,e,i,s,a)},configurable:!0})})}let AxiosHeaders$1=class{constructor(e){e&&this.set(e)}set(e,r,n){const i=this;function s(o,c,u){const h=normalizeHeader(c);if(!h)throw new Error("header name must be a non-empty string");const f=utils$2.findKey(i,h);(!f||i[f]===void 0||u===!0||u===void 0&&i[f]!==!1)&&(i[f||c]=normalizeValue(o))}const a=(o,c)=>utils$2.forEach(o,(u,h)=>s(u,h,c));if(utils$2.isPlainObject(e)||e instanceof this.constructor)a(e,r);else if(utils$2.isString(e)&&(e=e.trim())&&!isValidHeaderName(e))a(parseHeaders(e),r);else if(utils$2.isHeaders(e))for(const[o,c]of e.entries())s(c,o,n);else e!=null&&s(r,e,n);return this}get(e,r){if(e=normalizeHeader(e),e){const n=utils$2.findKey(this,e);if(n){const i=this[n];if(!r)return i;if(r===!0)return parseTokens(i);if(utils$2.isFunction(r))return r.call(this,i,n);if(utils$2.isRegExp(r))return r.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,r){if(e=normalizeHeader(e),e){const n=utils$2.findKey(this,e);return!!(n&&this[n]!==void 0&&(!r||matchHeaderValue(this,this[n],n,r)))}return!1}delete(e,r){const n=this;let i=!1;function s(a){if(a=normalizeHeader(a),a){const o=utils$2.findKey(n,a);o&&(!r||matchHeaderValue(n,n[o],o,r))&&(delete n[o],i=!0)}}return utils$2.isArray(e)?e.forEach(s):s(e),i}clear(e){const r=Object.keys(this);let n=r.length,i=!1;for(;n--;){const s=r[n];(!e||matchHeaderValue(this,this[s],s,e,!0))&&(delete this[s],i=!0)}return i}normalize(e){const r=this,n={};return utils$2.forEach(this,(i,s)=>{const a=utils$2.findKey(n,s);if(a){r[a]=normalizeValue(i),delete r[s];return}const o=e?formatHeader(s):String(s).trim();o!==s&&delete r[s],r[o]=normalizeValue(i),n[o]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const r=Object.create(null);return utils$2.forEach(this,(n,i)=>{n!=null&&n!==!1&&(r[i]=e&&utils$2.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,r])=>e+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...r){const n=new this(e);return r.forEach(i=>n.set(i)),n}static accessor(e){const n=(this[$internals]=this[$internals]={accessors:{}}).accessors,i=this.prototype;function s(a){const o=normalizeHeader(a);n[o]||(buildAccessors(i,a),n[o]=!0)}return utils$2.isArray(e)?e.forEach(s):s(e),this}};AxiosHeaders$1.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$2.reduceDescriptors(AxiosHeaders$1.prototype,({value:t},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(n){this[r]=n}}});utils$2.freezeMethods(AxiosHeaders$1);function transformData(t,e){const r=this||defaults,n=e||r,i=AxiosHeaders$1.from(n.headers);let s=n.data;return utils$2.forEach(t,function(o){s=o.call(r,s,i.normalize(),e?e.status:void 0)}),i.normalize(),s}function isCancel$1(t){return!!(t&&t.__CANCEL__)}function CanceledError$1(t,e,r){AxiosError$1.call(this,t==null?"canceled":t,AxiosError$1.ERR_CANCELED,e,r),this.name="CanceledError"}utils$2.inherits(CanceledError$1,AxiosError$1,{__CANCEL__:!0});function settle(t,e,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?t(r):e(new AxiosError$1("Request failed with status code "+r.status,[AxiosError$1.ERR_BAD_REQUEST,AxiosError$1.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function parseProtocol(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function speedometer(t,e){t=t||10;const r=new Array(t),n=new Array(t);let i=0,s=0,a;return e=e!==void 0?e:1e3,function(c){const u=Date.now(),h=n[s];a||(a=u),r[i]=c,n[i]=u;let f=s,m=0;for(;f!==i;)m+=r[f++],f=f%t;if(i=(i+1)%t,i===s&&(s=(s+1)%t),u-a<e)return;const E=h&&u-h;return E?Math.round(m*1e3/E):void 0}}function throttle(t,e){let r=0,n=1e3/e,i,s;const a=(u,h=Date.now())=>{r=h,i=null,s&&(clearTimeout(s),s=null),t.apply(null,u)};return[(...u)=>{const h=Date.now(),f=h-r;f>=n?a(u,h):(i=u,s||(s=setTimeout(()=>{s=null,a(i)},n-f)))},()=>i&&a(i)]}const progressEventReducer=(t,e,r=3)=>{let n=0;const i=speedometer(50,250);return throttle(s=>{const a=s.loaded,o=s.lengthComputable?s.total:void 0,c=a-n,u=i(c),h=a<=o;n=a;const f={loaded:a,total:o,progress:o?a/o:void 0,bytes:c,rate:u||void 0,estimated:u&&o&&h?(o-a)/u:void 0,event:s,lengthComputable:o!=null,[e?"download":"upload"]:!0};t(f)},r)},progressEventDecorator=(t,e)=>{const r=t!=null;return[n=>e[0]({lengthComputable:r,total:t,loaded:n}),e[1]]},asyncDecorator=t=>(...e)=>utils$2.asap(()=>t(...e)),isURLSameOrigin=platform.hasStandardBrowserEnv?((t,e)=>r=>(r=new URL(r,platform.origin),t.protocol===r.protocol&&t.host===r.host&&(e||t.port===r.port)))(new URL(platform.origin),platform.navigator&&/(msie|trident)/i.test(platform.navigator.userAgent)):()=>!0,cookies=platform.hasStandardBrowserEnv?{write(t,e,r,n,i,s){const a=[t+"="+encodeURIComponent(e)];utils$2.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),utils$2.isString(n)&&a.push("path="+n),utils$2.isString(i)&&a.push("domain="+i),s===!0&&a.push("secure"),document.cookie=a.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function combineURLs(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function buildFullPath(t,e,r){let n=!isAbsoluteURL(e);return t&&n||r==!1?combineURLs(t,e):e}const headersToObject=t=>t instanceof AxiosHeaders$1?Er({},t):t;function mergeConfig$1(t,e){e=e||{};const r={};function n(u,h,f,m){return utils$2.isPlainObject(u)&&utils$2.isPlainObject(h)?utils$2.merge.call({caseless:m},u,h):utils$2.isPlainObject(h)?utils$2.merge({},h):utils$2.isArray(h)?h.slice():h}function i(u,h,f,m){if(utils$2.isUndefined(h)){if(!utils$2.isUndefined(u))return n(void 0,u,f,m)}else return n(u,h,f,m)}function s(u,h){if(!utils$2.isUndefined(h))return n(void 0,h)}function a(u,h){if(utils$2.isUndefined(h)){if(!utils$2.isUndefined(u))return n(void 0,u)}else return n(void 0,h)}function o(u,h,f){if(f in e)return n(u,h);if(f in t)return n(void 0,u)}const c={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(u,h,f)=>i(headersToObject(u),headersToObject(h),f,!0)};return utils$2.forEach(Object.keys(Object.assign({},t,e)),function(h){const f=c[h]||i,m=f(t[h],e[h],h);utils$2.isUndefined(m)&&f!==o||(r[h]=m)}),r}const resolveConfig=t=>{const e=mergeConfig$1({},t);let{data:r,withXSRFToken:n,xsrfHeaderName:i,xsrfCookieName:s,headers:a,auth:o}=e;e.headers=a=AxiosHeaders$1.from(a),e.url=buildURL(buildFullPath(e.baseURL,e.url),t.params,t.paramsSerializer),o&&a.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let c;if(utils$2.isFormData(r)){if(platform.hasStandardBrowserEnv||platform.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if((c=a.getContentType())!==!1){const[u,...h]=c?c.split(";").map(f=>f.trim()).filter(Boolean):[];a.setContentType([u||"multipart/form-data",...h].join("; "))}}if(platform.hasStandardBrowserEnv&&(n&&utils$2.isFunction(n)&&(n=n(e)),n||n!==!1&&isURLSameOrigin(e.url))){const u=i&&s&&cookies.read(s);u&&a.set(i,u)}return e},isXHRAdapterSupported=typeof XMLHttpRequest!="undefined",xhrAdapter=isXHRAdapterSupported&&function(t){return new Promise(function(r,n){const i=resolveConfig(t);let s=i.data;const a=AxiosHeaders$1.from(i.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:u}=i,h,f,m,E,g;function p(){E&&E(),g&&g(),i.cancelToken&&i.cancelToken.unsubscribe(h),i.signal&&i.signal.removeEventListener("abort",h)}let _=new XMLHttpRequest;_.open(i.method.toUpperCase(),i.url,!0),_.timeout=i.timeout;function A(){if(!_)return;const te=AxiosHeaders$1.from("getAllResponseHeaders"in _&&_.getAllResponseHeaders()),j={data:!o||o==="text"||o==="json"?_.responseText:_.response,status:_.status,statusText:_.statusText,headers:te,config:t,request:_};settle(function(x){r(x),p()},function(x){n(x),p()},j),_=null}"onloadend"in _?_.onloadend=A:_.onreadystatechange=function(){!_||_.readyState!==4||_.status===0&&!(_.responseURL&&_.responseURL.indexOf("file:")===0)||setTimeout(A)},_.onabort=function(){_&&(n(new AxiosError$1("Request aborted",AxiosError$1.ECONNABORTED,t,_)),_=null)},_.onerror=function(){n(new AxiosError$1("Network Error",AxiosError$1.ERR_NETWORK,t,_)),_=null},_.ontimeout=function(){let ne=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const j=i.transitional||transitionalDefaults;i.timeoutErrorMessage&&(ne=i.timeoutErrorMessage),n(new AxiosError$1(ne,j.clarifyTimeoutError?AxiosError$1.ETIMEDOUT:AxiosError$1.ECONNABORTED,t,_)),_=null},s===void 0&&a.setContentType(null),"setRequestHeader"in _&&utils$2.forEach(a.toJSON(),function(ne,j){_.setRequestHeader(j,ne)}),utils$2.isUndefined(i.withCredentials)||(_.withCredentials=!!i.withCredentials),o&&o!=="json"&&(_.responseType=i.responseType),u&&([m,g]=progressEventReducer(u,!0),_.addEventListener("progress",m)),c&&_.upload&&([f,E]=progressEventReducer(c),_.upload.addEventListener("progress",f),_.upload.addEventListener("loadend",E)),(i.cancelToken||i.signal)&&(h=te=>{_&&(n(!te||te.type?new CanceledError$1(null,t,_):te),_.abort(),_=null)},i.cancelToken&&i.cancelToken.subscribe(h),i.signal&&(i.signal.aborted?h():i.signal.addEventListener("abort",h)));const H=parseProtocol(i.url);if(H&&platform.protocols.indexOf(H)===-1){n(new AxiosError$1("Unsupported protocol "+H+":",AxiosError$1.ERR_BAD_REQUEST,t));return}_.send(s||null)})},composeSignals=(t,e)=>{const{length:r}=t=t?t.filter(Boolean):[];if(e||r){let n=new AbortController,i;const s=function(u){if(!i){i=!0,o();const h=u instanceof Error?u:this.reason;n.abort(h instanceof AxiosError$1?h:new CanceledError$1(h instanceof Error?h.message:h))}};let a=e&&setTimeout(()=>{a=null,s(new AxiosError$1(`timeout ${e} of ms exceeded`,AxiosError$1.ETIMEDOUT))},e);const o=()=>{t&&(a&&clearTimeout(a),a=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(s):u.removeEventListener("abort",s)}),t=null)};t.forEach(u=>u.addEventListener("abort",s));const{signal:c}=n;return c.unsubscribe=()=>utils$2.asap(o),c}},streamChunk=function*(t,e){let r=t.byteLength;if(r<e){yield t;return}let n=0,i;for(;n<r;)i=n+e,yield t.slice(n,i),n=i},readBytes=function(t,e){return Gs(this,null,function*(){try{for(var r=Ja(readStream(t)),n,i,s;n=!(i=yield new ei(r.next())).done;n=!1){const a=i.value;yield*Xs(streamChunk(a,e))}}catch(i){s=[i]}finally{try{n&&(i=r.return)&&(yield new ei(i.call(r)))}finally{if(s)throw s[0]}}})},readStream=function(t){return Gs(this,null,function*(){if(t[Symbol.asyncIterator]){yield*Xs(t);return}const e=t.getReader();try{for(;;){const{done:r,value:n}=yield new ei(e.read());if(r)break;yield n}}finally{yield new ei(e.cancel())}})},trackStream=(t,e,r,n)=>{const i=readBytes(t,e);let s=0,a,o=u=>{a||(a=!0,n&&n(u))};return new ReadableStream({pull(u){return Ye(this,null,function*(){try{const{done:h,value:f}=yield i.next();if(h){o(),u.close();return}let m=f.byteLength;if(r){let E=s+=m;r(E)}u.enqueue(new Uint8Array(f))}catch(h){throw o(h),h}})},cancel(u){return o(u),i.return()}},{highWaterMark:2})},isFetchSupported=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",isReadableStreamSupported=isFetchSupported&&typeof ReadableStream=="function",encodeText=isFetchSupported&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):t=>Ye(void 0,null,function*(){return new Uint8Array(yield new Response(t).arrayBuffer())})),test=(t,...e)=>{try{return!!t(...e)}catch(r){return!1}},supportsRequestStream=isReadableStreamSupported&&test(()=>{let t=!1;const e=new Request(platform.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),DEFAULT_CHUNK_SIZE=64*1024,supportsResponseStream=isReadableStreamSupported&&test(()=>utils$2.isReadableStream(new Response("").body)),resolvers={stream:supportsResponseStream&&(t=>t.body)};isFetchSupported&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!resolvers[e]&&(resolvers[e]=utils$2.isFunction(t[e])?r=>r[e]():(r,n)=>{throw new AxiosError$1(`Response type '${e}' is not supported`,AxiosError$1.ERR_NOT_SUPPORT,n)})})})(new Response);const getBodyLength=t=>Ye(void 0,null,function*(){if(t==null)return 0;if(utils$2.isBlob(t))return t.size;if(utils$2.isSpecCompliantForm(t))return(yield new Request(platform.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(utils$2.isArrayBufferView(t)||utils$2.isArrayBuffer(t))return t.byteLength;if(utils$2.isURLSearchParams(t)&&(t=t+""),utils$2.isString(t))return(yield encodeText(t)).byteLength}),resolveBodyLength=(t,e)=>Ye(void 0,null,function*(){const r=utils$2.toFiniteNumber(t.getContentLength());return r==null?getBodyLength(e):r}),fetchAdapter=isFetchSupported&&(t=>Ye(void 0,null,function*(){let{url:e,method:r,data:n,signal:i,cancelToken:s,timeout:a,onDownloadProgress:o,onUploadProgress:c,responseType:u,headers:h,withCredentials:f="same-origin",fetchOptions:m}=resolveConfig(t);u=u?(u+"").toLowerCase():"text";let E=composeSignals([i,s&&s.toAbortSignal()],a),g;const p=E&&E.unsubscribe&&(()=>{E.unsubscribe()});let _;try{if(c&&supportsRequestStream&&r!=="get"&&r!=="head"&&(_=yield resolveBodyLength(h,n))!==0){let j=new Request(e,{method:"POST",body:n,duplex:"half"}),ee;if(utils$2.isFormData(n)&&(ee=j.headers.get("content-type"))&&h.setContentType(ee),j.body){const[x,M]=progressEventDecorator(_,progressEventReducer(asyncDecorator(c)));n=trackStream(j.body,DEFAULT_CHUNK_SIZE,x,M)}}utils$2.isString(f)||(f=f?"include":"omit");const A="credentials"in Request.prototype;g=new Request(e,Br(Er({},m),{signal:E,method:r.toUpperCase(),headers:h.normalize().toJSON(),body:n,duplex:"half",credentials:A?f:void 0}));let H=yield fetch(g);const te=supportsResponseStream&&(u==="stream"||u==="response");if(supportsResponseStream&&(o||te&&p)){const j={};["status","statusText","headers"].forEach(T=>{j[T]=H[T]});const ee=utils$2.toFiniteNumber(H.headers.get("content-length")),[x,M]=o&&progressEventDecorator(ee,progressEventReducer(asyncDecorator(o),!0))||[];H=new Response(trackStream(H.body,DEFAULT_CHUNK_SIZE,x,()=>{M&&M(),p&&p()}),j)}u=u||"text";let ne=yield resolvers[utils$2.findKey(resolvers,u)||"text"](H,t);return!te&&p&&p(),yield new Promise((j,ee)=>{settle(j,ee,{data:ne,headers:AxiosHeaders$1.from(H.headers),status:H.status,statusText:H.statusText,config:t,request:g})})}catch(A){throw p&&p(),A&&A.name==="TypeError"&&/fetch/i.test(A.message)?Object.assign(new AxiosError$1("Network Error",AxiosError$1.ERR_NETWORK,t,g),{cause:A.cause||A}):AxiosError$1.from(A,A&&A.code,t,g)}})),knownAdapters={http:httpAdapter,xhr:xhrAdapter,fetch:fetchAdapter};utils$2.forEach(knownAdapters,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch(r){}Object.defineProperty(t,"adapterName",{value:e})}});const renderReason=t=>`- ${t}`,isResolvedHandle=t=>utils$2.isFunction(t)||t===null||t===!1,adapters={getAdapter:t=>{t=utils$2.isArray(t)?t:[t];const{length:e}=t;let r,n;const i={};for(let s=0;s<e;s++){r=t[s];let a;if(n=r,!isResolvedHandle(r)&&(n=knownAdapters[(a=String(r)).toLowerCase()],n===void 0))throw new AxiosError$1(`Unknown adapter '${a}'`);if(n)break;i[a||"#"+s]=n}if(!n){const s=Object.entries(i).map(([o,c])=>`adapter ${o} `+(c===!1?"is not supported by the environment":"is not available in the build"));let a=e?s.length>1?`since :
`+s.map(renderReason).join(`
`):" "+renderReason(s[0]):"as no adapter specified";throw new AxiosError$1("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return n},adapters:knownAdapters};function throwIfCancellationRequested(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new CanceledError$1(null,t)}function dispatchRequest(t){return throwIfCancellationRequested(t),t.headers=AxiosHeaders$1.from(t.headers),t.data=transformData.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(t.adapter||defaults.adapter)(t).then(function(n){return throwIfCancellationRequested(t),n.data=transformData.call(t,t.transformResponse,n),n.headers=AxiosHeaders$1.from(n.headers),n},function(n){return isCancel$1(n)||(throwIfCancellationRequested(t),n&&n.response&&(n.response.data=transformData.call(t,t.transformResponse,n.response),n.response.headers=AxiosHeaders$1.from(n.response.headers))),Promise.reject(n)})}const VERSION$1="1.8.1",validators$1={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{validators$1[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const deprecatedWarnings={};validators$1.transitional=function(e,r,n){function i(s,a){return"[Axios v"+VERSION$1+"] Transitional option '"+s+"'"+a+(n?". "+n:"")}return(s,a,o)=>{if(e===!1)throw new AxiosError$1(i(a," has been removed"+(r?" in "+r:"")),AxiosError$1.ERR_DEPRECATED);return r&&!deprecatedWarnings[a]&&(deprecatedWarnings[a]=!0,console.warn(i(a," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(s,a,o):!0}};validators$1.spelling=function(e){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function assertOptions(t,e,r){if(typeof t!="object")throw new AxiosError$1("options must be an object",AxiosError$1.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let i=n.length;for(;i-- >0;){const s=n[i],a=e[s];if(a){const o=t[s],c=o===void 0||a(o,s,t);if(c!==!0)throw new AxiosError$1("option "+s+" must be "+c,AxiosError$1.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new AxiosError$1("Unknown option "+s,AxiosError$1.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;let Axios$1=class{constructor(e){this.defaults=e,this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}request(e,r){return Ye(this,null,function*(){try{return yield this._request(e,r)}catch(n){if(n instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}catch(a){}}throw n}})}_request(e,r){typeof e=="string"?(r=r||{},r.url=e):r=e||{},r=mergeConfig$1(this.defaults,r);const{transitional:n,paramsSerializer:i,headers:s}=r;n!==void 0&&validator.assertOptions(n,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),i!=null&&(utils$2.isFunction(i)?r.paramsSerializer={serialize:i}:validator.assertOptions(i,{encode:validators.function,serialize:validators.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),validator.assertOptions(r,{baseUrl:validators.spelling("baseURL"),withXsrfToken:validators.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let a=s&&utils$2.merge(s.common,s[r.method]);s&&utils$2.forEach(["delete","get","head","post","put","patch","common"],g=>{delete s[g]}),r.headers=AxiosHeaders$1.concat(a,s);const o=[];let c=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(r)===!1||(c=c&&p.synchronous,o.unshift(p.fulfilled,p.rejected))});const u=[];this.interceptors.response.forEach(function(p){u.push(p.fulfilled,p.rejected)});let h,f=0,m;if(!c){const g=[dispatchRequest.bind(this),void 0];for(g.unshift.apply(g,o),g.push.apply(g,u),m=g.length,h=Promise.resolve(r);f<m;)h=h.then(g[f++],g[f++]);return h}m=o.length;let E=r;for(f=0;f<m;){const g=o[f++],p=o[f++];try{E=g(E)}catch(_){p.call(this,_);break}}try{h=dispatchRequest.call(this,E)}catch(g){return Promise.reject(g)}for(f=0,m=u.length;f<m;)h=h.then(u[f++],u[f++]);return h}getUri(e){e=mergeConfig$1(this.defaults,e);const r=buildFullPath(e.baseURL,e.url,e.allowAbsoluteUrls);return buildURL(r,e.params,e.paramsSerializer)}};utils$2.forEach(["delete","get","head","options"],function(e){Axios$1.prototype[e]=function(r,n){return this.request(mergeConfig$1(n||{},{method:e,url:r,data:(n||{}).data}))}});utils$2.forEach(["post","put","patch"],function(e){function r(n){return function(s,a,o){return this.request(mergeConfig$1(o||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:a}))}}Axios$1.prototype[e]=r(),Axios$1.prototype[e+"Form"]=r(!0)});let CancelToken$1=class Qa{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});const n=this;this.promise.then(i=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](i);n._listeners=null}),this.promise.then=i=>{let s;const a=new Promise(o=>{n.subscribe(o),s=o}).then(i);return a.cancel=function(){n.unsubscribe(s)},a},e(function(s,a,o){n.reason||(n.reason=new CanceledError$1(s,a,o),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const e=new AbortController,r=n=>{e.abort(n)};return this.subscribe(r),e.signal.unsubscribe=()=>this.unsubscribe(r),e.signal}static source(){let e;return{token:new Qa(function(i){e=i}),cancel:e}}};function spread$1(t){return function(r){return t.apply(null,r)}}function isAxiosError$1(t){return utils$2.isObject(t)&&t.isAxiosError===!0}const HttpStatusCode$1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode$1).forEach(([t,e])=>{HttpStatusCode$1[e]=t});function createInstance(t){const e=new Axios$1(t),r=bind(Axios$1.prototype.request,e);return utils$2.extend(r,Axios$1.prototype,e,{allOwnKeys:!0}),utils$2.extend(r,e,null,{allOwnKeys:!0}),r.create=function(i){return createInstance(mergeConfig$1(t,i))},r}const axios=createInstance(defaults);axios.Axios=Axios$1;axios.CanceledError=CanceledError$1;axios.CancelToken=CancelToken$1;axios.isCancel=isCancel$1;axios.VERSION=VERSION$1;axios.toFormData=toFormData$1;axios.AxiosError=AxiosError$1;axios.Cancel=axios.CanceledError;axios.all=function(e){return Promise.all(e)};axios.spread=spread$1;axios.isAxiosError=isAxiosError$1;axios.mergeConfig=mergeConfig$1;axios.AxiosHeaders=AxiosHeaders$1;axios.formToJSON=t=>formDataToJSON(utils$2.isHTMLForm(t)?new FormData(t):t);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode$1;axios.default=axios;const{Axios,AxiosError,CanceledError,isCancel,CancelToken,VERSION,all,Cancel,isAxiosError,spread,toFormData,AxiosHeaders,HttpStatusCode,formToJSON,getAdapter,mergeConfig}=axios,configURL={API_URL:"https://doctec.duckdns.org/fast"};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var XLSX={};XLSX.version="0.18.5";var current_ansi=1252,VALID_ANSI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],CS2CP={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},set_ansi=function(t){VALID_ANSI.indexOf(t)!=-1&&(current_ansi=CS2CP[0]=t)};function reset_ansi(){set_ansi(1252)}var set_cp=function(t){set_ansi(t)};function reset_cp(){set_cp(1200),reset_ansi()}function char_codes(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function utf16leread(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function utf16beread(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var debom=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?utf16leread(t.slice(2)):e==254&&r==255?utf16beread(t.slice(2)):e==65279?t.slice(1):t},_getchar=function(e){return String.fromCharCode(e)},_getansi=function(e){return String.fromCharCode(e)},$cptable,Base64_map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Base64_encode(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,c=0,u=0;u<t.length;)r=t.charCodeAt(u++),s=r>>2,n=t.charCodeAt(u++),a=(r&3)<<4|n>>4,i=t.charCodeAt(u++),o=(n&15)<<2|i>>6,c=i&63,isNaN(n)?o=c=64:isNaN(i)&&(c=64),e+=Base64_map.charAt(s)+Base64_map.charAt(a)+Base64_map.charAt(o)+Base64_map.charAt(c);return e}function Base64_decode(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)s=Base64_map.indexOf(t.charAt(u++)),a=Base64_map.indexOf(t.charAt(u++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=Base64_map.indexOf(t.charAt(u++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),c=Base64_map.indexOf(t.charAt(u++)),i=(o&3)<<6|c,c!==64&&(e+=String.fromCharCode(i));return e}var has_buf=function(){return typeof Buffer!="undefined"&&typeof process!="undefined"&&typeof process.versions!="undefined"&&!!process.versions.node}(),Buffer_from=function(){if(typeof Buffer!="undefined"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch(e){t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function new_raw_buf(t){return has_buf?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array!="undefined"?new Uint8Array(t):new Array(t)}function new_unsafe_buf(t){return has_buf?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array!="undefined"?new Uint8Array(t):new Array(t)}var s2a=function(e){return has_buf?Buffer_from(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function s2ab(t){if(typeof ArrayBuffer=="undefined")return s2a(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function a2s(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function a2u(t){if(typeof Uint8Array=="undefined")throw new Error("Unsupported");return new Uint8Array(t)}function ab2a(t){if(typeof ArrayBuffer=="undefined")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return ab2a(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var bconcat=has_buf?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Buffer_from(e)}))}:function(t){if(typeof Uint8Array!="undefined"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function utf8decode(t){for(var e=[],r=0,n=t.length+250,i=new_raw_buf(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=new_raw_buf(65535),n=65530)}return e.push(i.slice(0,r)),bconcat(e)}var chr0=/\u0000/g,chr1=/[\u0001-\u0006]/g;function _strrev(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function pad0(t,e){var r=""+t;return r.length>=e?r:fill("0",e-r.length)+r}function pad_(t,e){var r=""+t;return r.length>=e?r:fill(" ",e-r.length)+r}function rpad_(t,e){var r=""+t;return r.length>=e?r:r+fill(" ",e-r.length)}function pad0r1(t,e){var r=""+Math.round(t);return r.length>=e?r:fill("0",e-r.length)+r}function pad0r2(t,e){var r=""+t;return r.length>=e?r:fill("0",e-r.length)+r}var p2_32=Math.pow(2,32);function pad0r(t,e){if(t>p2_32||t<-p2_32)return pad0r1(t,e);var r=Math.round(t);return pad0r2(r,e)}function SSF_isgeneral(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var days=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],months=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function SSF_init_table(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "',t}var table_fmt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "'},SSF_default_map={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SSF_default_str={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function SSF_frac(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,c=1,u=0,h=0,f=Math.floor(i);u<e&&(f=Math.floor(i),o=f*a+s,h=f*u+c,!(i-f<5e-8));)i=1/(i-f),s=a,a=o,c=u,u=h;if(h>e&&(u>e?(h=c,o=s):(h=u,o=a)),!r)return[0,n*o,h];var m=Math.floor(n*o/h);return[m,n*o-m*h,h]}function SSF_parse_date_code(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=SSF_fix_hijri(c,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var SSFbasedate=new Date(1899,11,31,0,0,0),SSFdnthresh=SSFbasedate.getTime(),SSFbase1904=new Date(1900,2,1,0,0,0);function datenum_local(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=SSFbase1904&&(r+=24*60*60*1e3),(r-(SSFdnthresh+(t.getTimezoneOffset()-SSFbasedate.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function SSF_strip_decimal(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function SSF_normalize_exp(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SSF_small_exp(t){var e=t<0?12:11,r=SSF_strip_decimal(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function SSF_large_exp(t){var e=SSF_strip_decimal(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function SSF_general_num(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=SSF_small_exp(t):e===10?r=t.toFixed(10).substr(0,12):r=SSF_large_exp(t),SSF_strip_decimal(SSF_normalize_exp(r.toUpperCase()))}function SSF_general(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):SSF_general_num(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return SSF_format(14,datenum_local(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function SSF_fix_hijri(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function SSF_write_date(t,e,r,n){var i="",s=0,a=0,o=r.y,c,u=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,u=e.length;break;case 3:return months[r.m-1][1];case 5:return months[r.m-1][0];default:return months[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,u=e.length;break;case 3:return days[r.q][0];default:return days[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?pad0(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=pad0(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:c=o,u=1;break}var h=u>0?pad0(c,u):"";return h}function commaify(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var pct1=/%/g;function write_num_pct(t,e,r){var n=e.replace(pct1,""),i=e.length-n.length;return write_num(t,n,r*Math.pow(10,2*i))+fill("%",i)}function write_num_cm(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return write_num(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function write_num_exp(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+write_num_exp(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,h){return c+u+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var frac1=/# (\?+)( ?)\/( ?)(\d+)/;function write_num_f1(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?fill(" ",t[1].length+1+t[4].length):pad_(a,t[1].length)+t[2]+"/"+t[3]+pad0(o,t[4].length))}function write_num_f2(t,e,r){return r+(e===0?"":""+e)+fill(" ",t[1].length+2+t[4].length)}var dec1=/^#*0*\.([0#]+)/,closeparen=/\).*[0#]/,phone=/\(###\) ###\\?-####/;function hashq(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function rnd(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function dec(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function carry(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function flr(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function write_num_flt(t,e,r){if(t.charCodeAt(0)===40&&!e.match(closeparen)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?write_num_flt("n",n,r):"("+write_num_flt("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return write_num_cm(t,e,r);if(e.indexOf("%")!==-1)return write_num_pct(t,e,r);if(e.indexOf("E")!==-1)return write_num_exp(e,r);if(e.charCodeAt(0)===36)return"$"+write_num_flt(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,c=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+pad0r(c,e.length);if(e.match(/^[#?]+$/))return i=pad0r(r,0),i==="0"&&(i=""),i.length>e.length?i:hashq(e.substr(0,e.length-i.length))+i;if(s=e.match(frac1))return write_num_f1(s,c,u);if(e.match(/^#+0+$/))return u+pad0r(c,e.length-e.indexOf("0"));if(s=e.match(dec1))return i=rnd(r,s[1].length).replace(/^([^\.]+)$/,"$1."+hashq(s[1])).replace(/\.$/,"."+hashq(s[1])).replace(/\.(\d*)$/,function(g,p){return"."+p+fill("0",hashq(s[1]).length-p.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+rnd(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+commaify(pad0r(c,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+write_num_flt(t,e,-r):commaify(""+(Math.floor(r)+carry(r,s[1].length)))+"."+pad0(dec(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return write_num_flt(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=_strrev(write_num_flt(t,e.replace(/[\\-]/g,""),r)),a=0,_strrev(_strrev(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(e.match(phone))return i=write_num_flt(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=SSF_frac(c,Math.pow(10,a)-1,!1),i=""+u,h=write_num("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=rpad_(o[2],a),h.length<s[4].length&&(h=hashq(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=SSF_frac(c,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?pad_(o[1],a)+s[2]+"/"+s[3]+rpad_(o[2],a):fill(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=pad0r(r,0),e.length<=i.length?i:hashq(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=e.indexOf(".")-a,m=e.length-i.length-f;return hashq(e.substr(0,f)+i+e.substr(e.length-m))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=dec(r,s[1].length),r<0?"-"+write_num_flt(t,e,-r):commaify(flr(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?pad0(0,3-g.length):"")+g})+"."+pad0(a,s[1].length);switch(e){case"###,##0.00":return write_num_flt(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var E=commaify(pad0r(c,0));return E!=="0"?u+E:"";case"###,###.00":return write_num_flt(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return write_num_flt(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function write_num_cm2(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return write_num(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function write_num_pct2(t,e,r){var n=e.replace(pct1,""),i=e.length-n.length;return write_num(t,n,r*Math.pow(10,2*i))+fill("%",i)}function write_num_exp2(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+write_num_exp2(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,h){return c+u+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function write_num_int(t,e,r){if(t.charCodeAt(0)===40&&!e.match(closeparen)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?write_num_int("n",n,r):"("+write_num_int("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return write_num_cm2(t,e,r);if(e.indexOf("%")!==-1)return write_num_pct2(t,e,r);if(e.indexOf("E")!==-1)return write_num_exp2(e,r);if(e.charCodeAt(0)===36)return"$"+write_num_int(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,c=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+pad0(c,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:hashq(e.substr(0,e.length-i.length))+i;if(s=e.match(frac1))return write_num_f2(s,c,u);if(e.match(/^#+0+$/))return u+pad0(c,e.length-e.indexOf("0"));if(s=e.match(dec1))return i=(""+r).replace(/^([^\.]+)$/,"$1."+hashq(s[1])).replace(/\.$/,"."+hashq(s[1])),i=i.replace(/\.(\d*)$/,function(g,p){return"."+p+fill("0",hashq(s[1]).length-p.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+commaify(""+c);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+write_num_int(t,e,-r):commaify(""+r)+"."+fill("0",s[1].length);if(s=e.match(/^#,#*,#0/))return write_num_int(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=_strrev(write_num_int(t,e.replace(/[\\-]/g,""),r)),a=0,_strrev(_strrev(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(e.match(phone))return i=write_num_int(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=SSF_frac(c,Math.pow(10,a)-1,!1),i=""+u,h=write_num("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=rpad_(o[2],a),h.length<s[4].length&&(h=hashq(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=SSF_frac(c,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?pad_(o[1],a)+s[2]+"/"+s[3]+rpad_(o[2],a):fill(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:hashq(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=e.indexOf(".")-a,m=e.length-i.length-f;return hashq(e.substr(0,f)+i+e.substr(e.length-m))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+write_num_int(t,e,-r):commaify(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?pad0(0,3-g.length):"")+g})+"."+pad0(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var E=commaify(""+c);return E!=="0"?u+E:"";default:if(e.match(/\.[0#?]*$/))return write_num_int(t,e.slice(0,e.lastIndexOf(".")),r)+hashq(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function write_num(t,e,r){return(r|0)===r?write_num_int(t,e,r):write_num_flt(t,e,r)}function SSF_split_fmt(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var SSF_abstime=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fmt_is_date(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":SSF_isgeneral(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"ä¸Š":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(SSF_abstime))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function eval_fmt(t,e,r,n){for(var i=[],s="",a=0,o="",c="t",u,h,f,m="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!SSF_isgeneral(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(f=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++a;break;case"\\":var E=t.charAt(++a),g=E==="("||E===")"?E:"t";i[i.length]={t:g,v:E},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(u==null&&(u=SSF_parse_date_code(e,r,t.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},c=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=SSF_parse_date_code(e,r),u==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),i[i.length]={t:o,v:s},c=o;break;case"A":case"a":case"ä¸Š":var p={t:o,v:o};if(u==null&&(u=SSF_parse_date_code(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",m="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",a+=5,m="h"):t.substr(a,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ"?(u!=null&&(p.v=u.H>=12?"ä¸‹åˆ":"ä¸Šåˆ"),p.t="T",a+=5,m="h"):(p.t="t",++a),u==null&&p.t==="T")return"";i[i.length]=p,c=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(SSF_abstime)){if(u==null&&(u=SSF_parse_date_code(e,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",fmt_is_date(t)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},c=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=â‚¬acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var _=0,A=0,H;for(a=i.length-1,c="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=m,c="h",_<1&&(_=1);break;case"s":(H=i[a].v.match(/\.0+$/))&&(A=Math.max(A,H[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":c=i[a].t;break;case"m":c==="s"&&(i[a].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&i[a].v.match(/[Hh]/)&&(_=1),_<2&&i[a].v.match(/[Mm]/)&&(_=2),_<3&&i[a].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var te="",ne;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=SSF_write_date(i[a].t.charCodeAt(0),i[a].v,u,A),i[a].t="t";break;case"n":case"?":for(ne=a+1;i[ne]!=null&&((o=i[ne].t)==="?"||o==="D"||(o===" "||o==="t")&&i[ne+1]!=null&&(i[ne+1].t==="?"||i[ne+1].t==="t"&&i[ne+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[ne].v==="/"||i[ne].v===" "&&i[ne+1]!=null&&i[ne+1].t=="?"));)i[a].v+=i[ne].v,i[ne]={v:"",t:";"},++ne;te+=i[a].v,a=ne-1;break;case"G":i[a].t="t",i[a].v=SSF_general(e,r);break}var j="",ee,x;if(te.length>0){te.charCodeAt(0)==40?(ee=e<0&&te.charCodeAt(0)===45?-e:e,x=write_num("n",te,ee)):(ee=e<0&&n>1?-e:e,x=write_num("n",te,ee),ee<0&&i[0]&&i[0].t=="t"&&(x=x.substr(1),i[0].v="-"+i[0].v)),ne=x.length-1;var M=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){M=a;break}var T=i.length;if(M===i.length&&x.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(ne>=i[a].v.length-1?(ne-=i[a].v.length,i[a].v=x.substr(ne+1,i[a].v.length)):ne<0?i[a].v="":(i[a].v=x.substr(0,ne+1),ne=-1),i[a].t="t",T=a);ne>=0&&T<i.length&&(i[T].v=x.substr(0,ne+1)+i[T].v)}else if(M!==i.length&&x.indexOf("E")===-1){for(ne=x.indexOf(".")-1,a=M;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(h=i[a].v.indexOf(".")>-1&&a===M?i[a].v.indexOf(".")-1:i[a].v.length-1,j=i[a].v.substr(h+1);h>=0;--h)ne>=0&&(i[a].v.charAt(h)==="0"||i[a].v.charAt(h)==="#")&&(j=x.charAt(ne--)+j);i[a].v=j,i[a].t="t",T=a}for(ne>=0&&T<i.length&&(i[T].v=x.substr(0,ne+1)+i[T].v),ne=x.indexOf(".")+1,a=M;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==M)){for(h=i[a].v.indexOf(".")>-1&&a===M?i[a].v.indexOf(".")+1:0,j=i[a].v.substr(0,h);h<i[a].v.length;++h)ne<x.length&&(j+=x.charAt(ne++));i[a].v=j,i[a].t="t",T=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(ee=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=write_num(i[a].t,i[a].v,ee),i[a].t="t");var O="";for(a=0;a!==i.length;++a)i[a]!=null&&(O+=i[a].v);return O}var cfregex2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function chkcond(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function choose_fmt(t,e){var r=SSF_split_fmt(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(cfregex2),o=r[1].match(cfregex2);return chkcond(e,a)?[n,r[0]]:chkcond(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function SSF_format(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:table_fmt)[t],n==null&&(n=r.table&&r.table[SSF_default_map[t]]||table_fmt[SSF_default_map[t]]),n==null&&(n=SSF_default_str[t]||"General");break}if(SSF_isgeneral(n,0))return SSF_general(e,r);e instanceof Date&&(e=datenum_local(e,r.date1904));var i=choose_fmt(n,e);if(SSF_isgeneral(i[1]))return SSF_general(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return eval_fmt(i[1],e,r,i[0])}function SSF_load(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(table_fmt[r]==null){e<0&&(e=r);continue}if(table_fmt[r]==t){e=r;break}}e<0&&(e=391)}return table_fmt[e]=t,e}function SSF_load_table(t){for(var e=0;e!=392;++e)t[e]!==void 0&&SSF_load(t[e],e)}function make_ssf(){table_fmt=SSF_init_table()}var SSFImplicit={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},dateNFregex=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dateNF_regex(t){var e=typeof t=="number"?table_fmt[t]:t;return e=e.replace(dateNFregex,"(\\d+)"),new RegExp("^"+e+"$")}function dateNF_fix(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,c=-1;(e.match(dateNFregex)||[]).forEach(function(f,m){var E=parseInt(r[m+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=E;break;case"d":s=E;break;case"h":a=E;break;case"s":c=E;break;case"m":a>=0?o=E:i=E;break}}),c>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var h=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&o==-1&&c==-1?u:n==-1&&i==-1&&s==-1?h:u+"T"+h}var CRC32=function(){var t={};t.version="1.2.0";function e(){for(var x=0,M=new Array(256),T=0;T!=256;++T)x=T,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,M[T]=x;return typeof Int32Array!="undefined"?new Int32Array(M):M}var r=e();function n(x){var M=0,T=0,O=0,R=typeof Int32Array!="undefined"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)R[O]=x[O];for(O=0;O!=256;++O)for(T=x[O],M=256+O;M<4096;M+=256)T=R[M]=T>>>8^x[T&255];var Y=[];for(O=1;O!=16;++O)Y[O-1]=typeof Int32Array!="undefined"?R.subarray(O*256,O*256+256):R.slice(O*256,O*256+256);return Y}var i=n(r),s=i[0],a=i[1],o=i[2],c=i[3],u=i[4],h=i[5],f=i[6],m=i[7],E=i[8],g=i[9],p=i[10],_=i[11],A=i[12],H=i[13],te=i[14];function ne(x,M){for(var T=M^-1,O=0,R=x.length;O<R;)T=T>>>8^r[(T^x.charCodeAt(O++))&255];return~T}function j(x,M){for(var T=M^-1,O=x.length-15,R=0;R<O;)T=te[x[R++]^T&255]^H[x[R++]^T>>8&255]^A[x[R++]^T>>16&255]^_[x[R++]^T>>>24]^p[x[R++]]^g[x[R++]]^E[x[R++]]^m[x[R++]]^f[x[R++]]^h[x[R++]]^u[x[R++]]^c[x[R++]]^o[x[R++]]^a[x[R++]]^s[x[R++]]^r[x[R++]];for(O+=15;R<O;)T=T>>>8^r[(T^x[R++])&255];return~T}function ee(x,M){for(var T=M^-1,O=0,R=x.length,Y=0,q=0;O<R;)Y=x.charCodeAt(O++),Y<128?T=T>>>8^r[(T^Y)&255]:Y<2048?(T=T>>>8^r[(T^(192|Y>>6&31))&255],T=T>>>8^r[(T^(128|Y&63))&255]):Y>=55296&&Y<57344?(Y=(Y&1023)+64,q=x.charCodeAt(O++)&1023,T=T>>>8^r[(T^(240|Y>>8&7))&255],T=T>>>8^r[(T^(128|Y>>2&63))&255],T=T>>>8^r[(T^(128|q>>6&15|(Y&3)<<4))&255],T=T>>>8^r[(T^(128|q&63))&255]):(T=T>>>8^r[(T^(224|Y>>12&15))&255],T=T>>>8^r[(T^(128|Y>>6&63))&255],T=T>>>8^r[(T^(128|Y&63))&255]);return~T}return t.table=r,t.bstr=ne,t.buf=j,t.str=ee,t}(),CFB=function(){var e={};e.version="1.2.1";function r(ye,De){for(var Re=ye.split("/"),Ie=De.split("/"),Me=0,Ne=0,et=Math.min(Re.length,Ie.length);Me<et;++Me){if(Ne=Re[Me].length-Ie[Me].length)return Ne;if(Re[Me]!=Ie[Me])return Re[Me]<Ie[Me]?-1:1}return Re.length-Ie.length}function n(ye){if(ye.charAt(ye.length-1)=="/")return ye.slice(0,-1).indexOf("/")===-1?ye:n(ye.slice(0,-1));var De=ye.lastIndexOf("/");return De===-1?ye:ye.slice(0,De+1)}function i(ye){if(ye.charAt(ye.length-1)=="/")return i(ye.slice(0,-1));var De=ye.lastIndexOf("/");return De===-1?ye:ye.slice(De+1)}function s(ye,De){typeof De=="string"&&(De=new Date(De));var Re=De.getHours();Re=Re<<6|De.getMinutes(),Re=Re<<5|De.getSeconds()>>>1,ye.write_shift(2,Re);var Ie=De.getFullYear()-1980;Ie=Ie<<4|De.getMonth()+1,Ie=Ie<<5|De.getDate(),ye.write_shift(2,Ie)}function a(ye){var De=ye.read_shift(2)&65535,Re=ye.read_shift(2)&65535,Ie=new Date,Me=Re&31;Re>>>=5;var Ne=Re&15;Re>>>=4,Ie.setMilliseconds(0),Ie.setFullYear(Re+1980),Ie.setMonth(Ne-1),Ie.setDate(Me);var et=De&31;De>>>=5;var kt=De&63;return De>>>=6,Ie.setHours(De),Ie.setMinutes(kt),Ie.setSeconds(et<<1),Ie}function o(ye){prep_blob(ye,0);for(var De={},Re=0;ye.l<=ye.length-4;){var Ie=ye.read_shift(2),Me=ye.read_shift(2),Ne=ye.l+Me,et={};switch(Ie){case 21589:Re=ye.read_shift(1),Re&1&&(et.mtime=ye.read_shift(4)),Me>5&&(Re&2&&(et.atime=ye.read_shift(4)),Re&4&&(et.ctime=ye.read_shift(4))),et.mtime&&(et.mt=new Date(et.mtime*1e3));break}ye.l=Ne,De[Ie]=et}return De}var c;function u(){return c||(c={})}function h(ye,De){if(ye[0]==80&&ye[1]==75)return Tr(ye,De);if((ye[0]|32)==109&&(ye[1]|32)==105)return He(ye,De);if(ye.length<512)throw new Error("CFB file size "+ye.length+" < 512");var Re=3,Ie=512,Me=0,Ne=0,et=0,kt=0,Rt=0,Tt=[],Ut=ye.slice(0,512);prep_blob(Ut,0);var ur=f(Ut);switch(Re=ur[0],Re){case 3:Ie=512;break;case 4:Ie=4096;break;case 0:if(ur[1]==0)return Tr(ye,De);default:throw new Error("Major Version: Expected 3 or 4 saw "+Re)}Ie!==512&&(Ut=ye.slice(0,Ie),prep_blob(Ut,28));var fr=ye.slice(0,Ie);m(Ut,Re);var Sr=Ut.read_shift(4,"i");if(Re===3&&Sr!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Sr);Ut.l+=4,et=Ut.read_shift(4,"i"),Ut.l+=4,Ut.chk("00100000","Mini Stream Cutoff Size: "),kt=Ut.read_shift(4,"i"),Me=Ut.read_shift(4,"i"),Rt=Ut.read_shift(4,"i"),Ne=Ut.read_shift(4,"i");for(var dr=-1,br=0;br<109&&(dr=Ut.read_shift(4,"i"),!(dr<0));++br)Tt[br]=dr;var Pr=E(ye,Ie);_(Rt,Ne,Pr,Ie,Tt);var jr=H(Pr,et,Tt,Ie);jr[et].name="!Directory",Me>0&&kt!==q&&(jr[kt].name="!MiniFAT"),jr[Tt[0]].name="!FAT",jr.fat_addrs=Tt,jr.ssz=Ie;var Ur={},Gr=[],un=[],hn=[];te(et,jr,Pr,Gr,Me,Ur,un,kt),g(un,hn,Gr),Gr.shift();var An={FileIndex:un,FullPaths:hn};return De&&De.raw&&(An.raw={header:fr,sectors:Pr}),An}function f(ye){if(ye[ye.l]==80&&ye[ye.l+1]==75)return[0,0];ye.chk(me,"Header Signature: "),ye.l+=16;var De=ye.read_shift(2,"u");return[ye.read_shift(2,"u"),De]}function m(ye,De){var Re=9;switch(ye.l+=2,Re=ye.read_shift(2)){case 9:if(De!=3)throw new Error("Sector Shift: Expected 9 saw "+Re);break;case 12:if(De!=4)throw new Error("Sector Shift: Expected 12 saw "+Re);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Re)}ye.chk("0600","Mini Sector Shift: "),ye.chk("000000000000","Reserved: ")}function E(ye,De){for(var Re=Math.ceil(ye.length/De)-1,Ie=[],Me=1;Me<Re;++Me)Ie[Me-1]=ye.slice(Me*De,(Me+1)*De);return Ie[Re-1]=ye.slice(Re*De),Ie}function g(ye,De,Re){for(var Ie=0,Me=0,Ne=0,et=0,kt=0,Rt=Re.length,Tt=[],Ut=[];Ie<Rt;++Ie)Tt[Ie]=Ut[Ie]=Ie,De[Ie]=Re[Ie];for(;kt<Ut.length;++kt)Ie=Ut[kt],Me=ye[Ie].L,Ne=ye[Ie].R,et=ye[Ie].C,Tt[Ie]===Ie&&(Me!==-1&&Tt[Me]!==Me&&(Tt[Ie]=Tt[Me]),Ne!==-1&&Tt[Ne]!==Ne&&(Tt[Ie]=Tt[Ne])),et!==-1&&(Tt[et]=Ie),Me!==-1&&Ie!=Tt[Ie]&&(Tt[Me]=Tt[Ie],Ut.lastIndexOf(Me)<kt&&Ut.push(Me)),Ne!==-1&&Ie!=Tt[Ie]&&(Tt[Ne]=Tt[Ie],Ut.lastIndexOf(Ne)<kt&&Ut.push(Ne));for(Ie=1;Ie<Rt;++Ie)Tt[Ie]===Ie&&(Ne!==-1&&Tt[Ne]!==Ne?Tt[Ie]=Tt[Ne]:Me!==-1&&Tt[Me]!==Me&&(Tt[Ie]=Tt[Me]));for(Ie=1;Ie<Rt;++Ie)if(ye[Ie].type!==0){if(kt=Ie,kt!=Tt[kt])do kt=Tt[kt],De[Ie]=De[kt]+"/"+De[Ie];while(kt!==0&&Tt[kt]!==-1&&kt!=Tt[kt]);Tt[Ie]=-1}for(De[0]+="/",Ie=1;Ie<Rt;++Ie)ye[Ie].type!==2&&(De[Ie]+="/")}function p(ye,De,Re){for(var Ie=ye.start,Me=ye.size,Ne=[],et=Ie;Re&&Me>0&&et>=0;)Ne.push(De.slice(et*Y,et*Y+Y)),Me-=Y,et=__readInt32LE(Re,et*4);return Ne.length===0?new_buf(0):bconcat(Ne).slice(0,ye.size)}function _(ye,De,Re,Ie,Me){var Ne=q;if(ye===q){if(De!==0)throw new Error("DIFAT chain shorter than expected")}else if(ye!==-1){var et=Re[ye],kt=(Ie>>>2)-1;if(!et)return;for(var Rt=0;Rt<kt&&(Ne=__readInt32LE(et,Rt*4))!==q;++Rt)Me.push(Ne);_(__readInt32LE(et,Ie-4),De-1,Re,Ie,Me)}}function A(ye,De,Re,Ie,Me){var Ne=[],et=[];Me||(Me=[]);var kt=Ie-1,Rt=0,Tt=0;for(Rt=De;Rt>=0;){Me[Rt]=!0,Ne[Ne.length]=Rt,et.push(ye[Rt]);var Ut=Re[Math.floor(Rt*4/Ie)];if(Tt=Rt*4&kt,Ie<4+Tt)throw new Error("FAT boundary crossed: "+Rt+" 4 "+Ie);if(!ye[Ut])break;Rt=__readInt32LE(ye[Ut],Tt)}return{nodes:Ne,data:__toBuffer([et])}}function H(ye,De,Re,Ie){var Me=ye.length,Ne=[],et=[],kt=[],Rt=[],Tt=Ie-1,Ut=0,ur=0,fr=0,Sr=0;for(Ut=0;Ut<Me;++Ut)if(kt=[],fr=Ut+De,fr>=Me&&(fr-=Me),!et[fr]){Rt=[];var dr=[];for(ur=fr;ur>=0;){dr[ur]=!0,et[ur]=!0,kt[kt.length]=ur,Rt.push(ye[ur]);var br=Re[Math.floor(ur*4/Ie)];if(Sr=ur*4&Tt,Ie<4+Sr)throw new Error("FAT boundary crossed: "+ur+" 4 "+Ie);if(!ye[br]||(ur=__readInt32LE(ye[br],Sr),dr[ur]))break}Ne[fr]={nodes:kt,data:__toBuffer([Rt])}}return Ne}function te(ye,De,Re,Ie,Me,Ne,et,kt){for(var Rt=0,Tt=Ie.length?2:0,Ut=De[ye].data,ur=0,fr=0,Sr;ur<Ut.length;ur+=128){var dr=Ut.slice(ur,ur+128);prep_blob(dr,64),fr=dr.read_shift(2),Sr=__utf16le(dr,0,fr-Tt),Ie.push(Sr);var br={name:Sr,type:dr.read_shift(1),color:dr.read_shift(1),L:dr.read_shift(4,"i"),R:dr.read_shift(4,"i"),C:dr.read_shift(4,"i"),clsid:dr.read_shift(16),state:dr.read_shift(4,"i"),start:0,size:0},Pr=dr.read_shift(2)+dr.read_shift(2)+dr.read_shift(2)+dr.read_shift(2);Pr!==0&&(br.ct=ne(dr,dr.l-8));var jr=dr.read_shift(2)+dr.read_shift(2)+dr.read_shift(2)+dr.read_shift(2);jr!==0&&(br.mt=ne(dr,dr.l-8)),br.start=dr.read_shift(4,"i"),br.size=dr.read_shift(4,"i"),br.size<0&&br.start<0&&(br.size=br.type=0,br.start=q,br.name=""),br.type===5?(Rt=br.start,Me>0&&Rt!==q&&(De[Rt].name="!StreamData")):br.size>=4096?(br.storage="fat",De[br.start]===void 0&&(De[br.start]=A(Re,br.start,De.fat_addrs,De.ssz)),De[br.start].name=br.name,br.content=De[br.start].data.slice(0,br.size)):(br.storage="minifat",br.size<0?br.size=0:Rt!==q&&br.start!==q&&De[Rt]&&(br.content=p(br,De[Rt].data,(De[kt]||{}).data))),br.content&&prep_blob(br.content,0),Ne[Sr]=br,et.push(br)}}function ne(ye,De){return new Date((__readUInt32LE(ye,De+4)/1e7*Math.pow(2,32)+__readUInt32LE(ye,De)/1e7-11644473600)*1e3)}function j(ye,De){return u(),h(c.readFileSync(ye),De)}function ee(ye,De){var Re=De&&De.type;switch(Re||has_buf&&Buffer.isBuffer(ye)&&(Re="buffer"),Re||"base64"){case"file":return j(ye,De);case"base64":return h(s2a(Base64_decode(ye)),De);case"binary":return h(s2a(ye),De)}return h(ye,De)}function x(ye,De){var Re=De||{},Ie=Re.root||"Root Entry";if(ye.FullPaths||(ye.FullPaths=[]),ye.FileIndex||(ye.FileIndex=[]),ye.FullPaths.length!==ye.FileIndex.length)throw new Error("inconsistent CFB structure");ye.FullPaths.length===0&&(ye.FullPaths[0]=Ie+"/",ye.FileIndex[0]={name:Ie,type:5}),Re.CLSID&&(ye.FileIndex[0].clsid=Re.CLSID),M(ye)}function M(ye){var De="Sh33tJ5";if(!CFB.find(ye,"/"+De)){var Re=new_buf(4);Re[0]=55,Re[1]=Re[3]=50,Re[2]=54,ye.FileIndex.push({name:De,type:2,content:Re,size:4,L:69,R:69,C:69}),ye.FullPaths.push(ye.FullPaths[0]+De),T(ye)}}function T(ye,De){x(ye);for(var Re=!1,Ie=!1,Me=ye.FullPaths.length-1;Me>=0;--Me){var Ne=ye.FileIndex[Me];switch(Ne.type){case 0:Ie?Re=!0:(ye.FileIndex.pop(),ye.FullPaths.pop());break;case 1:case 2:case 5:Ie=!0,isNaN(Ne.R*Ne.L*Ne.C)&&(Re=!0),Ne.R>-1&&Ne.L>-1&&Ne.R==Ne.L&&(Re=!0);break;default:Re=!0;break}}if(!(!Re&&!De)){var et=new Date(1987,1,19),kt=0,Rt=Object.create?Object.create(null):{},Tt=[];for(Me=0;Me<ye.FullPaths.length;++Me)Rt[ye.FullPaths[Me]]=!0,ye.FileIndex[Me].type!==0&&Tt.push([ye.FullPaths[Me],ye.FileIndex[Me]]);for(Me=0;Me<Tt.length;++Me){var Ut=n(Tt[Me][0]);Ie=Rt[Ut],Ie||(Tt.push([Ut,{name:i(Ut).replace("/",""),type:1,clsid:Ee,ct:et,mt:et,content:null}]),Rt[Ut]=!0)}for(Tt.sort(function(Sr,dr){return r(Sr[0],dr[0])}),ye.FullPaths=[],ye.FileIndex=[],Me=0;Me<Tt.length;++Me)ye.FullPaths[Me]=Tt[Me][0],ye.FileIndex[Me]=Tt[Me][1];for(Me=0;Me<Tt.length;++Me){var ur=ye.FileIndex[Me],fr=ye.FullPaths[Me];if(ur.name=i(fr).replace("/",""),ur.L=ur.R=ur.C=-(ur.color=1),ur.size=ur.content?ur.content.length:0,ur.start=0,ur.clsid=ur.clsid||Ee,Me===0)ur.C=Tt.length>1?1:-1,ur.size=0,ur.type=5;else if(fr.slice(-1)=="/"){for(kt=Me+1;kt<Tt.length&&n(ye.FullPaths[kt])!=fr;++kt);for(ur.C=kt>=Tt.length?-1:kt,kt=Me+1;kt<Tt.length&&n(ye.FullPaths[kt])!=n(fr);++kt);ur.R=kt>=Tt.length?-1:kt,ur.type=1}else n(ye.FullPaths[Me+1]||"")==n(fr)&&(ur.R=Me+1),ur.type=2}}}function O(ye,De){var Re=De||{};if(Re.fileType=="mad")return $e(ye,Re);switch(T(ye),Re.fileType){case"zip":return ze(ye,Re)}var Ie=function(Sr){for(var dr=0,br=0,Pr=0;Pr<Sr.FileIndex.length;++Pr){var jr=Sr.FileIndex[Pr];if(jr.content){var Ur=jr.content.length;Ur>0&&(Ur<4096?dr+=Ur+63>>6:br+=Ur+511>>9)}}for(var Gr=Sr.FullPaths.length+3>>2,un=dr+7>>3,hn=dr+127>>7,An=un+br+Gr+hn,dn=An+127>>7,vn=dn<=109?0:Math.ceil((dn-109)/127);An+dn+vn+127>>7>dn;)vn=++dn<=109?0:Math.ceil((dn-109)/127);var Or=[1,vn,dn,hn,Gr,br,dr,0];return Sr.FileIndex[0].size=dr<<6,Or[7]=(Sr.FileIndex[0].start=Or[0]+Or[1]+Or[2]+Or[3]+Or[4]+Or[5])+(Or[6]+7>>3),Or}(ye),Me=new_buf(Ie[7]<<9),Ne=0,et=0;{for(Ne=0;Ne<8;++Ne)Me.write_shift(1,xe[Ne]);for(Ne=0;Ne<8;++Ne)Me.write_shift(2,0);for(Me.write_shift(2,62),Me.write_shift(2,3),Me.write_shift(2,65534),Me.write_shift(2,9),Me.write_shift(2,6),Ne=0;Ne<3;++Ne)Me.write_shift(2,0);for(Me.write_shift(4,0),Me.write_shift(4,Ie[2]),Me.write_shift(4,Ie[0]+Ie[1]+Ie[2]+Ie[3]-1),Me.write_shift(4,0),Me.write_shift(4,4096),Me.write_shift(4,Ie[3]?Ie[0]+Ie[1]+Ie[2]-1:q),Me.write_shift(4,Ie[3]),Me.write_shift(-4,Ie[1]?Ie[0]-1:q),Me.write_shift(4,Ie[1]),Ne=0;Ne<109;++Ne)Me.write_shift(-4,Ne<Ie[2]?Ie[1]+Ne:-1)}if(Ie[1])for(et=0;et<Ie[1];++et){for(;Ne<236+et*127;++Ne)Me.write_shift(-4,Ne<Ie[2]?Ie[1]+Ne:-1);Me.write_shift(-4,et===Ie[1]-1?q:et+1)}var kt=function(Sr){for(et+=Sr;Ne<et-1;++Ne)Me.write_shift(-4,Ne+1);Sr&&(++Ne,Me.write_shift(-4,q))};for(et=Ne=0,et+=Ie[1];Ne<et;++Ne)Me.write_shift(-4,se.DIFSECT);for(et+=Ie[2];Ne<et;++Ne)Me.write_shift(-4,se.FATSECT);kt(Ie[3]),kt(Ie[4]);for(var Rt=0,Tt=0,Ut=ye.FileIndex[0];Rt<ye.FileIndex.length;++Rt)Ut=ye.FileIndex[Rt],Ut.content&&(Tt=Ut.content.length,!(Tt<4096)&&(Ut.start=et,kt(Tt+511>>9)));for(kt(Ie[6]+7>>3);Me.l&511;)Me.write_shift(-4,se.ENDOFCHAIN);for(et=Ne=0,Rt=0;Rt<ye.FileIndex.length;++Rt)Ut=ye.FileIndex[Rt],Ut.content&&(Tt=Ut.content.length,!(!Tt||Tt>=4096)&&(Ut.start=et,kt(Tt+63>>6)));for(;Me.l&511;)Me.write_shift(-4,se.ENDOFCHAIN);for(Ne=0;Ne<Ie[4]<<2;++Ne){var ur=ye.FullPaths[Ne];if(!ur||ur.length===0){for(Rt=0;Rt<17;++Rt)Me.write_shift(4,0);for(Rt=0;Rt<3;++Rt)Me.write_shift(4,-1);for(Rt=0;Rt<12;++Rt)Me.write_shift(4,0);continue}Ut=ye.FileIndex[Ne],Ne===0&&(Ut.start=Ut.size?Ut.start-1:q);var fr=Ne===0&&Re.root||Ut.name;if(Tt=2*(fr.length+1),Me.write_shift(64,fr,"utf16le"),Me.write_shift(2,Tt),Me.write_shift(1,Ut.type),Me.write_shift(1,Ut.color),Me.write_shift(-4,Ut.L),Me.write_shift(-4,Ut.R),Me.write_shift(-4,Ut.C),Ut.clsid)Me.write_shift(16,Ut.clsid,"hex");else for(Rt=0;Rt<4;++Rt)Me.write_shift(4,0);Me.write_shift(4,Ut.state||0),Me.write_shift(4,0),Me.write_shift(4,0),Me.write_shift(4,0),Me.write_shift(4,0),Me.write_shift(4,Ut.start),Me.write_shift(4,Ut.size),Me.write_shift(4,0)}for(Ne=1;Ne<ye.FileIndex.length;++Ne)if(Ut=ye.FileIndex[Ne],Ut.size>=4096)if(Me.l=Ut.start+1<<9,has_buf&&Buffer.isBuffer(Ut.content))Ut.content.copy(Me,Me.l,0,Ut.size),Me.l+=Ut.size+511&-512;else{for(Rt=0;Rt<Ut.size;++Rt)Me.write_shift(1,Ut.content[Rt]);for(;Rt&511;++Rt)Me.write_shift(1,0)}for(Ne=1;Ne<ye.FileIndex.length;++Ne)if(Ut=ye.FileIndex[Ne],Ut.size>0&&Ut.size<4096)if(has_buf&&Buffer.isBuffer(Ut.content))Ut.content.copy(Me,Me.l,0,Ut.size),Me.l+=Ut.size+63&-64;else{for(Rt=0;Rt<Ut.size;++Rt)Me.write_shift(1,Ut.content[Rt]);for(;Rt&63;++Rt)Me.write_shift(1,0)}if(has_buf)Me.l=Me.length;else for(;Me.l<Me.length;)Me.write_shift(1,0);return Me}function R(ye,De){var Re=ye.FullPaths.map(function(Rt){return Rt.toUpperCase()}),Ie=Re.map(function(Rt){var Tt=Rt.split("/");return Tt[Tt.length-(Rt.slice(-1)=="/"?2:1)]}),Me=!1;De.charCodeAt(0)===47?(Me=!0,De=Re[0].slice(0,-1)+De):Me=De.indexOf("/")!==-1;var Ne=De.toUpperCase(),et=Me===!0?Re.indexOf(Ne):Ie.indexOf(Ne);if(et!==-1)return ye.FileIndex[et];var kt=!Ne.match(chr1);for(Ne=Ne.replace(chr0,""),kt&&(Ne=Ne.replace(chr1,"!")),et=0;et<Re.length;++et)if((kt?Re[et].replace(chr1,"!"):Re[et]).replace(chr0,"")==Ne||(kt?Ie[et].replace(chr1,"!"):Ie[et]).replace(chr0,"")==Ne)return ye.FileIndex[et];return null}var Y=64,q=-2,me="d0cf11e0a1b11ae1",xe=[208,207,17,224,161,177,26,225],Ee="00000000000000000000000000000000",se={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:me,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Fe(ye,De,Re){u();var Ie=O(ye,Re);c.writeFileSync(De,Ie)}function ue(ye){for(var De=new Array(ye.length),Re=0;Re<ye.length;++Re)De[Re]=String.fromCharCode(ye[Re]);return De.join("")}function ae(ye,De){var Re=O(ye,De);switch(De&&De.type||"buffer"){case"file":return u(),c.writeFileSync(De.filename,Re),Re;case"binary":return typeof Re=="string"?Re:ue(Re);case"base64":return Base64_encode(typeof Re=="string"?Re:ue(Re));case"buffer":if(has_buf)return Buffer.isBuffer(Re)?Re:Buffer_from(Re);case"array":return typeof Re=="string"?s2a(Re):Re}return Re}var _e;function oe(ye){try{var De=ye.InflateRaw,Re=new De;if(Re._processChunk(new Uint8Array([3,0]),Re._finishFlushFlag),Re.bytesRead)_e=ye;else throw new Error("zlib does not expose bytesRead")}catch(Ie){console.error("cannot use native zlib: "+(Ie.message||Ie))}}function ie(ye,De){if(!_e)return ot(ye,De);var Re=_e.InflateRaw,Ie=new Re,Me=Ie._processChunk(ye.slice(ye.l),Ie._finishFlushFlag);return ye.l+=Ie.bytesRead,Me}function re(ye){return _e?_e.deflateRawSync(ye):vr(ye)}var ce=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],fe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],pe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ve(ye){var De=(ye<<1|ye<<11)&139536|(ye<<5|ye<<15)&558144;return(De>>16|De>>8|De)&255}for(var Ae=typeof Uint8Array!="undefined",be=Ae?new Uint8Array(256):[],je=0;je<256;++je)be[je]=ve(je);function Se(ye,De){var Re=be[ye&255];return De<=8?Re>>>8-De:(Re=Re<<8|be[ye>>8&255],De<=16?Re>>>16-De:(Re=Re<<8|be[ye>>16&255],Re>>>24-De))}function Xe(ye,De){var Re=De&7,Ie=De>>>3;return(ye[Ie]|(Re<=6?0:ye[Ie+1]<<8))>>>Re&3}function qe(ye,De){var Re=De&7,Ie=De>>>3;return(ye[Ie]|(Re<=5?0:ye[Ie+1]<<8))>>>Re&7}function Je(ye,De){var Re=De&7,Ie=De>>>3;return(ye[Ie]|(Re<=4?0:ye[Ie+1]<<8))>>>Re&15}function We(ye,De){var Re=De&7,Ie=De>>>3;return(ye[Ie]|(Re<=3?0:ye[Ie+1]<<8))>>>Re&31}function Ue(ye,De){var Re=De&7,Ie=De>>>3;return(ye[Ie]|(Re<=1?0:ye[Ie+1]<<8))>>>Re&127}function Ce(ye,De,Re){var Ie=De&7,Me=De>>>3,Ne=(1<<Re)-1,et=ye[Me]>>>Ie;return Re<8-Ie||(et|=ye[Me+1]<<8-Ie,Re<16-Ie)||(et|=ye[Me+2]<<16-Ie,Re<24-Ie)||(et|=ye[Me+3]<<24-Ie),et&Ne}function Le(ye,De,Re){var Ie=De&7,Me=De>>>3;return Ie<=5?ye[Me]|=(Re&7)<<Ie:(ye[Me]|=Re<<Ie&255,ye[Me+1]=(Re&7)>>8-Ie),De+3}function Ve(ye,De,Re){var Ie=De&7,Me=De>>>3;return Re=(Re&1)<<Ie,ye[Me]|=Re,De+1}function Ge(ye,De,Re){var Ie=De&7,Me=De>>>3;return Re<<=Ie,ye[Me]|=Re&255,Re>>>=8,ye[Me+1]=Re,De+8}function ut(ye,De,Re){var Ie=De&7,Me=De>>>3;return Re<<=Ie,ye[Me]|=Re&255,Re>>>=8,ye[Me+1]=Re&255,ye[Me+2]=Re>>>8,De+16}function Jt(ye,De){var Re=ye.length,Ie=2*Re>De?2*Re:De+5,Me=0;if(Re>=De)return ye;if(has_buf){var Ne=new_unsafe_buf(Ie);if(ye.copy)ye.copy(Ne);else for(;Me<ye.length;++Me)Ne[Me]=ye[Me];return Ne}else if(Ae){var et=new Uint8Array(Ie);if(et.set)et.set(ye);else for(;Me<Re;++Me)et[Me]=ye[Me];return et}return ye.length=Ie,ye}function Kt(ye){for(var De=new Array(ye),Re=0;Re<ye;++Re)De[Re]=0;return De}function Ze(ye,De,Re){var Ie=1,Me=0,Ne=0,et=0,kt=0,Rt=ye.length,Tt=Ae?new Uint16Array(32):Kt(32);for(Ne=0;Ne<32;++Ne)Tt[Ne]=0;for(Ne=Rt;Ne<Re;++Ne)ye[Ne]=0;Rt=ye.length;var Ut=Ae?new Uint16Array(Rt):Kt(Rt);for(Ne=0;Ne<Rt;++Ne)Tt[Me=ye[Ne]]++,Ie<Me&&(Ie=Me),Ut[Ne]=0;for(Tt[0]=0,Ne=1;Ne<=Ie;++Ne)Tt[Ne+16]=kt=kt+Tt[Ne-1]<<1;for(Ne=0;Ne<Rt;++Ne)kt=ye[Ne],kt!=0&&(Ut[Ne]=Tt[kt+16]++);var ur=0;for(Ne=0;Ne<Rt;++Ne)if(ur=ye[Ne],ur!=0)for(kt=Se(Ut[Ne],Ie)>>Ie-ur,et=(1<<Ie+4-ur)-1;et>=0;--et)De[kt|et<<ur]=ur&15|Ne<<4;return Ie}var tr=Ae?new Uint16Array(512):Kt(512),nr=Ae?new Uint16Array(32):Kt(32);if(!Ae){for(var xr=0;xr<512;++xr)tr[xr]=0;for(xr=0;xr<32;++xr)nr[xr]=0}(function(){for(var ye=[],De=0;De<32;De++)ye.push(5);Ze(ye,nr,32);var Re=[];for(De=0;De<=143;De++)Re.push(8);for(;De<=255;De++)Re.push(9);for(;De<=279;De++)Re.push(7);for(;De<=287;De++)Re.push(8);Ze(Re,tr,288)})();var pr=function(){for(var De=Ae?new Uint8Array(32768):[],Re=0,Ie=0;Re<pe.length-1;++Re)for(;Ie<pe[Re+1];++Ie)De[Ie]=Re;for(;Ie<32768;++Ie)De[Ie]=29;var Me=Ae?new Uint8Array(259):[];for(Re=0,Ie=0;Re<fe.length-1;++Re)for(;Ie<fe[Re+1];++Ie)Me[Ie]=Re;function Ne(kt,Rt){for(var Tt=0;Tt<kt.length;){var Ut=Math.min(65535,kt.length-Tt),ur=Tt+Ut==kt.length;for(Rt.write_shift(1,+ur),Rt.write_shift(2,Ut),Rt.write_shift(2,~Ut&65535);Ut-- >0;)Rt[Rt.l++]=kt[Tt++]}return Rt.l}function et(kt,Rt){for(var Tt=0,Ut=0,ur=Ae?new Uint16Array(32768):[];Ut<kt.length;){var fr=Math.min(65535,kt.length-Ut);if(fr<10){for(Tt=Le(Rt,Tt,+(Ut+fr==kt.length)),Tt&7&&(Tt+=8-(Tt&7)),Rt.l=Tt/8|0,Rt.write_shift(2,fr),Rt.write_shift(2,~fr&65535);fr-- >0;)Rt[Rt.l++]=kt[Ut++];Tt=Rt.l*8;continue}Tt=Le(Rt,Tt,+(Ut+fr==kt.length)+2);for(var Sr=0;fr-- >0;){var dr=kt[Ut];Sr=(Sr<<5^dr)&32767;var br=-1,Pr=0;if((br=ur[Sr])&&(br|=Ut&-32768,br>Ut&&(br-=32768),br<Ut))for(;kt[br+Pr]==kt[Ut+Pr]&&Pr<250;)++Pr;if(Pr>2){dr=Me[Pr],dr<=22?Tt=Ge(Rt,Tt,be[dr+1]>>1)-1:(Ge(Rt,Tt,3),Tt+=5,Ge(Rt,Tt,be[dr-23]>>5),Tt+=3);var jr=dr<8?0:dr-4>>2;jr>0&&(ut(Rt,Tt,Pr-fe[dr]),Tt+=jr),dr=De[Ut-br],Tt=Ge(Rt,Tt,be[dr]>>3),Tt-=3;var Ur=dr<4?0:dr-2>>1;Ur>0&&(ut(Rt,Tt,Ut-br-pe[dr]),Tt+=Ur);for(var Gr=0;Gr<Pr;++Gr)ur[Sr]=Ut&32767,Sr=(Sr<<5^kt[Ut])&32767,++Ut;fr-=Pr-1}else dr<=143?dr=dr+48:Tt=Ve(Rt,Tt,1),Tt=Ge(Rt,Tt,be[dr]),ur[Sr]=Ut&32767,++Ut}Tt=Ge(Rt,Tt,0)-1}return Rt.l=(Tt+7)/8|0,Rt.l}return function(Rt,Tt){return Rt.length<8?Ne(Rt,Tt):et(Rt,Tt)}}();function vr(ye){var De=new_buf(50+Math.floor(ye.length*1.1)),Re=pr(ye,De);return De.slice(0,Re)}var lr=Ae?new Uint16Array(32768):Kt(32768),mr=Ae?new Uint16Array(32768):Kt(32768),wr=Ae?new Uint16Array(128):Kt(128),Cr=1,Rr=1;function ar(ye,De){var Re=We(ye,De)+257;De+=5;var Ie=We(ye,De)+1;De+=5;var Me=Je(ye,De)+4;De+=4;for(var Ne=0,et=Ae?new Uint8Array(19):Kt(19),kt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Rt=1,Tt=Ae?new Uint8Array(8):Kt(8),Ut=Ae?new Uint8Array(8):Kt(8),ur=et.length,fr=0;fr<Me;++fr)et[ce[fr]]=Ne=qe(ye,De),Rt<Ne&&(Rt=Ne),Tt[Ne]++,De+=3;var Sr=0;for(Tt[0]=0,fr=1;fr<=Rt;++fr)Ut[fr]=Sr=Sr+Tt[fr-1]<<1;for(fr=0;fr<ur;++fr)(Sr=et[fr])!=0&&(kt[fr]=Ut[Sr]++);var dr=0;for(fr=0;fr<ur;++fr)if(dr=et[fr],dr!=0){Sr=be[kt[fr]]>>8-dr;for(var br=(1<<7-dr)-1;br>=0;--br)wr[Sr|br<<dr]=dr&7|fr<<3}var Pr=[];for(Rt=1;Pr.length<Re+Ie;)switch(Sr=wr[Ue(ye,De)],De+=Sr&7,Sr>>>=3){case 16:for(Ne=3+Xe(ye,De),De+=2,Sr=Pr[Pr.length-1];Ne-- >0;)Pr.push(Sr);break;case 17:for(Ne=3+qe(ye,De),De+=3;Ne-- >0;)Pr.push(0);break;case 18:for(Ne=11+Ue(ye,De),De+=7;Ne-- >0;)Pr.push(0);break;default:Pr.push(Sr),Rt<Sr&&(Rt=Sr);break}var jr=Pr.slice(0,Re),Ur=Pr.slice(Re);for(fr=Re;fr<286;++fr)jr[fr]=0;for(fr=Ie;fr<30;++fr)Ur[fr]=0;return Cr=Ze(jr,lr,286),Rr=Ze(Ur,mr,30),De}function it(ye,De){if(ye[0]==3&&!(ye[1]&3))return[new_raw_buf(De),2];for(var Re=0,Ie=0,Me=new_unsafe_buf(De||1<<18),Ne=0,et=Me.length>>>0,kt=0,Rt=0;(Ie&1)==0;){if(Ie=qe(ye,Re),Re+=3,Ie>>>1)Ie>>1==1?(kt=9,Rt=5):(Re=ar(ye,Re),kt=Cr,Rt=Rr);else{Re&7&&(Re+=8-(Re&7));var Tt=ye[Re>>>3]|ye[(Re>>>3)+1]<<8;if(Re+=32,Tt>0)for(!De&&et<Ne+Tt&&(Me=Jt(Me,Ne+Tt),et=Me.length);Tt-- >0;)Me[Ne++]=ye[Re>>>3],Re+=8;continue}for(;;){!De&&et<Ne+32767&&(Me=Jt(Me,Ne+32767),et=Me.length);var Ut=Ce(ye,Re,kt),ur=Ie>>>1==1?tr[Ut]:lr[Ut];if(Re+=ur&15,ur>>>=4,(ur>>>8&255)===0)Me[Ne++]=ur;else{if(ur==256)break;ur-=257;var fr=ur<8?0:ur-4>>2;fr>5&&(fr=0);var Sr=Ne+fe[ur];fr>0&&(Sr+=Ce(ye,Re,fr),Re+=fr),Ut=Ce(ye,Re,Rt),ur=Ie>>>1==1?nr[Ut]:mr[Ut],Re+=ur&15,ur>>>=4;var dr=ur<4?0:ur-2>>1,br=pe[ur];for(dr>0&&(br+=Ce(ye,Re,dr),Re+=dr),!De&&et<Sr&&(Me=Jt(Me,Sr+100),et=Me.length);Ne<Sr;)Me[Ne]=Me[Ne-br],++Ne}}}return De?[Me,Re+7>>>3]:[Me.slice(0,Ne),Re+7>>>3]}function ot(ye,De){var Re=ye.slice(ye.l||0),Ie=it(Re,De);return ye.l+=Ie[1],Ie[0]}function gr(ye,De){if(ye)typeof console!="undefined"&&console.error(De);else throw new Error(De)}function Tr(ye,De){var Re=ye;prep_blob(Re,0);var Ie=[],Me=[],Ne={FileIndex:Ie,FullPaths:Me};x(Ne,{root:De.root});for(var et=Re.length-4;(Re[et]!=80||Re[et+1]!=75||Re[et+2]!=5||Re[et+3]!=6)&&et>=0;)--et;Re.l=et+4,Re.l+=4;var kt=Re.read_shift(2);Re.l+=6;var Rt=Re.read_shift(4);for(Re.l=Rt,et=0;et<kt;++et){Re.l+=20;var Tt=Re.read_shift(4),Ut=Re.read_shift(4),ur=Re.read_shift(2),fr=Re.read_shift(2),Sr=Re.read_shift(2);Re.l+=8;var dr=Re.read_shift(4),br=o(Re.slice(Re.l+ur,Re.l+ur+fr));Re.l+=ur+fr+Sr;var Pr=Re.l;Re.l=dr+4,Te(Re,Tt,Ut,Ne,br),Re.l=Pr}return Ne}function Te(ye,De,Re,Ie,Me){ye.l+=2;var Ne=ye.read_shift(2),et=ye.read_shift(2),kt=a(ye);if(Ne&8257)throw new Error("Unsupported ZIP encryption");for(var Rt=ye.read_shift(4),Tt=ye.read_shift(4),Ut=ye.read_shift(4),ur=ye.read_shift(2),fr=ye.read_shift(2),Sr="",dr=0;dr<ur;++dr)Sr+=String.fromCharCode(ye[ye.l++]);if(fr){var br=o(ye.slice(ye.l,ye.l+fr));(br[21589]||{}).mt&&(kt=br[21589].mt),((Me||{})[21589]||{}).mt&&(kt=Me[21589].mt)}ye.l+=fr;var Pr=ye.slice(ye.l,ye.l+Tt);switch(et){case 8:Pr=ie(ye,Ut);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+et)}var jr=!1;Ne&8&&(Rt=ye.read_shift(4),Rt==134695760&&(Rt=ye.read_shift(4),jr=!0),Tt=ye.read_shift(4),Ut=ye.read_shift(4)),Tt!=De&&gr(jr,"Bad compressed size: "+De+" != "+Tt),Ut!=Re&&gr(jr,"Bad uncompressed size: "+Re+" != "+Ut),$t(Ie,Sr,Pr,{unsafe:!0,mt:kt})}function ze(ye,De){var Re=De||{},Ie=[],Me=[],Ne=new_buf(1),et=Re.compression?8:0,kt=0,Rt=0,Tt=0,Ut=0,ur=0,fr=ye.FullPaths[0],Sr=fr,dr=ye.FileIndex[0],br=[],Pr=0;for(Rt=1;Rt<ye.FullPaths.length;++Rt)if(Sr=ye.FullPaths[Rt].slice(fr.length),dr=ye.FileIndex[Rt],!(!dr.size||!dr.content||Sr=="Sh33tJ5")){var jr=Ut,Ur=new_buf(Sr.length);for(Tt=0;Tt<Sr.length;++Tt)Ur.write_shift(1,Sr.charCodeAt(Tt)&127);Ur=Ur.slice(0,Ur.l),br[ur]=CRC32.buf(dr.content,0);var Gr=dr.content;et==8&&(Gr=re(Gr)),Ne=new_buf(30),Ne.write_shift(4,67324752),Ne.write_shift(2,20),Ne.write_shift(2,kt),Ne.write_shift(2,et),dr.mt?s(Ne,dr.mt):Ne.write_shift(4,0),Ne.write_shift(-4,br[ur]),Ne.write_shift(4,Gr.length),Ne.write_shift(4,dr.content.length),Ne.write_shift(2,Ur.length),Ne.write_shift(2,0),Ut+=Ne.length,Ie.push(Ne),Ut+=Ur.length,Ie.push(Ur),Ut+=Gr.length,Ie.push(Gr),Ne=new_buf(46),Ne.write_shift(4,33639248),Ne.write_shift(2,0),Ne.write_shift(2,20),Ne.write_shift(2,kt),Ne.write_shift(2,et),Ne.write_shift(4,0),Ne.write_shift(-4,br[ur]),Ne.write_shift(4,Gr.length),Ne.write_shift(4,dr.content.length),Ne.write_shift(2,Ur.length),Ne.write_shift(2,0),Ne.write_shift(2,0),Ne.write_shift(2,0),Ne.write_shift(2,0),Ne.write_shift(4,0),Ne.write_shift(4,jr),Pr+=Ne.l,Me.push(Ne),Pr+=Ur.length,Me.push(Ur),++ur}return Ne=new_buf(22),Ne.write_shift(4,101010256),Ne.write_shift(2,0),Ne.write_shift(2,0),Ne.write_shift(2,ur),Ne.write_shift(2,ur),Ne.write_shift(4,Pr),Ne.write_shift(4,Ut),Ne.write_shift(2,0),bconcat([bconcat(Ie),bconcat(Me),Ne])}var zt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ir(ye,De){if(ye.ctype)return ye.ctype;var Re=ye.name||"",Ie=Re.match(/\.([^\.]+)$/);return Ie&&zt[Ie[1]]||De&&(Ie=(Re=De).match(/[\.\\]([^\.\\])+$/),Ie&&zt[Ie[1]])?zt[Ie[1]]:"application/octet-stream"}function cr(ye){for(var De=Base64_encode(ye),Re=[],Ie=0;Ie<De.length;Ie+=76)Re.push(De.slice(Ie,Ie+76));return Re.join(`\r
`)+`\r
`}function or(ye){var De=ye.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Tt){var Ut=Tt.charCodeAt(0).toString(16).toUpperCase();return"="+(Ut.length==1?"0"+Ut:Ut)});De=De.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),De.charAt(0)==`
`&&(De="=0D"+De.slice(1)),De=De.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Re=[],Ie=De.split(`\r
`),Me=0;Me<Ie.length;++Me){var Ne=Ie[Me];if(Ne.length==0){Re.push("");continue}for(var et=0;et<Ne.length;){var kt=76,Rt=Ne.slice(et,et+kt);Rt.charAt(kt-1)=="="?kt--:Rt.charAt(kt-2)=="="?kt-=2:Rt.charAt(kt-3)=="="&&(kt-=3),Rt=Ne.slice(et,et+kt),et+=kt,et<Ne.length&&(Rt+="="),Re.push(Rt)}}return Re.join(`\r
`)}function ke(ye){for(var De=[],Re=0;Re<ye.length;++Re){for(var Ie=ye[Re];Re<=ye.length&&Ie.charAt(Ie.length-1)=="=";)Ie=Ie.slice(0,Ie.length-1)+ye[++Re];De.push(Ie)}for(var Me=0;Me<De.length;++Me)De[Me]=De[Me].replace(/[=][0-9A-Fa-f]{2}/g,function(Ne){return String.fromCharCode(parseInt(Ne.slice(1),16))});return s2a(De.join(`\r
`))}function Oe(ye,De,Re){for(var Ie="",Me="",Ne="",et,kt=0;kt<10;++kt){var Rt=De[kt];if(!Rt||Rt.match(/^\s*$/))break;var Tt=Rt.match(/^(.*?):\s*([^\s].*)$/);if(Tt)switch(Tt[1].toLowerCase()){case"content-location":Ie=Tt[2].trim();break;case"content-type":Ne=Tt[2].trim();break;case"content-transfer-encoding":Me=Tt[2].trim();break}}switch(++kt,Me.toLowerCase()){case"base64":et=s2a(Base64_decode(De.slice(kt).join("")));break;case"quoted-printable":et=ke(De.slice(kt));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Me)}var Ut=$t(ye,Ie.slice(Re.length),et,{unsafe:!0});Ne&&(Ut.ctype=Ne)}function He(ye,De){if(ue(ye.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Re=De&&De.root||"",Ie=(has_buf&&Buffer.isBuffer(ye)?ye.toString("binary"):ue(ye)).split(`\r
`),Me=0,Ne="";for(Me=0;Me<Ie.length;++Me)if(Ne=Ie[Me],!!/^Content-Location:/i.test(Ne)&&(Ne=Ne.slice(Ne.indexOf("file")),Re||(Re=Ne.slice(0,Ne.lastIndexOf("/")+1)),Ne.slice(0,Re.length)!=Re))for(;Re.length>0&&(Re=Re.slice(0,Re.length-1),Re=Re.slice(0,Re.lastIndexOf("/")+1),Ne.slice(0,Re.length)!=Re););var et=(Ie[1]||"").match(/boundary="(.*?)"/);if(!et)throw new Error("MAD cannot find boundary");var kt="--"+(et[1]||""),Rt=[],Tt=[],Ut={FileIndex:Rt,FullPaths:Tt};x(Ut);var ur,fr=0;for(Me=0;Me<Ie.length;++Me){var Sr=Ie[Me];Sr!==kt&&Sr!==kt+"--"||(fr++&&Oe(Ut,Ie.slice(ur,Me),Re),ur=Me)}return Ut}function $e(ye,De){var Re=De||{},Ie=Re.boundary||"SheetJS";Ie="------="+Ie;for(var Me=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Ie.slice(2)+'"',"","",""],Ne=ye.FullPaths[0],et=Ne,kt=ye.FileIndex[0],Rt=1;Rt<ye.FullPaths.length;++Rt)if(et=ye.FullPaths[Rt].slice(Ne.length),kt=ye.FileIndex[Rt],!(!kt.size||!kt.content||et=="Sh33tJ5")){et=et.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Pr){return"_x"+Pr.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Pr){return"_u"+Pr.charCodeAt(0).toString(16)+"_"});for(var Tt=kt.content,Ut=has_buf&&Buffer.isBuffer(Tt)?Tt.toString("binary"):ue(Tt),ur=0,fr=Math.min(1024,Ut.length),Sr=0,dr=0;dr<=fr;++dr)(Sr=Ut.charCodeAt(dr))>=32&&Sr<128&&++ur;var br=ur>=fr*4/5;Me.push(Ie),Me.push("Content-Location: "+(Re.root||"file:///C:/SheetJS/")+et),Me.push("Content-Transfer-Encoding: "+(br?"quoted-printable":"base64")),Me.push("Content-Type: "+ir(kt,et)),Me.push(""),Me.push(br?or(Ut):cr(Ut))}return Me.push(Ie+`--\r
`),Me.join(`\r
`)}function St(ye){var De={};return x(De,ye),De}function $t(ye,De,Re,Ie){var Me=Ie&&Ie.unsafe;Me||x(ye);var Ne=!Me&&CFB.find(ye,De);if(!Ne){var et=ye.FullPaths[0];De.slice(0,et.length)==et?et=De:(et.slice(-1)!="/"&&(et+="/"),et=(et+De).replace("//","/")),Ne={name:i(De),type:2},ye.FileIndex.push(Ne),ye.FullPaths.push(et),Me||CFB.utils.cfb_gc(ye)}return Ne.content=Re,Ne.size=Re?Re.length:0,Ie&&(Ie.CLSID&&(Ne.clsid=Ie.CLSID),Ie.mt&&(Ne.mt=Ie.mt),Ie.ct&&(Ne.ct=Ie.ct)),Ne}function Yt(ye,De){x(ye);var Re=CFB.find(ye,De);if(Re){for(var Ie=0;Ie<ye.FileIndex.length;++Ie)if(ye.FileIndex[Ie]==Re)return ye.FileIndex.splice(Ie,1),ye.FullPaths.splice(Ie,1),!0}return!1}function _r(ye,De,Re){x(ye);var Ie=CFB.find(ye,De);if(Ie){for(var Me=0;Me<ye.FileIndex.length;++Me)if(ye.FileIndex[Me]==Ie)return ye.FileIndex[Me].name=i(Re),ye.FullPaths[Me]=Re,!0}return!1}function sr(ye){T(ye,!0)}return e.find=R,e.read=ee,e.parse=h,e.write=ae,e.writeFile=Fe,e.utils={cfb_new:St,cfb_add:$t,cfb_del:Yt,cfb_mov:_r,cfb_gc:sr,ReadShift,CheckField,prep_blob,bconcat,use_zlib:oe,_deflateRaw:vr,_inflateRaw:ot,consts:se},e}();function blobify(t){return typeof t=="string"?s2ab(t):Array.isArray(t)?a2u(t):t}function write_dl(t,e,r){if(typeof Deno!="undefined"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=s2ab(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?utf8write(e):e;if(typeof IE_SaveFile!="undefined")return IE_SaveFile(n,t);if(typeof Blob!="undefined"){var i=new Blob([blobify(n)],{type:"application/octet-stream"});if(typeof navigator!="undefined"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs!="undefined")return saveAs(i,t);if(typeof URL!="undefined"&&typeof document!="undefined"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout!="undefined"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout!="undefined"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $!="undefined"&&typeof File!="undefined"&&typeof Folder!="undefined")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=a2s(e)),o.write(e),o.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function read_binary(t){if(typeof Deno!="undefined")return Deno.readFileSync(t);if(typeof $!="undefined"&&typeof File!="undefined"&&typeof Folder!="undefined")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function keys(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function evert_key(t,e){for(var r=[],n=keys(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function evert(t){for(var e=[],r=keys(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function evert_num(t){for(var e=[],r=keys(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function evert_arr(t){for(var e=[],r=keys(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var basedate=new Date(1899,11,30,0,0,0);function datenum(t,e){var r=t.getTime(),n=basedate.getTime()+(t.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var refdate=new Date,dnthresh=basedate.getTime()+(refdate.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4,refoffset=refdate.getTimezoneOffset();function numdate(t){var e=new Date;return e.setTime(t*24*60*60*1e3+dnthresh),e.getTimezoneOffset()!==refoffset&&e.setTime(e.getTime()+(e.getTimezoneOffset()-refoffset)*6e4),e}function parse_isodur(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var good_pd_date_1=new Date("2017-02-19T19:06:09.000Z"),good_pd_date=isNaN(good_pd_date_1.getFullYear())?new Date("2/19/17"):good_pd_date_1,good_pd=good_pd_date.getFullYear()==2017;function parseDate(t,e){var r=new Date(t);if(good_pd)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(good_pd_date.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function cc2str(t,e){if(has_buf&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return utf8write(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return utf8write(utf16beread(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder!="undefined")try{if(e){if(t[0]==255&&t[1]==254)return utf8write(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return utf8write(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"â‚¬":"Â€","â€š":"Â‚",Æ’:"Âƒ","â€ž":"Â„","â€¦":"Â…","â€ ":"Â†","â€¡":"Â‡","Ë†":"Âˆ","â€°":"Â‰",Å :"ÂŠ","â€¹":"Â‹",Å’:"ÂŒ",Å½:"ÂŽ","â€˜":"Â‘","â€™":"Â’","â€œ":"Â“","â€":"Â”","â€¢":"Â•","â€“":"Â–","â€”":"Â—","Ëœ":"Â˜","â„¢":"Â™",Å¡:"Âš","â€º":"Â›",Å“:"Âœ",Å¾:"Âž",Å¸:"ÂŸ"};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[â‚¬â€šÆ’â€žâ€¦â€ â€¡Ë†â€°Å â€¹Å’Å½â€˜â€™â€œâ€â€¢â€“â€”Ëœâ„¢Å¡â€ºÅ“Å¾Å¸]/g,function(s){return r[s]||s})}catch(s){}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function dup(t){if(typeof JSON!="undefined"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=dup(t[r]));return e}function fill(t,e){for(var r="";r.length<e;)r+=t;return r}function fuzzynum(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var lower_months=["january","february","march","april","may","june","july","august","september","october","november","december"];function fuzzydate(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&lower_months.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var split_regex=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function getdatastr(t){return t?t.content&&t.type?cc2str(t.content,!0):t.data?debom(t.data):t.asNodeBuffer&&has_buf?debom(t.asNodeBuffer().toString("binary")):t.asBinary?debom(t.asBinary()):t._data&&t._data.getContent?debom(cc2str(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function getdatabin(t){if(!t)return null;if(t.data)return char_codes(t.data);if(t.asNodeBuffer&&has_buf)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?char_codes(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function getdata(t){return t&&t.name.slice(-4)===".bin"?getdatabin(t):getdatastr(t)}function safegetzipfile(t,e){for(var r=t.FullPaths||keys(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function getzipfile(t,e){var r=safegetzipfile(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function getzipdata(t,e,r){if(!r)return getdata(getzipfile(t,e));if(!e)return null;try{return getzipdata(t,e)}catch(n){return null}}function getzipstr(t,e,r){if(!r)return getdatastr(getzipfile(t,e));if(!e)return null;try{return getzipstr(t,e)}catch(n){return null}}function getzipbin(t,e,r){return getdatabin(getzipfile(t,e))}function zipentries(t){for(var e=t.FullPaths||keys(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function zip_add_file(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return has_buf?n=Buffer_from(r):n=utf8decode(r),CFB.utils.cfb_add(t,e,n)}CFB.utils.cfb_add(t,e,r)}else t.file(e,r)}function zip_new(){return CFB.utils.cfb_new()}function zip_read(t,e){switch(e.type){case"base64":return CFB.read(t,{type:"base64"});case"binary":return CFB.read(t,{type:"binary"});case"buffer":case"array":return CFB.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function resolve_path(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var XML_HEADER=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,attregexg=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,tagregex1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,tagregex2=/<[^>]*>/g,tagregex=XML_HEADER.match(tagregex1)?tagregex1:tagregex2,nsregex=/<\w*:/,nsregex2=/<(\/?)\w+:/;function parsexmltag(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(attregexg),o=0,c="",u=0,h="",f="",m=1;if(a)for(u=0;u!=a.length;++u){for(f=a[u],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(h=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(m=(i=f.charCodeAt(s+1))==34||i==39?1:0,c=f.slice(s+1+m,f.length-m),o=0;o!=h.length&&h.charCodeAt(o)!==58;++o);if(o===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=c,n[h.toLowerCase()]=c;else{var E=(o===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(o+1);if(n[E]&&h.slice(o-3,o)=="ext")continue;n[E]=c,n[E.toLowerCase()]=c}}return n}function strip_ns(t){return t.replace(nsregex2,"<$1")}var encodings={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rencoding=evert(encodings),unescapexml=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,c){return encodings[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,c){return String.fromCharCode(parseInt(c,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),decregex=/[&<>'"]/g,charegex=/[\u0000-\u0008\u000b-\u001f]/g;function escapexml(t){var e=t+"";return e.replace(decregex,function(r){return rencoding[r]}).replace(charegex,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function escapexmltag(t){return escapexml(t).replace(/ /g,"_x0020_")}var htmlcharegex=/[\u0000-\u001f]/g;function escapehtml(t){var e=t+"";return e.replace(decregex,function(r){return rencoding[r]}).replace(/\n/g,"<br/>").replace(htmlcharegex,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function escapexlml(t){var e=t+"";return e.replace(decregex,function(r){return rencoding[r]}).replace(htmlcharegex,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var xlml_fixstr=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function xlml_unfixstr(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function parsexmlbool(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function utf8reada(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function utf8readb(t){var e=new_raw_buf(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function utf8readc(t){return Buffer_from(t,"binary").toString("utf8")}var utf8corpus="foo bar bazÃ¢Â˜ÂƒÃ°ÂŸÂÂ£",utf8read=has_buf&&(utf8readc(utf8corpus)==utf8reada(utf8corpus)&&utf8readc||utf8readb(utf8corpus)==utf8reada(utf8corpus)&&utf8readb)||utf8reada,utf8write=has_buf?function(t){return Buffer_from(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},matchtag=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),htmldecode=function(){var t=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),vtregex=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),vtvregex=/<\/?(?:vt:)?variant>/g,vtmregex=/<(?:vt:)([^>]*)>([\s\S]*)</;function parseVector(t,e){var r=parsexmltag(t),n=t.match(vtregex(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(vtvregex,"").match(vtmregex);a&&i.push({v:utf8read(a[2]),t:a[1]})}),i}var wtregex=/(^\s|\s$|\n)/;function writetag(t,e){return"<"+t+(e.match(wtregex)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function wxt_helper(t){return keys(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function writextag(t,e,r){return"<"+t+(r!=null?wxt_helper(r):"")+(e!=null?(e.match(wtregex)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function write_w3cdtf(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function write_vt(t,e){switch(typeof t){case"string":var r=writextag("vt:lpwstr",escapexml(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return writextag((t|0)==t?"vt:i4":"vt:r8",escapexml(String(t)));case"boolean":return writextag("vt:bool",t?"true":"false")}if(t instanceof Date)return writextag("vt:filetime",write_w3cdtf(t));throw new Error("Unable to serialize "+t)}function xlml_normalize(t){if(has_buf&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array!="undefined"&&t instanceof Uint8Array)return utf8read(a2s(ab2a(t)));throw new Error("Bad input format: expected Buffer or string")}var xlmlregex=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,XMLNS={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},XMLNS_main=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],XLMLNS={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function read_double_le(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function write_double_le(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var ___toBuffer=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},__toBuffer=has_buf?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Buffer_from(e)})):___toBuffer(t)}:___toBuffer,___utf16le=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(__readUInt16LE(t,i)));return n.join("").replace(chr0,"")},__utf16le=has_buf?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(chr0,""):___utf16le(t,e,r)}:___utf16le,___hexlify=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},__hexlify=has_buf?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):___hexlify(t,e,r)}:___hexlify,___utf8=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(__readUInt8(t,i)));return n.join("")},__utf8=has_buf?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):___utf8(e,r,n)}:___utf8,___lpstr=function(t,e){var r=__readUInt32LE(t,e);return r>0?__utf8(t,e+4,e+4+r-1):""},__lpstr=___lpstr,___cpstr=function(t,e){var r=__readUInt32LE(t,e);return r>0?__utf8(t,e+4,e+4+r-1):""},__cpstr=___cpstr,___lpwstr=function(t,e){var r=2*__readUInt32LE(t,e);return r>0?__utf8(t,e+4,e+4+r-1):""},__lpwstr=___lpwstr,___lpp4=function(e,r){var n=__readUInt32LE(e,r);return n>0?__utf16le(e,r+4,r+4+n):""},__lpp4=___lpp4,___8lpp4=function(t,e){var r=__readUInt32LE(t,e);return r>0?__utf8(t,e+4,e+4+r):""},__8lpp4=___8lpp4,___double=function(t,e){return read_double_le(t,e)},__double=___double,is_buf=function(e){return Array.isArray(e)||typeof Uint8Array!="undefined"&&e instanceof Uint8Array};has_buf&&(__lpstr=function(e,r){if(!Buffer.isBuffer(e))return ___lpstr(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},__cpstr=function(e,r){if(!Buffer.isBuffer(e))return ___cpstr(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},__lpwstr=function(e,r){if(!Buffer.isBuffer(e))return ___lpwstr(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},__lpp4=function(e,r){if(!Buffer.isBuffer(e))return ___lpp4(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},__8lpp4=function(e,r){if(!Buffer.isBuffer(e))return ___8lpp4(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},__double=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):___double(e,r)},is_buf=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array!="undefined"&&e instanceof Uint8Array});var __readUInt8=function(t,e){return t[e]},__readUInt16LE=function(t,e){return t[e+1]*256+t[e]},__readInt16LE=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},__readUInt32LE=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},__readInt32LE=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},__readInt32BE=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function ReadShift(t,e){var r="",n,i,s=[],a,o,c,u;switch(e){case"dbcs":if(u=this.l,has_buf&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(__readUInt16LE(this,u)),u+=2;t*=2;break;case"utf8":r=__utf8(this,this.l,this.l+t);break;case"utf16le":t*=2,r=__utf16le(this,this.l,this.l+t);break;case"wstr":return ReadShift.call(this,t,"dbcs");case"lpstr-ansi":r=__lpstr(this,this.l),t=4+__readUInt32LE(this,this.l);break;case"lpstr-cp":r=__cpstr(this,this.l),t=4+__readUInt32LE(this,this.l);break;case"lpwstr":r=__lpwstr(this,this.l),t=4+2*__readUInt32LE(this,this.l);break;case"lpp4":t=4+__readUInt32LE(this,this.l),r=__lpp4(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+__readUInt32LE(this,this.l),r=__8lpp4(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=__readUInt8(this,this.l+t++))!==0;)s.push(_getchar(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=__readUInt16LE(this,this.l+t))!==0;)s.push(_getchar(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return a=__readUInt8(this,u),this.l=u+1,o=ReadShift.call(this,t-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(_getchar(__readUInt16LE(this,u))),u+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return a=__readUInt8(this,u),this.l=u+1,o=ReadShift.call(this,t-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(_getchar(__readUInt8(this,u))),u+=1}r=s.join("");break;default:switch(t){case 1:return n=__readUInt8(this,this.l),this.l++,n;case 2:return n=(e==="i"?__readInt16LE:__readUInt16LE)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?__readInt32LE:__readInt32BE)(this,this.l),this.l+=4,n):(i=__readUInt32LE(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=__double(this,this.l):i=__double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=__hexlify(this,this.l,t);break}}return this.l+=t,r}var __writeUInt32LE=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},__writeInt32LE=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},__writeUInt16LE=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function WriteShift(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)__writeUInt16LE(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,__writeUInt32LE(this,e,this.l);break;case 8:if(n=8,r==="f"){write_double_le(this,e,this.l);break}case 16:break;case-4:n=4,__writeInt32LE(this,e,this.l);break}return this.l+=n,this}function CheckField(t,e){var r=__hexlify(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function prep_blob(t,e){t.l=e,t.read_shift=ReadShift,t.chk=CheckField,t.write_shift=WriteShift}function parsenoop(t,e){t.l+=e}function new_buf(t){var e=new_raw_buf(t);return prep_blob(e,0),e}function recordhopper(t,e,r){if(t){var n,i,s;prep_blob(t,t.l||0);for(var a=t.length,o=0,c=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var u=XLSBRecordEnum[o]||XLSBRecordEnum[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;c=t.l+s;var h=u.f&&u.f(t,s,r);if(t.l=c,e(h,u,o))return}}}function buf_array(){var t=[],e=has_buf?256:2048,r=function(u){var h=new_buf(u);return prep_blob(h,0),h},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,e)))},a=function(){return i(),bconcat(t)},o=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function write_record(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=XLSBRecordEnum[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&is_buf(r)&&t.push(r)}}function shift_cell_xls(t,e,r){var n=dup(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function shift_range_xls(t,e,r){var n=dup(t);return n.s=shift_cell_xls(n.s,e.s,r),n.e=shift_cell_xls(n.e,e.s,r),n}function encode_cell_xls(t,e){if(t.cRel&&t.c<0)for(t=dup(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=dup(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=encode_cell(t);return!t.cRel&&t.cRel!=null&&(r=fix_col(r)),!t.rRel&&t.rRel!=null&&(r=fix_row(r)),r}function encode_range_xls(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+encode_col(t.s.c)+":"+(t.e.cRel?"":"$")+encode_col(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+encode_row(t.s.r)+":"+(t.e.rRel?"":"$")+encode_row(t.e.r):encode_cell_xls(t.s,e.biff)+":"+encode_cell_xls(t.e,e.biff)}function decode_row(t){return parseInt(unfix_row(t),10)-1}function encode_row(t){return""+(t+1)}function fix_row(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function unfix_row(t){return t.replace(/\$(\d+)$/,"$1")}function decode_col(t){for(var e=unfix_col(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function encode_col(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function fix_col(t){return t.replace(/^([A-Z])/,"$$$1")}function unfix_col(t){return t.replace(/^\$([A-Z])/,"$1")}function split_cell(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function decode_cell(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function encode_cell(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function decode_range(t){var e=t.indexOf(":");return e==-1?{s:decode_cell(t),e:decode_cell(t)}:{s:decode_cell(t.slice(0,e)),e:decode_cell(t.slice(e+1))}}function encode_range(t,e){return typeof e=="undefined"||typeof e=="number"?encode_range(t.s,t.e):(typeof t!="string"&&(t=encode_cell(t)),typeof e!="string"&&(e=encode_cell(e)),t==e?t:t+":"+e)}function safe_decode_range(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function safe_format_cell(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=SSF_format(t.z,r?datenum(e):e)}catch(n){}try{return t.w=SSF_format((t.XF||{}).numFmtId||(r?14:0),r?datenum(e):e)}catch(n){return""+e}}function format_cell(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?BErr[t.v]||t.v:e==null?safe_format_cell(t,t.v):safe_format_cell(t,e))}function sheet_to_workbook(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function sheet_add_aoa(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?decode_cell(n.origin):n.origin;a=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=safe_decode_range(s["!ref"]);u.s.c=h.s.c,u.s.r=h.s.r,u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),a==-1&&(u.e.r=a=h.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=e[f].length;++m)if(typeof e[f][m]!="undefined"){var E={v:e[f][m]},g=a+f,p=o+m;if(u.s.r>g&&(u.s.r=g),u.s.c>p&&(u.s.c=p),u.e.r<g&&(u.e.r=g),u.e.c<p&&(u.e.c=p),e[f][m]&&typeof e[f][m]=="object"&&!Array.isArray(e[f][m])&&!(e[f][m]instanceof Date))E=e[f][m];else if(Array.isArray(E.v)&&(E.f=e[f][m][1],E.v=E.v[0]),E.v===null)if(E.f)E.t="n";else if(n.nullError)E.t="e",E.v=0;else if(n.sheetStubs)E.t="z";else continue;else typeof E.v=="number"?E.t="n":typeof E.v=="boolean"?E.t="b":E.v instanceof Date?(E.z=n.dateNF||table_fmt[14],n.cellDates?(E.t="d",E.w=SSF_format(E.z,datenum(E.v))):(E.t="n",E.v=datenum(E.v),E.w=SSF_format(E.z,E.v))):E.t="s";if(i)s[g]||(s[g]=[]),s[g][p]&&s[g][p].z&&(E.z=s[g][p].z),s[g][p]=E;else{var _=encode_cell({c:p,r:g});s[_]&&s[_].z&&(E.z=s[_].z),s[_]=E}}}return u.s.c<1e7&&(s["!ref"]=encode_range(u)),s}function aoa_to_sheet(t,e){return sheet_add_aoa(null,t,e)}function parse_Int32LE(t){return t.read_shift(4,"i")}function write_UInt32LE(t,e){return e||(e=new_buf(4)),e.write_shift(4,t),e}function parse_XLWideString(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function write_XLWideString(t,e){var r=!1;return e==null&&(r=!0,e=new_buf(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function parse_StrRun(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function write_StrRun(t,e){return e||(e=new_buf(4)),e.write_shift(2,0),e.write_shift(2,0),e}function parse_RichStr(t,e){var r=t.l,n=t.read_shift(1),i=parse_XLWideString(t),s=[],a={t:i,h:i};if((n&1)!==0){for(var o=t.read_shift(4),c=0;c!=o;++c)s.push(parse_StrRun(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function write_RichStr(t,e){var r=!1;return e==null&&(r=!0,e=new_buf(15+4*t.t.length)),e.write_shift(1,0),write_XLWideString(t.t,e),r?e.slice(0,e.l):e}var parse_BrtCommentText=parse_RichStr;function write_BrtCommentText(t,e){var r=!1;return e==null&&(r=!0,e=new_buf(23+4*t.t.length)),e.write_shift(1,1),write_XLWideString(t.t,e),e.write_shift(4,1),write_StrRun({},e),r?e.slice(0,e.l):e}function parse_XLSBCell(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function write_XLSBCell(t,e){return e==null&&(e=new_buf(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function parse_XLSBShortCell(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function write_XLSBShortCell(t,e){return e==null&&(e=new_buf(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var parse_XLSBCodeName=parse_XLWideString,write_XLSBCodeName=write_XLWideString;function parse_XLNullableWideString(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function write_XLNullableWideString(t,e){var r=!1;return e==null&&(r=!0,e=new_buf(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var parse_XLNameWideString=parse_XLWideString,parse_RelID=parse_XLNullableWideString,write_RelID=write_XLNullableWideString;function parse_RkNumber(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?__double([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):__readInt32LE(e,0)>>2;return r?i/100:i}function write_RkNumber(t,e){e==null&&(e=new_buf(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function parse_RfX(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function write_RfX(t,e){return e||(e=new_buf(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var parse_UncheckedRfX=parse_RfX,write_UncheckedRfX=write_RfX;function parse_Xnum(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function write_Xnum(t,e){return(e||new_buf(8)).write_shift(8,t,"f")}function parse_BrtColor(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var u=XLSIcv[i];u&&(e.rgb=rgb2Hex(u));break;case 2:e.rgb=rgb2Hex([a,o,c]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function write_BrtColor(t,e){if(e||(e=new_buf(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function parse_FontFlags(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function write_FontFlags(t,e){e||(e=new_buf(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function parse_ClipboardFormatOrString(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function parse_ClipboardFormatOrAnsiString(t){return parse_ClipboardFormatOrString(t,1)}function parse_ClipboardFormatOrUnicodeString(t){return parse_ClipboardFormatOrString(t,2)}var VT_I2=2,VT_I4=3,VT_BOOL=11,VT_VARIANT=12,VT_UI4=19,VT_FILETIME=64,VT_BLOB=65,VT_CF=71,VT_VECTOR_VARIANT=4108,VT_VECTOR_LPSTR=4126,VT_STRING=80,VT_USTR=81,VT_CUSTOM=[VT_STRING,VT_USTR],DocSummaryPIDDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Category",t:VT_STRING},3:{n:"PresentationFormat",t:VT_STRING},4:{n:"ByteCount",t:VT_I4},5:{n:"LineCount",t:VT_I4},6:{n:"ParagraphCount",t:VT_I4},7:{n:"SlideCount",t:VT_I4},8:{n:"NoteCount",t:VT_I4},9:{n:"HiddenCount",t:VT_I4},10:{n:"MultimediaClipCount",t:VT_I4},11:{n:"ScaleCrop",t:VT_BOOL},12:{n:"HeadingPairs",t:VT_VECTOR_VARIANT},13:{n:"TitlesOfParts",t:VT_VECTOR_LPSTR},14:{n:"Manager",t:VT_STRING},15:{n:"Company",t:VT_STRING},16:{n:"LinksUpToDate",t:VT_BOOL},17:{n:"CharacterCount",t:VT_I4},19:{n:"SharedDoc",t:VT_BOOL},22:{n:"HyperlinksChanged",t:VT_BOOL},23:{n:"AppVersion",t:VT_I4,p:"version"},24:{n:"DigSig",t:VT_BLOB},26:{n:"ContentType",t:VT_STRING},27:{n:"ContentStatus",t:VT_STRING},28:{n:"Language",t:VT_STRING},29:{n:"Version",t:VT_STRING},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},SummaryPIDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Title",t:VT_STRING},3:{n:"Subject",t:VT_STRING},4:{n:"Author",t:VT_STRING},5:{n:"Keywords",t:VT_STRING},6:{n:"Comments",t:VT_STRING},7:{n:"Template",t:VT_STRING},8:{n:"LastAuthor",t:VT_STRING},9:{n:"RevNumber",t:VT_STRING},10:{n:"EditTime",t:VT_FILETIME},11:{n:"LastPrinted",t:VT_FILETIME},12:{n:"CreatedDate",t:VT_FILETIME},13:{n:"ModifiedDate",t:VT_FILETIME},14:{n:"PageCount",t:VT_I4},15:{n:"WordCount",t:VT_I4},16:{n:"CharCount",t:VT_I4},17:{n:"Thumbnail",t:VT_CF},18:{n:"Application",t:VT_STRING},19:{n:"DocSecurity",t:VT_I4},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},CountryEnum={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},XLSFillPattern=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function rgbify(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var _XLSIcv=rgbify([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),XLSIcv=dup(_XLSIcv),BErr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RBErr={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ct2type={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},CT_LIST={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function new_ct(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function parse_ct(t){var e=new_ct();if(!t||!t.match)return e;var r={};if((t.match(tagregex)||[]).forEach(function(n){var i=parsexmltag(n);switch(i[0].replace(nsregex,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[ct2type[i.ContentType]]!==void 0&&e[ct2type[i.ContentType]].push(i.PartName);break}}),e.xmlns!==XMLNS.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function write_ct(t,e){var r=evert_arr(ct2type),n=[],i;n[n.length]=XML_HEADER,n[n.length]=writextag("Types",null,{xmlns:XMLNS.CT,"xmlns:xsd":XMLNS.xsd,"xmlns:xsi":XMLNS.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return writextag("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){t[c]&&t[c].length>0&&(i=t[c][0],n[n.length]=writextag("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:CT_LIST[c][e.bookType]||CT_LIST[c].xlsx}))},a=function(c){(t[c]||[]).forEach(function(u){n[n.length]=writextag("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:CT_LIST[c][e.bookType]||CT_LIST[c].xlsx})})},o=function(c){(t[c]||[]).forEach(function(u){n[n.length]=writextag("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var RELS={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function get_rels_path(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function parse_rels(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(tagregex)||[]).forEach(function(i){var s=parsexmltag(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:resolve_path(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}function write_rels(t){var e=[XML_HEADER,writextag("Relationships",null,{xmlns:XMLNS.RELS})];return keys(t["!id"]).forEach(function(r){e[e.length]=writextag("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function add_rels(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[RELS.HLINK,RELS.XPATH,RELS.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var CT_ODS="application/vnd.oasis.opendocument.spreadsheet";function parse_manifest(t,e){for(var r=xlml_normalize(t),n,i;n=xlmlregex.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=parsexmltag(n[0],!1),i.path=="/"&&i.type!==CT_ODS)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function write_manifest(t){var e=[XML_HEADER];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function write_rdf_type(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf_has(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf(t){var e=[XML_HEADER];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(write_rdf_type(t[r][0],t[r][1])),e.push(write_rdf_has("",t[r][0]));return e.push(write_rdf_type("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function write_meta_ods(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+XLSX.version+"</meta:generator></office:meta></office:document-meta>"}var CORE_PROPS=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],CORE_PROPS_REGEX=function(){for(var t=new Array(CORE_PROPS.length),e=0;e<CORE_PROPS.length;++e){var r=CORE_PROPS[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function parse_core_props(t){var e={};t=utf8read(t);for(var r=0;r<CORE_PROPS.length;++r){var n=CORE_PROPS[r],i=t.match(CORE_PROPS_REGEX[r]);i!=null&&i.length>0&&(e[n[1]]=unescapexml(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=parseDate(e[n[1]]))}return e}function cp_doit(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=escapexml(e),n[n.length]=r?writextag(t,e,r):writetag(t,e))}function write_core_props(t,e){var r=e||{},n=[XML_HEADER,writextag("cp:coreProperties",null,{"xmlns:cp":XMLNS.CORE_PROPS,"xmlns:dc":XMLNS.dc,"xmlns:dcterms":XMLNS.dcterms,"xmlns:dcmitype":XMLNS.dcmitype,"xmlns:xsi":XMLNS.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&cp_doit("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:write_w3cdtf(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&cp_doit("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:write_w3cdtf(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=CORE_PROPS.length;++s){var a=CORE_PROPS[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&cp_doit(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var EXT_PROPS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],PseudoPropsPairs=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function load_props_pairs(t,e,r,n){var i=[];if(typeof t=="string")i=parseVector(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(h){return{v:h}}));var a=typeof e=="string"?parseVector(e,n).map(function(h){return h.v}):e,o=0,c=0;if(a.length>0)for(var u=0;u!==i.length;u+=2){switch(c=+i[u+1].v,i[u].v){case"Worksheets":case"å·¥ä½œè¡¨":case"Ð›Ð¸ÑÑ‚Ñ‹":case"Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„Ø¹Ù…Ù„":case"ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆ":case"×’×œ×™×•× ×•×ª ×¢×‘×•×“×”":case"ArbeitsblÃ¤tter":case"Ã‡alÄ±ÅŸma SayfalarÄ±":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cÃ¡lculo":case"Planilhas":case"Regneark":case"Hojas de cÃ¡lculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=a.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"åå‰ä»˜ãä¸€è¦§":case"Benannte Bereiche":case"Navngivne omrÃ¥der":r.NamedRanges=c,r.DefinedNames=a.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=a.slice(o,o+c);break}o+=c}}function parse_ext_props(t,e,r){var n={};return e||(e={}),t=utf8read(t),EXT_PROPS.forEach(function(i){var s=(t.match(matchtag(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=unescapexml(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&load_props_pairs(n.HeadingPairs,n.TitlesOfParts,e,r),e}function write_ext_props(t){var e=[],r=writextag;return t||(t={}),t.Application="SheetJS",e[e.length]=XML_HEADER,e[e.length]=writextag("Properties",null,{xmlns:XMLNS.EXT_PROPS,"xmlns:vt":XMLNS.vt}),EXT_PROPS.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=escapexml(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+escapexml(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var custregex=/<[^>]+>[^<]*/g;function parse_cust_props(t,e){var r={},n="",i=t.match(custregex);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=parsexmltag(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=unescapexml(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var c=a.split(">"),u=c[0].slice(4),h=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=unescapexml(h);break;case"bool":r[n]=parsexmlbool(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=parseDate(h);break;case"cy":case"error":r[n]=unescapexml(h);break;default:if(u.slice(-1)=="/")break;e.WTF&&typeof console!="undefined"&&console.warn("Unexpected",a,u,c)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function write_cust_props(t){var e=[XML_HEADER,writextag("Properties",null,{xmlns:XMLNS.CUST_PROPS,"xmlns:vt":XMLNS.vt})];if(!t)return e.join("");var r=1;return keys(t).forEach(function(i){++r,e[e.length]=writextag("property",write_vt(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:escapexml(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var XLMLDocPropsMap={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},evert_XLMLDPM;function xlml_set_prop(t,e,r){evert_XLMLDPM||(evert_XLMLDPM=evert(XLMLDocPropsMap)),e=evert_XLMLDPM[e]||e,t[e]=r}function xlml_write_docprops(t,e){var r=[];return keys(XLMLDocPropsMap).map(function(n){for(var i=0;i<CORE_PROPS.length;++i)if(CORE_PROPS[i][1]==n)return CORE_PROPS[i];for(i=0;i<EXT_PROPS.length;++i)if(EXT_PROPS[i][1]==n)return EXT_PROPS[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(writetag(XLMLDocPropsMap[n[1]]||n[1],i))}}),writextag("DocumentProperties",r.join(""),{xmlns:XLMLNS.o})}function xlml_write_custprops(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&keys(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<CORE_PROPS.length;++a)if(s==CORE_PROPS[a][1])return;for(a=0;a<EXT_PROPS.length;++a)if(s==EXT_PROPS[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),i.push(writextag(escapexmltag(s),o,{"dt:dt":c}))}}),e&&keys(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(writextag(escapexmltag(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+XLMLNS.o+'">'+i.join("")+"</"+n+">"}function parse_FILETIME(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function write_FILETIME(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=new_buf(8);return a.write_shift(4,n),a.write_shift(4,i),a}function parse_lpstr(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function parse_lpwstr(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function parse_VtStringBase(t,e,r){return e===31?parse_lpwstr(t):parse_lpstr(t,e,r)}function parse_VtString(t,e,r){return parse_VtStringBase(t,e,r===!1?0:4)}function parse_VtUnalignedString(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return parse_VtStringBase(t,e,0)}function parse_VtVecLpwstrValue(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(chr0,""),t.l-i&2&&(t.l+=2)}return r}function parse_VtVecUnalignedLpstrValue(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(chr0,"");return r}function parse_VtHeadingPair(t){var e=t.l,r=parse_TypedPropertyValue(t,VT_USTR);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=parse_TypedPropertyValue(t,VT_I4);return[r,n]}function parse_VtVecHeadingPairValue(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(parse_VtHeadingPair(t));return r}function parse_dictionary(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(chr0,"").replace(chr1,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function parse_BLOB(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function parse_ClipboardData(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function parse_TypedPropertyValue(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==VT_VARIANT&&n!==e&&VT_CUSTOM.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===VT_VARIANT?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return parse_lpstr(t,n,4).replace(chr0,"");case 31:return parse_lpwstr(t);case 64:return parse_FILETIME(t);case 65:return parse_BLOB(t);case 71:return parse_ClipboardData(t);case 80:return parse_VtString(t,n,!s.raw).replace(chr0,"");case 81:return parse_VtUnalignedString(t,n).replace(chr0,"");case 4108:return parse_VtVecHeadingPairValue(t);case 4126:case 4127:return n==4127?parse_VtVecLpwstrValue(t):parse_VtVecUnalignedLpstrValue(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function write_TypedPropertyValue(t,e){var r=new_buf(4),n=new_buf(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=new_buf(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=write_FILETIME(e);break;case 31:case 80:for(n=new_buf(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return bconcat([r,n])}function parse_PropertySet(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,c=-1,u={};for(a=0;a!=i;++a){var h=t.read_shift(4),f=t.read_shift(4);s[a]=[h,f+r]}s.sort(function(H,te){return H[1]-te[1]});var m={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var E=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,E=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],E=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],E=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(E=!1,t.l=s[a][1]),E)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var g=e[s[a][0]];if(m[g.n]=parse_TypedPropertyValue(t,g.t,{raw:!0}),g.p==="version"&&(m[g.n]=String(m[g.n]>>16)+"."+("0000"+String(m[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(m[g.n]){case 0:m[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:set_cp(o=m[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[g.n])}}else if(s[a][0]===1){if(o=m.CodePage=parse_TypedPropertyValue(t,VT_I2),set_cp(o),c!==-1){var p=t.l;t.l=s[c][1],u=parse_dictionary(t,o),t.l=p}}else if(s[a][0]===0){if(o===0){c=a,t.l=s[a+1][1];continue}u=parse_dictionary(t,o)}else{var _=u[s[a][0]],A;switch(t[t.l]){case 65:t.l+=4,A=parse_BLOB(t);break;case 30:t.l+=4,A=parse_VtString(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,A=parse_VtString(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,A=t.read_shift(4,"i");break;case 19:t.l+=4,A=t.read_shift(4);break;case 5:t.l+=4,A=t.read_shift(8,"f");break;case 11:t.l+=4,A=parsebool(t,4);break;case 64:t.l+=4,A=parseDate(parse_FILETIME(t));break;default:throw new Error("unparsed value: "+t[t.l])}m[_]=A}}return t.l=r+n,m}var XLSPSSkip=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function guess_property_type(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function write_PropertySet(t,e,r){var n=new_buf(8),i=[],s=[],a=8,o=0,c=new_buf(8),u=new_buf(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),i.push(u),a+=8+c.length,!e){u=new_buf(8),u.write_shift(4,0),i.unshift(u);var h=[new_buf(4)];for(h[0].write_shift(4,t.length),o=0;o<t.length;++o){var f=t[o][0];for(c=new_buf(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);h.push(c)}c=bconcat(h),s.unshift(c),a+=8+c.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(XLSPSSkip.indexOf(t[o][0])>-1||PseudoPropsPairs.indexOf(t[o][0])>-1)&&t[o][1]!=null){var m=t[o][1],E=0;if(e){E=+e[t[o][0]];var g=r[E];if(g.p=="version"&&typeof m=="string"){var p=m.split(".");m=(+p[0]<<16)+(+p[1]||0)}c=write_TypedPropertyValue(g.t,m)}else{var _=guess_property_type(m);_==-1&&(_=31,m=String(m)),c=write_TypedPropertyValue(_,m)}s.push(c),u=new_buf(8),u.write_shift(4,e?E:2+o),i.push(u),a+=8+c.length}var A=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,A),A+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),bconcat([n].concat(i).concat(s))}function parse_PropertySetStream(t,e,r){var n=t.content;if(!n)return{};prep_blob(n,0);var i,s,a,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),h=n.read_shift(16);if(h!==CFB.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),c=n.read_shift(4));var f=parse_PropertySet(n,e),m={SystemIdentifier:u};for(var E in f)m[E]=f[E];if(m.FMTID=s,i===1)return m;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var g;try{g=parse_PropertySet(n,null)}catch(p){}for(E in g)m[E]=g[E];return m.FMTID=[s,a],m}function write_PropertySetStream(t,e,r,n,i,s){var a=new_buf(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,CFB.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var c=write_PropertySet(t,r,n);if(o.push(c),i){var u=write_PropertySet(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+c.length),o.push(u)}return bconcat(o)}function parsenoop2(t,e){return t.read_shift(e),null}function writezeroes(t,e){e||(e=new_buf(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function parslurp(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function parsebool(t,e){return t.read_shift(e)===1}function writebool(t,e){return e||(e=new_buf(2)),e.write_shift(2,+!!t),e}function parseuint16(t){return t.read_shift(2,"u")}function writeuint16(t,e){return e||(e=new_buf(2)),e.write_shift(2,t),e}function parseuint16a(t,e){return parslurp(t,e,parseuint16)}function parse_Bes(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function write_Bes(t,e,r){return r||(r=new_buf(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function parse_ShortXLUnicodeString(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function parse_XLUnicodeRichExtendedString(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,c={};i&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",h=e===0?"":t.read_shift(e,u);return i&&(t.l+=4*a),n&&(t.l+=o),c.t=h,i||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function write_XLUnicodeRichExtendedString(t){var e=t.t||"",r=new_buf(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=new_buf(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return bconcat(i)}function parse_XLUnicodeStringNoCch(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function parse_XLUnicodeString(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):parse_XLUnicodeStringNoCch(t,n,r)}function parse_XLUnicodeString2(t,e,r){if(r.biff>5)return parse_XLUnicodeString(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function write_XLUnicodeString(t,e,r){return r||(r=new_buf(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function parse_ControlInfo(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function parse_URLMoniker(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(chr0,"");return n&&(t.l+=24),i}function parse_FileMoniker(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(chr0,"");return r+a}function parse_HyperlinkMoniker(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return parse_URLMoniker(t);case"0303000000000000c000000000000046":return parse_FileMoniker(t);default:throw new Error("Unsupported Moniker "+r)}}function parse_HyperlinkString(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(chr0,""):"";return r}function write_HyperlinkString(t,e){e||(e=new_buf(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function parse_Hyperlink(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,c,u="",h,f;i&16&&(s=parse_HyperlinkString(t,r-t.l)),i&128&&(a=parse_HyperlinkString(t,r-t.l)),(i&257)===257&&(o=parse_HyperlinkString(t,r-t.l)),(i&257)===1&&(c=parse_HyperlinkMoniker(t,r-t.l)),i&8&&(u=parse_HyperlinkString(t,r-t.l)),i&32&&(h=t.read_shift(16)),i&64&&(f=parse_FILETIME(t)),t.l=r;var m=a||o||c||"";m&&u&&(m+="#"+u),m||(m="#"+u),i&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var E={Target:m};return h&&(E.guid=h),f&&(E.time=f),s&&(E.Tooltip=s),E}function write_Hyperlink(t){var e=new_buf(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),write_HyperlinkString(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&write_HyperlinkString(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)e.write_shift(1,n.charCodeAt(r+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function parse_LongRGBA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function parse_LongRGB(t,e){var r=parse_LongRGBA(t);return r[3]=0,r}function parse_XLSCell(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function write_XLSCell(t,e,r,n){return n||(n=new_buf(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function parse_frtHeader(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function parse_OptXLUnicodeString(t,e,r){return e===0?"":parse_XLUnicodeString2(t,e,r)}function parse_XTI(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function parse_RkRec(t){var e=t.read_shift(2),r=parse_RkNumber(t);return[e,r]}function parse_AddinUdf(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=parse_ShortXLUnicodeString(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function parse_Ref8U(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function write_Ref8U(t,e){return e||(e=new_buf(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function parse_RefU(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var parse_Ref=parse_RefU;function parse_FtCmo(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function parse_FtNts(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function parse_FtCf(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function parse_FtSkip(t){t.l+=2,t.l+=t.read_shift(2)}var FtTab={0:parse_FtSkip,4:parse_FtSkip,5:parse_FtSkip,6:parse_FtSkip,7:parse_FtCf,8:parse_FtSkip,9:parse_FtSkip,10:parse_FtSkip,11:parse_FtSkip,12:parse_FtSkip,13:parse_FtNts,14:parse_FtSkip,15:parse_FtSkip,16:parse_FtSkip,17:parse_FtSkip,18:parse_FtSkip,19:parse_FtSkip,20:parse_FtSkip,21:parse_FtCmo};function parse_FtArray(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(FtTab[i](t,r-t.l))}catch(s){return t.l=r,n}}return t.l!=r&&(t.l=r),n}function parse_BOF(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function write_BOF(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=new_buf(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function parse_InterfaceHdr(t,e){return e===0||t.read_shift(2),1200}function parse_WriteAccess(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=parse_XLUnicodeString2(t,0,r);return t.read_shift(e+n-t.l),i}function write_WriteAccess(t,e){var r=!e||e.biff==8,n=new_buf(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function parse_WsBool(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function parse_BoundSheet8(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=parse_ShortXLUnicodeString(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function write_BoundSheet8(t,e){var r=!e||e.biff>=8?2:1,n=new_buf(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function parse_SST(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(parse_XLUnicodeRichExtendedString(t));return s.Count=n,s.Unique=i,s}function write_SST(t,e){var r=new_buf(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=write_XLUnicodeRichExtendedString(t[i]);var s=bconcat([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function parse_ExtSST(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function parse_Row(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function parse_ForceFullCalculation(t){var e=parse_frtHeader(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function parse_RecalcId(t){return t.read_shift(2),t.read_shift(4)}function parse_DefaultRowHeight(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function parse_Window1(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),u=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:c,TabRatio:u}}function write_Window1(){var t=new_buf(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function parse_Window2(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function write_Window2(t){var e=new_buf(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function parse_Pane(){}function parse_Font(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=parse_ShortXLUnicodeString(t,0,r),n}function write_Font(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=new_buf(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function parse_LabelSst(t){var e=parse_XLSCell(t);return e.isst=t.read_shift(4),e}function write_LabelSst(t,e,r,n){var i=new_buf(10);return write_XLSCell(t,e,n,i),i.write_shift(4,r),i}function parse_Label(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=parse_XLSCell(t);r.biff==2&&t.l++;var s=parse_XLUnicodeString(t,n-t.l,r);return i.val=s,i}function write_Label(t,e,r,n,i){var s=!i||i.biff==8,a=new_buf(8+ +s+(1+s)*r.length);return write_XLSCell(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function parse_Format(t,e,r){var n=t.read_shift(2),i=parse_XLUnicodeString2(t,0,r);return[n,i]}function write_Format(t,e,r,n){var i=r&&r.biff==5;n||(n=new_buf(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var parse_BIFF2Format=parse_XLUnicodeString2;function parse_Dimensions(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c}}}function write_Dimensions(t,e){var r=e.biff==8||!e.biff?4:2,n=new_buf(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function parse_RK(t){var e=t.read_shift(2),r=t.read_shift(2),n=parse_RkRec(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function parse_MulRk(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(parse_RkRec(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function parse_MulBlank(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function parse_CellStyleXF(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),c=t.read_shift(2);return i.patternType=XLSFillPattern[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=c&127,i.icvBack=c>>7&127,i.fsxButton=c>>14&1),i}function parse_XF(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=parse_CellStyleXF(t,e,n.fStyle,r),n}function write_XF(t,e,r,n){var i=r&&r.biff==5;n||(n=new_buf(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function parse_Guts(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function write_Guts(t){var e=new_buf(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function parse_BoolErr(t,e,r){var n=parse_XLSCell(t);(r.biff==2||e==9)&&++t.l;var i=parse_Bes(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function write_BoolErr(t,e,r,n,i,s){var a=new_buf(8);return write_XLSCell(t,e,n,a),write_Bes(r,s,a),a}function parse_Number(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=parse_XLSCell(t),i=parse_Xnum(t);return n.val=i,n}function write_Number(t,e,r,n){var i=new_buf(14);return write_XLSCell(t,e,n,i),write_Xnum(r,i),i}var parse_XLHeaderFooter=parse_OptXLUnicodeString;function parse_SupBook(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=parse_XLUnicodeStringNoCch(t,s),o=[];n>t.l;)o.push(parse_XLUnicodeString(t));return[s,i,a,o]}function parse_ExternName(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=parse_AddinUdf(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var XLSLblBuiltIn=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function parse_Lbl(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),c=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var u=parse_XLUnicodeStringNoCch(t,a,r);i&32&&(u=XLSLblBuiltIn[u.charCodeAt(0)]);var h=n-t.l;r&&r.biff==2&&--h;var f=n==t.l||o===0||!(h>0)?[]:parse_NameParsedFormula(t,h,r,o);return{chKey:s,Name:u,itab:c,rgce:f}}function parse_ExternSheet(t,e,r){if(r.biff<8)return parse_BIFF5ExternSheet(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(parse_XTI(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function parse_BIFF5ExternSheet(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=parse_ShortXLUnicodeString(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function parse_NameCmt(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=parse_XLUnicodeStringNoCch(t,n,r),a=parse_XLUnicodeStringNoCch(t,i,r);return[s,a]}function parse_ShrFmla(t,e,r){var n=parse_RefU(t);t.l++;var i=t.read_shift(1);return e-=8,[parse_SharedParsedFormula(t,e,r),i,n]}function parse_Array(t,e,r){var n=parse_Ref(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,parse_ArrayParsedFormula(t,e,r)]}function parse_MTRSettings(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function parse_NoteSh(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=parse_XLUnicodeString2(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function parse_Note(t,e,r){return parse_NoteSh(t,e,r)}function parse_MergeCells(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(parse_Ref8U(t));return r}function write_MergeCells(t){var e=new_buf(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)write_Ref8U(t[r],e);return e}function parse_Obj(t,e,r){if(r&&r.biff<8)return parse_BIFF5Obj(t,e,r);var n=parse_FtCmo(t),i=parse_FtArray(t,e-22,n[1]);return{cmo:n,ft:i}}var parse_BIFF5OT={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function parse_BIFF5Obj(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((parse_BIFF5OT[n]||parsenoop)(t,e,r)),{cmo:[i,n,s],ft:a}}function parse_TxO(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=parse_ControlInfo(t,6,r);var o=t.read_shift(2);t.read_shift(2),parseuint16(t,2);var c=t.read_shift(2);t.l+=c;for(var u=1;u<t.lens.length-1;++u){if(t.l-n!=t.lens[u])throw new Error("TxO: bad continue record");var h=t[t.l],f=parse_XLUnicodeStringNoCch(t,t.lens[u+1]-t.lens[u]-1);if(i+=f,i.length>=(h?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch(m){return t.l=n+e,{t:i}}}function parse_HLink(t,e){var r=parse_Ref8U(t);t.l+=16;var n=parse_Hyperlink(t,e-24);return[r,n]}function write_HLink(t){var e=new_buf(24),r=decode_cell(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return bconcat([e,write_Hyperlink(t[1])])}function parse_HLinkTooltip(t,e){t.read_shift(2);var r=parse_Ref8U(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(chr0,""),[r,n]}function write_HLinkTooltip(t){var e=t[1].Tooltip,r=new_buf(10+2*(e.length+1));r.write_shift(2,2048);var n=decode_cell(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function parse_Country(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=CountryEnum[r]||r,r=t.read_shift(2),e[1]=CountryEnum[r]||r,e}function write_Country(t){return t||(t=new_buf(4)),t.write_shift(2,1),t.write_shift(2,1),t}function parse_ClrtClient(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(parse_LongRGB(t));return r}function parse_Palette(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(parse_LongRGB(t));return r}function parse_XFCRC(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function parse_ColInfo(t,e,r){if(!r.cellStyles)return parsenoop(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function write_ColInfo(t,e){var r=new_buf(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function parse_Setup(t,e){var r={};return e<32||(t.l+=16,r.header=parse_Xnum(t),r.footer=parse_Xnum(t),t.l+=2),r}function parse_ShtProps(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function write_RRTabId(t){for(var e=new_buf(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var parse_Blank=parse_XLSCell,parse_Scl=parseuint16a,parse_String=parse_XLUnicodeString;function parse_ImData(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function parse_BIFF2STR(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=parse_XLSCell(t);++t.l;var i=parse_XLUnicodeString2(t,e-7,r);return n.t="str",n.val=i,n}function parse_BIFF2NUM(t){var e=parse_XLSCell(t);++t.l;var r=parse_Xnum(t);return e.t="n",e.val=r,e}function write_BIFF2NUM(t,e,r){var n=new_buf(15);return write_BIFF2Cell(n,t,e),n.write_shift(8,r,"f"),n}function parse_BIFF2INT(t){var e=parse_XLSCell(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function write_BIFF2INT(t,e,r){var n=new_buf(9);return write_BIFF2Cell(n,t,e),n.write_shift(2,r),n}function parse_BIFF2STRING(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function parse_BIFF2FONTXTRA(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function parse_RString(t,e,r){var n=t.l+e,i=parse_XLSCell(t),s=t.read_shift(2),a=parse_XLUnicodeStringNoCch(t,s,r);return t.l=n,i.t="str",i.val=a,i}var DBF_SUPPORTED_VERSIONS=[2,3,48,49,131,139,140,245],DBF=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=evert({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],h=new_raw_buf(1);switch(c.type){case"base64":h=s2a(Base64_decode(o));break;case"binary":h=s2a(o);break;case"buffer":case"array":h=o;break}prep_blob(h,0);var f=h.read_shift(1),m=!!(f&136),E=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:E=!0,m=!0;break;case 49:E=!0,m=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,_=521;f==2&&(p=h.read_shift(2)),h.l+=3,f!=2&&(p=h.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(_=h.read_shift(2));var A=h.read_shift(2),H=c.codepage||1252;f!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(H=t[h[h.l]]),h.l+=1,h.l+=2),g&&(h.l+=36);for(var te=[],ne={},j=Math.min(h.length,f==2?521:_-10-(E?264:0)),ee=g?32:11;h.l<j&&h[h.l]!=13;)switch(ne={},ne.name=$cptable.utils.decode(H,h.slice(h.l,h.l+ee)).replace(/[\u0000\r\n].*$/g,""),h.l+=ee,ne.type=String.fromCharCode(h.read_shift(1)),f!=2&&!g&&(ne.offset=h.read_shift(4)),ne.len=h.read_shift(1),f==2&&(ne.offset=h.read_shift(2)),ne.dec=h.read_shift(1),ne.name.length&&te.push(ne),f!=2&&(h.l+=g?13:14),ne.type){case"B":(!E||ne.len!=8)&&c.WTF&&console.log("Skipping "+ne.name+":"+ne.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+ne.name+":"+ne.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+ne.type)}if(h[h.l]!==13&&(h.l=_-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=_;var x=0,M=0;for(u[0]=[],M=0;M!=te.length;++M)u[0][M]=te[M].name;for(;p-- >0;){if(h[h.l]===42){h.l+=A;continue}for(++h.l,u[++x]=[],M=0,M=0;M!=te.length;++M){var T=h.slice(h.l,h.l+te[M].len);h.l+=te[M].len,prep_blob(T,0);var O=$cptable.utils.decode(H,T);switch(te[M].type){case"C":O.trim().length&&(u[x][M]=O.replace(/\s+$/,""));break;case"D":O.length===8?u[x][M]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):u[x][M]=O;break;case"F":u[x][M]=parseFloat(O.trim());break;case"+":case"I":u[x][M]=g?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":u[x][M]=!0;break;case"N":case"F":u[x][M]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[x][M]="##MEMO##"+(g?parseInt(O.trim(),10):T.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(u[x][M]=+O||0);break;case"@":u[x][M]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":u[x][M]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":u[x][M]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[x][M]=-T.read_shift(-8,"f");break;case"B":if(E&&te[M].len==8){u[x][M]=T.read_shift(8,"f");break}case"G":case"P":T.l+=te[M].len;break;case"0":if(te[M].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+te[M].type)}}}if(f!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=te,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var h=aoa_to_sheet(r(o,u),u);return h["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,h}function i(o,c){try{return sheet_to_workbook(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,c){var u=c||{};if(+u.codepage>=0&&set_cp(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var h=buf_array(),f=sheet_to_json(o,{header:1,raw:!0,cellDates:!0}),m=f[0],E=f.slice(1),g=o["!cols"]||[],p=0,_=0,A=0,H=1;for(p=0;p<m.length;++p){if(((g[p]||{}).DBF||{}).name){m[p]=g[p].DBF.name,++A;continue}if(m[p]!=null){if(++A,typeof m[p]=="number"&&(m[p]=m[p].toString(10)),typeof m[p]!="string")throw new Error("DBF Invalid column name "+m[p]+" |"+typeof m[p]+"|");if(m.indexOf(m[p])!==p){for(_=0;_<1024;++_)if(m.indexOf(m[p]+"_"+_)==-1){m[p]+="_"+_;break}}}}var te=safe_decode_range(o["!ref"]),ne=[],j=[],ee=[];for(p=0;p<=te.e.c-te.s.c;++p){var x="",M="",T=0,O=[];for(_=0;_<E.length;++_)E[_][p]!=null&&O.push(E[_][p]);if(O.length==0||m[p]==null){ne[p]="?";continue}for(_=0;_<O.length;++_){switch(typeof O[_]){case"number":M="B";break;case"string":M="C";break;case"boolean":M="L";break;case"object":M=O[_]instanceof Date?"D":"C";break;default:M="C"}T=Math.max(T,String(O[_]).length),x=x&&x!=M?"C":M}T>250&&(T=250),M=((g[p]||{}).DBF||{}).type,M=="C"&&g[p].DBF.len>T&&(T=g[p].DBF.len),x=="B"&&M=="N"&&(x="N",ee[p]=g[p].DBF.dec,T=g[p].DBF.len),j[p]=x=="C"||M=="N"?T:s[x]||0,H+=j[p],ne[p]=x}var R=h.next(32);for(R.write_shift(4,318902576),R.write_shift(4,E.length),R.write_shift(2,296+32*A),R.write_shift(2,H),p=0;p<4;++p)R.write_shift(4,0);for(R.write_shift(4,0|(+e[current_ansi]||3)<<8),p=0,_=0;p<m.length;++p)if(m[p]!=null){var Y=h.next(32),q=(m[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Y.write_shift(1,q,"sbcs"),Y.write_shift(1,ne[p]=="?"?"C":ne[p],"sbcs"),Y.write_shift(4,_),Y.write_shift(1,j[p]||s[ne[p]]||0),Y.write_shift(1,ee[p]||0),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(1,0),Y.write_shift(4,0),Y.write_shift(4,0),_+=j[p]||s[ne[p]]||0}var me=h.next(264);for(me.write_shift(4,13),p=0;p<65;++p)me.write_shift(4,0);for(p=0;p<E.length;++p){var xe=h.next(H);for(xe.write_shift(1,0),_=0;_<m.length;++_)if(m[_]!=null)switch(ne[_]){case"L":xe.write_shift(1,E[p][_]==null?63:E[p][_]?84:70);break;case"B":xe.write_shift(8,E[p][_]||0,"f");break;case"N":var Ee="0";for(typeof E[p][_]=="number"&&(Ee=E[p][_].toFixed(ee[_]||0)),A=0;A<j[_]-Ee.length;++A)xe.write_shift(1,32);xe.write_shift(1,Ee,"sbcs");break;case"D":E[p][_]?(xe.write_shift(4,("0000"+E[p][_].getFullYear()).slice(-4),"sbcs"),xe.write_shift(2,("00"+(E[p][_].getMonth()+1)).slice(-2),"sbcs"),xe.write_shift(2,("00"+E[p][_].getDate()).slice(-2),"sbcs")):xe.write_shift(8,"00000000","sbcs");break;case"C":var se=String(E[p][_]!=null?E[p][_]:"").slice(0,j[_]);for(xe.write_shift(1,se,"sbcs"),A=0;A<j[_]-se.length;++A)xe.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),SYLK=function(){var t={AA:"Ã€",BA:"Ã",CA:"Ã‚",DA:195,HA:"Ã„",JA:197,AE:"Ãˆ",BE:"Ã‰",CE:"ÃŠ",HE:"Ã‹",AI:"ÃŒ",BI:"Ã",CI:"ÃŽ",HI:"Ã",AO:"Ã’",BO:"Ã“",CO:"Ã”",DO:213,HO:"Ã–",AU:"Ã™",BU:"Ãš",CU:"Ã›",HU:"Ãœ",Aa:"Ã ",Ba:"Ã¡",Ca:"Ã¢",Da:227,Ha:"Ã¤",Ja:229,Ae:"Ã¨",Be:"Ã©",Ce:"Ãª",He:"Ã«",Ai:"Ã¬",Bi:"Ã­",Ci:"Ã®",Hi:"Ã¯",Ao:"Ã²",Bo:"Ã³",Co:"Ã´",Do:245,Ho:"Ã¶",Au:"Ã¹",Bu:"Ãº",Cu:"Ã»",Hu:"Ã¼",KC:"Ã‡",Kc:"Ã§",q:"Ã¦",z:"Å“",a:"Ã†",j:"Å’",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+keys(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,E){var g=t[E];return typeof g=="number"?_getansi(g):g},n=function(m,E,g){var p=E.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return p==59?m:_getansi(p)};t["|"]=254;function i(m,E){switch(E.type){case"base64":return s(Base64_decode(m),E);case"binary":return s(m,E);case"buffer":return s(has_buf&&Buffer.isBuffer(m)?m.toString("binary"):a2s(m),E);case"array":return s(cc2str(m),E)}throw new Error("Unrecognized type "+E.type)}function s(m,E){var g=m.split(/[\n\r]+/),p=-1,_=-1,A=0,H=0,te=[],ne=[],j=null,ee={},x=[],M=[],T=[],O=0,R;for(+E.codepage>=0&&set_cp(+E.codepage);A!==g.length;++A){O=0;var Y=g[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),q=Y.replace(/;;/g,"\0").split(";").map(function(ce){return ce.replace(/\u0000/g,";")}),me=q[0],xe;if(Y.length>0)switch(me){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&ne.push(Y.slice(3).replace(/;;/g,";"));break;case"C":var Ee=!1,se=!1,Fe=!1,ue=!1,ae=-1,_e=-1;for(H=1;H<q.length;++H)switch(q[H].charAt(0)){case"A":break;case"X":_=parseInt(q[H].slice(1))-1,se=!0;break;case"Y":for(p=parseInt(q[H].slice(1))-1,se||(_=0),R=te.length;R<=p;++R)te[R]=[];break;case"K":xe=q[H].slice(1),xe.charAt(0)==='"'?xe=xe.slice(1,xe.length-1):xe==="TRUE"?xe=!0:xe==="FALSE"?xe=!1:isNaN(fuzzynum(xe))?isNaN(fuzzydate(xe).getDate())||(xe=parseDate(xe)):(xe=fuzzynum(xe),j!==null&&fmt_is_date(j)&&(xe=numdate(xe))),Ee=!0;break;case"E":ue=!0;var oe=rc_to_a1(q[H].slice(1),{r:p,c:_});te[p][_]=[te[p][_],oe];break;case"S":Fe=!0,te[p][_]=[te[p][_],"S5S"];break;case"G":break;case"R":ae=parseInt(q[H].slice(1))-1;break;case"C":_e=parseInt(q[H].slice(1))-1;break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+Y)}if(Ee&&(te[p][_]&&te[p][_].length==2?te[p][_][0]=xe:te[p][_]=xe,j=null),Fe){if(ue)throw new Error("SYLK shared formula cannot have own formula");var ie=ae>-1&&te[ae][_e];if(!ie||!ie[1])throw new Error("SYLK shared formula cannot find base");te[p][_][1]=shift_formula_str(ie[1],{r:p-ae,c:_-_e})}break;case"F":var re=0;for(H=1;H<q.length;++H)switch(q[H].charAt(0)){case"X":_=parseInt(q[H].slice(1))-1,++re;break;case"Y":for(p=parseInt(q[H].slice(1))-1,R=te.length;R<=p;++R)te[R]=[];break;case"M":O=parseInt(q[H].slice(1))/20;break;case"F":break;case"G":break;case"P":j=ne[parseInt(q[H].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=q[H].slice(1).split(" "),R=parseInt(T[0],10);R<=parseInt(T[1],10);++R)O=parseInt(T[2],10),M[R-1]=O===0?{hidden:!0}:{wch:O},process_col(M[R-1]);break;case"C":_=parseInt(q[H].slice(1))-1,M[_]||(M[_]={});break;case"R":p=parseInt(q[H].slice(1))-1,x[p]||(x[p]={}),O>0?(x[p].hpt=O,x[p].hpx=pt2px(O)):O===0&&(x[p].hidden=!0);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+Y)}re<1&&(j=null);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+Y)}}return x.length>0&&(ee["!rows"]=x),M.length>0&&(ee["!cols"]=M),E&&E.sheetRows&&(te=te.slice(0,E.sheetRows)),[te,ee]}function a(m,E){var g=i(m,E),p=g[0],_=g[1],A=aoa_to_sheet(p,E);return keys(_).forEach(function(H){A[H]=_[H]}),A}function o(m,E){return sheet_to_workbook(a(m,E),E)}function c(m,E,g,p){var _="C;Y"+(g+1)+";X"+(p+1)+";K";switch(m.t){case"n":_+=m.v||0,m.f&&!m.F&&(_+=";E"+a1_to_rc(m.f,{r:g,c:p}));break;case"b":_+=m.v?"TRUE":"FALSE";break;case"e":_+=m.w||m.v;break;case"d":_+='"'+(m.w||m.v)+'"';break;case"s":_+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function u(m,E){E.forEach(function(g,p){var _="F;W"+(p+1)+" "+(p+1)+" ";g.hidden?_+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=width2px(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=px2char(g.wpx)),typeof g.wch=="number"&&(_+=Math.round(g.wch))),_.charAt(_.length-1)!=" "&&m.push(_)})}function h(m,E){E.forEach(function(g,p){var _="F;";g.hidden?_+="M0;":g.hpt?_+="M"+20*g.hpt+";":g.hpx&&(_+="M"+20*px2pt(g.hpx)+";"),_.length>2&&m.push(_+"R"+(p+1))})}function f(m,E){var g=["ID;PWXL;N;E"],p=[],_=safe_decode_range(m["!ref"]),A,H=Array.isArray(m),te=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),m["!cols"]&&u(g,m["!cols"]),m["!rows"]&&h(g,m["!rows"]),g.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var ne=_.s.r;ne<=_.e.r;++ne)for(var j=_.s.c;j<=_.e.c;++j){var ee=encode_cell({r:ne,c:j});A=H?(m[ne]||[])[j]:m[ee],!(!A||A.v==null&&(!A.f||A.F))&&p.push(c(A,m,ne,j))}return g.join(te)+te+p.join(te)+te+"E"+te}return{to_workbook:o,to_sheet:a,from_sheet:f}}(),DIF=function(){function t(s,a){switch(a.type){case"base64":return e(Base64_decode(s),a);case"binary":return e(s,a);case"buffer":return e(has_buf&&Buffer.isBuffer(s)?s.toString("binary"):a2s(s),a);case"array":return e(cc2str(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),c=-1,u=-1,h=0,f=[];h!==o.length;++h){if(o[h].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var m=o[h].trim().split(","),E=m[0],g=m[1];++h;for(var p=o[h]||"";(p.match(/["]/g)||[]).length&1&&h<o.length-1;)p+=`
`+o[++h];switch(p=p.trim(),+E){case-1:if(p==="BOT"){f[++c]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][u]=!0:p==="FALSE"?f[c][u]=!1:isNaN(fuzzynum(g))?isNaN(fuzzydate(g).getDate())?f[c][u]=g:f[c][u]=parseDate(g):f[c][u]=fuzzynum(g),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][u++]=p!==""?p:null;break}if(p==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function r(s,a){return aoa_to_sheet(t(s,a),a)}function n(s,a){return sheet_to_workbook(r(s,a),a)}var i=function(){var s=function(c,u,h,f,m){c.push(u),c.push(h+","+f),c.push('"'+m.replace(/"/g,'""')+'"')},a=function(c,u,h,f){c.push(u+","+h),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],h=safe_decode_range(c["!ref"]),f,m=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,h.e.r-h.s.r+1,""),s(u,"TUPLES",0,h.e.c-h.s.c+1,""),s(u,"DATA",0,0,"");for(var E=h.s.r;E<=h.e.r;++E){a(u,-1,0,"BOT");for(var g=h.s.c;g<=h.e.c;++g){var p=encode_cell({r:E,c:g});if(f=m?(c[E]||[])[g]:c[p],!f){a(u,1,0,"");continue}switch(f.t){case"n":var _=f.w;!_&&f.v!=null&&(_=f.v),_==null?f.f&&!f.F?a(u,1,0,"="+f.f):a(u,1,0,""):a(u,0,_,"V");break;case"b":a(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=SSF_format(f.z||table_fmt[14],datenum(parseDate(f.v)))),a(u,0,f.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var A=`\r
`,H=u.join(A);return H}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),ETH=function(){function t(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,m){for(var E=f.split(`
`),g=-1,p=-1,_=0,A=[];_!==E.length;++_){var H=E[_].trim().split(":");if(H[0]==="cell"){var te=decode_cell(H[1]);if(A.length<=te.r)for(g=A.length;g<=te.r;++g)A[g]||(A[g]=[]);switch(g=te.r,p=te.c,H[2]){case"t":A[g][p]=t(H[3]);break;case"v":A[g][p]=+H[3];break;case"vtf":var ne=H[H.length-1];case"vtc":switch(H[3]){case"nl":A[g][p]=!!+H[4];break;default:A[g][p]=+H[4];break}H[2]=="vtf"&&(A[g][p]=[A[g][p],ne])}}}return m&&m.sheetRows&&(A=A.slice(0,m.sheetRows)),A}function n(f,m){return aoa_to_sheet(r(f,m),m)}function i(f,m){return sheet_to_workbook(n(f,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var m=[],E=[],g,p="",_=decode_range(f["!ref"]),A=Array.isArray(f),H=_.s.r;H<=_.e.r;++H)for(var te=_.s.c;te<=_.e.c;++te)if(p=encode_cell({r:H,c:te}),g=A?(f[H]||[])[te]:f[p],!(!g||g.v==null||g.t==="z")){switch(E=["cell",p,"t"],g.t){case"s":case"str":E.push(e(g.v));break;case"n":g.f?(E[2]="vtf",E[3]="n",E[4]=g.v,E[5]=e(g.f)):(E[2]="v",E[3]=g.v);break;case"b":E[2]="vt"+(g.f?"f":"c"),E[3]="nl",E[4]=g.v?"1":"0",E[5]=e(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var ne=datenum(parseDate(g.v));E[2]="vtc",E[3]="nd",E[4]=""+ne,E[5]=g.w||SSF_format(g.z||table_fmt[14],ne);break;case"e":continue}m.push(E.join(":"))}return m.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function h(f){return[s,a,o,a,u(f),c].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:h}}(),PRN=function(){function t(h,f,m,E,g){g.raw?f[m][E]=h:h===""||(h==="TRUE"?f[m][E]=!0:h==="FALSE"?f[m][E]=!1:isNaN(fuzzynum(h))?isNaN(fuzzydate(h).getDate())?f[m][E]=h:f[m][E]=parseDate(h):f[m][E]=fuzzynum(h))}function e(h,f){var m=f||{},E=[];if(!h||h.length===0)return E;for(var g=h.split(/[\r\n]/),p=g.length-1;p>=0&&g[p].length===0;)--p;for(var _=10,A=0,H=0;H<=p;++H)A=g[H].indexOf(" "),A==-1?A=g[H].length:A++,_=Math.max(_,A);for(H=0;H<=p;++H){E[H]=[];var te=0;for(t(g[H].slice(0,_).trim(),E,H,te,m),te=1;te<=(g[H].length-_)/10+1;++te)t(g[H].slice(_+(te-1)*10,_+te*10).trim(),E,H,te,m)}return m.sheetRows&&(E=E.slice(0,m.sheetRows)),E}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(h){for(var f={},m=!1,E=0,g=0;E<h.length;++E)(g=h.charCodeAt(E))==34?m=!m:!m&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(E in f)Object.prototype.hasOwnProperty.call(f,E)&&g.push([f[E],E]);if(!g.length){f=n;for(E in f)Object.prototype.hasOwnProperty.call(f,E)&&g.push([f[E],E])}return g.sort(function(p,_){return p[0]-_[0]||n[p[1]]-n[_[1]]}),r[g.pop()[1]]||44}function s(h,f){var m=f||{},E="",g=m.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(E=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(E=h.charAt(4),h=h.slice(6)):E=i(h.slice(0,1024)):m&&m.FS?E=m.FS:E=i(h.slice(0,1024));var _=0,A=0,H=0,te=0,ne=0,j=E.charCodeAt(0),ee=!1,x=0,M=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var T=m.dateNF!=null?dateNF_regex(m.dateNF):null;function O(){var R=h.slice(te,ne),Y={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)Y.t="z";else if(m.raw)Y.t="s",Y.v=R;else if(R.trim().length===0)Y.t="s",Y.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(Y.t="s",Y.v=R.slice(2,-1).replace(/""/g,'"')):fuzzyfmla(R)?(Y.t="n",Y.f=R.slice(1)):(Y.t="s",Y.v=R);else if(R=="TRUE")Y.t="b",Y.v=!0;else if(R=="FALSE")Y.t="b",Y.v=!1;else if(!isNaN(H=fuzzynum(R)))Y.t="n",m.cellText!==!1&&(Y.w=R),Y.v=H;else if(!isNaN(fuzzydate(R).getDate())||T&&R.match(T)){Y.z=m.dateNF||table_fmt[14];var q=0;T&&R.match(T)&&(R=dateNF_fix(R,m.dateNF,R.match(T)||[]),q=1),m.cellDates?(Y.t="d",Y.v=parseDate(R,q)):(Y.t="n",Y.v=datenum(parseDate(R,q))),m.cellText!==!1&&(Y.w=SSF_format(Y.z,Y.v instanceof Date?datenum(Y.v):Y.v)),m.cellNF||delete Y.z}else Y.t="s",Y.v=R;if(Y.t=="z"||(m.dense?(g[_]||(g[_]=[]),g[_][A]=Y):g[encode_cell({c:A,r:_})]=Y),te=ne+1,M=h.charCodeAt(te),p.e.c<A&&(p.e.c=A),p.e.r<_&&(p.e.r=_),x==j)++A;else if(A=0,++_,m.sheetRows&&m.sheetRows<=_)return!0}e:for(;ne<h.length;++ne)switch(x=h.charCodeAt(ne)){case 34:M===34&&(ee=!ee);break;case j:case 10:case 13:if(!ee&&O())break e;break}return ne-te>0&&O(),g["!ref"]=encode_range(p),g}function a(h,f){return!(f&&f.PRN)||f.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,f):aoa_to_sheet(e(h,f),f)}function o(h,f){var m="",E=f.type=="string"?[0,0,0,0]:firstbyte(h,f);switch(f.type){case"base64":m=Base64_decode(h);break;case"binary":m=h;break;case"buffer":f.codepage==65001?m=h.toString("utf8"):(f.codepage,m=has_buf&&Buffer.isBuffer(h)?h.toString("binary"):a2s(h));break;case"array":m=cc2str(h);break;case"string":m=h;break;default:throw new Error("Unrecognized type "+f.type)}return E[0]==239&&E[1]==187&&E[2]==191?m=utf8read(m.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?m=utf8read(m):f.type=="binary",m.slice(0,19)=="socialcalc:version:"?ETH.to_sheet(f.type=="string"?m:utf8read(m),f):a(m,f)}function c(h,f){return sheet_to_workbook(o(h,f),f)}function u(h){for(var f=[],m=safe_decode_range(h["!ref"]),E,g=Array.isArray(h),p=m.s.r;p<=m.e.r;++p){for(var _=[],A=m.s.c;A<=m.e.c;++A){var H=encode_cell({r:p,c:A});if(E=g?(h[p]||[])[A]:h[H],!E||E.v==null){_.push("          ");continue}for(var te=(E.w||(format_cell(E),E.w)||"").slice(0,10);te.length<10;)te+=" ";_.push(te+(A===0?" ":""))}f.push(_.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}();function read_wb_ID(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=SYLK.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return PRN.to_workbook(t,e)}}var WK_=function(){function t(oe,ie,re){if(oe){prep_blob(oe,oe.l||0);for(var ce=re.Enum||ae;oe.l<oe.length;){var fe=oe.read_shift(2),pe=ce[fe]||ce[65535],ve=oe.read_shift(2),Ae=oe.l+ve,be=pe.f&&pe.f(oe,ve,re);if(oe.l=Ae,ie(be,pe,fe))return}}}function e(oe,ie){switch(ie.type){case"base64":return r(s2a(Base64_decode(oe)),ie);case"binary":return r(s2a(oe),ie);case"buffer":case"array":return r(oe,ie)}throw"Unsupported type "+ie.type}function r(oe,ie){if(!oe)return oe;var re=ie||{},ce=re.dense?[]:{},fe="Sheet1",pe="",ve=0,Ae={},be=[],je=[],Se={s:{r:0,c:0},e:{r:0,c:0}},Xe=re.sheetRows||0;if(oe[2]==0&&(oe[3]==8||oe[3]==9)&&oe.length>=16&&oe[14]==5&&oe[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(oe[2]==2)re.Enum=ae,t(oe,function(Ue,Ce,Le){switch(Le){case 0:re.vers=Ue,Ue>=4096&&(re.qpro=!0);break;case 6:Se=Ue;break;case 204:Ue&&(pe=Ue);break;case 222:pe=Ue;break;case 15:case 51:re.qpro||(Ue[1].v=Ue[1].v.slice(1));case 13:case 14:case 16:Le==14&&(Ue[2]&112)==112&&(Ue[2]&15)>1&&(Ue[2]&15)<15&&(Ue[1].z=re.dateNF||table_fmt[14],re.cellDates&&(Ue[1].t="d",Ue[1].v=numdate(Ue[1].v))),re.qpro&&Ue[3]>ve&&(ce["!ref"]=encode_range(Se),Ae[fe]=ce,be.push(fe),ce=re.dense?[]:{},Se={s:{r:0,c:0},e:{r:0,c:0}},ve=Ue[3],fe=pe||"Sheet"+(ve+1),pe="");var Ve=re.dense?(ce[Ue[0].r]||[])[Ue[0].c]:ce[encode_cell(Ue[0])];if(Ve){Ve.t=Ue[1].t,Ve.v=Ue[1].v,Ue[1].z!=null&&(Ve.z=Ue[1].z),Ue[1].f!=null&&(Ve.f=Ue[1].f);break}re.dense?(ce[Ue[0].r]||(ce[Ue[0].r]=[]),ce[Ue[0].r][Ue[0].c]=Ue[1]):ce[encode_cell(Ue[0])]=Ue[1];break}},re);else if(oe[2]==26||oe[2]==14)re.Enum=_e,oe[2]==14&&(re.qpro=!0,oe.l=0),t(oe,function(Ue,Ce,Le){switch(Le){case 204:fe=Ue;break;case 22:Ue[1].v=Ue[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ue[3]>ve&&(ce["!ref"]=encode_range(Se),Ae[fe]=ce,be.push(fe),ce=re.dense?[]:{},Se={s:{r:0,c:0},e:{r:0,c:0}},ve=Ue[3],fe="Sheet"+(ve+1)),Xe>0&&Ue[0].r>=Xe)break;re.dense?(ce[Ue[0].r]||(ce[Ue[0].r]=[]),ce[Ue[0].r][Ue[0].c]=Ue[1]):ce[encode_cell(Ue[0])]=Ue[1],Se.e.c<Ue[0].c&&(Se.e.c=Ue[0].c),Se.e.r<Ue[0].r&&(Se.e.r=Ue[0].r);break;case 27:Ue[14e3]&&(je[Ue[14e3][0]]=Ue[14e3][1]);break;case 1537:je[Ue[0]]=Ue[1],Ue[0]==ve&&(fe=Ue[1]);break}},re);else throw new Error("Unrecognized LOTUS BOF "+oe[2]);if(ce["!ref"]=encode_range(Se),Ae[pe||fe]=ce,be.push(pe||fe),!je.length)return{SheetNames:be,Sheets:Ae};for(var qe={},Je=[],We=0;We<je.length;++We)Ae[be[We]]?(Je.push(je[We]||be[We]),qe[je[We]]=Ae[je[We]]||Ae[be[We]]):(Je.push(je[We]),qe[je[We]]={"!ref":"A1"});return{SheetNames:Je,Sheets:qe}}function n(oe,ie){var re=ie||{};if(+re.codepage>=0&&set_cp(+re.codepage),re.type=="string")throw new Error("Cannot write WK1 to JS string");var ce=buf_array(),fe=safe_decode_range(oe["!ref"]),pe=Array.isArray(oe),ve=[];write_biff_rec(ce,0,s(1030)),write_biff_rec(ce,6,c(fe));for(var Ae=Math.min(fe.e.r,8191),be=fe.s.r;be<=Ae;++be)for(var je=encode_row(be),Se=fe.s.c;Se<=fe.e.c;++Se){be===fe.s.r&&(ve[Se]=encode_col(Se));var Xe=ve[Se]+je,qe=pe?(oe[be]||[])[Se]:oe[Xe];if(!(!qe||qe.t=="z"))if(qe.t=="n")(qe.v|0)==qe.v&&qe.v>=-32768&&qe.v<=32767?write_biff_rec(ce,13,E(be,Se,qe.v)):write_biff_rec(ce,14,p(be,Se,qe.v));else{var Je=format_cell(qe);write_biff_rec(ce,15,f(be,Se,Je.slice(0,239)))}}return write_biff_rec(ce,1),ce.end()}function i(oe,ie){var re=ie||{};if(+re.codepage>=0&&set_cp(+re.codepage),re.type=="string")throw new Error("Cannot write WK3 to JS string");var ce=buf_array();write_biff_rec(ce,0,a(oe));for(var fe=0,pe=0;fe<oe.SheetNames.length;++fe)(oe.Sheets[oe.SheetNames[fe]]||{})["!ref"]&&write_biff_rec(ce,27,ue(oe.SheetNames[fe],pe++));var ve=0;for(fe=0;fe<oe.SheetNames.length;++fe){var Ae=oe.Sheets[oe.SheetNames[fe]];if(!(!Ae||!Ae["!ref"])){for(var be=safe_decode_range(Ae["!ref"]),je=Array.isArray(Ae),Se=[],Xe=Math.min(be.e.r,8191),qe=be.s.r;qe<=Xe;++qe)for(var Je=encode_row(qe),We=be.s.c;We<=be.e.c;++We){qe===be.s.r&&(Se[We]=encode_col(We));var Ue=Se[We]+Je,Ce=je?(Ae[qe]||[])[We]:Ae[Ue];if(!(!Ce||Ce.t=="z"))if(Ce.t=="n")write_biff_rec(ce,23,O(qe,We,ve,Ce.v));else{var Le=format_cell(Ce);write_biff_rec(ce,22,x(qe,We,ve,Le.slice(0,239)))}}++ve}}return write_biff_rec(ce,1),ce.end()}function s(oe){var ie=new_buf(2);return ie.write_shift(2,oe),ie}function a(oe){var ie=new_buf(26);ie.write_shift(2,4096),ie.write_shift(2,4),ie.write_shift(4,0);for(var re=0,ce=0,fe=0,pe=0;pe<oe.SheetNames.length;++pe){var ve=oe.SheetNames[pe],Ae=oe.Sheets[ve];if(!(!Ae||!Ae["!ref"])){++fe;var be=decode_range(Ae["!ref"]);re<be.e.r&&(re=be.e.r),ce<be.e.c&&(ce=be.e.c)}}return re>8191&&(re=8191),ie.write_shift(2,re),ie.write_shift(1,fe),ie.write_shift(1,ce),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(1,1),ie.write_shift(1,2),ie.write_shift(4,0),ie.write_shift(4,0),ie}function o(oe,ie,re){var ce={s:{c:0,r:0},e:{c:0,r:0}};return ie==8&&re.qpro?(ce.s.c=oe.read_shift(1),oe.l++,ce.s.r=oe.read_shift(2),ce.e.c=oe.read_shift(1),oe.l++,ce.e.r=oe.read_shift(2),ce):(ce.s.c=oe.read_shift(2),ce.s.r=oe.read_shift(2),ie==12&&re.qpro&&(oe.l+=2),ce.e.c=oe.read_shift(2),ce.e.r=oe.read_shift(2),ie==12&&re.qpro&&(oe.l+=2),ce.s.c==65535&&(ce.s.c=ce.e.c=ce.s.r=ce.e.r=0),ce)}function c(oe){var ie=new_buf(8);return ie.write_shift(2,oe.s.c),ie.write_shift(2,oe.s.r),ie.write_shift(2,oe.e.c),ie.write_shift(2,oe.e.r),ie}function u(oe,ie,re){var ce=[{c:0,r:0},{t:"n",v:0},0,0];return re.qpro&&re.vers!=20768?(ce[0].c=oe.read_shift(1),ce[3]=oe.read_shift(1),ce[0].r=oe.read_shift(2),oe.l+=2):(ce[2]=oe.read_shift(1),ce[0].c=oe.read_shift(2),ce[0].r=oe.read_shift(2)),ce}function h(oe,ie,re){var ce=oe.l+ie,fe=u(oe,ie,re);if(fe[1].t="s",re.vers==20768){oe.l++;var pe=oe.read_shift(1);return fe[1].v=oe.read_shift(pe,"utf8"),fe}return re.qpro&&oe.l++,fe[1].v=oe.read_shift(ce-oe.l,"cstr"),fe}function f(oe,ie,re){var ce=new_buf(7+re.length);ce.write_shift(1,255),ce.write_shift(2,ie),ce.write_shift(2,oe),ce.write_shift(1,39);for(var fe=0;fe<ce.length;++fe){var pe=re.charCodeAt(fe);ce.write_shift(1,pe>=128?95:pe)}return ce.write_shift(1,0),ce}function m(oe,ie,re){var ce=u(oe,ie,re);return ce[1].v=oe.read_shift(2,"i"),ce}function E(oe,ie,re){var ce=new_buf(7);return ce.write_shift(1,255),ce.write_shift(2,ie),ce.write_shift(2,oe),ce.write_shift(2,re,"i"),ce}function g(oe,ie,re){var ce=u(oe,ie,re);return ce[1].v=oe.read_shift(8,"f"),ce}function p(oe,ie,re){var ce=new_buf(13);return ce.write_shift(1,255),ce.write_shift(2,ie),ce.write_shift(2,oe),ce.write_shift(8,re,"f"),ce}function _(oe,ie,re){var ce=oe.l+ie,fe=u(oe,ie,re);if(fe[1].v=oe.read_shift(8,"f"),re.qpro)oe.l=ce;else{var pe=oe.read_shift(2);ne(oe.slice(oe.l,oe.l+pe),fe),oe.l+=pe}return fe}function A(oe,ie,re){var ce=ie&32768;return ie&=-32769,ie=(ce?oe:0)+(ie>=8192?ie-16384:ie),(ce?"":"$")+(re?encode_col(ie):encode_row(ie))}var H={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},te=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function ne(oe,ie){prep_blob(oe,0);for(var re=[],ce=0,fe="",pe="",ve="",Ae="";oe.l<oe.length;){var be=oe[oe.l++];switch(be){case 0:re.push(oe.read_shift(8,"f"));break;case 1:pe=A(ie[0].c,oe.read_shift(2),!0),fe=A(ie[0].r,oe.read_shift(2),!1),re.push(pe+fe);break;case 2:{var je=A(ie[0].c,oe.read_shift(2),!0),Se=A(ie[0].r,oe.read_shift(2),!1);pe=A(ie[0].c,oe.read_shift(2),!0),fe=A(ie[0].r,oe.read_shift(2),!1),re.push(je+Se+":"+pe+fe)}break;case 3:if(oe.l<oe.length){console.error("WK1 premature formula end");return}break;case 4:re.push("("+re.pop()+")");break;case 5:re.push(oe.read_shift(2));break;case 6:{for(var Xe="";be=oe[oe.l++];)Xe+=String.fromCharCode(be);re.push('"'+Xe.replace(/"/g,'""')+'"')}break;case 8:re.push("-"+re.pop());break;case 23:re.push("+"+re.pop());break;case 22:re.push("NOT("+re.pop()+")");break;case 20:case 21:Ae=re.pop(),ve=re.pop(),re.push(["AND","OR"][be-20]+"("+ve+","+Ae+")");break;default:if(be<32&&te[be])Ae=re.pop(),ve=re.pop(),re.push(ve+te[be]+Ae);else if(H[be]){if(ce=H[be][1],ce==69&&(ce=oe[oe.l++]),ce>re.length){console.error("WK1 bad formula parse 0x"+be.toString(16)+":|"+re.join("|")+"|");return}var qe=re.slice(-ce);re.length-=ce,re.push(H[be][0]+"("+qe.join(",")+")")}else return be<=7?console.error("WK1 invalid opcode "+be.toString(16)):be<=24?console.error("WK1 unsupported op "+be.toString(16)):be<=30?console.error("WK1 invalid opcode "+be.toString(16)):be<=115?console.error("WK1 unsupported function opcode "+be.toString(16)):console.error("WK1 unrecognized opcode "+be.toString(16))}}re.length==1?ie[1].f=""+re[0]:console.error("WK1 bad formula parse |"+re.join("|")+"|")}function j(oe){var ie=[{c:0,r:0},{t:"n",v:0},0];return ie[0].r=oe.read_shift(2),ie[3]=oe[oe.l++],ie[0].c=oe[oe.l++],ie}function ee(oe,ie){var re=j(oe);return re[1].t="s",re[1].v=oe.read_shift(ie-4,"cstr"),re}function x(oe,ie,re,ce){var fe=new_buf(6+ce.length);fe.write_shift(2,oe),fe.write_shift(1,re),fe.write_shift(1,ie),fe.write_shift(1,39);for(var pe=0;pe<ce.length;++pe){var ve=ce.charCodeAt(pe);fe.write_shift(1,ve>=128?95:ve)}return fe.write_shift(1,0),fe}function M(oe,ie){var re=j(oe);re[1].v=oe.read_shift(2);var ce=re[1].v>>1;if(re[1].v&1)switch(ce&7){case 0:ce=(ce>>3)*5e3;break;case 1:ce=(ce>>3)*500;break;case 2:ce=(ce>>3)/20;break;case 3:ce=(ce>>3)/200;break;case 4:ce=(ce>>3)/2e3;break;case 5:ce=(ce>>3)/2e4;break;case 6:ce=(ce>>3)/16;break;case 7:ce=(ce>>3)/64;break}return re[1].v=ce,re}function T(oe,ie){var re=j(oe),ce=oe.read_shift(4),fe=oe.read_shift(4),pe=oe.read_shift(2);if(pe==65535)return ce===0&&fe===3221225472?(re[1].t="e",re[1].v=15):ce===0&&fe===3489660928?(re[1].t="e",re[1].v=42):re[1].v=0,re;var ve=pe&32768;return pe=(pe&32767)-16446,re[1].v=(1-ve*2)*(fe*Math.pow(2,pe+32)+ce*Math.pow(2,pe)),re}function O(oe,ie,re,ce){var fe=new_buf(14);if(fe.write_shift(2,oe),fe.write_shift(1,re),fe.write_shift(1,ie),ce==0)return fe.write_shift(4,0),fe.write_shift(4,0),fe.write_shift(2,65535),fe;var pe=0,ve=0,Ae=0,be=0;return ce<0&&(pe=1,ce=-ce),ve=Math.log2(ce)|0,ce/=Math.pow(2,ve-31),be=ce>>>0,(be&2147483648)==0&&(ce/=2,++ve,be=ce>>>0),ce-=be,be|=2147483648,be>>>=0,ce*=Math.pow(2,32),Ae=ce>>>0,fe.write_shift(4,Ae),fe.write_shift(4,be),ve+=16383+(pe?32768:0),fe.write_shift(2,ve),fe}function R(oe,ie){var re=T(oe);return oe.l+=ie-14,re}function Y(oe,ie){var re=j(oe),ce=oe.read_shift(4);return re[1].v=ce>>6,re}function q(oe,ie){var re=j(oe),ce=oe.read_shift(8,"f");return re[1].v=ce,re}function me(oe,ie){var re=q(oe);return oe.l+=ie-10,re}function xe(oe,ie){return oe[oe.l+ie-1]==0?oe.read_shift(ie,"cstr"):""}function Ee(oe,ie){var re=oe[oe.l++];re>ie-1&&(re=ie-1);for(var ce="";ce.length<re;)ce+=String.fromCharCode(oe[oe.l++]);return ce}function se(oe,ie,re){if(!(!re.qpro||ie<21)){var ce=oe.read_shift(1);oe.l+=17,oe.l+=1,oe.l+=2;var fe=oe.read_shift(ie-21,"cstr");return[ce,fe]}}function Fe(oe,ie){for(var re={},ce=oe.l+ie;oe.l<ce;){var fe=oe.read_shift(2);if(fe==14e3){for(re[fe]=[0,""],re[fe][0]=oe.read_shift(2);oe[oe.l];)re[fe][1]+=String.fromCharCode(oe[oe.l]),oe.l++;oe.l++}}return re}function ue(oe,ie){var re=new_buf(5+oe.length);re.write_shift(2,14e3),re.write_shift(2,ie);for(var ce=0;ce<oe.length;++ce){var fe=oe.charCodeAt(ce);re[re.l++]=fe>127?95:fe}return re[re.l++]=0,re}var ae={0:{n:"BOF",f:parseuint16},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:xe},222:{n:"SHEETNAMELP",f:Ee},65535:{n:""}},_e={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:ee},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:M},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Fe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Y},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:me},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:xe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:se},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function parse_rpr(t){var e={},r=t.match(tagregex),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=parsexmltag(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=CS2CP[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var parse_rs=function(){var t=matchtag("t"),e=matchtag("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:unescapexml(a[1])},c=s.match(e);return c&&(o.s=parse_rpr(c[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),rs_to_html=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var c=i.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),a.push("</"+c+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),sitregex=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,sirregex=/<(?:\w+:)?r>/,sirphregex=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function parse_si(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=unescapexml(utf8read(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=utf8read(t),r&&(n.h=escapehtml(n.t))):t.match(sirregex)&&(n.r=utf8read(t),n.t=unescapexml(utf8read((t.replace(sirphregex,"").match(sitregex)||[]).join("").replace(tagregex,""))),r&&(n.h=rs_to_html(parse_rs(n.r)))),n):{t:""}}var sstr0=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,sstr1=/<(?:\w+:)?(?:si|sstItem)>/g,sstr2=/<\/(?:\w+:)?(?:si|sstItem)>/;function parse_sst_xml(t,e){var r=[],n="";if(!t)return r;var i=t.match(sstr0);if(i){n=i[2].replace(sstr1,"").split(sstr2);for(var s=0;s!=n.length;++s){var a=parse_si(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=parsexmltag(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var straywsregex=/^\s|\s$|[\t\n\r]/;function write_sst_xml(t,e){if(!e.bookSST)return"";var r=[XML_HEADER];r[r.length]=writextag("sst",null,{xmlns:XMLNS_main[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(straywsregex)&&(s+=' xml:space="preserve"'),s+=">"+escapexml(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function parse_BrtBeginSst(t){return[t.read_shift(4),t.read_shift(4)]}function parse_sst_bin(t,e){var r=[],n=!1;return recordhopper(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function write_BrtBeginSst(t,e){return e||(e=new_buf(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var write_BrtSSTItem=write_RichStr;function write_sst_bin(t){var e=buf_array();write_record(e,159,write_BrtBeginSst(t));for(var r=0;r<t.length;++r)write_record(e,19,write_BrtSSTItem(t[r]));return write_record(e,160),e.end()}function _JS2ANSI(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function parse_CRYPTOVersion(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function parse_DataSpaceVersionInfo(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=parse_CRYPTOVersion(t,4),e.U=parse_CRYPTOVersion(t,4),e.W=parse_CRYPTOVersion(t,4),e}function parse_DataSpaceMapEntry(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function parse_DataSpaceMap(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(parse_DataSpaceMapEntry(t));return e}function parse_DataSpaceDefinition(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function parse_TransformInfoHeader(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=parse_CRYPTOVersion(t,4),e.U=parse_CRYPTOVersion(t,4),e.W=parse_CRYPTOVersion(t,4),e}function parse_Primary(t){var e=parse_TransformInfoHeader(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function parse_EncryptionHeader(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function parse_EncryptionVerifier(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function parse_EncryptionInfo(t){var e=parse_CRYPTOVersion(t);switch(e.Minor){case 2:return[e.Minor,parse_EncInfoStd(t)];case 3:return[e.Minor,parse_EncInfoExt()];case 4:return[e.Minor,parse_EncInfoAgl(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function parse_EncInfoStd(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=parse_EncryptionHeader(t,r),i=parse_EncryptionVerifier(t,t.length-t.l);return{t:"Std",h:n,v:i}}function parse_EncInfoExt(){throw new Error("File is password-protected: ECMA-376 Extensible")}function parse_EncInfoAgl(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(tagregex,function(s){var a=parsexmltag(s);switch(strip_ns(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function parse_RC4CryptoHeader(t,e){var r={},n=r.EncryptionVersionInfo=parse_CRYPTOVersion(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=parse_EncryptionHeader(t,i),e-=i,r.EncryptionVerifier=parse_EncryptionVerifier(t,e),r}function parse_RC4Header(t){var e={},r=e.EncryptionVersionInfo=parse_CRYPTOVersion(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function crypto_CreatePasswordVerifier_Method1(t){var e=0,r,n=_JS2ANSI(t),i=n.length+1,s,a,o,c,u;for(r=new_raw_buf(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=(e&16384)===0?0:1,c=e<<1&32767,u=o|c,e=u^a;return e^52811}var crypto_CreateXorArray_Method1=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],c=104,u=a.length-1;u>=0;--u)for(var h=a[u],f=0;f!=7;++f)h&64&&(o^=r[c]),h*=2,--c;return o};return function(a){for(var o=_JS2ANSI(a),c=s(o),u=o.length,h=new_raw_buf(16),f=0;f!=16;++f)h[f]=0;var m,E,g;for((u&1)===1&&(m=c>>8,h[u]=i(t[0],m),--u,m=c&255,E=o[o.length-1],h[u]=i(E,m));u>0;)--u,m=c>>8,h[u]=i(o[u],m),--u,m=c&255,h[u]=i(o[u],m);for(u=15,g=15-o.length;g>0;)m=c>>8,h[u]=i(t[g],m),--u,--g,m=c&255,h[u]=i(o[u],m),--u,--g;return h}}(),crypto_DecryptData_Method1=function(t,e,r,n,i){i||(i=e),n||(n=crypto_CreateXorArray_Method1(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},crypto_MakeXorDecryptor=function(t){var e=0,r=crypto_CreateXorArray_Method1(t);return function(n){var i=crypto_DecryptData_Method1("",n,e,r);return e=i[1],i[0]}};function parse_XORObfuscation(t,e,r,n){var i={key:parseuint16(t),verificationBytes:parseuint16(t)};return r.password&&(i.verifier=crypto_CreatePasswordVerifier_Method1(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=crypto_MakeXorDecryptor(r.password)),i}function parse_FilePassHeader(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=parse_RC4Header(t):n.Data=parse_RC4CryptoHeader(t,e),n}function parse_FilePass(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?parse_FilePassHeader(t,e-2,n):parse_XORObfuscation(t,r.biff>=8?e:e-2,r,n),n}var RTF=function(){function t(i,s){switch(s.type){case"base64":return e(Base64_decode(i),s);case"binary":return e(i,s);case"buffer":return e(has_buf&&Buffer.isBuffer(i)?i.toString("binary"):a2s(i),s);case"array":return e(cc2str(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(h,f){Array.isArray(o)&&(o[f]=[]);for(var m=/\\\w+\b/g,E=0,g,p=-1;g=m.exec(h);){switch(g[0]){case"\\cell":var _=h.slice(E,m.lastIndex-g[0].length);if(_[0]==" "&&(_=_.slice(1)),++p,_.length){var A={v:_,t:"s"};Array.isArray(o)?o[f][p]=A:o[encode_cell({r:f,c:p})]=A}break}E=m.lastIndex}p>u.e.c&&(u.e.c=p)}),o["!ref"]=encode_range(u),o}function r(i,s){return sheet_to_workbook(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=safe_decode_range(i["!ref"]),o,c=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var h=a.s.c;h<=a.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=a.s.c;h<=a.e.c;++h){var f=encode_cell({r:u,c:h});o=c?(i[u]||[])[h]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(format_cell(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function hex2RGB(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function rgb2Hex(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function rgb2HSL(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,c=0,u=i+s;switch(c=a/(u>1?2-u:u),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,c,u/2]}function hsl2RGB(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,c;if(r!==0)switch(o|0){case 0:case 6:c=i*o,a[0]+=i,a[1]+=c;break;case 1:c=i*(2-o),a[0]+=c,a[1]+=i;break;case 2:c=i*(o-2),a[1]+=i,a[2]+=c;break;case 3:c=i*(4-o),a[1]+=c,a[2]+=i;break;case 4:c=i*(o-4),a[2]+=i,a[0]+=c;break;case 5:c=i*(6-o),a[2]+=c,a[0]+=i;break}for(var u=0;u!=3;++u)a[u]=Math.round(a[u]*255);return a}function rgb_tint(t,e){if(e===0)return t;var r=rgb2HSL(hex2RGB(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),rgb2Hex(hsl2RGB(r))}var DEF_MDW=6,MAX_MDW=15,MIN_MDW=1,MDW=DEF_MDW;function width2px(t){return Math.floor((t+Math.round(128/MDW)/256)*MDW)}function px2char(t){return Math.floor((t-5)/MDW*100+.5)/100}function char2width(t){return Math.round((t*MDW+5)/MDW*256)/256}function cycle_width(t){return char2width(px2char(width2px(t)))}function find_mdw_colw(t){var e=Math.abs(t-cycle_width(t)),r=MDW;if(e>.005)for(MDW=MIN_MDW;MDW<MAX_MDW;++MDW)Math.abs(t-cycle_width(t))<=e&&(e=Math.abs(t-cycle_width(t)),r=MDW);MDW=r}function process_col(t){t.width?(t.wpx=width2px(t.width),t.wch=px2char(t.wpx),t.MDW=MDW):t.wpx?(t.wch=px2char(t.wpx),t.width=char2width(t.wch),t.MDW=MDW):typeof t.wch=="number"&&(t.width=char2width(t.wch),t.wpx=width2px(t.width),t.MDW=MDW),t.customWidth&&delete t.customWidth}var DEF_PPI=96,PPI=DEF_PPI;function px2pt(t){return t*96/PPI}function pt2px(t){return t*PPI/96}var XLMLPatternTypeMap={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function parse_borders(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(tagregex)||[]).forEach(function(a){var o=parsexmltag(a);switch(strip_ns(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=parsexmlbool(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=parsexmlbool(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function parse_fills(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(tagregex)||[]).forEach(function(a){var o=parsexmltag(a);switch(strip_ns(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function parse_fonts(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(tagregex)||[]).forEach(function(a){var o=parsexmltag(a);switch(strip_ns(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=utf8read(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?parsexmlbool(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?parsexmlbool(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?parsexmlbool(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?parsexmlbool(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?parsexmlbool(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?parsexmlbool(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?parsexmlbool(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=CS2CP[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=parsexmlbool(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var c=XLSIcv[i.color.index];i.color.index==81&&(c=XLSIcv[1]),c||(c=XLSIcv[1]),i.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=rgb_tint(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function parse_numFmts(t,e,r){e.NumberFmt=[];for(var n=keys(table_fmt),i=0;i<n.length;++i)e.NumberFmt[n[i]]=table_fmt[n[i]];var s=t[0].match(tagregex);if(s)for(i=0;i<s.length;++i){var a=parsexmltag(s[i]);switch(strip_ns(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=unescapexml(utf8read(a.formatCode)),c=parseInt(a.numFmtId,10);if(e.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=o}SSF_load(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function write_numFmts(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=writextag("numFmt",null,{numFmtId:n,formatCode:escapexml(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=writextag("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var cellXF_uint=["numFmtId","fillId","fontId","borderId","xfId"],cellXF_bool=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function parse_cellXfs(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(tagregex)||[]).forEach(function(s){var a=parsexmltag(s),o=0;switch(strip_ns(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<cellXF_uint.length;++o)n[cellXF_uint[o]]&&(n[cellXF_uint[o]]=parseInt(n[cellXF_uint[o]],10));for(o=0;o<cellXF_bool.length;++o)n[cellXF_bool[o]]&&(n[cellXF_bool[o]]=parsexmlbool(n[cellXF_bool[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};a.vertical&&(c.vertical=a.vertical),a.horizontal&&(c.horizontal=a.horizontal),a.textRotation!=null&&(c.textRotation=a.textRotation),a.indent&&(c.indent=a.indent),a.wrapText&&(c.wrapText=parsexmlbool(a.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function write_cellXfs(t){var e=[];return e[e.length]=writextag("cellXfs",null),t.forEach(function(r){e[e.length]=writextag("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=writextag("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var parse_sty_xml=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var h={};if(!o)return h;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(e))&&parse_numFmts(f,h,u),(f=o.match(i))&&parse_fonts(f,h,c,u),(f=o.match(n))&&parse_fills(f,h,c,u),(f=o.match(s))&&parse_borders(f,h,c,u),(f=o.match(r))&&parse_cellXfs(f,h,u),h}}();function write_sty_xml(t,e){var r=[XML_HEADER,writextag("styleSheet",null,{xmlns:XMLNS_main[0],"xmlns:vt":XMLNS.vt})],n;return t.SSF&&(n=write_numFmts(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=write_cellXfs(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function parse_BrtFmt(t,e){var r=t.read_shift(2),n=parse_XLWideString(t);return[r,n]}function write_BrtFmt(t,e,r){r||(r=new_buf(6+4*e.length)),r.write_shift(2,t),write_XLWideString(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function parse_BrtFont(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=parse_FontFlags(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=parse_BrtColor(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=parse_XLWideString(t),n}function write_BrtFont(t,e){e||(e=new_buf(25+4*32)),e.write_shift(2,t.sz*20),write_FontFlags(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),write_BrtColor(t.color,e);var n=0;return n=2,e.write_shift(1,n),write_XLWideString(t.name,e),e.length>e.l?e.slice(0,e.l):e}var XLSBFillPTNames=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rev_XLSBFillPTNames,parse_BrtFill=parsenoop;function write_BrtFill(t,e){e||(e=new_buf(4*3+8*7+16*1)),rev_XLSBFillPTNames||(rev_XLSBFillPTNames=evert(XLSBFillPTNames));var r=rev_XLSBFillPTNames[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(write_BrtColor({auto:1},e),write_BrtColor({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function parse_BrtXF(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function write_BrtXF(t,e,r){r||(r=new_buf(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function write_Blxf(t,e){return e||(e=new_buf(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var parse_BrtBorder=parsenoop;function write_BrtBorder(t,e){return e||(e=new_buf(51)),e.write_shift(1,0),write_Blxf(null,e),write_Blxf(null,e),write_Blxf(null,e),write_Blxf(null,e),write_Blxf(null,e),e.length>e.l?e.slice(0,e.l):e}function write_BrtStyle(t,e){return e||(e=new_buf(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),write_XLNullableWideString(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function write_BrtBeginTableStyles(t,e,r){var n=new_buf(2052);return n.write_shift(4,t),write_XLNullableWideString(e,n),write_XLNullableWideString(r,n),n.length>n.l?n.slice(0,n.l):n}function parse_sty_bin(t,e,r){var n={};n.NumberFmt=[];for(var i in table_fmt)n.NumberFmt[i]=table_fmt[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return recordhopper(t,function(c,u,h){switch(h){case 44:n.NumberFmt[c[0]]=c[1],SSF_load(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=rgb_tint(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(h),a=!0;break;case 38:s.pop(),a=!1;break;default:if(u.T>0)s.push(h);else if(u.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}function write_FMTS_bin(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(write_record(t,615,write_UInt32LE(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&write_record(t,44,write_BrtFmt(i,e[i]))}),write_record(t,616))}}function write_FONTS_bin(t){var e=1;write_record(t,611,write_UInt32LE(e)),write_record(t,43,write_BrtFont({sz:12,color:{theme:1},name:"Calibri",family:2})),write_record(t,612)}function write_FILLS_bin(t){var e=2;write_record(t,603,write_UInt32LE(e)),write_record(t,45,write_BrtFill({patternType:"none"})),write_record(t,45,write_BrtFill({patternType:"gray125"})),write_record(t,604)}function write_BORDERS_bin(t){var e=1;write_record(t,613,write_UInt32LE(e)),write_record(t,46,write_BrtBorder()),write_record(t,614)}function write_CELLSTYLEXFS_bin(t){var e=1;write_record(t,626,write_UInt32LE(e)),write_record(t,47,write_BrtXF({numFmtId:0},65535)),write_record(t,627)}function write_CELLXFS_bin(t,e){write_record(t,617,write_UInt32LE(e.length)),e.forEach(function(r){write_record(t,47,write_BrtXF(r,0))}),write_record(t,618)}function write_STYLES_bin(t){var e=1;write_record(t,619,write_UInt32LE(e)),write_record(t,48,write_BrtStyle({xfId:0,name:"Normal"})),write_record(t,620)}function write_DXFS_bin(t){var e=0;write_record(t,505,write_UInt32LE(e)),write_record(t,506)}function write_TABLESTYLES_bin(t){var e=0;write_record(t,508,write_BrtBeginTableStyles(e,"TableStyleMedium9","PivotStyleMedium4")),write_record(t,509)}function write_sty_bin(t,e){var r=buf_array();return write_record(r,278),write_FMTS_bin(r,t.SSF),write_FONTS_bin(r),write_FILLS_bin(r),write_BORDERS_bin(r),write_CELLSTYLEXFS_bin(r),write_CELLXFS_bin(r,e.cellXfs),write_STYLES_bin(r),write_DXFS_bin(r),write_TABLESTYLES_bin(r),write_record(r,279),r.end()}var XLSXThemeClrScheme=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function parse_clrScheme(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(tagregex)||[]).forEach(function(i){var s=parsexmltag(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[XLSXThemeClrScheme.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function parse_fontScheme(){}function parse_fmtScheme(){}var clrsregex=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,fntsregex=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,fmtsregex=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function parse_themeElements(t,e,r){e.themeElements={};var n;[["clrScheme",clrsregex,parse_clrScheme],["fontScheme",fntsregex,parse_fontScheme],["fmtScheme",fmtsregex,parse_fmtScheme]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var themeltregex=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function parse_theme_xml(t,e){(!t||t.length===0)&&(t=write_theme());var r,n={};if(!(r=t.match(themeltregex)))throw new Error("themeElements not found in theme");return parse_themeElements(r[0],n,e),n.raw=t,n}function write_theme(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[XML_HEADER];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',r[r.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',r[r.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',r[r.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',r[r.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function parse_Theme(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=zip_read(s,{type:"array"})}catch(c){return}var o=getzipstr(a,"theme/theme/theme1.xml",!0);if(o)return parse_theme_xml(o,r)}}function parse_ColorTheme(t){return t.read_shift(4)}function parse_FullColorExt(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=parse_IcvXF(t,4);break;case 2:e.xclrValue=parse_LongRGBA(t);break;case 3:e.xclrValue=parse_ColorTheme(t);break;case 4:t.l+=4;break}return t.l+=8,e}function parse_IcvXF(t,e){return parsenoop(t,e)}function parse_XFExtGradient(t,e){return parsenoop(t,e)}function parse_ExtProp(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=parse_FullColorExt(t);break;case 6:n[1]=parse_XFExtGradient(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function parse_XFExt(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(parse_ExtProp(t,r-t.l));return{ixfe:n,ext:s}}function update_xfext(t,e){e.forEach(function(r){r[0]})}function parse_BrtMdtinfo(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:parse_XLWideString(t)}}function write_BrtMdtinfo(t){var e=new_buf(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),write_XLWideString(t.name,e),e.slice(0,e.l)}function parse_BrtMdb(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function write_BrtMdb(t){var e=new_buf(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function write_BrtBeginEsfmd(t,e){var r=new_buf(8+2*e.length);return r.write_shift(4,t),write_XLWideString(e,r),r.slice(0,r.l)}function parse_BrtBeginEsmdb(t){return t.l+=4,t.read_shift(4)!=0}function write_BrtBeginEsmdb(t,e){var r=new_buf(8);return r.write_shift(4,t),r.write_shift(4,1),r}function parse_xlmeta_bin(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return recordhopper(t,function(c,u,h){switch(h){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:s.push(h),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!u.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function write_xlmeta_bin(){var t=buf_array();return write_record(t,332),write_record(t,334,write_UInt32LE(1)),write_record(t,335,write_BrtMdtinfo({name:"XLDAPR",version:12e4,flags:3496657072})),write_record(t,336),write_record(t,339,write_BrtBeginEsfmd(1,"XLDAPR")),write_record(t,52),write_record(t,35,write_UInt32LE(514)),write_record(t,4096,write_UInt32LE(0)),write_record(t,4097,writeuint16(1)),write_record(t,36),write_record(t,53),write_record(t,340),write_record(t,337,write_BrtBeginEsmdb(1)),write_record(t,51,write_BrtMdb([[1,0]])),write_record(t,338),write_record(t,333),t.end()}function parse_xlmeta_xml(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(tagregex,function(o){var c=parsexmltag(o);switch(strip_ns(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(a=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+c.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function write_xlmeta_xml(){var t=[XML_HEADER];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function parse_cc_xml(t){var e=[];if(!t)return e;var r=1;return(t.match(tagregex)||[]).forEach(function(n){var i=parsexmltag(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function parse_BrtCalcChainItem$(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=encode_cell(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function parse_cc_bin(t,e,r){var n=[];return recordhopper(t,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function parse_xlink_xml(){}function parse_xlink_bin(t,e,r,n){if(!t)return t;var i=n||{},s=!1;recordhopper(t,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function parse_drawing(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var _shapeid=1024;function write_comments_vml(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[writextag("xml",null,{"xmlns:v":XLMLNS.v,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:mv":XLMLNS.mv}).replace(/\/>/,">"),writextag("o:shapelayout",writextag("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),writextag("v:shapetype",[writextag("v:stroke",null,{joinstyle:"miter"}),writextag("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];_shapeid<t*1e3;)_shapeid+=1e3;return e.forEach(function(s){var a=decode_cell(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?writextag("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=writextag("v:fill",c,o),h={on:"t",obscured:"t"};++_shapeid,i=i.concat(["<v:shape"+wxt_helper({id:"_x0000_s"+_shapeid,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,writextag("v:shadow",null,h),writextag("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",writetag("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),writetag("x:AutoFill","False"),writetag("x:Row",String(a.r)),writetag("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function sheet_insert_comments(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=decode_cell(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var c=safe_decode_range(t["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=encode_range(c);u!==t["!ref"]&&(t["!ref"]=u)}s.c||(s.c=[]);var h={a:a.author,t:a.t,r:a.r,T:r};a.h&&(h.h=a.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(h.a==n[f].id){h.a=n[f].name||h.a;break}}s.c.push(h)})}function parse_comments_xml(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=parsexmltag(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},h=decode_cell(c.ref);if(!(e.sheetRows&&e.sheetRows<=h.r)){var f=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!f&&!!f[1]&&parse_si(f[1])||{r:"",t:"",h:""};u.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),u.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(u.h=m.h),n.push(u)}}}}),n}function write_comments_xml(t){var e=[XML_HEADER,writextag("comments",null,{xmlns:XMLNS_main[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=escapexml(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(i=r.indexOf(escapexml(c.a))),s.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(writetag("t",escapexml(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(writetag("t",escapexml(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function parse_tcmnt_xml(t,e){var r=[],n=!1,i={},s=0;return t.replace(tagregex,function(o,c){var u=parsexmltag(o);switch(strip_ns(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=c+o.length;break;case"</text>":i.t=t.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function write_tcmnt_xml(t,e,r){var n=[XML_HEADER,writextag("ThreadedComments",null,{xmlns:XMLNS.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var c={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=c.id:c.parentId=s,a.ID=c.id,a.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(writextag("threadedComment",writetag("text",a.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function parse_people_xml(t,e){var r=[],n=!1;return t.replace(tagregex,function(s){var a=parsexmltag(s);switch(strip_ns(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function write_people_xml(t){var e=[XML_HEADER,writextag("personList",null,{xmlns:XMLNS.TCMNT,"xmlns:x":XMLNS_main[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(writextag("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function parse_BrtBeginComment(t){var e={};e.iauthor=t.read_shift(4);var r=parse_UncheckedRfX(t);return e.rfx=r.s,e.ref=encode_cell(r.s),t.l+=16,e}function write_BrtBeginComment(t,e){return e==null&&(e=new_buf(36)),e.write_shift(4,t[1].iauthor),write_UncheckedRfX(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var parse_BrtCommentAuthor=parse_XLWideString;function write_BrtCommentAuthor(t){return write_XLWideString(t.slice(0,54))}function parse_comments_bin(t,e){var r=[],n=[],i={},s=!1;return recordhopper(t,function(o,c,u){switch(u){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function write_comments_bin(t){var e=buf_array(),r=[];return write_record(e,628),write_record(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),write_record(e,632,write_BrtCommentAuthor(i.a)))})}),write_record(e,631),write_record(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:decode_cell(n[0]),e:decode_cell(n[0])};write_record(e,635,write_BrtBeginComment([s,i])),i.t&&i.t.length>0&&write_record(e,637,write_BrtCommentText(i)),write_record(e,636),delete i.iauthor})}),write_record(e,634),write_record(e,629),e.end()}var CT_VBA="application/vnd.ms-office.vbaProject";function make_vba_xls(t){var e=CFB.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");CFB.utils.cfb_add(e,i,t.FileIndex[n].content)}}),CFB.write(e)}function fill_vba_xls(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&CFB.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var VBAFMTS=["xlsb","xlsm","xlam","biff8","xla"];function parse_ds_bin(){return{"!type":"dialog"}}function parse_ds_xml(){return{"!type":"dialog"}}function parse_ms_bin(){return{"!type":"macro"}}function parse_ms_xml(){return{"!type":"macro"}}var rc_to_a1=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,h=a.length>0?parseInt(a,10)|0:0;return o?h+=e.c:--h,c?u+=e.r:--u,i+(o?"":"$")+encode_col(h)+(c?"":"$")+encode_row(u)}return function(i,s){return e=s,i.replace(t,r)}}(),crefregex=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,a1_to_rc=function(){return function(e,r){return e.replace(crefregex,function(n,i,s,a,o,c){var u=decode_col(a)-(s?0:r.c),h=decode_row(c)-(o?0:r.r),f=h==0?"":o?h+1:"["+h+"]",m=u==0?"":s?u+1:"["+u+"]";return i+"R"+f+"C"+m})}}();function shift_formula_str(t,e){return t.replace(crefregex,function(r,n,i,s,a,o){return n+(i=="$"?i+s:encode_col(decode_col(s)+e.c))+(a=="$"?a+o:encode_row(decode_row(o)+e.r))})}function shift_formula_xlsx(t,e,r){var n=decode_range(e),i=n.s,s=decode_cell(r),a={r:s.r-i.r,c:s.c-i.c};return shift_formula_str(t,a)}function fuzzyfmla(t){return t.length!=1}function _xlfn(t){return t.replace(/_xlfn\./g,"")}function parseread1(t){t.l+=1}function parse_ColRelU(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function parse_RgceArea(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return parse_RgceArea_BIFF2(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=parse_ColRelU(t),o=parse_ColRelU(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function parse_RgceArea_BIFF2(t){var e=parse_ColRelU(t),r=parse_ColRelU(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function parse_RgceAreaRel(t,e,r){if(r.biff<8)return parse_RgceArea_BIFF2(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=parse_ColRelU(t),a=parse_ColRelU(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function parse_RgceLoc(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return parse_RgceLoc_BIFF2(t);var n=t.read_shift(r&&r.biff==12?4:2),i=parse_ColRelU(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function parse_RgceLoc_BIFF2(t){var e=parse_ColRelU(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function parse_RgceElfLoc(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function parse_RgceLocRel(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return parse_RgceLocRel_BIFF2(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function parse_RgceLocRel_BIFF2(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function parse_PtgArea(t,e,r){var n=(t[t.l++]&96)>>5,i=parse_RgceArea(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function parse_PtgArea3d(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=parse_RgceArea(t,s,r);return[n,i,a]}function parse_PtgAreaErr(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function parse_PtgAreaErr3d(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function parse_PtgAreaN(t,e,r){var n=(t[t.l++]&96)>>5,i=parse_RgceAreaRel(t,e-1,r);return[n,i]}function parse_PtgArray(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function parse_PtgAttrBaxcel(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function parse_PtgAttrChoose(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function parse_PtgAttrGoto(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function parse_PtgAttrIf(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function parse_PtgAttrIfError(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function parse_PtgAttrSemi(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function parse_PtgAttrSpaceType(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function parse_PtgAttrSpace(t){return t.read_shift(2),parse_PtgAttrSpaceType(t)}function parse_PtgAttrSpaceSemi(t){return t.read_shift(2),parse_PtgAttrSpaceType(t)}function parse_PtgRef(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=parse_RgceLoc(t,0,r);return[n,i]}function parse_PtgRefN(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=parse_RgceLocRel(t,0,r);return[n,i]}function parse_PtgRef3d(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=parse_RgceLoc(t,0,r);return[n,i,s]}function parse_PtgFunc(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[FtabArgc[i],Ftab[i],n]}function parse_PtgFuncVar(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:parsetab(t);return[i,(s[0]===0?Ftab:Cetab)[s[1]]]}function parsetab(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function parse_PtgAttrSum(t,e,r){t.l+=r&&r.biff==2?3:4}function parse_PtgExp(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function parse_PtgErr(t){return t.l++,BErr[t.read_shift(1)]}function parse_PtgInt(t){return t.l++,t.read_shift(2)}function parse_PtgBool(t){return t.l++,t.read_shift(1)!==0}function parse_PtgNum(t){return t.l++,parse_Xnum(t)}function parse_PtgStr(t,e,r){return t.l++,parse_ShortXLUnicodeString(t,e-1,r)}function parse_SerAr(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=parsebool(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=BErr[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=parse_Xnum(t);break;case 2:r[1]=parse_XLUnicodeString2(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function parse_PtgExtraMem(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?parse_UncheckedRfX:parse_Ref8U)(t));return i}function parse_PtgExtraArray(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=parse_SerAr(t,r.biff);return a}function parse_PtgName(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function parse_PtgNameX(t,e,r){if(r.biff==5)return parse_PtgNameX_BIFF5(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function parse_PtgNameX_BIFF5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function parse_PtgMemArea(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function parse_PtgMemFunc(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function parse_PtgRefErr(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function parse_PtgRefErr3d(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var parse_PtgMemErr=parsenoop,parse_PtgMemNoMem=parsenoop,parse_PtgTbl=parsenoop;function parse_PtgElfLoc(t,e,r){return t.l+=2,[parse_RgceElfLoc(t)]}function parse_PtgElfNoop(t){return t.l+=6,[]}var parse_PtgElfCol=parse_PtgElfLoc,parse_PtgElfColS=parse_PtgElfNoop,parse_PtgElfColSV=parse_PtgElfNoop,parse_PtgElfColV=parse_PtgElfLoc;function parse_PtgElfLel(t){return t.l+=2,[parseuint16(t),t.read_shift(2)&1]}var parse_PtgElfRadical=parse_PtgElfLoc,parse_PtgElfRadicalLel=parse_PtgElfLel,parse_PtgElfRadicalS=parse_PtgElfNoop,parse_PtgElfRw=parse_PtgElfLoc,parse_PtgElfRwV=parse_PtgElfLoc,PtgListRT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function parse_PtgList(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=PtgListRT[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function parse_PtgSxName(t){return t.l+=2,[t.read_shift(4)]}function parse_PtgSheet(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function parse_PtgEndSheet(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function parse_PtgMemAreaN(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function parse_PtgMemNoMemN(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function parse_PtgAttrNoop(t){return t.l+=4,[0,0]}var PtgTypes={1:{n:"PtgExp",f:parse_PtgExp},2:{n:"PtgTbl",f:parse_PtgTbl},3:{n:"PtgAdd",f:parseread1},4:{n:"PtgSub",f:parseread1},5:{n:"PtgMul",f:parseread1},6:{n:"PtgDiv",f:parseread1},7:{n:"PtgPower",f:parseread1},8:{n:"PtgConcat",f:parseread1},9:{n:"PtgLt",f:parseread1},10:{n:"PtgLe",f:parseread1},11:{n:"PtgEq",f:parseread1},12:{n:"PtgGe",f:parseread1},13:{n:"PtgGt",f:parseread1},14:{n:"PtgNe",f:parseread1},15:{n:"PtgIsect",f:parseread1},16:{n:"PtgUnion",f:parseread1},17:{n:"PtgRange",f:parseread1},18:{n:"PtgUplus",f:parseread1},19:{n:"PtgUminus",f:parseread1},20:{n:"PtgPercent",f:parseread1},21:{n:"PtgParen",f:parseread1},22:{n:"PtgMissArg",f:parseread1},23:{n:"PtgStr",f:parse_PtgStr},26:{n:"PtgSheet",f:parse_PtgSheet},27:{n:"PtgEndSheet",f:parse_PtgEndSheet},28:{n:"PtgErr",f:parse_PtgErr},29:{n:"PtgBool",f:parse_PtgBool},30:{n:"PtgInt",f:parse_PtgInt},31:{n:"PtgNum",f:parse_PtgNum},32:{n:"PtgArray",f:parse_PtgArray},33:{n:"PtgFunc",f:parse_PtgFunc},34:{n:"PtgFuncVar",f:parse_PtgFuncVar},35:{n:"PtgName",f:parse_PtgName},36:{n:"PtgRef",f:parse_PtgRef},37:{n:"PtgArea",f:parse_PtgArea},38:{n:"PtgMemArea",f:parse_PtgMemArea},39:{n:"PtgMemErr",f:parse_PtgMemErr},40:{n:"PtgMemNoMem",f:parse_PtgMemNoMem},41:{n:"PtgMemFunc",f:parse_PtgMemFunc},42:{n:"PtgRefErr",f:parse_PtgRefErr},43:{n:"PtgAreaErr",f:parse_PtgAreaErr},44:{n:"PtgRefN",f:parse_PtgRefN},45:{n:"PtgAreaN",f:parse_PtgAreaN},46:{n:"PtgMemAreaN",f:parse_PtgMemAreaN},47:{n:"PtgMemNoMemN",f:parse_PtgMemNoMemN},57:{n:"PtgNameX",f:parse_PtgNameX},58:{n:"PtgRef3d",f:parse_PtgRef3d},59:{n:"PtgArea3d",f:parse_PtgArea3d},60:{n:"PtgRefErr3d",f:parse_PtgRefErr3d},61:{n:"PtgAreaErr3d",f:parse_PtgAreaErr3d},255:{}},PtgDupes={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ptg18={1:{n:"PtgElfLel",f:parse_PtgElfLel},2:{n:"PtgElfRw",f:parse_PtgElfRw},3:{n:"PtgElfCol",f:parse_PtgElfCol},6:{n:"PtgElfRwV",f:parse_PtgElfRwV},7:{n:"PtgElfColV",f:parse_PtgElfColV},10:{n:"PtgElfRadical",f:parse_PtgElfRadical},11:{n:"PtgElfRadicalS",f:parse_PtgElfRadicalS},13:{n:"PtgElfColS",f:parse_PtgElfColS},15:{n:"PtgElfColSV",f:parse_PtgElfColSV},16:{n:"PtgElfRadicalLel",f:parse_PtgElfRadicalLel},25:{n:"PtgList",f:parse_PtgList},29:{n:"PtgSxName",f:parse_PtgSxName},255:{}},Ptg19={0:{n:"PtgAttrNoop",f:parse_PtgAttrNoop},1:{n:"PtgAttrSemi",f:parse_PtgAttrSemi},2:{n:"PtgAttrIf",f:parse_PtgAttrIf},4:{n:"PtgAttrChoose",f:parse_PtgAttrChoose},8:{n:"PtgAttrGoto",f:parse_PtgAttrGoto},16:{n:"PtgAttrSum",f:parse_PtgAttrSum},32:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},33:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},64:{n:"PtgAttrSpace",f:parse_PtgAttrSpace},65:{n:"PtgAttrSpaceSemi",f:parse_PtgAttrSpaceSemi},128:{n:"PtgAttrIfError",f:parse_PtgAttrIfError},255:{}};function parse_RgbExtra(t,e,r,n){if(n.biff<8)return parsenoop(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=parse_PtgExtraArray(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=parse_PtgExtraMem(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(parsenoop(t,e)),s}function parse_Rgce(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=PtgTypes[s]||PtgTypes[PtgDupes[s]],(s===24||s===25)&&(i=(s===24?Ptg18:Ptg19)[t[t.l+1]]),!i||!i.f?parsenoop(t,e):a.push([i.n,i.f(t,e,r)]);return a}function stringify_array(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var PtgBinOp={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function formula_quote_sheet_name(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function get_ixti_raw(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function get_ixti(t,e,r){var n=get_ixti_raw(t,e,r);return n=="#REF"?n:formula_quote_sheet_name(n,r)}function stringify_formula(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],c,u,h,f=0,m=0,E,g="";if(!t[0]||!t[0][0])return"";for(var p=-1,_="",A=0,H=t[0].length;A<H;++A){var te=t[0][A];switch(te[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),p>=0){switch(t[0][p][1][0]){case 0:_=fill(" ",t[0][p][1][1]);break;case 1:_=fill("\r",t[0][p][1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}u=u+_,p=-1}o.push(u+PtgBinOp[te[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=shift_cell_xls(te[1][1],a,i),o.push(encode_cell_xls(h,s));break;case"PtgRefN":h=r?shift_cell_xls(te[1][1],r,i):te[1][1],o.push(encode_cell_xls(h,s));break;case"PtgRef3d":f=te[1][1],h=shift_cell_xls(te[1][2],a,i),g=get_ixti(n,f,i),o.push(g+"!"+encode_cell_xls(h,s));break;case"PtgFunc":case"PtgFuncVar":var ne=te[1][0],j=te[1][1];ne||(ne=0),ne&=127;var ee=ne==0?[]:o.slice(-ne);o.length-=ne,j==="User"&&(j=ee.shift()),o.push(j+"("+ee.join(",")+")");break;case"PtgBool":o.push(te[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(te[1]);break;case"PtgNum":o.push(String(te[1]));break;case"PtgStr":o.push('"'+te[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(te[1]);break;case"PtgAreaN":E=shift_range_xls(te[1][1],r?{s:r}:a,i),o.push(encode_range_xls(E,i));break;case"PtgArea":E=shift_range_xls(te[1][1],a,i),o.push(encode_range_xls(E,i));break;case"PtgArea3d":f=te[1][1],E=te[1][2],g=get_ixti(n,f,i),o.push(g+"!"+encode_range_xls(E,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=te[1][2];var x=(n.names||[])[m-1]||(n[0]||[])[m],M=x?x.Name:"SH33TJSNAME"+String(m);M&&M.slice(0,6)=="_xlfn."&&!i.xlfn&&(M=M.slice(6)),o.push(M);break;case"PtgNameX":var T=te[1][1];m=te[1][2];var O;if(i.biff<=5)T<0&&(T=-T),n[T]&&(O=n[T][m]);else{var R="";if(((n[T]||[])[0]||[])[0]==14849||(((n[T]||[])[0]||[])[0]==1025?n[T][m]&&n[T][m].itab>0&&(R=n.SheetNames[n[T][m].itab-1]+"!"):R=n.SheetNames[m-1]+"!"),n[T]&&n[T][m])R+=n[T][m].Name;else if(n[0]&&n[0][m])R+=n[0][m].Name;else{var Y=(get_ixti_raw(n,T,i)||"").split(";;");Y[m-1]?R=Y[m-1]:R+="SH33TJSERRX"}o.push(R);break}O||(O={Name:"SH33TJSERRY"}),o.push(O.Name);break;case"PtgParen":var q="(",me=")";if(p>=0){switch(_="",t[0][p][1][0]){case 2:q=fill(" ",t[0][p][1][1])+q;break;case 3:q=fill("\r",t[0][p][1][1])+q;break;case 4:me=fill(" ",t[0][p][1][1])+me;break;case 5:me=fill("\r",t[0][p][1][1])+me;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}p=-1}o.push(q+o.pop()+me);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:te[1][1],r:te[1][0]};var xe={c:r.c,r:r.r};if(n.sharedf[encode_cell(h)]){var Ee=n.sharedf[encode_cell(h)];o.push(stringify_formula(Ee,a,xe,n,i))}else{var se=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(h.c<u[0].s.c||h.c>u[0].e.c)&&!(h.r<u[0].s.r||h.r>u[0].e.r)){o.push(stringify_formula(u[1],a,xe,n,i)),se=!0;break}se||o.push(te[1])}break;case"PtgArray":o.push("{"+stringify_array(te[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+te[1].idx+"[#"+te[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(te));default:throw new Error("Unrecognized Formula Token: "+String(te))}var Fe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&p>=0&&Fe.indexOf(t[0][A][0])==-1){te=t[0][p];var ue=!0;switch(te[1][0]){case 4:ue=!1;case 0:_=fill(" ",te[1][1]);break;case 5:ue=!1;case 1:_=fill("\r",te[1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+te[1][0])}o.push((ue?_:"")+o.pop()+(ue?"":_)),p=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function parse_ArrayParsedFormula(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],parsenoop(t,e-2)];var o=parse_Rgce(t,a,r);return e!==a+i&&(s=parse_RgbExtra(t,e-a-i,o,r)),t.l=n,[o,s]}function parse_XLSCellParsedFormula(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],parsenoop(t,e-2)];var o=parse_Rgce(t,a,r);return e!==a+i&&(s=parse_RgbExtra(t,e-a-i,o,r)),t.l=n,[o,s]}function parse_NameParsedFormula(t,e,r,n){var i=t.l+e,s=parse_Rgce(t,n,r),a;return i!==t.l&&(a=parse_RgbExtra(t,i-t.l,s,r)),[s,a]}function parse_SharedParsedFormula(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=parse_Rgce(t,s,r);return s==65535?[[],parsenoop(t,e-2)]:(e!==s+2&&(i=parse_RgbExtra(t,n-s-2,a,r)),[a,i])}function parse_FormulaValue(t){var e;if(__readUInt16LE(t,t.l+6)!==65535)return[parse_Xnum(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function write_FormulaValue(t){if(t==null){var e=new_buf(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return write_Xnum(t);return write_Xnum(0)}function parse_Formula(t,e,r){var n=t.l+e,i=parse_XLSCell(t);r.biff==2&&++t.l;var s=parse_FormulaValue(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=parse_XLSCellParsedFormula(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function write_Formula(t,e,r,n,i){var s=write_XLSCell(e,r,i),a=write_FormulaValue(t.v),o=new_buf(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=new_buf(t.bf.length),h=0;h<t.bf.length;++h)u[h]=t.bf[h];var f=bconcat([s,a,o,u]);return f}function parse_XLSBParsedFormula(t,e,r){var n=t.read_shift(4),i=parse_Rgce(t,n,r),s=t.read_shift(4),a=s>0?parse_RgbExtra(t,s,i,r):null;return[i,a]}var parse_XLSBArrayParsedFormula=parse_XLSBParsedFormula,parse_XLSBCellParsedFormula=parse_XLSBParsedFormula,parse_XLSBNameParsedFormula=parse_XLSBParsedFormula,parse_XLSBSharedParsedFormula=parse_XLSBParsedFormula,Cetab={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ftab={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},FtabArgc={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ods_to_csf_formula(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function csf_to_ods_formula(t){var e="of:="+t.replace(crefregex,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function ods_to_csf_3D(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function csf_to_ods_3D(t){return t.replace(/\./,"!")}var strs={},_ssfopts={},browser_has_Map=typeof Map!="undefined";function get_sst_id(t,e,r){var n=0,i=t.length;if(r){if(browser_has_Map?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=browser_has_Map?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(browser_has_Map?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function col_obj_w(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(MDW=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=px2char(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=char2width(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function default_margins(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function get_cell_style(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){SSF_load(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function safe_format(t,e,r,n,i,s){try{n.cellNF&&(t.z=table_fmt[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=parseDate(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(table_fmt[e]==null&&SSF_load(SSFImplicit[e]||"General",e),t.t==="e")t.w=t.w||BErr[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=SSF_general_num(t.v);else if(t.t==="d"){var a=datenum(t.v);(a|0)===a?t.w=a.toString(10):t.w=SSF_general_num(a)}else{if(t.v===void 0)return"";t.w=SSF_general(t.v,_ssfopts)}else t.t==="d"?t.w=SSF_format(e,datenum(t.v),_ssfopts):t.w=SSF_format(e,t.v,_ssfopts)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=rgb_tint(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=rgb_tint(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function check_ws(t,e,r){if(t&&t["!ref"]){var n=safe_decode_range(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function parse_ws_xml_dim(t,e){var r=safe_decode_range(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=encode_range(r))}var mergecregex=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,sheetdataregex=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hlinkregex=/<(?:\w:)?hyperlink [^>]*>/mg,dimregex=/"(\w*:\w*)"/,colregex=/<(?:\w:)?col\b[^>]*[\/]?>/g,afregex=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,marginregex=/<(?:\w:)?pageMargins[^>]*\/>/g,sheetprregex=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,sheetprregex2=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,svsregex=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function parse_ws_xml(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",h="",f=t.match(sheetdataregex);f?(u=t.slice(0,f.index),h=t.slice(f.index+f[0].length)):u=h=t;var m=u.match(sheetprregex);m?parse_ws_xml_sheetpr(m[0],o,i,r):(m=u.match(sheetprregex2))&&parse_ws_xml_sheetpr2(m[0],m[1]||"",o,i,r);var E=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(E>0){var g=u.slice(E,E+50).match(dimregex);g&&parse_ws_xml_dim(o,g[1])}var p=u.match(svsregex);p&&p[1]&&parse_ws_xml_sheetviews(p[1],i);var _=[];if(e.cellStyles){var A=u.match(colregex);A&&parse_ws_xml_cols(_,A)}f&&parse_ws_xml_data(f[1],o,e,c,s,a);var H=h.match(afregex);H&&(o["!autofilter"]=parse_ws_xml_autofilter(H[0]));var te=[],ne=h.match(mergecregex);if(ne)for(E=0;E!=ne.length;++E)te[E]=safe_decode_range(ne[E].slice(ne[E].indexOf('"')+1));var j=h.match(hlinkregex);j&&parse_ws_xml_hlinks(o,j,n);var ee=h.match(marginregex);if(ee&&(o["!margins"]=parse_ws_xml_margins(parsexmltag(ee[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=encode_range(c)),e.sheetRows>0&&o["!ref"]){var x=safe_decode_range(o["!ref"]);e.sheetRows<=+x.e.r&&(x.e.r=e.sheetRows-1,x.e.r>c.e.r&&(x.e.r=c.e.r),x.e.r<x.s.r&&(x.s.r=x.e.r),x.e.c>c.e.c&&(x.e.c=c.e.c),x.e.c<x.s.c&&(x.s.c=x.e.c),o["!fullref"]=o["!ref"],o["!ref"]=encode_range(x))}return _.length>0&&(o["!cols"]=_),te.length>0&&(o["!merges"]=te),o}function write_ws_xml_merges(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+encode_range(t[r])+'"/>';return e+"</mergeCells>"}function parse_ws_xml_sheetpr(t,e,r,n){var i=parsexmltag(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=unescapexml(utf8read(i.codeName)))}function parse_ws_xml_sheetpr2(t,e,r,n,i){parse_ws_xml_sheetpr(t.slice(0,t.indexOf(">")),r,n,i)}function write_ws_xml_sheetpr(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[r];try{e.Workbook&&(c=e.Workbook.Sheets[r].CodeName||c)}catch(h){}s=!0,a.codeName=utf8write(escapexml(c))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),o=(o||"")+writextag("outlinePr",null,u)}!s&&!o||(i[i.length]=writextag("sheetPr",o,a))}var sheetprot_deffalse=["objects","scenarios","selectLockedCells","selectUnlockedCells"],sheetprot_deftrue=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function write_ws_xml_protection(t){var e={sheet:1};return sheetprot_deffalse.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),sheetprot_deftrue.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=crypto_CreatePasswordVerifier_Method1(t.password).toString(16).toUpperCase()),writextag("sheetProtection",null,e)}function parse_ws_xml_hlinks(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=parsexmltag(utf8read(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+unescapexml(s.location))):(s.Target="#"+unescapexml(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=safe_decode_range(s.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var h=encode_cell({c:u,r:c});n?(t[c]||(t[c]=[]),t[c][u]||(t[c][u]={t:"z",v:void 0}),t[c][u].l=s):(t[h]||(t[h]={t:"z",v:void 0}),t[h].l=s)}}}function parse_ws_xml_margins(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function write_ws_xml_margins(t){return default_margins(t),writextag("pageMargins",null,t)}function parse_ws_xml_cols(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=parsexmltag(e[n],!0);i.hidden&&(i.hidden=parsexmlbool(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,find_mdw_colw(i.width)),process_col(i);s<=a;)t[s++]=dup(i)}}function write_ws_xml_cols(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=writextag("col",null,col_obj_w(i,n)));return r[r.length]="</cols>",r.join("")}function parse_ws_xml_autofilter(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function write_ws_xml_autofilter(t,e,r,n){var i=typeof t.ref=="string"?t.ref:encode_range(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=decode_range(i);a.s.r==a.e.r&&(a.e.r=decode_range(e["!ref"]).e.r,i=encode_range(a));for(var o=0;o<s.length;++o){var c=s[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),writextag("autoFilter",null,{ref:i})}var sviewregex=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function parse_ws_xml_sheetviews(t,e){e.Views||(e.Views=[{}]),(t.match(sviewregex)||[]).forEach(function(r,n){var i=parsexmltag(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),parsexmlbool(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function write_ws_xml_sheetviews(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),writextag("sheetViews",writextag("sheetView",null,i),{})}function write_ws_xml_cell(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=BErr[t.v];break;case"d":n&&n.cellDates?i=parseDate(t.v,-1).toISOString():(t=dup(t),t.t="n",i=""+(t.v=datenum(parseDate(t.v)))),typeof t.z=="undefined"&&(t.z=table_fmt[14]);break;default:i=t.v;break}var o=writetag("v",escapexml(i)),c={r:e},u=get_cell_style(n.cellXfs,t,n);switch(u!==0&&(c.s=u),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=writetag("v",""+get_sst_id(n.Strings,t.v,n.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var h=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=writextag("f",escapexml(t.f),h)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(c.cm=1),writextag("c",o,c)}var parse_ws_xml_data=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=matchtag("v"),a=matchtag("f");return function(c,u,h,f,m,E){for(var g=0,p="",_=[],A=[],H=0,te=0,ne=0,j="",ee,x,M=0,T=0,O,R,Y=0,q=0,me=Array.isArray(E.CellXf),xe,Ee=[],se=[],Fe=Array.isArray(u),ue=[],ae={},_e=!1,oe=!!h.sheetStubs,ie=c.split(e),re=0,ce=ie.length;re!=ce;++re){p=ie[re].trim();var fe=p.length;if(fe!==0){var pe=0;e:for(g=0;g<fe;++g)switch(p[g]){case">":if(p[g-1]!="/"){++g;break e}if(h&&h.cellStyles){if(x=parsexmltag(p.slice(pe,g),!0),M=x.r!=null?parseInt(x.r,10):M+1,T=-1,h.sheetRows&&h.sheetRows<M)continue;ae={},_e=!1,x.ht&&(_e=!0,ae.hpt=parseFloat(x.ht),ae.hpx=pt2px(ae.hpt)),x.hidden=="1"&&(_e=!0,ae.hidden=!0),x.outlineLevel!=null&&(_e=!0,ae.level=+x.outlineLevel),_e&&(ue[M-1]=ae)}break;case"<":pe=g;break}if(pe>=g)break;if(x=parsexmltag(p.slice(pe,g),!0),M=x.r!=null?parseInt(x.r,10):M+1,T=-1,!(h.sheetRows&&h.sheetRows<M)){f.s.r>M-1&&(f.s.r=M-1),f.e.r<M-1&&(f.e.r=M-1),h&&h.cellStyles&&(ae={},_e=!1,x.ht&&(_e=!0,ae.hpt=parseFloat(x.ht),ae.hpx=pt2px(ae.hpt)),x.hidden=="1"&&(_e=!0,ae.hidden=!0),x.outlineLevel!=null&&(_e=!0,ae.level=+x.outlineLevel),_e&&(ue[M-1]=ae)),_=p.slice(g).split(t);for(var ve=0;ve!=_.length&&_[ve].trim().charAt(0)=="<";++ve);for(_=_.slice(ve),g=0;g!=_.length;++g)if(p=_[g].trim(),p.length!==0){if(A=p.match(r),H=g,te=0,ne=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,A!=null&&A.length===2){for(H=0,j=A[1],te=0;te!=j.length&&!((ne=j.charCodeAt(te)-64)<1||ne>26);++te)H=26*H+ne;--H,T=H}else++T;for(te=0;te!=p.length&&p.charCodeAt(te)!==62;++te);if(++te,x=parsexmltag(p.slice(0,te),!0),x.r||(x.r=encode_cell({r:M-1,c:T})),j=p.slice(te),ee={t:""},(A=j.match(s))!=null&&A[1]!==""&&(ee.v=unescapexml(A[1])),h.cellFormula){if((A=j.match(a))!=null&&A[1]!==""){if(ee.f=unescapexml(utf8read(A[1])).replace(/\r\n/g,`
`),h.xlfn||(ee.f=_xlfn(ee.f)),A[0].indexOf('t="array"')>-1)ee.F=(j.match(i)||[])[1],ee.F.indexOf(":")>-1&&Ee.push([safe_decode_range(ee.F),ee.F]);else if(A[0].indexOf('t="shared"')>-1){R=parsexmltag(A[0]);var Ae=unescapexml(utf8read(A[1]));h.xlfn||(Ae=_xlfn(Ae)),se[parseInt(R.si,10)]=[R,Ae,x.r]}}else(A=j.match(/<f[^>]*\/>/))&&(R=parsexmltag(A[0]),se[R.si]&&(ee.f=shift_formula_xlsx(se[R.si][1],se[R.si][2],x.r)));var be=decode_cell(x.r);for(te=0;te<Ee.length;++te)be.r>=Ee[te][0].s.r&&be.r<=Ee[te][0].e.r&&be.c>=Ee[te][0].s.c&&be.c<=Ee[te][0].e.c&&(ee.F=Ee[te][1])}if(x.t==null&&ee.v===void 0)if(ee.f||ee.F)ee.v=0,ee.t="n";else if(oe)ee.t="z";else continue;else ee.t=x.t||"n";switch(f.s.c>T&&(f.s.c=T),f.e.c<T&&(f.e.c=T),ee.t){case"n":if(ee.v==""||ee.v==null){if(!oe)continue;ee.t="z"}else ee.v=parseFloat(ee.v);break;case"s":if(typeof ee.v=="undefined"){if(!oe)continue;ee.t="z"}else O=strs[parseInt(ee.v,10)],ee.v=O.t,ee.r=O.r,h.cellHTML&&(ee.h=O.h);break;case"str":ee.t="s",ee.v=ee.v!=null?utf8read(ee.v):"",h.cellHTML&&(ee.h=escapehtml(ee.v));break;case"inlineStr":A=j.match(n),ee.t="s",A!=null&&(O=parse_si(A[1]))?(ee.v=O.t,h.cellHTML&&(ee.h=O.h)):ee.v="";break;case"b":ee.v=parsexmlbool(ee.v);break;case"d":h.cellDates?ee.v=parseDate(ee.v,1):(ee.v=datenum(parseDate(ee.v,1)),ee.t="n");break;case"e":(!h||h.cellText!==!1)&&(ee.w=ee.v),ee.v=RBErr[ee.v];break}if(Y=q=0,xe=null,me&&x.s!==void 0&&(xe=E.CellXf[x.s],xe!=null&&(xe.numFmtId!=null&&(Y=xe.numFmtId),h.cellStyles&&xe.fillId!=null&&(q=xe.fillId))),safe_format(ee,Y,q,h,m,E),h.cellDates&&me&&ee.t=="n"&&fmt_is_date(table_fmt[Y])&&(ee.t="d",ee.v=numdate(ee.v)),x.cm&&h.xlmeta){var je=(h.xlmeta.Cell||[])[+x.cm-1];je&&je.type=="XLDAPR"&&(ee.D=!0)}if(Fe){var Se=decode_cell(x.r);u[Se.r]||(u[Se.r]=[]),u[Se.r][Se.c]=ee}else u[x.r]=ee}}}}ue.length>0&&(u["!rows"]=ue)}}();function write_ws_xml_data(t,e,r,n){var i=[],s=[],a=safe_decode_range(t["!ref"]),o="",c,u="",h=[],f=0,m=0,E=t["!rows"],g=Array.isArray(t),p={r:u},_,A=-1;for(m=a.s.c;m<=a.e.c;++m)h[m]=encode_col(m);for(f=a.s.r;f<=a.e.r;++f){for(s=[],u=encode_row(f),m=a.s.c;m<=a.e.c;++m){c=h[m]+u;var H=g?(t[f]||[])[m]:t[c];H!==void 0&&(o=write_ws_xml_cell(H,c,t,e))!=null&&s.push(o)}(s.length>0||E&&E[f])&&(p={r:u},E&&E[f]&&(_=E[f],_.hidden&&(p.hidden=1),A=-1,_.hpx?A=px2pt(_.hpx):_.hpt&&(A=_.hpt),A>-1&&(p.ht=A,p.customHeight=1),_.level&&(p.outlineLevel=_.level)),i[i.length]=writextag("row",s.join(""),p))}if(E)for(;f<E.length;++f)E&&E[f]&&(p={r:f+1},_=E[f],_.hidden&&(p.hidden=1),A=-1,_.hpx?A=px2pt(_.hpx):_.hpt&&(A=_.hpt),A>-1&&(p.ht=A,p.customHeight=1),_.level&&(p.outlineLevel=_.level),i[i.length]=writextag("row","",p));return i.join("")}function write_ws_xml(t,e,r,n){var i=[XML_HEADER,writextag("worksheet",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r})],s=r.SheetNames[t],a=0,o="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",h=safe_decode_range(u);if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),u=encode_range(h)}n||(n={}),c["!comments"]=[];var f=[];write_ws_xml_sheetpr(c,r,t,e,i),i[i.length]=writextag("dimension",null,{ref:u}),i[i.length]=write_ws_xml_sheetviews(c,e,t,r),e.sheetFormat&&(i[i.length]=writextag("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(i[i.length]=write_ws_xml_cols(c,c["!cols"])),i[a=i.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=write_ws_xml_data(c,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),c["!protect"]&&(i[i.length]=write_ws_xml_protection(c["!protect"])),c["!autofilter"]!=null&&(i[i.length]=write_ws_xml_autofilter(c["!autofilter"],c,r,t)),c["!merges"]!=null&&c["!merges"].length>0&&(i[i.length]=write_ws_xml_merges(c["!merges"]));var m=-1,E,g=-1;return c["!links"].length>0&&(i[i.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(E={ref:p[0]},p[1].Target.charAt(0)!="#"&&(g=add_rels(n,-1,escapexml(p[1].Target).replace(/#.*$/,""),RELS.HLINK),E["r:id"]="rId"+g),(m=p[1].Target.indexOf("#"))>-1&&(E.location=escapexml(p[1].Target.slice(m+1))),p[1].Tooltip&&(E.tooltip=escapexml(p[1].Tooltip)),i[i.length]=writextag("hyperlink",null,E))}),i[i.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(i[i.length]=write_ws_xml_margins(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=writetag("ignoredErrors",writextag("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(g=add_rels(n,-1,"../drawings/drawing"+(t+1)+".xml",RELS.DRAW),i[i.length]=writextag("drawing",null,{"r:id":"rId"+g}),c["!drawing"]=f),c["!comments"].length>0&&(g=add_rels(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",RELS.VML),i[i.length]=writextag("legacyDrawing",null,{"r:id":"rId"+g}),c["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function parse_BrtRowHdr(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function write_BrtRowHdr(t,e,r){var n=new_buf(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=px2pt(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:t,c:0},h=0;h<16;++h)if(!(e.s.c>h+1<<10||e.e.c<h<<10)){for(var f=-1,m=-1,E=h<<10;E<h+1<<10;++E){u.c=E;var g=Array.isArray(r)?(r[u.r]||[])[u.c]:r[encode_cell(u)];g&&(f<0&&(f=E),m=E)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,m))}var p=n.l;return n.l=c,n.write_shift(4,o),n.l=p,n.length>n.l?n.slice(0,n.l):n}function write_row_header(t,e,r,n){var i=write_BrtRowHdr(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&write_record(t,0,i)}var parse_BrtWsDim=parse_UncheckedRfX,write_BrtWsDim=write_UncheckedRfX;function parse_BrtWsFmtInfo(){}function parse_BrtWsProp(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=parse_XLSBCodeName(t),r}function write_BrtWsProp(t,e,r){r==null&&(r=new_buf(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return write_BrtColor({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),write_XLSBCodeName(t,r),r.slice(0,r.l)}function parse_BrtCellBlank(t){var e=parse_XLSBCell(t);return[e]}function write_BrtCellBlank(t,e,r){return r==null&&(r=new_buf(8)),write_XLSBCell(e,r)}function parse_BrtShortBlank(t){var e=parse_XLSBShortCell(t);return[e]}function write_BrtShortBlank(t,e,r){return r==null&&(r=new_buf(4)),write_XLSBShortCell(e,r)}function parse_BrtCellBool(t){var e=parse_XLSBCell(t),r=t.read_shift(1);return[e,r,"b"]}function write_BrtCellBool(t,e,r){return r==null&&(r=new_buf(9)),write_XLSBCell(e,r),r.write_shift(1,t.v?1:0),r}function parse_BrtShortBool(t){var e=parse_XLSBShortCell(t),r=t.read_shift(1);return[e,r,"b"]}function write_BrtShortBool(t,e,r){return r==null&&(r=new_buf(5)),write_XLSBShortCell(e,r),r.write_shift(1,t.v?1:0),r}function parse_BrtCellError(t){var e=parse_XLSBCell(t),r=t.read_shift(1);return[e,r,"e"]}function write_BrtCellError(t,e,r){return r==null&&(r=new_buf(9)),write_XLSBCell(e,r),r.write_shift(1,t.v),r}function parse_BrtShortError(t){var e=parse_XLSBShortCell(t),r=t.read_shift(1);return[e,r,"e"]}function write_BrtShortError(t,e,r){return r==null&&(r=new_buf(8)),write_XLSBShortCell(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function parse_BrtCellIsst(t){var e=parse_XLSBCell(t),r=t.read_shift(4);return[e,r,"s"]}function write_BrtCellIsst(t,e,r){return r==null&&(r=new_buf(12)),write_XLSBCell(e,r),r.write_shift(4,e.v),r}function parse_BrtShortIsst(t){var e=parse_XLSBShortCell(t),r=t.read_shift(4);return[e,r,"s"]}function write_BrtShortIsst(t,e,r){return r==null&&(r=new_buf(8)),write_XLSBShortCell(e,r),r.write_shift(4,e.v),r}function parse_BrtCellReal(t){var e=parse_XLSBCell(t),r=parse_Xnum(t);return[e,r,"n"]}function write_BrtCellReal(t,e,r){return r==null&&(r=new_buf(16)),write_XLSBCell(e,r),write_Xnum(t.v,r),r}function parse_BrtShortReal(t){var e=parse_XLSBShortCell(t),r=parse_Xnum(t);return[e,r,"n"]}function write_BrtShortReal(t,e,r){return r==null&&(r=new_buf(12)),write_XLSBShortCell(e,r),write_Xnum(t.v,r),r}function parse_BrtCellRk(t){var e=parse_XLSBCell(t),r=parse_RkNumber(t);return[e,r,"n"]}function write_BrtCellRk(t,e,r){return r==null&&(r=new_buf(12)),write_XLSBCell(e,r),write_RkNumber(t.v,r),r}function parse_BrtShortRk(t){var e=parse_XLSBShortCell(t),r=parse_RkNumber(t);return[e,r,"n"]}function write_BrtShortRk(t,e,r){return r==null&&(r=new_buf(8)),write_XLSBShortCell(e,r),write_RkNumber(t.v,r),r}function parse_BrtCellRString(t){var e=parse_XLSBCell(t),r=parse_RichStr(t);return[e,r,"is"]}function parse_BrtCellSt(t){var e=parse_XLSBCell(t),r=parse_XLWideString(t);return[e,r,"str"]}function write_BrtCellSt(t,e,r){return r==null&&(r=new_buf(12+4*t.v.length)),write_XLSBCell(e,r),write_XLWideString(t.v,r),r.length>r.l?r.slice(0,r.l):r}function parse_BrtShortSt(t){var e=parse_XLSBShortCell(t),r=parse_XLWideString(t);return[e,r,"str"]}function write_BrtShortSt(t,e,r){return r==null&&(r=new_buf(8+4*t.v.length)),write_XLSBShortCell(e,r),write_XLWideString(t.v,r),r.length>r.l?r.slice(0,r.l):r}function parse_BrtFmlaBool(t,e,r){var n=t.l+e,i=parse_XLSBCell(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=parse_XLSBCellParsedFormula(t,n-t.l,r);a[3]=stringify_formula(o,null,i,r.supbooks,r)}else t.l=n;return a}function parse_BrtFmlaError(t,e,r){var n=t.l+e,i=parse_XLSBCell(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=parse_XLSBCellParsedFormula(t,n-t.l,r);a[3]=stringify_formula(o,null,i,r.supbooks,r)}else t.l=n;return a}function parse_BrtFmlaNum(t,e,r){var n=t.l+e,i=parse_XLSBCell(t);i.r=r["!row"];var s=parse_Xnum(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=parse_XLSBCellParsedFormula(t,n-t.l,r);a[3]=stringify_formula(o,null,i,r.supbooks,r)}else t.l=n;return a}function parse_BrtFmlaString(t,e,r){var n=t.l+e,i=parse_XLSBCell(t);i.r=r["!row"];var s=parse_XLWideString(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=parse_XLSBCellParsedFormula(t,n-t.l,r);a[3]=stringify_formula(o,null,i,r.supbooks,r)}else t.l=n;return a}var parse_BrtMergeCell=parse_UncheckedRfX,write_BrtMergeCell=write_UncheckedRfX;function write_BrtBeginMergeCells(t,e){return e==null&&(e=new_buf(4)),e.write_shift(4,t),e}function parse_BrtHLink(t,e){var r=t.l+e,n=parse_UncheckedRfX(t),i=parse_XLNullableWideString(t),s=parse_XLWideString(t),a=parse_XLWideString(t),o=parse_XLWideString(t);t.l=r;var c={rfx:n,relId:i,loc:s,display:o};return a&&(c.Tooltip=a),c}function write_BrtHLink(t,e){var r=new_buf(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));write_UncheckedRfX({s:decode_cell(t[0]),e:decode_cell(t[0])},r),write_RelID("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return write_XLWideString(i||"",r),write_XLWideString(t[1].Tooltip||"",r),write_XLWideString("",r),r.slice(0,r.l)}function parse_BrtPane(){}function parse_BrtArrFmla(t,e,r){var n=t.l+e,i=parse_RfX(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=parse_XLSBArrayParsedFormula(t,n-t.l,r);a[1]=o}else t.l=n;return a}function parse_BrtShrFmla(t,e,r){var n=t.l+e,i=parse_UncheckedRfX(t),s=[i];if(r.cellFormula){var a=parse_XLSBSharedParsedFormula(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function write_BrtColInfo(t,e,r){r==null&&(r=new_buf(18));var n=col_obj_w(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var BrtMarginKeys=["left","right","top","bottom","header","footer"];function parse_BrtMargins(t){var e={};return BrtMarginKeys.forEach(function(r){e[r]=parse_Xnum(t)}),e}function write_BrtMargins(t,e){return e==null&&(e=new_buf(6*8)),default_margins(t),BrtMarginKeys.forEach(function(r){write_Xnum(t[r],e)}),e}function parse_BrtBeginWsView(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function write_BrtBeginWsView(t,e,r){r==null&&(r=new_buf(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function write_BrtCellIgnoreEC(t){var e=new_buf(24);return e.write_shift(4,4),e.write_shift(4,1),write_UncheckedRfX(t,e),e}function write_BrtSheetProtection(t,e){return e==null&&(e=new_buf(16*4+2)),e.write_shift(2,t.password?crypto_CreatePasswordVerifier_Method1(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function parse_BrtDVal(){}function parse_BrtDVal14(){}function parse_ws_bin(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var c=o.dense?[]:{},u,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,m=!1,E,g,p,_,A,H,te,ne,j,ee=[];o.biff=12,o["!row"]=0;var x=0,M=!1,T=[],O={},R=o.supbooks||i.supbooks||[[]];if(R.sharedf=O,R.arrayf=T,R.SheetNames=i.SheetNames||i.Sheets.map(function(Fe){return Fe.name}),!o.supbooks&&(o.supbooks=R,i.Names))for(var Y=0;Y<i.Names.length;++Y)R[0][Y+1]=i.Names[Y];var q=[],me=[],xe=!1;XLSBRecordEnum[16]={n:"BrtShortReal",f:parse_BrtShortReal};var Ee;if(recordhopper(t,function(ue,ae,_e){if(!m)switch(_e){case 148:u=ue;break;case 0:E=ue,o.sheetRows&&o.sheetRows<=E.r&&(m=!0),ne=encode_row(_=E.r),o["!row"]=E.r,(ue.hidden||ue.hpt||ue.level!=null)&&(ue.hpt&&(ue.hpx=pt2px(ue.hpt)),me[ue.r]=ue);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:ue[2]},ue[2]){case"n":g.v=ue[1];break;case"s":te=strs[ue[1]],g.v=te.t,g.r=te.r;break;case"b":g.v=!!ue[1];break;case"e":g.v=ue[1],o.cellText!==!1&&(g.w=BErr[g.v]);break;case"str":g.t="s",g.v=ue[1];break;case"is":g.t="s",g.v=ue[1].t;break}if((p=a.CellXf[ue[0].iStyleRef])&&safe_format(g,p.numFmtId,null,o,s,a),A=ue[0].c==-1?A+1:ue[0].c,o.dense?(c[_]||(c[_]=[]),c[_][A]=g):c[encode_col(A)+ne]=g,o.cellFormula){for(M=!1,x=0;x<T.length;++x){var oe=T[x];E.r>=oe[0].s.r&&E.r<=oe[0].e.r&&A>=oe[0].s.c&&A<=oe[0].e.c&&(g.F=encode_range(oe[0]),M=!0)}!M&&ue.length>3&&(g.f=ue[3])}if(h.s.r>E.r&&(h.s.r=E.r),h.s.c>A&&(h.s.c=A),h.e.r<E.r&&(h.e.r=E.r),h.e.c<A&&(h.e.c=A),o.cellDates&&p&&g.t=="n"&&fmt_is_date(table_fmt[p.numFmtId])){var ie=SSF_parse_date_code(g.v);ie&&(g.t="d",g.v=new Date(ie.y,ie.m-1,ie.d,ie.H,ie.M,ie.S,ie.u))}Ee&&(Ee.type=="XLDAPR"&&(g.D=!0),Ee=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;g={t:"z",v:void 0},A=ue[0].c==-1?A+1:ue[0].c,o.dense?(c[_]||(c[_]=[]),c[_][A]=g):c[encode_col(A)+ne]=g,h.s.r>E.r&&(h.s.r=E.r),h.s.c>A&&(h.s.c=A),h.e.r<E.r&&(h.e.r=E.r),h.e.c<A&&(h.e.c=A),Ee&&(Ee.type=="XLDAPR"&&(g.D=!0),Ee=void 0);break;case 176:ee.push(ue);break;case 49:Ee=((o.xlmeta||{}).Cell||[])[ue-1];break;case 494:var re=n["!id"][ue.relId];for(re?(ue.Target=re.Target,ue.loc&&(ue.Target+="#"+ue.loc),ue.Rel=re):ue.relId==""&&(ue.Target="#"+ue.loc),_=ue.rfx.s.r;_<=ue.rfx.e.r;++_)for(A=ue.rfx.s.c;A<=ue.rfx.e.c;++A)o.dense?(c[_]||(c[_]=[]),c[_][A]||(c[_][A]={t:"z",v:void 0}),c[_][A].l=ue):(H=encode_cell({c:A,r:_}),c[H]||(c[H]={t:"z",v:void 0}),c[H].l=ue);break;case 426:if(!o.cellFormula)break;T.push(ue),j=o.dense?c[_][A]:c[encode_col(A)+ne],j.f=stringify_formula(ue[1],h,{r:E.r,c:A},R,o),j.F=encode_range(ue[0]);break;case 427:if(!o.cellFormula)break;O[encode_cell(ue[0].s)]=ue[1],j=o.dense?c[_][A]:c[encode_col(A)+ne],j.f=stringify_formula(ue[1],h,{r:E.r,c:A},R,o);break;case 60:if(!o.cellStyles)break;for(;ue.e>=ue.s;)q[ue.e--]={width:ue.w/256,hidden:!!(ue.flags&1),level:ue.level},xe||(xe=!0,find_mdw_colw(ue.w/256)),process_col(q[ue.e+1]);break;case 161:c["!autofilter"]={ref:encode_range(ue)};break;case 476:c["!margins"]=ue;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),ue.name&&(i.Sheets[r].CodeName=ue.name),(ue.above||ue.left)&&(c["!outline"]={above:ue.above,left:ue.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),ue.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ae.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+_e.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(h.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=encode_range(u||h)),o.sheetRows&&c["!ref"]){var se=safe_decode_range(c["!ref"]);o.sheetRows<=+se.e.r&&(se.e.r=o.sheetRows-1,se.e.r>h.e.r&&(se.e.r=h.e.r),se.e.r<se.s.r&&(se.s.r=se.e.r),se.e.c>h.e.c&&(se.e.c=h.e.c),se.e.c<se.s.c&&(se.s.c=se.e.c),c["!fullref"]=c["!ref"],c["!ref"]=encode_range(se))}return ee.length>0&&(c["!merges"]=ee),q.length>0&&(c["!cols"]=q),me.length>0&&(c["!rows"]=me),c}function write_ws_bin_cell(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=dup(e),e.z=e.z||table_fmt[14],e.v=datenum(parseDate(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var c={r,c:n};switch(c.s=get_cell_style(i.cellXfs,e,i),e.l&&s["!links"].push([encode_cell(c),e.l]),e.c&&s["!comments"].push([encode_cell(c),e.c]),e.t){case"s":case"str":return i.bookSST?(o=get_sst_id(i.Strings,e.v,i.revStrings),c.t="s",c.v=o,a?write_record(t,18,write_BrtShortIsst(e,c)):write_record(t,7,write_BrtCellIsst(e,c))):(c.t="str",a?write_record(t,17,write_BrtShortSt(e,c)):write_record(t,6,write_BrtCellSt(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?write_record(t,13,write_BrtShortRk(e,c)):write_record(t,2,write_BrtCellRk(e,c)):a?write_record(t,16,write_BrtShortReal(e,c)):write_record(t,5,write_BrtCellReal(e,c)),!0;case"b":return c.t="b",a?write_record(t,15,write_BrtShortBool(e,c)):write_record(t,4,write_BrtCellBool(e,c)),!0;case"e":return c.t="e",a?write_record(t,14,write_BrtShortError(e,c)):write_record(t,3,write_BrtCellError(e,c)),!0}return a?write_record(t,12,write_BrtShortBlank(e,c)):write_record(t,1,write_BrtCellBlank(e,c)),!0}function write_CELLTABLE(t,e,r,n){var i=safe_decode_range(e["!ref"]||"A1"),s,a="",o=[];write_record(t,145);var c=Array.isArray(e),u=i.e.r;e["!rows"]&&(u=Math.max(i.e.r,e["!rows"].length-1));for(var h=i.s.r;h<=u;++h){a=encode_row(h),write_row_header(t,e,i,h);var f=!1;if(h<=i.e.r)for(var m=i.s.c;m<=i.e.c;++m){h===i.s.r&&(o[m]=encode_col(m)),s=o[m]+a;var E=c?(e[h]||[])[m]:e[s];if(!E){f=!1;continue}f=write_ws_bin_cell(t,E,h,m,n,e,f)}}write_record(t,146)}function write_MERGECELLS(t,e){!e||!e["!merges"]||(write_record(t,177,write_BrtBeginMergeCells(e["!merges"].length)),e["!merges"].forEach(function(r){write_record(t,176,write_BrtMergeCell(r))}),write_record(t,178))}function write_COLINFOS(t,e){!e||!e["!cols"]||(write_record(t,390),e["!cols"].forEach(function(r,n){r&&write_record(t,60,write_BrtColInfo(n,r))}),write_record(t,391))}function write_IGNOREECS(t,e){!e||!e["!ref"]||(write_record(t,648),write_record(t,649,write_BrtCellIgnoreEC(safe_decode_range(e["!ref"]))),write_record(t,650))}function write_HLINKS(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=add_rels(r,-1,n[1].Target.replace(/#.*$/,""),RELS.HLINK);write_record(t,494,write_BrtHLink(n,i))}}),delete e["!links"]}function write_LEGACYDRAWING(t,e,r,n){if(e["!comments"].length>0){var i=add_rels(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",RELS.VML);write_record(t,551,write_RelID("rId"+i)),e["!legacy"]=i}}function write_AUTOFILTER(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:encode_range(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=decode_range(s);o.s.r==o.e.r&&(o.e.r=decode_range(e["!ref"]).e.r,s=encode_range(o));for(var c=0;c<a.length;++c){var u=a[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),write_record(t,161,write_UncheckedRfX(safe_decode_range(s))),write_record(t,162)}}function write_WSVIEWS2(t,e,r){write_record(t,133),write_record(t,137,write_BrtBeginWsView(e,r)),write_record(t,138),write_record(t,134)}function write_SHEETPROTECT(t,e){e["!protect"]&&write_record(t,535,write_BrtSheetProtection(e["!protect"]))}function write_ws_bin(t,e,r,n){var i=buf_array(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch(u){}var c=safe_decode_range(a["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],write_record(i,129),(r.vbaraw||a["!outline"])&&write_record(i,147,write_BrtWsProp(o,a["!outline"])),write_record(i,148,write_BrtWsDim(c)),write_WSVIEWS2(i,a,r.Workbook),write_COLINFOS(i,a),write_CELLTABLE(i,a,t,e),write_SHEETPROTECT(i,a),write_AUTOFILTER(i,a,r,t),write_MERGECELLS(i,a),write_HLINKS(i,a,n),a["!margins"]&&write_record(i,476,write_BrtMargins(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&write_IGNOREECS(i,a),write_LEGACYDRAWING(i,a,t,n),write_record(i,130),i.end()}function parse_Cache(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=unescapexml((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function parse_chart(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,c=0,u="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var m=parse_Cache(f);h.s.r=h.s.c=0,h.e.c=o,u=encode_col(o),m[0].forEach(function(E,g){a[u+encode_row(g)]={t:"n",v:E,z:m[1]},c=g}),h.e.r<c&&(h.e.r=c),++o}),o>0&&(a["!ref"]=encode_range(h)),a}function parse_cs_xml(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(sheetprregex);return o&&parse_ws_xml_sheetpr(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function parse_BrtCsProp(t,e){t.l+=10;var r=parse_XLWideString(t);return{name:r}}function parse_cs_bin(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return recordhopper(t,function(c,u,h){switch(h){case 550:s["!rel"]=c;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),c.name&&(i.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var WBPropsDef=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],WBViewDef=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],SheetDef=[],CalcPrDef=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function push_defaults_array(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=parsexmlbool(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function push_defaults(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=parsexmlbool(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function parse_wb_defaults(t){push_defaults(t.WBProps,WBPropsDef),push_defaults(t.CalcPr,CalcPrDef),push_defaults_array(t.WBView,WBViewDef),push_defaults_array(t.Sheets,SheetDef),_ssfopts.date1904=parsexmlbool(t.WBProps.date1904)}function safe1904(t){return!t.Workbook||!t.Workbook.WBProps?"false":parsexmlbool(t.Workbook.WBProps.date1904)?"true":"false"}var badchars="][*?/\\".split("");function check_ws_name(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return badchars.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function check_wb_names(t,e,r){t.forEach(function(n,i){check_ws_name(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function check_wb(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];check_wb_names(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)check_ws(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var wbnsregex=/<\w+:workbook/;function parse_wb_xml(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(tagregex,function(c,u){var h=parsexmltag(c);switch(strip_ns(h[0])){case"<?xml":break;case"<workbook":c.match(wbnsregex)&&(i="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=h[i];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":WBPropsDef.forEach(function(f){if(h[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=parsexmlbool(h[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(h[f[0]],10);break;default:r.WBProps[f[0]]=h[f[0]]}}),h.codeName&&(r.WBProps.CodeName=utf8read(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=unescapexml(utf8read(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=utf8read(h.name),h.comment&&(s.Comment=h.comment),h.localSheetId&&(s.Sheet=+h.localSheetId),parsexmlbool(h.hidden||"0")&&(s.Hidden=!0),a=u+c.length;break;case"</definedName>":s.Ref=unescapexml(utf8read(t.slice(a,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return c}),XMLNS_main.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return parse_wb_defaults(r),r}function write_wb_xml(t){var e=[XML_HEADER];e[e.length]=writextag("workbook",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(WBPropsDef.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=writextag("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:escapexml(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=writextag("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(e[e.length]=writextag("definedName",escapexml(o.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function parse_BrtBundleSh(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=parse_RelID(t),r.name=parse_XLWideString(t),r}function write_BrtBundleSh(t,e){return e||(e=new_buf(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),write_RelID(t.strRelID,e),write_XLWideString(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function parse_BrtWbProp(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?parse_XLWideString(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function write_BrtWbProp(t,e){e||(e=new_buf(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),write_XLSBCodeName(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function parse_BrtFRTArchID$(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function parse_BrtName(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=parse_XLNameWideString(t),a=parse_XLSBNameParsedFormula(t,0,r),o=parse_XLNullableWideString(t);t.l=n;var c={Name:s,Ptg:a};return i<268435455&&(c.Sheet=i),o&&(c.Comment=o),c}function parse_wb_bin(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],XLSBRecordEnum[16]={n:"BrtFRTArchID$",f:parse_BrtFRTArchID$},recordhopper(t,function(c,u,h){switch(h){case 156:a.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=stringify_formula(c.Ptg,null,null,a,e),delete e.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([h,c]):a[0]=[h,c],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(c),a.XTI=a.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(h),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!u.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},e),parse_wb_defaults(r),r.Names=s,r.supbooks=a,r}function write_BUNDLESHS(t,e){write_record(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};write_record(t,156,write_BrtBundleSh(i))}write_record(t,144)}function write_BrtFileVersion(t,e){e||(e=new_buf(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return write_XLWideString("SheetJS",e),write_XLWideString(XLSX.version,e),write_XLWideString(XLSX.version,e),write_XLWideString("7262",e),e.length>e.l?e.slice(0,e.l):e}function write_BrtBookView(t,e){e||(e=new_buf(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function write_BOOKVIEWS(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(write_record(t,135),write_record(t,158,write_BrtBookView(i)),write_record(t,136))}}function write_wb_bin(t,e){var r=buf_array();return write_record(r,131),write_record(r,128,write_BrtFileVersion()),write_record(r,153,write_BrtWbProp(t.Workbook&&t.Workbook.WBProps||null)),write_BOOKVIEWS(r,t),write_BUNDLESHS(r,t),write_record(r,132),r.end()}function parse_wb(t,e,r){return e.slice(-4)===".bin"?parse_wb_bin(t,r):parse_wb_xml(t,r)}function parse_ws(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?parse_ws_bin(t,n,r,i,s,a,o):parse_ws_xml(t,n,r,i,s,a,o)}function parse_cs(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?parse_cs_bin(t,n,r,i,s):parse_cs_xml(t,n,r,i,s)}function parse_ms(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?parse_ms_bin():parse_ms_xml()}function parse_ds(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?parse_ds_bin():parse_ds_xml()}function parse_sty(t,e,r,n){return e.slice(-4)===".bin"?parse_sty_bin(t,r,n):parse_sty_xml(t,r,n)}function parse_theme(t,e,r){return parse_theme_xml(t,r)}function parse_sst(t,e,r){return e.slice(-4)===".bin"?parse_sst_bin(t,r):parse_sst_xml(t,r)}function parse_cmnt(t,e,r){return e.slice(-4)===".bin"?parse_comments_bin(t,r):parse_comments_xml(t,r)}function parse_cc(t,e,r){return e.slice(-4)===".bin"?parse_cc_bin(t):parse_cc_xml(t)}function parse_xlink(t,e,r,n){return r.slice(-4)===".bin"?parse_xlink_bin(t,e,r,n):void 0}function parse_xlmeta(t,e,r){return e.slice(-4)===".bin"?parse_xlmeta_bin(t,e,r):parse_xlmeta_xml(t,e,r)}function write_wb(t,e,r){return(e.slice(-4)===".bin"?write_wb_bin:write_wb_xml)(t)}function write_ws(t,e,r,n,i){return(e.slice(-4)===".bin"?write_ws_bin:write_ws_xml)(t,r,n,i)}function write_sty(t,e,r){return(e.slice(-4)===".bin"?write_sty_bin:write_sty_xml)(t,r)}function write_sst(t,e,r){return(e.slice(-4)===".bin"?write_sst_bin:write_sst_xml)(t,r)}function write_cmnt(t,e,r){return(e.slice(-4)===".bin"?write_comments_bin:write_comments_xml)(t)}function write_xlmeta(t){return(t.slice(-4)===".bin"?write_xlmeta_bin:write_xlmeta_xml)()}var attregexg2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,attregex2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function xlml_parsexmltag(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(attregexg2),s,a,o,c;if(i)for(c=0;c!=i.length;++c)s=i[c].match(attregex2),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function xlml_parsexmltagobj(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(attregexg2),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(attregex2),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var XLMLFormatMap;function xlml_format(t,e){var r=XLMLFormatMap[t]||unescapexml(t);return r==="General"?SSF_general(e):SSF_format(r,e)}function xlml_set_custprop(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=parsexmlbool(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=parseDate(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[unescapexml(e)]=i}function safe_format_xlml(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||BErr[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=SSF_general_num(t.v):t.w=SSF_general(t.v):t.w=xlml_format(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=XLMLFormatMap[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&fmt_is_date(n)){var i=SSF_parse_date_code(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function process_style_xlml(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=XLMLPatternTypeMap[n.Pattern]||n.Pattern)}t[e.ID]=e}function parse_xlml_data(t,e,r,n,i,s,a,o,c,u){var h="General",f=n.StyleID,m={};u=u||{};var E=[],g=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&a&&(f=a.StyleID);s[f]!==void 0&&(s[f].nf&&(h=s[f].nf),s[f].Interior&&E.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=parsexmlbool(t);break;case"String":n.t="s",n.r=xlml_fixstr(unescapexml(t)),n.v=t.indexOf("<")>-1?unescapexml(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(parseDate(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=unescapexml(t):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=RBErr[t],u.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=xlml_fixstr(e||t));break}if(safe_format_xlml(n,h,u),u.cellFormula!==!1)if(n.Formula){var p=unescapexml(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=rc_to_a1(p,i),delete n.Formula,n.ArrayRange=="RC"?n.F=rc_to_a1("RC:RC",i):n.ArrayRange&&(n.F=rc_to_a1(n.ArrayRange,i),c.push([safe_decode_range(n.F),n.F]))}else for(g=0;g<c.length;++g)i.r>=c[g][0].s.r&&i.r<=c[g][0].e.r&&i.c>=c[g][0].s.c&&i.c<=c[g][0].e.c&&(n.F=c[g][1]);u.cellStyles&&(E.forEach(function(_){!m.patternType&&_.patternType&&(m.patternType=_.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function xlml_clean_comment(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function parse_xlml_xml(t,e){var r=e||{};make_ssf();var n=debom(xlml_normalize(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=utf8read(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=dup(r);return a.type="string",PRN.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ce){i.indexOf("<"+Ce)>=0&&(s=!0)}),s)return html_to_workbook(n,r);XLMLFormatMap={"General Number":"General","General Date":table_fmt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":table_fmt[15],"Short Date":table_fmt[14],"Long Time":table_fmt[19],"Medium Time":table_fmt[18],"Short Time":table_fmt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:table_fmt[2],Standard:table_fmt[4],Percent:table_fmt[10],Scientific:table_fmt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,h={},f=[],m=r.dense?[]:{},E="",g={},p={},_=xlml_parsexmltag('<Data ss:Type="String">'),A=0,H=0,te=0,ne={s:{r:2e6,c:2e6},e:{r:0,c:0}},j={},ee={},x="",M=0,T=[],O={},R={},Y=0,q=[],me=[],xe={},Ee=[],se,Fe=!1,ue=[],ae=[],_e={},oe=0,ie=0,re={Sheets:[],WBProps:{date1904:!1}},ce={};xlmlregex.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var fe="";o=xlmlregex.exec(n);)switch(o[3]=(fe=o[3]).toLowerCase()){case"data":if(fe=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?parse_xlml_data(n.slice(A,o.index),x,_,c[c.length-1][0]=="comment"?xe:g,{c:H,r:te},j,Ee[H],p,ue,r):(x="",_=xlml_parsexmltag(o[0]),A=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(me.length>0&&(g.c=me),(!r.sheetRows||r.sheetRows>te)&&g.v!==void 0&&(r.dense?(m[te]||(m[te]=[]),m[te][H]=g):m[encode_col(H)+encode_row(te)]=g),g.HRef&&(g.l={Target:unescapexml(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(oe=H+(parseInt(g.MergeAcross,10)|0),ie=te+(parseInt(g.MergeDown,10)|0),T.push({s:{c:H,r:te},e:{c:oe,r:ie}})),!r.sheetStubs)g.MergeAcross?H=oe+1:++H;else if(g.MergeAcross||g.MergeDown){for(var pe=H;pe<=oe;++pe)for(var ve=te;ve<=ie;++ve)(pe>H||ve>te)&&(r.dense?(m[ve]||(m[ve]=[]),m[ve][pe]={t:"z"}):m[encode_col(pe)+encode_row(ve)]={t:"z"});H=oe+1}else++H;else g=xlml_parsexmltagobj(o[0]),g.Index&&(H=+g.Index-1),H<ne.s.c&&(ne.s.c=H),H>ne.e.c&&(ne.e.c=H),o[0].slice(-2)==="/>"&&++H,me=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(te<ne.s.r&&(ne.s.r=te),te>ne.e.r&&(ne.e.r=te),o[0].slice(-2)==="/>"&&(p=xlml_parsexmltag(o[0]),p.Index&&(te=+p.Index-1)),H=0,++te):(p=xlml_parsexmltag(o[0]),p.Index&&(te=+p.Index-1),_e={},(p.AutoFitHeight=="0"||p.Height)&&(_e.hpx=parseInt(p.Height,10),_e.hpt=px2pt(_e.hpx),ae[te]=_e),p.Hidden=="1"&&(_e.hidden=!0,ae[te]=_e));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));f.push(E),ne.s.r<=ne.e.r&&ne.s.c<=ne.e.c&&(m["!ref"]=encode_range(ne),r.sheetRows&&r.sheetRows<=ne.e.r&&(m["!fullref"]=m["!ref"],ne.e.r=r.sheetRows-1,m["!ref"]=encode_range(ne))),T.length&&(m["!merges"]=T),Ee.length>0&&(m["!cols"]=Ee),ae.length>0&&(m["!rows"]=ae),h[E]=m}else ne={s:{r:2e6,c:2e6},e:{r:0,c:0}},te=H=0,c.push([o[3],!1]),u=xlml_parsexmltag(o[0]),E=unescapexml(u.Name),m=r.dense?[]:{},T=[],ue=[],ae=[],ce={name:E,Hidden:0},re.Sheets.push(ce);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),Ee=[],Fe=!1}break;case"style":o[1]==="/"?process_style_xlml(j,ee,r):ee=xlml_parsexmltag(o[0]);break;case"numberformat":ee.nf=unescapexml(xlml_parsexmltag(o[0]).Format||"General"),XLMLFormatMap[ee.nf]&&(ee.nf=XLMLFormatMap[ee.nf]);for(var Ae=0;Ae!=392&&table_fmt[Ae]!=ee.nf;++Ae);if(Ae==392){for(Ae=57;Ae!=392;++Ae)if(table_fmt[Ae]==null){SSF_load(ee.nf,Ae);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(se=xlml_parsexmltag(o[0]),se.Hidden&&(se.hidden=!0,delete se.Hidden),se.Width&&(se.wpx=parseInt(se.Width,10)),!Fe&&se.wpx>10){Fe=!0,MDW=DEF_MDW;for(var be=0;be<Ee.length;++be)Ee[be]&&process_col(Ee[be])}Fe&&process_col(se),Ee[se.Index-1||Ee.length]=se;for(var je=0;je<+se.Span;++je)Ee[Ee.length]=dup(se);break;case"namedrange":if(o[1]==="/")break;re.Names||(re.Names=[]);var Se=parsexmltag(o[0]),Xe={Name:Se.Name,Ref:rc_to_a1(Se.RefersTo.slice(1),{r:0,c:0})};re.Sheets.length>0&&(Xe.Sheet=re.Sheets.length-1),re.Names.push(Xe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?x+=n.slice(M,o.index):M=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;ee.Interior=xlml_parsexmltag(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?xlml_set_prop(O,fe,n.slice(Y,o.index)):Y=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));xlml_clean_comment(xe),me.push(xe)}else c.push([o[3],!1]),u=xlml_parsexmltag(o[0]),xe={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var qe=xlml_parsexmltag(o[0]);m["!autofilter"]={ref:rc_to_a1(qe.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return parse_fods(n,r);var Je=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Je=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Je=!1}break;case"excelworkbook":switch(o[3]){case"date1904":re.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Je=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Je=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(Y,o.index)){case"SheetHidden":ce.Hidden=1;break;case"SheetVeryHidden":ce.Hidden=2;break}else Y=o.index+o[0].length;break;case"header":m["!margins"]||default_margins(m["!margins"]={},"xlml"),isNaN(+parsexmltag(o[0]).Margin)||(m["!margins"].header=+parsexmltag(o[0]).Margin);break;case"footer":m["!margins"]||default_margins(m["!margins"]={},"xlml"),isNaN(+parsexmltag(o[0]).Margin)||(m["!margins"].footer=+parsexmltag(o[0]).Margin);break;case"pagemargins":var We=parsexmltag(o[0]);m["!margins"]||default_margins(m["!margins"]={},"xlml"),isNaN(+We.Top)||(m["!margins"].top=+We.Top),isNaN(+We.Left)||(m["!margins"].left=+We.Left),isNaN(+We.Right)||(m["!margins"].right=+We.Right),isNaN(+We.Bottom)||(m["!margins"].bottom=+We.Bottom);break;case"displayrighttoleft":re.Views||(re.Views=[]),re.Views[0]||(re.Views[0]={}),re.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Je=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Je=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Je=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Je=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Je=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Je=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Je=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Je=!1}break;case"smarttags":break;default:Je=!1;break}if(Je||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?xlml_set_custprop(R,fe,q,n.slice(Y,o.index)):(q=o,Y=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var Ue={};return!r.bookSheets&&!r.bookProps&&(Ue.Sheets=h),Ue.SheetNames=f,Ue.Workbook=re,Ue.SSF=dup(table_fmt),Ue.Props=O,Ue.Custprops=R,Ue}function parse_xlml(t,e){switch(fix_read_opts(e=e||{}),e.type||"base64"){case"base64":return parse_xlml_xml(Base64_decode(t),e);case"binary":case"buffer":case"file":return parse_xlml_xml(t,e);case"array":return parse_xlml_xml(a2s(t),e)}}function write_props_xlml(t,e){var r=[];return t.Props&&r.push(xlml_write_docprops(t.Props,e)),t.Custprops&&r.push(xlml_write_custprops(t.Props,t.Custprops)),r.join("")}function write_wb_xlml(){return""}function write_sty_xlml(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(writextag("NumberFormat",null,{"ss:Format":escapexml(table_fmt[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(writextag("Style",s.join(""),a))}),writextag("Styles",r.join(""))}function write_name_xlml(t){return writextag("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+a1_to_rc(t.Ref,{r:0,c:0})})}function write_names_xlml(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(write_name_xlml(i)))}return writextag("Names",r.join(""))}function write_ws_xlml_names(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(write_name_xlml(o)))}return s.join("")}function write_ws_xlml_wsopts(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(writextag("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(writextag("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(writextag("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(writextag("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(writetag("ProtectContents","True")),t["!protect"].objects&&i.push(writetag("ProtectObjects","True")),t["!protect"].scenarios&&i.push(writetag("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(writetag("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(writetag("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":writextag("WorksheetOptions",i.join(""),{xmlns:XLMLNS.x})}function write_ws_xlml_comment(t){return t.map(function(e){var r=xlml_unfixstr(e.t||""),n=writextag("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return writextag("Comment",n,{"ss:Author":e.a})}).join("")}function write_ws_xlml_cell(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+escapexml(a1_to_rc(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var c=decode_cell(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==a.r?"":"["+(c.r-a.r)+"]")+"C"+(c.c==a.c?"":"["+(c.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=escapexml(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=escapexml(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],h=0;h!=u.length;++h)u[h].s.c!=a.c||u[h].s.r!=a.r||(u[h].e.c>u[h].s.c&&(o["ss:MergeAcross"]=u[h].e.c-u[h].s.c),u[h].e.r>u[h].s.r&&(o["ss:MergeDown"]=u[h].e.r-u[h].s.r));var f="",m="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",m=String(t.v);break;case"b":f="Boolean",m=t.v?"1":"0";break;case"e":f="Error",m=BErr[t.v];break;case"d":f="DateTime",m=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||table_fmt[14]);break;case"s":f="String",m=escapexlml(t.v||"");break}var E=get_cell_style(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+E),o["ss:Index"]=a.c+1;var g=t.v!=null?m:"",p=t.t=="z"?"":'<Data ss:Type="'+f+'">'+g+"</Data>";return(t.c||[]).length>0&&(p+=write_ws_xlml_comment(t.c)),writextag("Cell",p,o)}function write_ws_xlml_row(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=pt2px(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function write_ws_xlml_table(t,e,r,n){if(!t["!ref"])return"";var i=safe_decode_range(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(_,A){process_col(_);var H=!!_.width,te=col_obj_w(A,_),ne={"ss:Index":A+1};H&&(ne["ss:Width"]=width2px(te.width)),_.hidden&&(ne["ss:Hidden"]="1"),o.push(writextag("Column",null,ne))});for(var c=Array.isArray(t),u=i.s.r;u<=i.e.r;++u){for(var h=[write_ws_xlml_row(u,(t["!rows"]||[])[u])],f=i.s.c;f<=i.e.c;++f){var m=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>f)&&!(s[a].s.r>u)&&!(s[a].e.c<f)&&!(s[a].e.r<u)){(s[a].s.c!=f||s[a].s.r!=u)&&(m=!0);break}if(!m){var E={r:u,c:f},g=encode_cell(E),p=c?(t[u]||[])[f]:t[g];h.push(write_ws_xlml_cell(p,g,t,e,r,n,E))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function write_ws_xlml(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?write_ws_xlml_names(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?write_ws_xlml_table(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(write_ws_xlml_wsopts(s,e,t,r)),n.join("")}function write_xlml(t,e){e||(e={}),t.SSF||(t.SSF=dup(table_fmt)),t.SSF&&(make_ssf(),SSF_load_table(t.SSF),e.revssf=evert_num(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],get_cell_style(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(write_props_xlml(t,e)),r.push(write_wb_xlml()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(writextag("Worksheet",write_ws_xlml(n,e,t),{"ss:Name":escapexml(t.SheetNames[n])}));return r[2]=write_sty_xlml(t,e),r[3]=write_names_xlml(t),XML_HEADER+writextag("Workbook",r.join(""),{xmlns:XLMLNS.ss,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:ss":XLMLNS.ss,"xmlns:dt":XLMLNS.dt,"xmlns:html":XLMLNS.html})}function parse_compobj(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=parse_ClipboardFormatOrAnsiString(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=parse_ClipboardFormatOrUnicodeString(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var CONTINUE_RT=[60,1084,2066,2165,2175];function slurp(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var c=__readUInt16LE(r,r.l),u=XLSRecordEnum[c],h=0;u!=null&&CONTINUE_RT.indexOf(c)>-1;)s=__readUInt16LE(r,r.l+2),h=r.l+4,c==2066?h+=4:(c==2165||c==2175)&&(h+=12),o=r.slice(h,r.l+4+s),a.push(o),r.l+=4+s,u=XLSRecordEnum[c=__readUInt16LE(r,r.l)];var f=bconcat(a);prep_blob(f,0);var m=0;f.lens=[];for(var E=0;E<a.length;++E)f.lens.push(m),m+=a[E].length;if(f.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+f.length+" < "+n;return e.f(f,f.length,i)}function safe_format_xf(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=table_fmt[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||BErr[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=SSF_general_num(t.v):t.w=SSF_general(t.v):t.w=SSF_format(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&fmt_is_date(table_fmt[n]||String(n))){var i=SSF_parse_date_code(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function make_cell(t,e,r){return{v:t,ixfe:e,t:r}}function parse_workbook(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,c=[],u="",h={},f,m="",E,g,p,_,A={},H=[],te,ne,j=[],ee=[],x={Sheets:[],WBProps:{date1904:!1},Views:[{}]},M={},T=function(vr){return vr<8?XLSIcv[vr]:vr<64&&ee[vr-8]||XLSIcv[vr]},O=function(vr,lr,mr){var wr=lr.XF.data;if(!(!wr||!wr.patternType||!mr||!mr.cellStyles)){lr.s={},lr.s.patternType=wr.patternType;var Cr;(Cr=rgb2Hex(T(wr.icvFore)))&&(lr.s.fgColor={rgb:Cr}),(Cr=rgb2Hex(T(wr.icvBack)))&&(lr.s.bgColor={rgb:Cr})}},R=function(vr,lr,mr){if(!(_e>1)&&!(mr.sheetRows&&vr.r>=mr.sheetRows)){if(mr.cellStyles&&lr.XF&&lr.XF.data&&O(vr,lr,mr),delete lr.ixfe,delete lr.XF,f=vr,m=encode_cell(vr),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),vr.r<a.s.r&&(a.s.r=vr.r),vr.c<a.s.c&&(a.s.c=vr.c),vr.r+1>a.e.r&&(a.e.r=vr.r+1),vr.c+1>a.e.c&&(a.e.c=vr.c+1),mr.cellFormula&&lr.f){for(var wr=0;wr<H.length;++wr)if(!(H[wr][0].s.c>vr.c||H[wr][0].s.r>vr.r)&&!(H[wr][0].e.c<vr.c||H[wr][0].e.r<vr.r)){lr.F=encode_range(H[wr][0]),(H[wr][0].s.c!=vr.c||H[wr][0].s.r!=vr.r)&&delete lr.f,lr.f&&(lr.f=""+stringify_formula(H[wr][1],a,vr,ue,Y));break}}mr.dense?(i[vr.r]||(i[vr.r]=[]),i[vr.r][vr.c]=lr):i[m]=lr}},Y={enc:!1,sbcch:0,snames:[],sharedf:A,arrayf:H,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(Y.password=e.password);var q,me=[],xe=[],Ee=[],se=[],Fe=!1,ue=[];ue.SheetNames=Y.snames,ue.sharedf=Y.sharedf,ue.arrayf=Y.arrayf,ue.names=[],ue.XTI=[];var ae=0,_e=0,oe=0,ie=[],re=[],ce;Y.codepage=1200,set_cp(1200);for(var fe=!1;t.l<t.length-1;){var pe=t.l,ve=t.read_shift(2);if(ve===0&&ae===10)break;var Ae=t.l===t.length?0:t.read_shift(2),be=XLSRecordEnum[ve];if(be&&be.f){if(e.bookSheets&&ae===133&&ve!==133)break;if(ae=ve,be.r===2||be.r==12){var je=t.read_shift(2);if(Ae-=2,!Y.enc&&je!==ve&&((je&255)<<8|je>>8)!==ve)throw new Error("rt mismatch: "+je+"!="+ve);be.r==12&&(t.l+=10,Ae-=10)}var Se={};if(ve===10?Se=be.f(t,Ae,Y):Se=slurp(ve,be,t,Ae,Y),_e==0&&[9,521,1033,2057].indexOf(ae)===-1)continue;switch(ve){case 34:r.opts.Date1904=x.WBProps.date1904=Se;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(Y.enc||(t.l=0),Y.enc=Se,!e.password)throw new Error("File is password-protected");if(Se.valid==null)throw new Error("Encryption scheme unsupported");if(!Se.valid)throw new Error("Password is incorrect");break;case 92:Y.lastuser=Se;break;case 66:var Xe=Number(Se);switch(Xe){case 21010:Xe=1200;break;case 32768:Xe=1e4;break;case 32769:Xe=1252;break}set_cp(Y.codepage=Xe),fe=!0;break;case 317:Y.rrtabid=Se;break;case 25:Y.winlocked=Se;break;case 439:r.opts.RefreshAll=Se;break;case 12:r.opts.CalcCount=Se;break;case 16:r.opts.CalcDelta=Se;break;case 17:r.opts.CalcIter=Se;break;case 13:r.opts.CalcMode=Se;break;case 14:r.opts.CalcPrecision=Se;break;case 95:r.opts.CalcSaveRecalc=Se;break;case 15:Y.CalcRefMode=Se;break;case 2211:r.opts.FullCalc=Se;break;case 129:Se.fDialog&&(i["!type"]="dialog"),Se.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),Se.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:j.push(Se);break;case 430:ue.push([Se]),ue[ue.length-1].XTI=[];break;case 35:case 547:ue[ue.length-1].push(Se);break;case 24:case 536:ce={Name:Se.Name,Ref:stringify_formula(Se.rgce,a,null,ue,Y)},Se.itab>0&&(ce.Sheet=Se.itab-1),ue.names.push(ce),ue[0]||(ue[0]=[],ue[0].XTI=[]),ue[ue.length-1].push(Se),Se.Name=="_xlnm._FilterDatabase"&&Se.itab>0&&Se.rgce&&Se.rgce[0]&&Se.rgce[0][0]&&Se.rgce[0][0][0]=="PtgArea3d"&&(re[Se.itab-1]={ref:encode_range(Se.rgce[0][0][1][2])});break;case 22:Y.ExternCount=Se;break;case 23:ue.length==0&&(ue[0]=[],ue[0].XTI=[]),ue[ue.length-1].XTI=ue[ue.length-1].XTI.concat(Se),ue.XTI=ue.XTI.concat(Se);break;case 2196:if(Y.biff<8)break;ce!=null&&(ce.Comment=Se[1]);break;case 18:i["!protect"]=Se;break;case 19:Se!==0&&Y.WTF&&console.error("Password verifier: "+Se);break;case 133:s[Se.pos]=Se,Y.snames.push(Se.name);break;case 10:{if(--_e)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=encode_range(a),e.sheetRows&&e.sheetRows<=a.e.r){var qe=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=encode_range(a),a.e.r=qe}a.e.r++,a.e.c++}me.length>0&&(i["!merges"]=me),xe.length>0&&(i["!objects"]=xe),Ee.length>0&&(i["!cols"]=Ee),se.length>0&&(i["!rows"]=se),x.Sheets.push(M)}u===""?h=i:n[u]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Y.biff===8&&(Y.biff={9:2,521:3,1033:4}[ve]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Se.BIFFVer]||8),Y.biffguess=Se.BIFFVer==0,Se.BIFFVer==0&&Se.dt==4096&&(Y.biff=5,fe=!0,set_cp(Y.codepage=28591)),Y.biff==8&&Se.BIFFVer==0&&Se.dt==16&&(Y.biff=2),_e++)break;if(i=e.dense?[]:{},Y.biff<8&&!fe&&(fe=!0,set_cp(Y.codepage=e.codepage||1252)),Y.biff<5||Se.BIFFVer==0&&Se.dt==4096){u===""&&(u="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Je={pos:t.l-Ae,name:u};s[Je.pos]=Je,Y.snames.push(u)}else u=(s[pe]||{name:""}).name;Se.dt==32&&(i["!type"]="chart"),Se.dt==64&&(i["!type"]="macro"),me=[],xe=[],Y.arrayf=H=[],Ee=[],se=[],Fe=!1,M={Hidden:(s[pe]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[Se.r]||[])[Se.c]:i[encode_cell({c:Se.c,r:Se.r})])&&++Se.c,te={ixfe:Se.ixfe,XF:j[Se.ixfe]||{},v:Se.val,t:"n"},oe>0&&(te.z=ie[te.ixfe>>8&63]),safe_format_xf(te,e,r.opts.Date1904),R({c:Se.c,r:Se.r},te,e);break;case 5:case 517:te={ixfe:Se.ixfe,XF:j[Se.ixfe],v:Se.val,t:Se.t},oe>0&&(te.z=ie[te.ixfe>>8&63]),safe_format_xf(te,e,r.opts.Date1904),R({c:Se.c,r:Se.r},te,e);break;case 638:te={ixfe:Se.ixfe,XF:j[Se.ixfe],v:Se.rknum,t:"n"},oe>0&&(te.z=ie[te.ixfe>>8&63]),safe_format_xf(te,e,r.opts.Date1904),R({c:Se.c,r:Se.r},te,e);break;case 189:for(var We=Se.c;We<=Se.C;++We){var Ue=Se.rkrec[We-Se.c][0];te={ixfe:Ue,XF:j[Ue],v:Se.rkrec[We-Se.c][1],t:"n"},oe>0&&(te.z=ie[te.ixfe>>8&63]),safe_format_xf(te,e,r.opts.Date1904),R({c:We,r:Se.r},te,e)}break;case 6:case 518:case 1030:{if(Se.val=="String"){o=Se;break}if(te=make_cell(Se.val,Se.cell.ixfe,Se.tt),te.XF=j[te.ixfe],e.cellFormula){var Ce=Se.formula;if(Ce&&Ce[0]&&Ce[0][0]&&Ce[0][0][0]=="PtgExp"){var Le=Ce[0][0][1][0],Ve=Ce[0][0][1][1],Ge=encode_cell({r:Le,c:Ve});A[Ge]?te.f=""+stringify_formula(Se.formula,a,Se.cell,ue,Y):te.F=((e.dense?(i[Le]||[])[Ve]:i[Ge])||{}).F}else te.f=""+stringify_formula(Se.formula,a,Se.cell,ue,Y)}oe>0&&(te.z=ie[te.ixfe>>8&63]),safe_format_xf(te,e,r.opts.Date1904),R(Se.cell,te,e),o=Se}break;case 7:case 519:if(o)o.val=Se,te=make_cell(Se,o.cell.ixfe,"s"),te.XF=j[te.ixfe],e.cellFormula&&(te.f=""+stringify_formula(o.formula,a,o.cell,ue,Y)),oe>0&&(te.z=ie[te.ixfe>>8&63]),safe_format_xf(te,e,r.opts.Date1904),R(o.cell,te,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{H.push(Se);var ut=encode_cell(Se[0].s);if(E=e.dense?(i[Se[0].s.r]||[])[Se[0].s.c]:i[ut],e.cellFormula&&E){if(!o||!ut||!E)break;E.f=""+stringify_formula(Se[1],a,Se[0],ue,Y),E.F=encode_range(Se[0])}}break;case 1212:{if(!e.cellFormula)break;if(m){if(!o)break;A[encode_cell(o.cell)]=Se[0],E=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[encode_cell(o.cell)],(E||{}).f=""+stringify_formula(Se[0],a,f,ue,Y)}}break;case 253:te=make_cell(c[Se.isst].t,Se.ixfe,"s"),c[Se.isst].h&&(te.h=c[Se.isst].h),te.XF=j[te.ixfe],oe>0&&(te.z=ie[te.ixfe>>8&63]),safe_format_xf(te,e,r.opts.Date1904),R({c:Se.c,r:Se.r},te,e);break;case 513:e.sheetStubs&&(te={ixfe:Se.ixfe,XF:j[Se.ixfe],t:"z"},oe>0&&(te.z=ie[te.ixfe>>8&63]),safe_format_xf(te,e,r.opts.Date1904),R({c:Se.c,r:Se.r},te,e));break;case 190:if(e.sheetStubs)for(var Jt=Se.c;Jt<=Se.C;++Jt){var Kt=Se.ixfe[Jt-Se.c];te={ixfe:Kt,XF:j[Kt],t:"z"},oe>0&&(te.z=ie[te.ixfe>>8&63]),safe_format_xf(te,e,r.opts.Date1904),R({c:Jt,r:Se.r},te,e)}break;case 214:case 516:case 4:te=make_cell(Se.val,Se.ixfe,"s"),te.XF=j[te.ixfe],oe>0&&(te.z=ie[te.ixfe>>8&63]),safe_format_xf(te,e,r.opts.Date1904),R({c:Se.c,r:Se.r},te,e);break;case 0:case 512:_e===1&&(a=Se);break;case 252:c=Se;break;case 1054:if(Y.biff==4){ie[oe++]=Se[1];for(var Ze=0;Ze<oe+163&&table_fmt[Ze]!=Se[1];++Ze);Ze>=163&&SSF_load(Se[1],oe+163)}else SSF_load(Se[1],Se[0]);break;case 30:{ie[oe++]=Se;for(var tr=0;tr<oe+163&&table_fmt[tr]!=Se;++tr);tr>=163&&SSF_load(Se,oe+163)}break;case 229:me=me.concat(Se);break;case 93:xe[Se.cmo[0]]=Y.lastobj=Se;break;case 438:Y.lastobj.TxO=Se;break;case 127:Y.lastobj.ImData=Se;break;case 440:for(_=Se[0].s.r;_<=Se[0].e.r;++_)for(p=Se[0].s.c;p<=Se[0].e.c;++p)E=e.dense?(i[_]||[])[p]:i[encode_cell({c:p,r:_})],E&&(E.l=Se[1]);break;case 2048:for(_=Se[0].s.r;_<=Se[0].e.r;++_)for(p=Se[0].s.c;p<=Se[0].e.c;++p)E=e.dense?(i[_]||[])[p]:i[encode_cell({c:p,r:_})],E&&E.l&&(E.l.Tooltip=Se[1]);break;case 28:{if(Y.biff<=5&&Y.biff>=2)break;E=e.dense?(i[Se[0].r]||[])[Se[0].c]:i[encode_cell(Se[0])];var nr=xe[Se[2]];E||(e.dense?(i[Se[0].r]||(i[Se[0].r]=[]),E=i[Se[0].r][Se[0].c]={t:"z"}):E=i[encode_cell(Se[0])]={t:"z"},a.e.r=Math.max(a.e.r,Se[0].r),a.s.r=Math.min(a.s.r,Se[0].r),a.e.c=Math.max(a.e.c,Se[0].c),a.s.c=Math.min(a.s.c,Se[0].c)),E.c||(E.c=[]),g={a:Se[1],t:nr.TxO.t},E.c.push(g)}break;case 2173:update_xfext(j[Se.ixfe],Se.ext);break;case 125:{if(!Y.cellStyles)break;for(;Se.e>=Se.s;)Ee[Se.e--]={width:Se.w/256,level:Se.level||0,hidden:!!(Se.flags&1)},Fe||(Fe=!0,find_mdw_colw(Se.w/256)),process_col(Ee[Se.e+1])}break;case 520:{var xr={};Se.level!=null&&(se[Se.r]=xr,xr.level=Se.level),Se.hidden&&(se[Se.r]=xr,xr.hidden=!0),Se.hpt&&(se[Se.r]=xr,xr.hpt=Se.hpt,xr.hpx=pt2px(Se.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||default_margins(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ve]]=Se;break;case 161:i["!margins"]||default_margins(i["!margins"]={}),i["!margins"].header=Se.header,i["!margins"].footer=Se.footer;break;case 574:Se.RTL&&(x.Views[0].RTL=!0);break;case 146:ee=Se;break;case 2198:q=Se;break;case 140:ne=Se;break;case 442:u?M.CodeName=Se||M.name:x.WBProps.CodeName=Se||"ThisWorkbook";break}}else be||console.error("Missing Info for XLS Record 0x"+ve.toString(16)),t.l+=Ae}return r.SheetNames=keys(s).sort(function(pr,vr){return Number(pr)-Number(vr)}).map(function(pr){return s[pr].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&re.forEach(function(pr,vr){r.Sheets[r.SheetNames[vr]]["!autofilter"]=pr}),r.Strings=c,r.SSF=dup(table_fmt),Y.enc&&(r.Encryption=Y.enc),q&&(r.Themes=q),r.Metadata={},ne!==void 0&&(r.Metadata.Country=ne),ue.names.length>0&&(x.Names=ue.names),r.Workbook=x,r}var PSCLSID={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function parse_xls_props(t,e,r){var n=CFB.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=parse_PropertySetStream(n,DocSummaryPIDDSI,PSCLSID.DSI);for(var s in i)e[s]=i[s]}catch(u){if(r.WTF)throw u}var a=CFB.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=parse_PropertySetStream(a,SummaryPIDSI,PSCLSID.SI);for(var c in o)e[c]==null&&(e[c]=o[c])}catch(u){if(r.WTF)throw u}e.HeadingPairs&&e.TitlesOfParts&&(load_props_pairs(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function write_xls_props(t,e){var r=[],n=[],i=[],s=0,a,o=evert_key(DocSummaryPIDDSI,"n"),c=evert_key(SummaryPIDSI,"n");if(t.Props)for(a=keys(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(c,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=keys(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(c,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var u=[];for(s=0;s<i.length;++s)XLSPSSkip.indexOf(i[s][0])>-1||PseudoPropsPairs.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&CFB.utils.cfb_add(e,"/SummaryInformation",write_PropertySetStream(n,PSCLSID.SI,c,SummaryPIDSI)),(r.length||u.length)&&CFB.utils.cfb_add(e,"/DocumentSummaryInformation",write_PropertySetStream(r,PSCLSID.DSI,o,DocSummaryPIDDSI,u.length?u:null,PSCLSID.UDI))}function parse_xlscfb(t,e){e||(e={}),fix_read_opts(e),reset_cp(),e.codepage&&set_ansi(e.codepage);var r,n;if(t.FullPaths){if(CFB.find(t,"/encryption"))throw new Error("File is password-protected");r=CFB.find(t,"!CompObj"),n=CFB.find(t,"/Workbook")||CFB.find(t,"/Book")}else{switch(e.type){case"base64":t=s2a(Base64_decode(t));break;case"binary":t=s2a(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}prep_blob(t,0),n={content:t}}var i,s;if(r&&parse_compobj(r),e.bookProps&&!e.bookSheets)i={};else{var a=has_buf?"buffer":"array";if(n&&n.content)i=parse_workbook(n.content,e);else if((s=CFB.find(t,"PerfectOffice_MAIN"))&&s.content)i=WK_.to_workbook(s.content,(e.type=a,e));else if((s=CFB.find(t,"NativeContent_MAIN"))&&s.content)i=WK_.to_workbook(s.content,(e.type=a,e));else throw(s=CFB.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&CFB.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=make_vba_xls(t))}var o={};return t.FullPaths&&parse_xls_props(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}function write_xlscfb(t,e){var r=e||{},n=CFB.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return CFB.utils.cfb_add(n,i,write_biff_buf(t,r)),r.biff==8&&(t.Props||t.Custprops)&&write_xls_props(t,n),r.biff==8&&t.vbaraw&&fill_vba_xls(n,CFB.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var XLSBRecordEnum={0:{f:parse_BrtRowHdr},1:{f:parse_BrtCellBlank},2:{f:parse_BrtCellRk},3:{f:parse_BrtCellError},4:{f:parse_BrtCellBool},5:{f:parse_BrtCellReal},6:{f:parse_BrtCellSt},7:{f:parse_BrtCellIsst},8:{f:parse_BrtFmlaString},9:{f:parse_BrtFmlaNum},10:{f:parse_BrtFmlaBool},11:{f:parse_BrtFmlaError},12:{f:parse_BrtShortBlank},13:{f:parse_BrtShortRk},14:{f:parse_BrtShortError},15:{f:parse_BrtShortBool},16:{f:parse_BrtShortReal},17:{f:parse_BrtShortSt},18:{f:parse_BrtShortIsst},19:{f:parse_RichStr},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:parse_BrtName},40:{},42:{},43:{f:parse_BrtFont},44:{f:parse_BrtFmt},45:{f:parse_BrtFill},46:{f:parse_BrtBorder},47:{f:parse_BrtXF},48:{},49:{f:parse_Int32LE},50:{},51:{f:parse_BrtMdb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:parse_ColInfo},62:{f:parse_BrtCellRString},63:{f:parse_BrtCalcChainItem$},64:{f:parse_BrtDVal},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:parsenoop,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:parse_BrtBeginWsView},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:parse_BrtWsProp},148:{f:parse_BrtWsDim,p:16},151:{f:parse_BrtPane},152:{},153:{f:parse_BrtWbProp},154:{},155:{},156:{f:parse_BrtBundleSh},157:{},158:{},159:{T:1,f:parse_BrtBeginSst},160:{T:-1},161:{T:1,f:parse_UncheckedRfX},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:parse_BrtMergeCell},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:parse_BrtMdtinfo},336:{T:-1},337:{f:parse_BrtBeginEsmdb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:parse_RelID},357:{},358:{},359:{},360:{T:1},361:{},362:{f:parse_ExternSheet},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:parse_BrtArrFmla},427:{f:parse_BrtShrFmla},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:parse_BrtMargins},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:parse_BrtWsFmtInfo},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:parse_BrtHLink},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:parse_RelID},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:parse_BrtCommentAuthor},633:{T:1},634:{T:-1},635:{T:1,f:parse_BrtBeginComment},636:{T:-1},637:{f:parse_BrtCommentText},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:parse_BrtCsProp},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:parse_BrtDVal14},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},XLSRecordEnum={6:{f:parse_Formula},10:{f:parsenoop2},12:{f:parseuint16},13:{f:parseuint16},14:{f:parsebool},15:{f:parsebool},16:{f:parse_Xnum},17:{f:parsebool},18:{f:parsebool},19:{f:parseuint16},20:{f:parse_XLHeaderFooter},21:{f:parse_XLHeaderFooter},23:{f:parse_ExternSheet},24:{f:parse_Lbl},25:{f:parsebool},26:{},27:{},28:{f:parse_Note},29:{},34:{f:parsebool},35:{f:parse_ExternName},38:{f:parse_Xnum},39:{f:parse_Xnum},40:{f:parse_Xnum},41:{f:parse_Xnum},42:{f:parsebool},43:{f:parsebool},47:{f:parse_FilePass},49:{f:parse_Font},51:{f:parseuint16},60:{},61:{f:parse_Window1},64:{f:parsebool},65:{f:parse_Pane},66:{f:parseuint16},77:{},80:{},81:{},82:{},85:{f:parseuint16},89:{},90:{},91:{},92:{f:parse_WriteAccess},93:{f:parse_Obj},94:{},95:{f:parsebool},96:{},97:{},99:{f:parsebool},125:{f:parse_ColInfo},128:{f:parse_Guts},129:{f:parse_WsBool},130:{f:parseuint16},131:{f:parsebool},132:{f:parsebool},133:{f:parse_BoundSheet8},134:{},140:{f:parse_Country},141:{f:parseuint16},144:{},146:{f:parse_Palette},151:{},152:{},153:{},154:{},155:{},156:{f:parseuint16},157:{},158:{},160:{f:parse_Scl},161:{f:parse_Setup},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:parse_MulRk},190:{f:parse_MulBlank},193:{f:parsenoop2},197:{},198:{},199:{},200:{},201:{},202:{f:parsebool},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:parseuint16},220:{},221:{f:parsebool},222:{},224:{f:parse_XF},225:{f:parse_InterfaceHdr},226:{f:parsenoop2},227:{},229:{f:parse_MergeCells},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:parse_SST},253:{f:parse_LabelSst},255:{f:parse_ExtSST},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:parseuint16a},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:parsebool},353:{f:parsenoop2},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:parse_SupBook},431:{f:parsebool},432:{},433:{},434:{},437:{},438:{f:parse_TxO},439:{f:parsebool},440:{f:parse_HLink},441:{},442:{f:parse_XLUnicodeString},443:{},444:{f:parseuint16},445:{},446:{},448:{f:parsenoop2},449:{f:parse_RecalcId,r:2},450:{f:parsenoop2},512:{f:parse_Dimensions},513:{f:parse_Blank},515:{f:parse_Number},516:{f:parse_Label},517:{f:parse_BoolErr},519:{f:parse_String},520:{f:parse_Row},523:{},545:{f:parse_Array},549:{f:parse_DefaultRowHeight},566:{},574:{f:parse_Window2},638:{f:parse_RK},659:{},1048:{},1054:{f:parse_Format},1084:{},1212:{f:parse_ShrFmla},2048:{f:parse_HLinkTooltip},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:parse_BOF},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:parsenoop2},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:parse_XFCRC,r:12},2173:{f:parse_XFExt,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:parsebool,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:parse_NameCmt,r:12},2197:{},2198:{f:parse_Theme,r:12},2199:{},2200:{},2201:{},2202:{f:parse_MTRSettings,r:12},2203:{f:parsenoop2},2204:{},2205:{},2206:{},2207:{},2211:{f:parse_ForceFullCalculation},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:parseuint16},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:parse_ShtProps},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:parse_ClrtClient},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:parse_Dimensions},1:{},2:{f:parse_BIFF2INT},3:{f:parse_BIFF2NUM},4:{f:parse_BIFF2STR},5:{f:parse_BoolErr},7:{f:parse_BIFF2STRING},8:{},9:{f:parse_BOF},11:{},22:{f:parseuint16},30:{f:parse_BIFF2Format},31:{},32:{},33:{f:parse_Array},36:{},37:{f:parse_DefaultRowHeight},50:{f:parse_BIFF2FONTXTRA},62:{},52:{},67:{},68:{f:parseuint16},69:{},86:{},126:{},127:{f:parse_ImData},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:parse_RString},223:{},234:{},354:{},421:{},518:{f:parse_Formula},521:{f:parse_BOF},536:{f:parse_Lbl},547:{f:parse_ExternName},561:{},579:{},1030:{f:parse_Formula},1033:{f:parse_BOF},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function write_biff_rec(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&is_buf(r)&&t.push(r)}}function write_biff_continue(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return write_biff_rec(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,c=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var h=t.next(4);for(h.write_shift(2,s),h.write_shift(2,u),t.push(r.slice(c,c+u)),c+=u;c<i;){for(h=t.next(4),h.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;h.write_shift(2,u),t.push(r.slice(c,c+u)),c+=u}}}function write_BIFF2Cell(t,e,r){return t||(t=new_buf(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function write_BIFF2BERR(t,e,r,n){var i=new_buf(9);return write_BIFF2Cell(i,t,e),write_Bes(r,n||"b",i),i}function write_BIFF2LABEL(t,e,r){var n=new_buf(8+2*r.length);return write_BIFF2Cell(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function write_ws_biff2_cell(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?datenum(parseDate(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?write_biff_rec(t,2,write_BIFF2INT(r,n,i)):write_biff_rec(t,3,write_BIFF2NUM(r,n,i));return;case"b":case"e":write_biff_rec(t,5,write_BIFF2BERR(r,n,e.v,e.t));return;case"s":case"str":write_biff_rec(t,4,write_BIFF2LABEL(r,n,(e.v||"").slice(0,255)));return}write_biff_rec(t,1,write_BIFF2Cell(null,r,n))}function write_ws_biff2(t,e,r,n){var i=Array.isArray(e),s=safe_decode_range(e["!ref"]||"A1"),a,o="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=encode_range(s)}for(var u=s.s.r;u<=s.e.r;++u){o=encode_row(u);for(var h=s.s.c;h<=s.e.c;++h){u===s.s.r&&(c[h]=encode_col(h)),a=c[h]+o;var f=i?(e[u]||[])[h]:e[a];f&&write_ws_biff2_cell(t,f,u,h)}}}function write_biff2_buf(t,e){for(var r=e||{},n=buf_array(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return write_biff_rec(n,r.biff==4?1033:r.biff==3?521:9,write_BOF(t,16,r)),write_ws_biff2(n,t.Sheets[t.SheetNames[i]],i,r),write_biff_rec(n,10),n.end()}function write_FONTS_biff8(t,e,r){write_biff_rec(t,49,write_Font({sz:12,name:"Arial"},r))}function write_FMTS_biff8(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&write_biff_rec(t,1054,write_Format(i,e[i],r))})}function write_FEAT(t,e){var r=new_buf(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),write_biff_rec(t,2151,r),r=new_buf(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),write_Ref8U(safe_decode_range(e["!ref"]||"A1"),r),r.write_shift(4,4),write_biff_rec(t,2152,r)}function write_CELLXFS_biff8(t,e){for(var r=0;r<16;++r)write_biff_rec(t,224,write_XF({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){write_biff_rec(t,224,write_XF(n,0,e))})}function write_ws_biff8_hlinks(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];write_biff_rec(t,440,write_HLink(n)),n[1].Tooltip&&write_biff_rec(t,2048,write_HLinkTooltip(n))}delete e["!links"]}function write_ws_cols_biff8(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&write_biff_rec(t,125,write_ColInfo(col_obj_w(i,n),i))})}}function write_ws_biff8_cell(t,e,r,n,i){var s=16+get_cell_style(i.cellXfs,e,i);if(e.v==null&&!e.bf){write_biff_rec(t,513,write_XLSCell(r,n,s));return}if(e.bf)write_biff_rec(t,6,write_Formula(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?datenum(parseDate(e.v)):e.v;write_biff_rec(t,515,write_Number(r,n,a,s));break;case"b":case"e":write_biff_rec(t,517,write_BoolErr(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=get_sst_id(i.Strings,e.v,i.revStrings);write_biff_rec(t,253,write_LabelSst(r,n,o,s))}else write_biff_rec(t,516,write_Label(r,n,(e.v||"").slice(0,255),s,i));break;default:write_biff_rec(t,513,write_XLSCell(r,n,s))}}function write_ws_biff8(t,e,r){var n=buf_array(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},c=Array.isArray(s),u=e.biff==8,h,f="",m=[],E=safe_decode_range(s["!ref"]||"A1"),g=u?65536:16384;if(E.e.c>255||E.e.r>=g){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");E.e.c=Math.min(E.e.c,255),E.e.r=Math.min(E.e.c,g-1)}write_biff_rec(n,2057,write_BOF(r,16,e)),write_biff_rec(n,13,writeuint16(1)),write_biff_rec(n,12,writeuint16(100)),write_biff_rec(n,15,writebool(!0)),write_biff_rec(n,17,writebool(!1)),write_biff_rec(n,16,write_Xnum(.001)),write_biff_rec(n,95,writebool(!0)),write_biff_rec(n,42,writebool(!1)),write_biff_rec(n,43,writebool(!1)),write_biff_rec(n,130,writeuint16(1)),write_biff_rec(n,128,write_Guts()),write_biff_rec(n,131,writebool(!1)),write_biff_rec(n,132,writebool(!1)),u&&write_ws_cols_biff8(n,s["!cols"]),write_biff_rec(n,512,write_Dimensions(E,e)),u&&(s["!links"]=[]);for(var p=E.s.r;p<=E.e.r;++p){f=encode_row(p);for(var _=E.s.c;_<=E.e.c;++_){p===E.s.r&&(m[_]=encode_col(_)),h=m[_]+f;var A=c?(s[p]||[])[_]:s[h];A&&(write_ws_biff8_cell(n,A,p,_,e),u&&A.l&&s["!links"].push([h,A.l]))}}var H=o.CodeName||o.name||i;return u&&write_biff_rec(n,574,write_Window2((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&write_biff_rec(n,229,write_MergeCells(s["!merges"])),u&&write_ws_biff8_hlinks(n,s),write_biff_rec(n,442,write_XLUnicodeString(H)),u&&write_FEAT(n,s),write_biff_rec(n,10),n.end()}function write_biff8_global(t,e,r){var n=buf_array(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,c=r.biff==5;if(write_biff_rec(n,2057,write_BOF(t,5,r)),r.bookType=="xla"&&write_biff_rec(n,135),write_biff_rec(n,225,o?writeuint16(1200):null),write_biff_rec(n,193,writezeroes(2)),c&&write_biff_rec(n,191),c&&write_biff_rec(n,192),write_biff_rec(n,226),write_biff_rec(n,92,write_WriteAccess("SheetJS",r)),write_biff_rec(n,66,writeuint16(o?1200:1252)),o&&write_biff_rec(n,353,writeuint16(0)),o&&write_biff_rec(n,448),write_biff_rec(n,317,write_RRTabId(t.SheetNames.length)),o&&t.vbaraw&&write_biff_rec(n,211),o&&t.vbaraw){var u=a.CodeName||"ThisWorkbook";write_biff_rec(n,442,write_XLUnicodeString(u))}write_biff_rec(n,156,writeuint16(17)),write_biff_rec(n,25,writebool(!1)),write_biff_rec(n,18,writebool(!1)),write_biff_rec(n,19,writeuint16(0)),o&&write_biff_rec(n,431,writebool(!1)),o&&write_biff_rec(n,444,writeuint16(0)),write_biff_rec(n,61,write_Window1()),write_biff_rec(n,64,writebool(!1)),write_biff_rec(n,141,writeuint16(0)),write_biff_rec(n,34,writebool(safe1904(t)=="true")),write_biff_rec(n,14,writebool(!0)),o&&write_biff_rec(n,439,writebool(!1)),write_biff_rec(n,218,writeuint16(0)),write_FONTS_biff8(n,t,r),write_FMTS_biff8(n,t.SSF,r),write_CELLXFS_biff8(n,r),o&&write_biff_rec(n,352,writebool(!1));var h=n.end(),f=buf_array();o&&write_biff_rec(f,140,write_Country()),o&&r.Strings&&write_biff_continue(f,252,write_SST(r.Strings)),write_biff_rec(f,10);var m=f.end(),E=buf_array(),g=0,p=0;for(p=0;p<t.SheetNames.length;++p)g+=(o?12:11)+(o?2:1)*t.SheetNames[p].length;var _=h.length+g+m.length;for(p=0;p<t.SheetNames.length;++p){var A=s[p]||{};write_biff_rec(E,133,write_BoundSheet8({pos:_,hs:A.Hidden||0,dt:0,name:t.SheetNames[p]},r)),_+=e[p].length}var H=E.end();if(g!=H.length)throw new Error("BS8 "+g+" != "+H.length);var te=[];return h.length&&te.push(h),H.length&&te.push(H),m.length&&te.push(m),bconcat(te)}function write_biff8_buf(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=dup(table_fmt)),t&&t.SSF&&(make_ssf(),SSF_load_table(t.SSF),r.revssf=evert_num(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,fix_write_opts(r),r.cellXfs=[],get_cell_style(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=write_ws_biff8(i,r,t);return n.unshift(write_biff8_global(t,n,r)),bconcat(n)}function write_biff_buf(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=decode_range(n["!ref"]);i.e.c>255&&typeof console!="undefined"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return write_biff8_buf(t,e);case 4:case 3:case 2:return write_biff2_buf(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function html_to_sheet(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,c=split_regex(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,h=0,f=0,m=0,E={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(a=0;a<c.length;++a){var p=c[a].trim(),_=p.slice(0,3).toLowerCase();if(_=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}h=0;continue}if(!(_!="<td"&&_!="<th")){var A=p.split(/<\/t[dh]>/i);for(o=0;o<A.length;++o){var H=A[o].trim();if(H.match(/<t[dh]/i)){for(var te=H,ne=0;te.charAt(0)=="<"&&(ne=te.indexOf(">"))>-1;)te=te.slice(ne+1);for(var j=0;j<g.length;++j){var ee=g[j];ee.s.c==h&&ee.s.r<u&&u<=ee.e.r&&(h=ee.e.c+1,j=-1)}var x=parsexmltag(H.slice(0,H.indexOf(">")));m=x.colspan?+x.colspan:1,((f=+x.rowspan)>1||m>1)&&g.push({s:{r:u,c:h},e:{r:u+(f||1)-1,c:h+m-1}});var M=x.t||x["data-t"]||"";if(!te.length){h+=m;continue}if(te=htmldecode(te),E.s.r>u&&(E.s.r=u),E.e.r<u&&(E.e.r=u),E.s.c>h&&(E.s.c=h),E.e.c<h&&(E.e.c=h),!te.length){h+=m;continue}var T={t:"s",v:te};r.raw||!te.trim().length||M=="s"||(te==="TRUE"?T={t:"b",v:!0}:te==="FALSE"?T={t:"b",v:!1}:isNaN(fuzzynum(te))?isNaN(fuzzydate(te).getDate())||(T={t:"d",v:parseDate(te)},r.cellDates||(T={t:"n",v:datenum(T.v)}),T.z=r.dateNF||table_fmt[14]):T={t:"n",v:fuzzynum(te)}),r.dense?(n[u]||(n[u]=[]),n[u][h]=T):n[encode_cell({r:u,c:h})]=T,h+=m}}}}return n["!ref"]=encode_range(E),g.length&&(n["!merges"]=g),n}function make_html_row(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,c=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>a)&&!(i[u].e.r<r||i[u].e.c<a)){if(i[u].s.r<r||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,c=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var h=encode_cell({r,c:a}),f=n.dense?(t[r]||[])[a]:t[h],m=f&&f.v!=null&&(f.h||escapehtml(f.w||(format_cell(f),f.w)||""))||"",E={};o>1&&(E.rowspan=o),c>1&&(E.colspan=c),n.editable?m='<span contenteditable="true">'+m+"</span>":f&&(E["data-t"]=f&&f.t||"z",f.v!=null&&(E["data-v"]=f.v),f.z!=null&&(E["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+f.l.Target+'">'+m+"</a>")),E.id=(n.id||"sjs")+"-"+h,s.push(writextag("td",m,E))}}var g="<tr>";return g+s.join("")+"</tr>"}var HTML_BEGIN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HTML_END="</body></html>";function html_to_workbook(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return sheet_to_workbook(html_to_sheet(r[0],e),e);var n=book_new();return r.forEach(function(i,s){book_append_sheet(n,html_to_sheet(i,e),"Sheet"+(s+1))}),n}function make_html_preamble(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function sheet_to_html(t,e){var r=e||{},n=r.header!=null?r.header:HTML_BEGIN,i=r.footer!=null?r.footer:HTML_END,s=[n],a=decode_range(t["!ref"]);r.dense=Array.isArray(t),s.push(make_html_preamble(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(make_html_row(t,a,o,r));return s.push("</table>"+i),s.join("")}function sheet_add_dom(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?decode_cell(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var h=decode_range(t["!ref"]);u.s.r=Math.min(u.s.r,h.s.r),u.s.c=Math.min(u.s.c,h.s.c),u.e.r=Math.max(u.e.r,h.e.r),u.e.c=Math.max(u.e.c,h.e.c),i==-1&&(u.e.r=i=h.e.r+1)}var f=[],m=0,E=t["!rows"]||(t["!rows"]=[]),g=0,p=0,_=0,A=0,H=0,te=0;for(t["!cols"]||(t["!cols"]=[]);g<o.length&&p<c;++g){var ne=o[g];if(is_dom_element_hidden(ne)){if(n.display)continue;E[p]={hidden:!0}}var j=ne.children;for(_=A=0;_<j.length;++_){var ee=j[_];if(!(n.display&&is_dom_element_hidden(ee))){var x=ee.hasAttribute("data-v")?ee.getAttribute("data-v"):ee.hasAttribute("v")?ee.getAttribute("v"):htmldecode(ee.innerHTML),M=ee.getAttribute("data-z")||ee.getAttribute("z");for(m=0;m<f.length;++m){var T=f[m];T.s.c==A+s&&T.s.r<p+i&&p+i<=T.e.r&&(A=T.e.c+1-s,m=-1)}te=+ee.getAttribute("colspan")||1,((H=+ee.getAttribute("rowspan")||1)>1||te>1)&&f.push({s:{r:p+i,c:A+s},e:{r:p+i+(H||1)-1,c:A+s+(te||1)-1}});var O={t:"s",v:x},R=ee.getAttribute("data-t")||ee.getAttribute("t")||"";x!=null&&(x.length==0?O.t=R||"z":n.raw||x.trim().length==0||R=="s"||(x==="TRUE"?O={t:"b",v:!0}:x==="FALSE"?O={t:"b",v:!1}:isNaN(fuzzynum(x))?isNaN(fuzzydate(x).getDate())||(O={t:"d",v:parseDate(x)},n.cellDates||(O={t:"n",v:datenum(O.v)}),O.z=n.dateNF||table_fmt[14]):O={t:"n",v:fuzzynum(x)})),O.z===void 0&&M!=null&&(O.z=M);var Y="",q=ee.getElementsByTagName("A");if(q&&q.length)for(var me=0;me<q.length&&!(q[me].hasAttribute("href")&&(Y=q[me].getAttribute("href"),Y.charAt(0)!="#"));++me);Y&&Y.charAt(0)!="#"&&(O.l={Target:Y}),n.dense?(t[p+i]||(t[p+i]=[]),t[p+i][A+s]=O):t[encode_cell({c:A+s,r:p+i})]=O,u.e.c<A+s&&(u.e.c=A+s),A+=te}}++p}return f.length&&(t["!merges"]=(t["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,p-1+i),t["!ref"]=encode_range(u),p>=c&&(t["!fullref"]=encode_range((u.e.r=o.length-g+p-1+i,u))),t}function parse_dom_table(t,e){var r=e||{},n=r.dense?[]:{};return sheet_add_dom(n,t,e)}function table_to_book(t,e){return sheet_to_workbook(parse_dom_table(t,e),e)}function is_dom_element_hidden(t){var e="",r=get_get_computed_style_function(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function get_get_computed_style_function(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function parse_text_p(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=unescapexml(e.replace(/<[^>]*>/g,""));return[r]}var number_formats_ods={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function parse_content_xml(t,e){var r=e||{},n=xlml_normalize(t),i=[],s,a,o={name:""},c="",u=0,h,f,m={},E=[],g=r.dense?[]:{},p,_,A={value:""},H="",te=0,ne=[],j=-1,ee=-1,x={s:{r:1e6,c:1e7},e:{r:0,c:0}},M=0,T={},O=[],R={},Y=0,q=0,me=[],xe=1,Ee=1,se=[],Fe={Names:[]},ue={},ae=["",""],_e=[],oe={},ie="",re=0,ce=!1,fe=!1,pe=0;for(xlmlregex.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=xlmlregex.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"å·¥ä½œè¡¨":p[1]==="/"?(x.e.c>=x.s.c&&x.e.r>=x.s.r?g["!ref"]=encode_range(x):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=x.e.r&&(g["!fullref"]=g["!ref"],x.e.r=r.sheetRows-1,g["!ref"]=encode_range(x)),O.length&&(g["!merges"]=O),me.length&&(g["!rows"]=me),h.name=h.åç§°||h.name,typeof JSON!="undefined"&&JSON.stringify(h),E.push(h.name),m[h.name]=g,fe=!1):p[0].charAt(p[0].length-2)!=="/"&&(h=parsexmltag(p[0],!1),j=ee=-1,x.s.r=x.s.c=1e7,x.e.r=x.e.c=0,g=r.dense?[]:{},O=[],me=[],fe=!0);break;case"table-row-group":p[1]==="/"?--M:++M;break;case"table-row":case"è¡Œ":if(p[1]==="/"){j+=xe,xe=1;break}if(f=parsexmltag(p[0],!1),f.è¡Œå·?j=f.è¡Œå·-1:j==-1&&(j=0),xe=+f["number-rows-repeated"]||1,xe<10)for(pe=0;pe<xe;++pe)M>0&&(me[j+pe]={level:M});ee=-1;break;case"covered-table-cell":p[1]!=="/"&&++ee,r.sheetStubs&&(r.dense?(g[j]||(g[j]=[]),g[j][ee]={t:"z"}):g[encode_cell({r:j,c:ee})]={t:"z"}),H="",ne=[];break;case"table-cell":case"æ•°æ®":if(p[0].charAt(p[0].length-2)==="/")++ee,A=parsexmltag(p[0],!1),Ee=parseInt(A["number-columns-repeated"]||"1",10),_={t:"z",v:null},A.formula&&r.cellFormula!=!1&&(_.f=ods_to_csf_formula(unescapexml(A.formula))),(A.æ•°æ®ç±»åž‹||A["value-type"])=="string"&&(_.t="s",_.v=unescapexml(A["string-value"]||""),r.dense?(g[j]||(g[j]=[]),g[j][ee]=_):g[encode_cell({r:j,c:ee})]=_),ee+=Ee-1;else if(p[1]!=="/"){++ee,H="",te=0,ne=[],Ee=1;var ve=xe?j+xe-1:j;if(ee>x.e.c&&(x.e.c=ee),ee<x.s.c&&(x.s.c=ee),j<x.s.r&&(x.s.r=j),ve>x.e.r&&(x.e.r=ve),A=parsexmltag(p[0],!1),_e=[],oe={},_={t:A.æ•°æ®ç±»åž‹||A["value-type"],v:null},r.cellFormula)if(A.formula&&(A.formula=unescapexml(A.formula)),A["number-matrix-columns-spanned"]&&A["number-matrix-rows-spanned"]&&(Y=parseInt(A["number-matrix-rows-spanned"],10)||0,q=parseInt(A["number-matrix-columns-spanned"],10)||0,R={s:{r:j,c:ee},e:{r:j+Y-1,c:ee+q-1}},_.F=encode_range(R),se.push([R,_.F])),A.formula)_.f=ods_to_csf_formula(A.formula);else for(pe=0;pe<se.length;++pe)j>=se[pe][0].s.r&&j<=se[pe][0].e.r&&ee>=se[pe][0].s.c&&ee<=se[pe][0].e.c&&(_.F=se[pe][1]);switch((A["number-columns-spanned"]||A["number-rows-spanned"])&&(Y=parseInt(A["number-rows-spanned"],10)||0,q=parseInt(A["number-columns-spanned"],10)||0,R={s:{r:j,c:ee},e:{r:j+Y-1,c:ee+q-1}},O.push(R)),A["number-columns-repeated"]&&(Ee=parseInt(A["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=parsexmlbool(A["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(A.value);break;case"percentage":_.t="n",_.v=parseFloat(A.value);break;case"currency":_.t="n",_.v=parseFloat(A.value);break;case"date":_.t="d",_.v=parseDate(A["date-value"]),r.cellDates||(_.t="n",_.v=datenum(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=parse_isodur(A["time-value"])/86400,r.cellDates&&(_.t="d",_.v=numdate(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(A.æ•°æ®æ•°å€¼);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",A["string-value"]!=null&&(H=unescapexml(A["string-value"]),ne=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(ce=!1,_.t==="s"&&(_.v=H||"",ne.length&&(_.R=ne),ce=te==0),ue.Target&&(_.l=ue),_e.length>0&&(_.c=_e,_e=[]),H&&r.cellText!==!1&&(_.w=H),ce&&(_.t="z",delete _.v),(!ce||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=j))for(var Ae=0;Ae<xe;++Ae){if(Ee=parseInt(A["number-columns-repeated"]||"1",10),r.dense)for(g[j+Ae]||(g[j+Ae]=[]),g[j+Ae][ee]=Ae==0?_:dup(_);--Ee>0;)g[j+Ae][ee+Ee]=dup(_);else for(g[encode_cell({r:j+Ae,c:ee})]=_;--Ee>0;)g[encode_cell({r:j+Ae,c:ee+Ee})]=dup(_);x.e.c<=ee&&(x.e.c=ee)}Ee=parseInt(A["number-columns-repeated"]||"1",10),ee+=Ee-1,Ee=0,_={},H="",ne=[]}ue={};break;case"document":case"document-content":case"ç”µå­è¡¨æ ¼æ–‡æ¡£":case"spreadsheet":case"ä¸»ä½“":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s;oe.t=H,ne.length&&(oe.R=ne),oe.a=ie,_e.push(oe)}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!1]);ie="",re=0,H="",te=0,ne=[];break;case"creator":p[1]==="/"?ie=n.slice(re,p.index):re=p.index+p[0].length;break;case"meta":case"å…ƒæ•°æ®":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!1]);H="",te=0,ne=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(T[o.name]=c,(s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(c="",o=parsexmltag(p[0],!1),i.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=parsexmltag(p[0],!1),c+=number_formats_ods[p[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=parsexmltag(p[0],!1),c+=number_formats_ods[p[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":a=parsexmltag(p[0],!1),ae=ods_to_csf_3D(a["cell-range-address"]);var be={Name:a.name,Ref:ae[0]+"!"+ae[1]};fe&&(be.Sheet=E.length),Fe.Names.push(be);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"ç”µå­è¡¨æ ¼":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"æ–‡æœ¬ä¸²":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(p[1]==="/"&&(!A||!A["string-value"])){var je=parse_text_p(n.slice(te,p.index));H=(H.length>0?H+`
`:"")+je[0]}else parsexmltag(p[0],!1),te=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{ae=ods_to_csf_3D(parsexmltag(p[0])["target-range-address"]),m[ae[0]]["!autofilter"]={ref:ae[1]}}catch(Xe){}break;case"date":break;case"object":break;case"title":case"æ ‡é¢˜":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(ue=parsexmltag(p[0],!1),!ue.href)break;ue.Target=unescapexml(ue.href),delete ue.href,ue.Target.charAt(0)=="#"&&ue.Target.indexOf(".")>-1?(ae=ods_to_csf_3D(ue.Target.slice(1)),ue.Target="#"+ae[0]+"!"+ae[1]):ue.Target.match(/^\.\.[\\\/]/)&&(ue.Target=ue.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"è¡¨:":case"å­—:":break;default:if(r.WTF)throw new Error(p)}}var Se={Sheets:m,SheetNames:E,Workbook:Fe};return r.bookSheets&&delete Se.Sheets,Se}function parse_ods(t,e){e=e||{},safegetzipfile(t,"META-INF/manifest.xml")&&parse_manifest(getzipdata(t,"META-INF/manifest.xml"),e);var r=getzipstr(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=parse_content_xml(utf8read(r),e);return safegetzipfile(t,"meta.xml")&&(n.Props=parse_core_props(getzipdata(t,"meta.xml"))),n}function parse_fods(t,e){return parse_content_xml(t,e)}var write_styles_ods=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return XML_HEADER+e}}(),write_content_ods=function(){var t=function(s){return escapexml(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var c=[];c.push('      <table:table table:name="'+escapexml(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,h=0,f=decode_range(s["!ref"]||"A1"),m=s["!merges"]||[],E=0,g=Array.isArray(s);if(s["!cols"])for(h=0;h<=f.e.c;++h)c.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var p="",_=s["!rows"]||[];for(u=0;u<f.s.r;++u)p=_[u]?' table:style-name="ro'+_[u].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;u<=f.e.r;++u){for(p=_[u]?' table:style-name="ro'+_[u].ods+'"':"",c.push("        <table:table-row"+p+`>
`),h=0;h<f.s.c;++h)c.push(e);for(;h<=f.e.c;++h){var A=!1,H={},te="";for(E=0;E!=m.length;++E)if(!(m[E].s.c>h)&&!(m[E].s.r>u)&&!(m[E].e.c<h)&&!(m[E].e.r<u)){(m[E].s.c!=h||m[E].s.r!=u)&&(A=!0),H["table:number-columns-spanned"]=m[E].e.c-m[E].s.c+1,H["table:number-rows-spanned"]=m[E].e.r-m[E].s.r+1;break}if(A){c.push(r);continue}var ne=encode_cell({r:u,c:h}),j=g?(s[u]||[])[h]:s[ne];if(j&&j.f&&(H["table:formula"]=escapexml(csf_to_ods_formula(j.f)),j.F&&j.F.slice(0,ne.length)==ne)){var ee=decode_range(j.F);H["table:number-matrix-columns-spanned"]=ee.e.c-ee.s.c+1,H["table:number-matrix-rows-spanned"]=ee.e.r-ee.s.r+1}if(!j){c.push(e);continue}switch(j.t){case"b":te=j.v?"TRUE":"FALSE",H["office:value-type"]="boolean",H["office:boolean-value"]=j.v?"true":"false";break;case"n":te=j.w||String(j.v||0),H["office:value-type"]="float",H["office:value"]=j.v||0;break;case"s":case"str":te=j.v==null?"":j.v,H["office:value-type"]="string";break;case"d":te=j.w||parseDate(j.v).toISOString(),H["office:value-type"]="date",H["office:date-value"]=parseDate(j.v).toISOString(),H["table:style-name"]="ce1";break;default:c.push(e);continue}var x=t(te);if(j.l&&j.l.Target){var M=j.l.Target;M=M.charAt(0)=="#"?"#"+csf_to_ods_3D(M.slice(1)):M,M.charAt(0)!="#"&&!M.match(/^\w+:/)&&(M="../"+M),x=writextag("text:a",x,{"xlink:href":M.replace(/&/g,"&amp;")})}c.push("          "+writextag("table:table-cell",writextag("text:p",x,{}),H)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var h=0;h<u["!cols"].length;++h)if(u["!cols"][h]){var f=u["!cols"][h];if(f.width==null&&f.wpx==null&&f.wch==null)continue;process_col(f),f.ods=o;var m=u["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),s.push(`  </style:style>
`),++o}}});var c=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var h=0;h<u["!rows"].length;++h)if(u["!rows"][h]){u["!rows"][h].ods=c;var f=u["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var c=[XML_HEADER],u=wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=wxt_helper({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+h+`>
`),c.push(write_meta_ods().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),i(c,a),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=a.SheetNames.length;++f)c.push(n(a.Sheets[a.SheetNames[f]],a,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function write_ods(t,e){if(e.bookType=="fods")return write_content_ods(t,e);var r=zip_new(),n="",i=[],s=[];return n="mimetype",zip_add_file(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",zip_add_file(r,n,write_content_ods(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",zip_add_file(r,n,write_styles_ods(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",zip_add_file(r,n,XML_HEADER+write_meta_ods()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",zip_add_file(r,n,write_rdf(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",zip_add_file(r,n,write_manifest(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function u8_to_dataview(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function u8str(t){return typeof TextDecoder!="undefined"?new TextDecoder().decode(t):utf8read(a2s(t))}function stru8(t){return typeof TextEncoder!="undefined"?new TextEncoder().encode(t):s2a(utf8write(t))}function u8contains(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function u8concat(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function popcnt(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function readDecimal128LE(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function writeDecimal128LE(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function parse_varint49(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function write_varint49(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function varint_to_i32(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function parse_shallow(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=parse_varint49(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var c=r[0];t[r[0]++]>=128;);o=t.slice(c,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=parse_varint49(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:o,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function write_shallow(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(write_varint49(n*8+i.type)),i.type==2&&e.push(write_varint49(i.data.length)),e.push(i.data))})}),u8concat(e)}function mappa(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function parse_iwa_file(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=parse_varint49(t,n),s=parse_shallow(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:varint_to_i32(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=parse_shallow(o.data),u=varint_to_i32(c[3][0].data);a.messages.push({meta:c,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(a.merge=varint_to_i32(s[3][0].data)>>>0>0),r.push(a)}return r}function write_iwa_file(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:write_varint49(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:write_varint49(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:write_varint49(a.data.length)}],n[2].push({data:write_shallow(a.meta),type:2})});var s=write_shallow(n);e.push(write_varint49(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),u8concat(e)}function parse_snappy_chunk(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=parse_varint49(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var c=0,u=0;if(s==1?(u=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,s==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[u8concat(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(i.push(i[0].slice(-c)),u-=c;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-c,-c+u))}}var h=u8concat(i);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function decompress_iwa_file(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(parse_snappy_chunk(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return u8concat(e)}function compress_iwa_file(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=write_varint49(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return u8concat(e)}function parse_old_storage(t,e,r,n){var i=u8_to_dataview(t),s=i.getUint32(4,!0),a=(n>1?12:8)+popcnt(s&(n>1?3470:398))*4,o=-1,c=-1,u=NaN,h=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=popcnt(s&(n>1?12288:4096))*4,s&16&&(c=i.getUint32(a,!0),a+=4),s&32&&(u=i.getFloat64(a,!0),a+=8),s&64&&(h.setTime(h.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var f;switch(t[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:e[c]};break;case 5:f={t:"d",v:h};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(c>-1)f={t:"s",v:e[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return f}function parse_new_storage(t,e,r){var n=u8_to_dataview(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,c=NaN,u=NaN,h=new Date(2001,0,1);i&1&&(c=readDecimal128LE(t,s),s+=16),i&2&&(u=n.getFloat64(s,!0),s+=8),i&4&&(h.setTime(h.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var f;switch(t[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:e[o]};break;case 5:f={t:"d",v:h};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(a>-1)f={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return f}function write_new_storage(t,e){var r=new Uint8Array(32),n=u8_to_dataview(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,writeDecimal128LE(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function write_old_storage(t,e){var r=new Uint8Array(32),n=u8_to_dataview(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function parse_cell_storage(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return parse_old_storage(t,e,r,t[0]);case 5:return parse_new_storage(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function parse_TSP_Reference(t){var e=parse_shallow(t);return parse_varint49(e[1][0].data)}function parse_TST_TableDataList(t,e){var r=parse_shallow(e.data),n=varint_to_i32(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=parse_shallow(a.data),c=varint_to_i32(o[1][0].data)>>>0;switch(n){case 1:s[c]=u8str(o[3][0].data);break;case 8:{var u=t[parse_TSP_Reference(o[9][0].data)][0],h=parse_shallow(u.data),f=t[parse_TSP_Reference(h[1][0].data)][0],m=varint_to_i32(f.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var E=parse_shallow(f.data);s[c]=E[3].map(function(g){return u8str(g.data)}).join("")}break}}),s}function parse_TST_TileRowInfo(t,e){var r,n,i,s,a,o,c,u,h,f,m,E,g,p,_=parse_shallow(t),A=varint_to_i32(_[1][0].data)>>>0,H=varint_to_i32(_[2][0].data)>>>0,te=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&varint_to_i32(_[8][0].data)>0||!1,ne,j;if((s=(i=_[7])==null?void 0:i[0])!=null&&s.data&&e!=0)ne=(o=(a=_[7])==null?void 0:a[0])==null?void 0:o.data,j=(u=(c=_[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(h=_[4])==null?void 0:h[0])!=null&&f.data&&e!=1)ne=(E=(m=_[4])==null?void 0:m[0])==null?void 0:E.data,j=(p=(g=_[3])==null?void 0:g[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var ee=te?4:1,x=u8_to_dataview(ne),M=[],T=0;T<ne.length/2;++T){var O=x.getUint16(T*2,!0);O<65535&&M.push([T,O])}if(M.length!=H)throw"Expected ".concat(H," cells, found ").concat(M.length);var R=[];for(T=0;T<M.length-1;++T)R[M[T][0]]=j.subarray(M[T][1]*ee,M[T+1][1]*ee);return M.length>=1&&(R[M[M.length-1][0]]=j.subarray(M[M.length-1][1]*ee)),{R:A,cells:R}}function parse_TST_Tile(t,e){var r,n=parse_shallow(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?varint_to_i32(n[7][0].data)>>>0>0?1:0:-1,s=mappa(n[5],function(a){return parse_TST_TileRowInfo(a,i)});return{nrows:varint_to_i32(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(c,u){if(a[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));a[o.R][u]=c}),a},[])}}function parse_TST_TableModelArchive(t,e,r){var n,i=parse_shallow(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(varint_to_i32(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(varint_to_i32(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=encode_range(s);var a=parse_shallow(i[4][0].data),o=parse_TST_TableDataList(t,t[parse_TSP_Reference(a[4][0].data)][0]),c=(n=a[17])!=null&&n[0]?parse_TST_TableDataList(t,t[parse_TSP_Reference(a[17][0].data)][0]):[],u=parse_shallow(a[3][0].data),h=0;u[1].forEach(function(f){var m=parse_shallow(f.data),E=t[parse_TSP_Reference(m[2][0].data)][0],g=varint_to_i32(E.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var p=parse_TST_Tile(t,E);p.data.forEach(function(_,A){_.forEach(function(H,te){var ne=encode_cell({r:h+A,c:te}),j=parse_cell_storage(H,o,c);j&&(r[ne]=j)})}),h+=p.nrows})}function parse_TST_TableInfoArchive(t,e){var r=parse_shallow(e.data),n={"!ref":"A1"},i=t[parse_TSP_Reference(r[2][0].data)],s=varint_to_i32(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return parse_TST_TableModelArchive(t,i[0],n),n}function parse_TN_SheetArchive(t,e){var r,n=parse_shallow(e.data),i={name:(r=n[1])!=null&&r[0]?u8str(n[1][0].data):"",sheets:[]},s=mappa(n[2],parse_TSP_Reference);return s.forEach(function(a){t[a].forEach(function(o){var c=varint_to_i32(o.meta[1][0].data);c==6e3&&i.sheets.push(parse_TST_TableInfoArchive(t,o))})}),i}function parse_TN_DocumentArchive(t,e){var r=book_new(),n=parse_shallow(e.data),i=mappa(n[1],parse_TSP_Reference);if(i.forEach(function(s){t[s].forEach(function(a){var o=varint_to_i32(a.meta[1][0].data);if(o==2){var c=parse_TN_SheetArchive(t,a);c.sheets.forEach(function(u,h){book_append_sheet(r,u,h==0?c.name:c.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function parse_numbers_iwa(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=decompress_iwa_file(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var h;try{h=parse_iwa_file(u)}catch(f){return console.log("## "+(f.message||f))}h.forEach(function(f){s[f.id]=f.messages,a.push(f.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&varint_to_i32(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(c){s[c].forEach(function(u){var h=varint_to_i32(u.meta[1][0].data)>>>0;if(h==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return parse_TN_DocumentArchive(s,o)}function write_tile_row(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&varint_to_i32(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=u8_to_dataview(t[7][0].data),h=0,f=[],m=u8_to_dataview(t[4][0].data),E=0,g=[],p=0;p<e.length;++p){if(e[p]==null){u.setUint16(p*2,65535,!0),m.setUint16(p*2,65535);continue}u.setUint16(p*2,h,!0),m.setUint16(p*2,E,!0);var _,A;switch(typeof e[p]){case"string":_=write_new_storage({t:"s",v:e[p]},r),A=write_old_storage({t:"s",v:e[p]},r);break;case"number":_=write_new_storage({t:"n",v:e[p]},r),A=write_old_storage({t:"n",v:e[p]},r);break;case"boolean":_=write_new_storage({t:"b",v:e[p]},r),A=write_old_storage({t:"b",v:e[p]},r);break;default:throw new Error("Unsupported value "+e[p])}f.push(_),h+=_.length,g.push(A),E+=A.length,++c}for(t[2][0].data=write_varint49(c);p<t[7][0].data.length/2;++p)u.setUint16(p*2,65535,!0),m.setUint16(p*2,65535,!0);return t[6][0].data=u8concat(f),t[3][0].data=u8concat(g),c}function write_numbers_iwa(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=decode_range(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(encode_range(n)));var s=sheet_to_json(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(ie){return ie.forEach(function(re){typeof re=="string"&&a.push(re)})});var o={},c=[],u=CFB.read(e.numbers,{type:"base64"});u.FileIndex.map(function(ie,re){return[ie,u.FullPaths[re]]}).forEach(function(ie){var re=ie[0],ce=ie[1];if(re.type==2&&re.name.match(/\.iwa/)){var fe=re.content,pe=decompress_iwa_file(fe),ve=parse_iwa_file(pe);ve.forEach(function(Ae){c.push(Ae.id),o[Ae.id]={deps:[],location:ce,type:varint_to_i32(Ae.messages[0].meta[1][0].data)}})}}),c.sort(function(ie,re){return ie-re});var h=c.filter(function(ie){return ie>1}).map(function(ie){return[ie,write_varint49(ie)]});u.FileIndex.map(function(ie,re){return[ie,u.FullPaths[re]]}).forEach(function(ie){var re=ie[0];if(ie[1],!!re.name.match(/\.iwa/)){var ce=parse_iwa_file(decompress_iwa_file(re.content));ce.forEach(function(fe){fe.messages.forEach(function(pe){h.forEach(function(ve){fe.messages.some(function(Ae){return varint_to_i32(Ae.meta[1][0].data)!=11006&&u8contains(Ae.data,ve[1])})&&o[ve[0]].deps.push(fe.id)})})})}});for(var f=CFB.find(u,o[1].location),m=parse_iwa_file(decompress_iwa_file(f.content)),E,g=0;g<m.length;++g){var p=m[g];p.id==1&&(E=p)}var _=parse_TSP_Reference(parse_shallow(E.messages[0].data)[1][0].data);for(f=CFB.find(u,o[_].location),m=parse_iwa_file(decompress_iwa_file(f.content)),g=0;g<m.length;++g)p=m[g],p.id==_&&(E=p);for(_=parse_TSP_Reference(parse_shallow(E.messages[0].data)[2][0].data),f=CFB.find(u,o[_].location),m=parse_iwa_file(decompress_iwa_file(f.content)),g=0;g<m.length;++g)p=m[g],p.id==_&&(E=p);for(_=parse_TSP_Reference(parse_shallow(E.messages[0].data)[2][0].data),f=CFB.find(u,o[_].location),m=parse_iwa_file(decompress_iwa_file(f.content)),g=0;g<m.length;++g)p=m[g],p.id==_&&(E=p);var A=parse_shallow(E.messages[0].data);{A[6][0].data=write_varint49(n.e.r+1),A[7][0].data=write_varint49(n.e.c+1);var H=parse_TSP_Reference(A[46][0].data),te=CFB.find(u,o[H].location),ne=parse_iwa_file(decompress_iwa_file(te.content));{for(var j=0;j<ne.length&&ne[j].id!=H;++j);if(ne[j].id!=H)throw"Bad ColumnRowUIDMapArchive";var ee=parse_shallow(ne[j].messages[0].data);ee[1]=[],ee[2]=[],ee[3]=[];for(var x=0;x<=n.e.c;++x){var M=[];M[1]=M[2]=[{type:0,data:write_varint49(x+420690)}],ee[1].push({type:2,data:write_shallow(M)}),ee[2].push({type:0,data:write_varint49(x)}),ee[3].push({type:0,data:write_varint49(x)})}ee[4]=[],ee[5]=[],ee[6]=[];for(var T=0;T<=n.e.r;++T)M=[],M[1]=M[2]=[{type:0,data:write_varint49(T+726270)}],ee[4].push({type:2,data:write_shallow(M)}),ee[5].push({type:0,data:write_varint49(T)}),ee[6].push({type:0,data:write_varint49(T)});ne[j].messages[0].data=write_shallow(ee)}te.content=compress_iwa_file(write_iwa_file(ne)),te.size=te.content.length,delete A[46];var O=parse_shallow(A[4][0].data);{O[7][0].data=write_varint49(n.e.r+1);var R=parse_shallow(O[1][0].data),Y=parse_TSP_Reference(R[2][0].data);te=CFB.find(u,o[Y].location),ne=parse_iwa_file(decompress_iwa_file(te.content));{if(ne[0].id!=Y)throw"Bad HeaderStorageBucket";var q=parse_shallow(ne[0].messages[0].data);for(T=0;T<s.length;++T){var me=parse_shallow(q[2][0].data);me[1][0].data=write_varint49(T),me[4][0].data=write_varint49(s[T].length),q[2][T]={type:q[2][0].type,data:write_shallow(me)}}ne[0].messages[0].data=write_shallow(q)}te.content=compress_iwa_file(write_iwa_file(ne)),te.size=te.content.length;var xe=parse_TSP_Reference(O[2][0].data);te=CFB.find(u,o[xe].location),ne=parse_iwa_file(decompress_iwa_file(te.content));{if(ne[0].id!=xe)throw"Bad HeaderStorageBucket";for(q=parse_shallow(ne[0].messages[0].data),x=0;x<=n.e.c;++x)me=parse_shallow(q[2][0].data),me[1][0].data=write_varint49(x),me[4][0].data=write_varint49(n.e.r+1),q[2][x]={type:q[2][0].type,data:write_shallow(me)};ne[0].messages[0].data=write_shallow(q)}te.content=compress_iwa_file(write_iwa_file(ne)),te.size=te.content.length;var Ee=parse_TSP_Reference(O[4][0].data);(function(){for(var ie=CFB.find(u,o[Ee].location),re=parse_iwa_file(decompress_iwa_file(ie.content)),ce,fe=0;fe<re.length;++fe){var pe=re[fe];pe.id==Ee&&(ce=pe)}var ve=parse_shallow(ce.messages[0].data);{ve[3]=[];var Ae=[];a.forEach(function(Se,Xe){Ae[1]=[{type:0,data:write_varint49(Xe)}],Ae[2]=[{type:0,data:write_varint49(1)}],Ae[3]=[{type:2,data:stru8(Se)}],ve[3].push({type:2,data:write_shallow(Ae)})})}ce.messages[0].data=write_shallow(ve);var be=write_iwa_file(re),je=compress_iwa_file(be);ie.content=je,ie.size=ie.content.length})();var se=parse_shallow(O[3][0].data);{var Fe=se[1][0];delete se[2];var ue=parse_shallow(Fe.data);{var ae=parse_TSP_Reference(ue[2][0].data);(function(){for(var ie=CFB.find(u,o[ae].location),re=parse_iwa_file(decompress_iwa_file(ie.content)),ce,fe=0;fe<re.length;++fe){var pe=re[fe];pe.id==ae&&(ce=pe)}var ve=parse_shallow(ce.messages[0].data);{delete ve[6],delete se[7];var Ae=new Uint8Array(ve[5][0].data);ve[5]=[];for(var be=0,je=0;je<=n.e.r;++je){var Se=parse_shallow(Ae);be+=write_tile_row(Se,s[je],a),Se[1][0].data=write_varint49(je),ve[5].push({data:write_shallow(Se),type:2})}ve[1]=[{type:0,data:write_varint49(n.e.c+1)}],ve[2]=[{type:0,data:write_varint49(n.e.r+1)}],ve[3]=[{type:0,data:write_varint49(be)}],ve[4]=[{type:0,data:write_varint49(n.e.r+1)}]}ce.messages[0].data=write_shallow(ve);var Xe=write_iwa_file(re),qe=compress_iwa_file(Xe);ie.content=qe,ie.size=ie.content.length})()}Fe.data=write_shallow(ue)}O[3][0].data=write_shallow(se)}A[4][0].data=write_shallow(O)}E.messages[0].data=write_shallow(A);var _e=write_iwa_file(m),oe=compress_iwa_file(_e);return f.content=oe,f.size=f.content.length,u}function fix_opts_func(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function fix_read_opts(t){fix_opts_func([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function fix_write_opts(t){fix_opts_func([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function get_sheet_type(t){return RELS.WS.indexOf(t)>-1?"sheet":t==RELS.CS?"chart":t==RELS.DS?"dialog":t==RELS.MS?"macro":t&&t.length?t:"sheet"}function safe_parse_wbrels(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,get_sheet_type(t["!id"][n.id].Type)]})}catch(r){return null}return!t||t.length===0?null:t}function safe_parse_sheet(t,e,r,n,i,s,a,o,c,u,h,f){try{s[n]=parse_rels(getzipstr(t,r,!0),e);var m=getzipdata(t,e),E;switch(o){case"sheet":E=parse_ws(m,e,i,c,s[n],u,h,f);break;case"chart":if(E=parse_cs(m,e,i,c,s[n],u,h,f),!E||!E["!drawel"])break;var g=resolve_path(E["!drawel"].Target,e),p=get_rels_path(g),_=parse_drawing(getzipstr(t,g,!0),parse_rels(getzipstr(t,p,!0),g)),A=resolve_path(_,g),H=get_rels_path(A);E=parse_chart(getzipstr(t,A,!0),A,c,parse_rels(getzipstr(t,H,!0),A),u,E);break;case"macro":E=parse_ms(m,e,i,c,s[n],u,h,f);break;case"dialog":E=parse_ds(m,e,i,c,s[n],u,h,f);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=E;var te=[];s&&s[n]&&keys(s[n]).forEach(function(ne){var j="";if(s[n][ne].Type==RELS.CMNT){j=resolve_path(s[n][ne].Target,e);var ee=parse_cmnt(getzipdata(t,j,!0),j,c);if(!ee||!ee.length)return;sheet_insert_comments(E,ee,!1)}s[n][ne].Type==RELS.TCMNT&&(j=resolve_path(s[n][ne].Target,e),te=te.concat(parse_tcmnt_xml(getzipdata(t,j,!0),c)))}),te&&te.length&&sheet_insert_comments(E,te,!0,c.people||[])}catch(ne){if(c.WTF)throw ne}}function strip_front_slash(t){return t.charAt(0)=="/"?t.slice(1):t}function parse_zip(t,e){if(make_ssf(),e=e||{},fix_read_opts(e),safegetzipfile(t,"META-INF/manifest.xml")||safegetzipfile(t,"objectdata.xml"))return parse_ods(t,e);if(safegetzipfile(t,"Index/Document.iwa")){if(typeof Uint8Array=="undefined")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof parse_numbers_iwa!="undefined"){if(t.FileIndex)return parse_numbers_iwa(t);var r=CFB.utils.cfb_new();return zipentries(t).forEach(function(me){zip_add_file(r,me,getzipbin(t,me))}),parse_numbers_iwa(r)}throw new Error("Unsupported NUMBERS file")}if(!safegetzipfile(t,"[Content_Types].xml"))throw safegetzipfile(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):safegetzipfile(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=zipentries(t),i=parse_ct(getzipstr(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",getzipdata(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!getzipdata(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},u={};if(!e.bookSheets&&!e.bookProps){if(strs=[],i.sst)try{strs=parse_sst(getzipdata(t,strip_front_slash(i.sst)),i.sst,e)}catch(me){if(e.WTF)throw me}e.cellStyles&&i.themes.length&&(c=parse_theme(getzipstr(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(u=parse_sty(getzipdata(t,strip_front_slash(i.style)),i.style,c,e))}i.links.map(function(me){try{var xe=parse_rels(getzipstr(t,get_rels_path(strip_front_slash(me))),me);return parse_xlink(getzipdata(t,strip_front_slash(me)),xe,me,e)}catch(Ee){}});var h=parse_wb(getzipdata(t,strip_front_slash(i.workbooks[0])),i.workbooks[0],e),f={},m="";i.coreprops.length&&(m=getzipdata(t,strip_front_slash(i.coreprops[0]),!0),m&&(f=parse_core_props(m)),i.extprops.length!==0&&(m=getzipdata(t,strip_front_slash(i.extprops[0]),!0),m&&parse_ext_props(m,f,e)));var E={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(m=getzipstr(t,strip_front_slash(i.custprops[0]),!0),m&&(E=parse_cust_props(m,e)));var g={};if((e.bookSheets||e.bookProps)&&(h.Sheets?a=h.Sheets.map(function(xe){return xe.name}):f.Worksheets&&f.SheetNames.length>0&&(a=f.SheetNames),e.bookProps&&(g.Props=f,g.Custprops=E),e.bookSheets&&typeof a!="undefined"&&(g.SheetNames=a),e.bookSheets?g.SheetNames:e.bookProps))return g;a={};var p={};e.bookDeps&&i.calcchain&&(p=parse_cc(getzipdata(t,strip_front_slash(i.calcchain)),i.calcchain));var _=0,A={},H,te;{var ne=h.Sheets;f.Worksheets=ne.length,f.SheetNames=[];for(var j=0;j!=ne.length;++j)f.SheetNames[j]=ne[j].name}var ee=s?"bin":"xml",x=i.workbooks[0].lastIndexOf("/"),M=(i.workbooks[0].slice(0,x+1)+"_rels/"+i.workbooks[0].slice(x+1)+".rels").replace(/^\//,"");safegetzipfile(t,M)||(M="xl/_rels/workbook."+ee+".rels");var T=parse_rels(getzipstr(t,M,!0),M.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=parse_xlmeta(getzipdata(t,strip_front_slash(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=parse_people_xml(getzipdata(t,strip_front_slash(i.people[0])),e)),T&&(T=safe_parse_wbrels(T,h.Sheets));var O=getzipdata(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=f.Worksheets;++_){var R="sheet";if(T&&T[_]?(H="xl/"+T[_][1].replace(/[\/]?xl\//,""),safegetzipfile(t,H)||(H=T[_][1]),safegetzipfile(t,H)||(H=M.replace(/_rels\/.*$/,"")+T[_][1]),R=T[_][2]):(H="xl/worksheets/sheet"+(_+1-O)+"."+ee,H=H.replace(/sheet0\./,"sheet.")),te=H.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(_!=e.sheets)continue e;break;case"string":if(f.SheetNames[_].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var Y=!1,q=0;q!=e.sheets.length;++q)typeof e.sheets[q]=="number"&&e.sheets[q]==_&&(Y=1),typeof e.sheets[q]=="string"&&e.sheets[q].toLowerCase()==f.SheetNames[_].toLowerCase()&&(Y=1);if(!Y)continue e}}safe_parse_sheet(t,H,te,f.SheetNames[_],_,A,a,R,e,h,c,u)}return g={Directory:i,Workbook:h,Props:f,Custprops:E,Deps:p,Sheets:a,SheetNames:f.SheetNames,Strings:strs,Styles:u,Themes:c,SSF:dup(table_fmt)},e&&e.bookFiles&&(t.files?(g.keys=n,g.files=t.files):(g.keys=[],g.files={},t.FullPaths.forEach(function(me,xe){me=me.replace(/^Root Entry[\/]/,""),g.keys.push(me),g.files[me]=t.FileIndex[xe]}))),e&&e.bookVBA&&(i.vba.length>0?g.vbaraw=getzipdata(t,strip_front_slash(i.vba[0]),!0):i.defaults&&i.defaults.bin===CT_VBA&&(g.vbaraw=getzipdata(t,"xl/vbaProject.bin",!0))),g}function parse_xlsxcfb(t,e){var r=e||{},n="Workbook",i=CFB.find(t,n);try{if(n="/!DataSpaces/Version",i=CFB.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(parse_DataSpaceVersionInfo(i.content),n="/!DataSpaces/DataSpaceMap",i=CFB.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=parse_DataSpaceMap(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=CFB.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=parse_DataSpaceDefinition(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=CFB.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);parse_Primary(i.content)}catch(c){}if(n="/EncryptionInfo",i=CFB.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=parse_EncryptionInfo(i.content);if(n="/EncryptedPackage",i=CFB.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile!="undefined")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76!="undefined")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function write_zip(t,e){return e.bookType=="ods"?write_ods(t,e):e.bookType=="numbers"?write_numbers_iwa(t,e):e.bookType=="xlsb"?write_zip_xlsxb(t,e):write_zip_xlsx(t,e)}function write_zip_xlsxb(t,e){_shapeid=1024,t&&!t.SSF&&(t.SSF=dup(table_fmt)),t&&t.SSF&&(make_ssf(),SSF_load_table(t.SSF),e.revssf=evert_num(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,browser_has_Map?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=VBAFMTS.indexOf(e.bookType)>-1,i=new_ct();fix_write_opts(e=e||{});var s=zip_new(),a="",o=0;if(e.cellXfs=[],get_cell_style(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",zip_add_file(s,a,write_core_props(t.Props,e)),i.coreprops.push(a),add_rels(e.rels,2,a,RELS.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(t.SheetNames[u]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,zip_add_file(s,a,write_ext_props(t.Props)),i.extprops.push(a),add_rels(e.rels,3,a,RELS.EXT_PROPS),t.Custprops!==t.Props&&keys(t.Custprops||{}).length>0&&(a="docProps/custom.xml",zip_add_file(s,a,write_cust_props(t.Custprops)),i.custprops.push(a),add_rels(e.rels,4,a,RELS.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},f=t.Sheets[t.SheetNames[o-1]],m=(f||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,zip_add_file(s,a,write_ws(o-1,a,e,t,h)),i.sheets.push(a),add_rels(e.wbrels,-1,"worksheets/sheet"+o+"."+r,RELS.WS[0])}if(f){var E=f["!comments"],g=!1,p="";E&&E.length>0&&(p="xl/comments"+o+"."+r,zip_add_file(s,p,write_cmnt(E,p)),i.comments.push(p),add_rels(h,-1,"../comments"+o+"."+r,RELS.CMNT),g=!0),f["!legacy"]&&g&&zip_add_file(s,"xl/drawings/vmlDrawing"+o+".vml",write_comments_vml(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&zip_add_file(s,get_rels_path(a),write_rels(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,zip_add_file(s,a,write_sst(e.Strings,a,e)),i.strs.push(a),add_rels(e.wbrels,-1,"sharedStrings."+r,RELS.SST)),a="xl/workbook."+r,zip_add_file(s,a,write_wb(t,a)),i.workbooks.push(a),add_rels(e.rels,1,a,RELS.WB),a="xl/theme/theme1.xml",zip_add_file(s,a,write_theme(t.Themes,e)),i.themes.push(a),add_rels(e.wbrels,-1,"theme/theme1.xml",RELS.THEME),a="xl/styles."+r,zip_add_file(s,a,write_sty(t,a,e)),i.styles.push(a),add_rels(e.wbrels,-1,"styles."+r,RELS.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",zip_add_file(s,a,t.vbaraw),i.vba.push(a),add_rels(e.wbrels,-1,"vbaProject.bin",RELS.VBA)),a="xl/metadata."+r,zip_add_file(s,a,write_xlmeta(a)),i.metadata.push(a),add_rels(e.wbrels,-1,"metadata."+r,RELS.XLMETA),zip_add_file(s,"[Content_Types].xml",write_ct(i,e)),zip_add_file(s,"_rels/.rels",write_rels(e.rels)),zip_add_file(s,"xl/_rels/workbook."+r+".rels",write_rels(e.wbrels)),delete e.revssf,delete e.ssf,s}function write_zip_xlsx(t,e){_shapeid=1024,t&&!t.SSF&&(t.SSF=dup(table_fmt)),t&&t.SSF&&(make_ssf(),SSF_load_table(t.SSF),e.revssf=evert_num(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,browser_has_Map?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=VBAFMTS.indexOf(e.bookType)>-1,i=new_ct();fix_write_opts(e=e||{});var s=zip_new(),a="",o=0;if(e.cellXfs=[],get_cell_style(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",zip_add_file(s,a,write_core_props(t.Props,e)),i.coreprops.push(a),add_rels(e.rels,2,a,RELS.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(t.SheetNames[u]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,zip_add_file(s,a,write_ext_props(t.Props)),i.extprops.push(a),add_rels(e.rels,3,a,RELS.EXT_PROPS),t.Custprops!==t.Props&&keys(t.Custprops||{}).length>0&&(a="docProps/custom.xml",zip_add_file(s,a,write_cust_props(t.Custprops)),i.custprops.push(a),add_rels(e.rels,4,a,RELS.CUST_PROPS));var h=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var f={"!id":{}},m=t.Sheets[t.SheetNames[o-1]],E=(m||{})["!type"]||"sheet";switch(E){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,zip_add_file(s,a,write_ws_xml(o-1,e,t,f)),i.sheets.push(a),add_rels(e.wbrels,-1,"worksheets/sheet"+o+"."+r,RELS.WS[0])}if(m){var g=m["!comments"],p=!1,_="";if(g&&g.length>0){var A=!1;g.forEach(function(H){H[1].forEach(function(te){te.T==!0&&(A=!0)})}),A&&(_="xl/threadedComments/threadedComment"+o+"."+r,zip_add_file(s,_,write_tcmnt_xml(g,h,e)),i.threadedcomments.push(_),add_rels(f,-1,"../threadedComments/threadedComment"+o+"."+r,RELS.TCMNT)),_="xl/comments"+o+"."+r,zip_add_file(s,_,write_comments_xml(g)),i.comments.push(_),add_rels(f,-1,"../comments"+o+"."+r,RELS.CMNT),p=!0}m["!legacy"]&&p&&zip_add_file(s,"xl/drawings/vmlDrawing"+o+".vml",write_comments_vml(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}f["!id"].rId1&&zip_add_file(s,get_rels_path(a),write_rels(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,zip_add_file(s,a,write_sst_xml(e.Strings,e)),i.strs.push(a),add_rels(e.wbrels,-1,"sharedStrings."+r,RELS.SST)),a="xl/workbook."+r,zip_add_file(s,a,write_wb_xml(t)),i.workbooks.push(a),add_rels(e.rels,1,a,RELS.WB),a="xl/theme/theme1.xml",zip_add_file(s,a,write_theme(t.Themes,e)),i.themes.push(a),add_rels(e.wbrels,-1,"theme/theme1.xml",RELS.THEME),a="xl/styles."+r,zip_add_file(s,a,write_sty_xml(t,e)),i.styles.push(a),add_rels(e.wbrels,-1,"styles."+r,RELS.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",zip_add_file(s,a,t.vbaraw),i.vba.push(a),add_rels(e.wbrels,-1,"vbaProject.bin",RELS.VBA)),a="xl/metadata."+r,zip_add_file(s,a,write_xlmeta_xml()),i.metadata.push(a),add_rels(e.wbrels,-1,"metadata."+r,RELS.XLMETA),h.length>1&&(a="xl/persons/person.xml",zip_add_file(s,a,write_people_xml(h)),i.people.push(a),add_rels(e.wbrels,-1,"persons/person.xml",RELS.PEOPLE)),zip_add_file(s,"[Content_Types].xml",write_ct(i,e)),zip_add_file(s,"_rels/.rels",write_rels(e.rels)),zip_add_file(s,"xl/_rels/workbook."+r+".rels",write_rels(e.wbrels)),delete e.revssf,delete e.ssf,s}function firstbyte(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Base64_decode(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function read_cfb(t,e){return CFB.find(t,"EncryptedPackage")?parse_xlsxcfb(t,e):parse_xlscfb(t,e)}function read_zip(t,e){var r,n=t,i=e||{};return i.type||(i.type=has_buf&&Buffer.isBuffer(t)?"buffer":"base64"),r=zip_read(n,i),parse_zip(r,i)}function read_plaintext(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return parse_xlml(t.slice(r),e);default:break e}return PRN.to_workbook(t,e)}function read_plaintext_raw(t,e){var r="",n=firstbyte(t,e);switch(e.type){case"base64":r=Base64_decode(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=cc2str(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=utf8read(r)),e.type="binary",read_plaintext(r,e)}function read_utf16(t,e){var r=t;return e.type=="base64"&&(r=Base64_decode(r)),r=$cptable.utils.decode(1200,r.slice(2),"str"),e.type="binary",read_plaintext(r,e)}function bstrify(t){return t.match(/[^\x00-\x7F]/)?utf8write(t):t}function read_prn(t,e,r,n){return n?(r.type="string",PRN.to_workbook(t,r)):PRN.to_workbook(e,r)}function readSync(t,e){reset_cp();var r=e||{};if(typeof ArrayBuffer!="undefined"&&t instanceof ArrayBuffer)return readSync(new Uint8Array(t),(r=dup(r),r.type="array",r));typeof Uint8Array!="undefined"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno!="undefined"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),_ssfopts={},r.dateNF&&(_ssfopts.dateNF=r.dateNF),r.type||(r.type=has_buf&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=has_buf?"buffer":"binary",n=read_binary(t),typeof Uint8Array!="undefined"&&!has_buf&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=bstrify(t)),r.type=="array"&&typeof Uint8Array!="undefined"&&t instanceof Uint8Array&&typeof ArrayBuffer!="undefined"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=dup(r),r.type="array",readSync(ab2a(n),r)}switch((i=firstbyte(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return read_cfb(CFB.read(n,r),r);break;case 9:if(i[1]<=8)return parse_xlscfb(n,r);break;case 60:return parse_xlml(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return read_wb_ID(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return DIF.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?read_zip(n,r):read_prn(t,n,r,s);case 239:return i[3]===60?parse_xlml(n,r):read_prn(t,n,r,s);case 255:if(i[1]===254)return read_utf16(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return WK_.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return WK_.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return DBF.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return RTF.to_workbook(n,r);break;case 10:case 13:case 32:return read_plaintext_raw(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return DBF_SUPPORTED_VERSIONS.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?DBF.to_workbook(n,r):read_prn(t,n,r,s)}function write_cfb_ctr(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return write_dl(e.file,CFB.write(t,{type:has_buf?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return CFB.write(t,e)}function write_zip_type(t,e){var r=dup(e||{}),n=write_zip(t,r);return write_zip_denouement(n,r)}function write_zip_denouement(t,e){var r={},n=has_buf?"nodebuffer":typeof Uint8Array!="undefined"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?CFB.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno!="undefined"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(s2ab(i))}return e.password&&typeof encrypt_agile!="undefined"?write_cfb_ctr(encrypt_agile(i,e.password),e):e.type==="file"?write_dl(e.file,i):e.type=="string"?utf8read(i):i}function write_cfb_type(t,e){var r=e||{},n=write_xlscfb(t,r);return write_cfb_ctr(n,r)}function write_string_type(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Base64_encode(utf8write(n));case"binary":return utf8write(n);case"string":return t;case"file":return write_dl(e.file,n,"utf8");case"buffer":return has_buf?Buffer_from(n,"utf8"):typeof TextEncoder!="undefined"?new TextEncoder().encode(n):write_string_type(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function write_stxt_type(t,e){switch(e.type){case"base64":return Base64_encode(t);case"binary":return t;case"string":return t;case"file":return write_dl(e.file,t,"binary");case"buffer":return has_buf?Buffer_from(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function write_binary_type(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Base64_encode(r):e.type=="string"?utf8read(r):r;case"file":return write_dl(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function writeSync(t,e){reset_cp(),check_wb(t);var r=dup(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=writeSync(t,r);return r.type="array",s2ab(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return write_string_type(write_xlml(t,r),r);case"slk":case"sylk":return write_string_type(SYLK.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return write_string_type(sheet_to_html(t.Sheets[t.SheetNames[i]],r),r);case"txt":return write_stxt_type(sheet_to_txt(t.Sheets[t.SheetNames[i]],r),r);case"csv":return write_string_type(sheet_to_csv(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return write_string_type(DIF.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return write_binary_type(DBF.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return write_string_type(PRN.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return write_string_type(RTF.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return write_string_type(ETH.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return write_string_type(write_ods(t,r),r);case"wk1":return write_binary_type(WK_.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return write_binary_type(WK_.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),write_binary_type(write_biff_buf(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),write_cfb_type(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return write_zip_type(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function resolve_book_type(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function writeFileSync(t,e,r){var n={};return n.type="file",n.file=e,resolve_book_type(n),writeSync(t,n)}function make_json_row(t,e,r,n,i,s,a,o){var c=encode_row(r),u=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,m=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch(_){m.__rowNum__=r}else m.__rowNum__=r;if(!a||t[r])for(var E=e.s.c;E<=e.e.c;++E){var g=a?t[r][E]:t[n[E]+c];if(g===void 0||g.t===void 0){if(u===void 0)continue;s[E]!=null&&(m[s[E]]=u);continue}var p=g.v;switch(g.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[E]!=null){if(p==null)if(g.t=="e"&&p===null)m[s[E]]=null;else if(u!==void 0)m[s[E]]=u;else if(h&&p===null)m[s[E]]=null;else continue;else m[s[E]]=h&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?p:format_cell(g,p,o);p!=null&&(f=!1)}}return{row:m,isempty:f}}function sheet_to_json(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},h=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof h){case"string":c=safe_decode_range(h);break;case"number":c=safe_decode_range(t["!ref"]),c.s.r=h;break;default:c=h}n>0&&(i=0);var f=encode_row(c.s.r),m=[],E=[],g=0,p=0,_=Array.isArray(t),A=c.s.r,H=0,te={};_&&!t[A]&&(t[A]=[]);var ne=u.skipHidden&&t["!cols"]||[],j=u.skipHidden&&t["!rows"]||[];for(H=c.s.c;H<=c.e.c;++H)if(!(ne[H]||{}).hidden)switch(m[H]=encode_col(H),r=_?t[A][H]:t[m[H]+f],n){case 1:s[H]=H-c.s.c;break;case 2:s[H]=m[H];break;case 3:s[H]=u.header[H-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=format_cell(r,null,u),p=te[a]||0,!p)te[a]=1;else{do o=a+"_"+p++;while(te[o]);te[a]=p,te[o]=1}s[H]=o}for(A=c.s.r+i;A<=c.e.r;++A)if(!(j[A]||{}).hidden){var ee=make_json_row(t,c,A,m,n,s,_,u);(ee.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(E[g++]=ee.row)}return E.length=g,E}var qreg=/"/g;function make_csv_row(t,e,r,n,i,s,a,o){for(var c=!0,u=[],h="",f=encode_row(r),m=e.s.c;m<=e.e.c;++m)if(n[m]){var E=o.dense?(t[r]||[])[m]:t[n[m]+f];if(E==null)h="";else if(E.v!=null){c=!1,h=""+(o.rawNumbers&&E.t=="n"?E.v:format_cell(E,null,o));for(var g=0,p=0;g!==h.length;++g)if((p=h.charCodeAt(g))===i||p===s||p===34||o.forceQuotes){h='"'+h.replace(qreg,'""')+'"';break}h=="ID"&&(h='"ID"')}else E.f!=null&&!E.F?(c=!1,h="="+E.f,h.indexOf(",")>=0&&(h='"'+h.replace(qreg,'""')+'"')):h="";u.push(h)}return o.blankrows===!1&&c?null:u.join(a)}function sheet_to_csv(t,e){var r=[],n=e==null?{}:e;if(t==null||t["!ref"]==null)return"";var i=safe_decode_range(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),h="",f=[];n.dense=Array.isArray(t);for(var m=n.skipHidden&&t["!cols"]||[],E=n.skipHidden&&t["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(m[g]||{}).hidden||(f[g]=encode_col(g));for(var p=0,_=i.s.r;_<=i.e.r;++_)(E[_]||{}).hidden||(h=make_csv_row(t,i,_,f,a,c,s,n),h!=null&&(n.strip&&(h=h.replace(u,"")),(h||n.blankrows!==!1)&&r.push((p++?o:"")+h)));return delete n.dense,r.join("")}function sheet_to_txt(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=sheet_to_csv(t,e);return r}function sheet_to_formulae(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=safe_decode_range(t["!ref"]),s="",a=[],o,c=[],u=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=encode_col(o);for(var h=i.s.r;h<=i.e.r;++h)for(s=encode_row(h),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=u?(t[h]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function sheet_add_json(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?decode_cell(n.origin):n.origin;a=c.r,o=c.c}var u,h={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var f=safe_decode_range(s["!ref"]);h.e.c=Math.max(h.e.c,f.e.c),h.e.r=Math.max(h.e.r,f.e.r),a==-1&&(a=f.e.r+1,h.e.r=a+e.length-1+i)}else a==-1&&(a=0,h.e.r=e.length-1+i);var m=n.header||[],E=0;e.forEach(function(p,_){keys(p).forEach(function(A){(E=m.indexOf(A))==-1&&(m[E=m.length]=A);var H=p[A],te="z",ne="",j=encode_cell({c:o+E,r:a+_+i});u=ws_get_cell_stub(s,j),H&&typeof H=="object"&&!(H instanceof Date)?s[j]=H:(typeof H=="number"?te="n":typeof H=="boolean"?te="b":typeof H=="string"?te="s":H instanceof Date?(te="d",n.cellDates||(te="n",H=datenum(H)),ne=n.dateNF||table_fmt[14]):H===null&&n.nullError&&(te="e",H=0),u?(u.t=te,u.v=H,delete u.w,delete u.R,ne&&(u.z=ne)):s[j]=u={t:te,v:H},ne&&(u.z=ne))})}),h.e.c=Math.max(h.e.c,o+m.length-1);var g=encode_row(a);if(i)for(E=0;E<m.length;++E)s[encode_col(E+o)+g]={t:"s",v:m[E]};return s["!ref"]=encode_range(h),s}function json_to_sheet(t,e){return sheet_add_json(null,t,e)}function ws_get_cell_stub(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=decode_cell(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?ws_get_cell_stub(t,encode_cell(e)):ws_get_cell_stub(t,encode_cell({r:e,c:r||0}))}function wb_sheet_idx(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function book_new(){return{SheetNames:[],Sheets:{}}}function book_append_sheet(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(check_ws_name(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function book_set_sheet_visibility(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=wb_sheet_idx(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function cell_set_number_format(t,e){return t.z=e,t}function cell_set_hyperlink(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function cell_set_internal_link(t,e,r){return cell_set_hyperlink(t,"#"+e,r)}function cell_add_comment(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function sheet_set_array_formula(t,e,r,n){for(var i=typeof e!="string"?e:safe_decode_range(e),s=typeof e=="string"?e:encode_range(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var c=ws_get_cell_stub(t,a,o);c.t="n",c.F=s,delete c.v,a==i.s.r&&o==i.s.c&&(c.f=r,n&&(c.D=!0))}return t}var utils={encode_col,encode_row,encode_cell,encode_range,decode_col,decode_row,split_cell,decode_cell,decode_range,format_cell,sheet_add_aoa,sheet_add_json,sheet_add_dom,aoa_to_sheet,json_to_sheet,table_to_sheet:parse_dom_table,table_to_book,sheet_to_csv,sheet_to_txt,sheet_to_json,sheet_to_html,sheet_to_formulae,sheet_to_row_object_array:sheet_to_json,sheet_get_cell:ws_get_cell_stub,book_new,book_append_sheet,book_set_sheet_visibility,cell_set_number_format,cell_set_hyperlink,cell_set_internal_link,cell_add_comment,sheet_set_array_formula,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Mt(t){if(typeof document=="undefined")return;let e=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}Mt(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var L$1=t=>typeof t=="number"&&!isNaN(t),N=t=>typeof t=="string",P=t=>typeof t=="function",mt=t=>N(t)||L$1(t),B=t=>N(t)||P(t)?t:null,pt=(t,e)=>t===!1||L$1(t)&&t>0?t:e,z=t=>reactExports.isValidElement(t)||N(t)||P(t)||L$1(t);function Z(t,e,r=300){let{scrollHeight:n,style:i}=t;requestAnimationFrame(()=>{i.minHeight="initial",i.height=n+"px",i.transition=`all ${r}ms`,requestAnimationFrame(()=>{i.height="0",i.padding="0",i.margin="0",setTimeout(e,r)})})}function $$1({enter:t,exit:e,appendPosition:r=!1,collapse:n=!0,collapseDuration:i=300}){return function({children:s,position:a,preventExitTransition:o,done:c,nodeRef:u,isIn:h,playToast:f}){let m=r?`${t}--${a}`:t,E=r?`${e}--${a}`:e,g=reactExports.useRef(0);return reactExports.useLayoutEffect(()=>{let p=u.current,_=m.split(" "),A=H=>{H.target===u.current&&(f(),p.removeEventListener("animationend",A),p.removeEventListener("animationcancel",A),g.current===0&&H.type!=="animationcancel"&&p.classList.remove(..._))};p.classList.add(..._),p.addEventListener("animationend",A),p.addEventListener("animationcancel",A)},[]),reactExports.useEffect(()=>{let p=u.current,_=()=>{p.removeEventListener("animationend",_),n?Z(p,c,i):c()};h||(o?_():(g.current=1,p.className+=` ${E}`,p.addEventListener("animationend",_)))},[h]),React.createElement(React.Fragment,null,s)}}function J(t,e){return{content:tt(t.content,t.props),containerId:t.props.containerId,id:t.props.toastId,theme:t.props.theme,type:t.props.type,data:t.props.data||{},isLoading:t.props.isLoading,icon:t.props.icon,reason:t.removalReason,status:e}}function tt(t,e,r=!1){return reactExports.isValidElement(t)&&!N(t.type)?reactExports.cloneElement(t,{closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:r}):P(t)?t({closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:r}):t}function yt({closeToast:t,theme:e,ariaLabel:r="close"}){return React.createElement("button",{className:`Toastify__close-button Toastify__close-button--${e}`,type:"button",onClick:n=>{n.stopPropagation(),t(!0)},"aria-label":r},React.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},React.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function gt({delay:t,isRunning:e,closeToast:r,type:n="default",hide:i,className:s,controlledProgress:a,progress:o,rtl:c,isIn:u,theme:h}){let f=i||a&&o===0,m={animationDuration:`${t}ms`,animationPlayState:e?"running":"paused"};a&&(m.transform=`scaleX(${o})`);let E=clsx("Toastify__progress-bar",a?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${h}`,`Toastify__progress-bar--${n}`,{"Toastify__progress-bar--rtl":c}),g=P(s)?s({rtl:c,type:n,defaultClassName:E}):clsx(E,s),p={[a&&o>=1?"onTransitionEnd":"onAnimationEnd"]:a&&o<1?null:()=>{u&&r()}};return React.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":f},React.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${h} Toastify__progress-bar--${n}`}),React.createElement("div",Er({role:"progressbar","aria-hidden":f?"true":"false","aria-label":"notification timer",className:g,style:m},p)))}var Xt=1,at=()=>`${Xt++}`;function _t(t,e,r){let n=1,i=0,s=[],a=[],o=e,c=new Map,u=new Set,h=H=>(u.add(H),()=>u.delete(H)),f=()=>{a=Array.from(c.values()),u.forEach(H=>H())},m=({containerId:H,toastId:te,updateId:ne})=>{let j=H?H!==t:t!==1,ee=c.has(te)&&ne==null;return j||ee},E=(H,te)=>{c.forEach(ne=>{var j;(te==null||te===ne.props.toastId)&&((j=ne.toggle)==null||j.call(ne,H))})},g=H=>{var te,ne;(ne=(te=H.props)==null?void 0:te.onClose)==null||ne.call(te,H.removalReason),H.isActive=!1},p=H=>{if(H==null)c.forEach(g);else{let te=c.get(H);te&&g(te)}f()},_=()=>{i-=s.length,s=[]},A=H=>{var te,ne;let{toastId:j,updateId:ee}=H.props,x=ee==null;H.staleId&&c.delete(H.staleId),H.isActive=!0,c.set(j,H),f(),r(J(H,x?"added":"updated")),x&&((ne=(te=H.props).onOpen)==null||ne.call(te))};return{id:t,props:o,observe:h,toggle:E,removeToast:p,toasts:c,clearQueue:_,buildToast:(H,te)=>{if(m(te))return;let{toastId:ne,updateId:j,data:ee,staleId:x,delay:M}=te,T=j==null;T&&i++;let O=Br(Er(Br(Er({},o),{style:o.toastStyle,key:n++}),Object.fromEntries(Object.entries(te).filter(([Y,q])=>q!=null))),{toastId:ne,updateId:j,data:ee,isIn:!1,className:B(te.className||o.toastClassName),progressClassName:B(te.progressClassName||o.progressClassName),autoClose:te.isLoading?!1:pt(te.autoClose,o.autoClose),closeToast(Y){c.get(ne).removalReason=Y,p(ne)},deleteToast(){let Y=c.get(ne);if(Y!=null){if(r(J(Y,"removed")),c.delete(ne),i--,i<0&&(i=0),s.length>0){A(s.shift());return}f()}}});O.closeButton=o.closeButton,te.closeButton===!1||z(te.closeButton)?O.closeButton=te.closeButton:te.closeButton===!0&&(O.closeButton=z(o.closeButton)?o.closeButton:!0);let R={content:H,props:O,staleId:x};o.limit&&o.limit>0&&i>o.limit&&T?s.push(R):L$1(M)?setTimeout(()=>{A(R)},M):A(R)},setProps(H){o=H},setToggle:(H,te)=>{let ne=c.get(H);ne&&(ne.toggle=te)},isToastActive:H=>{var te;return(te=c.get(H))==null?void 0:te.isActive},getSnapshot:()=>a}}var I=new Map,F=[],st=new Set,Vt=t=>st.forEach(e=>e(t)),bt=()=>I.size>0;function Qt(){F.forEach(t=>nt(t.content,t.options)),F=[]}var vt=(t,{containerId:e})=>{var r;return(r=I.get(e||1))==null?void 0:r.toasts.get(t)};function X(t,e){var r;if(e)return!!((r=I.get(e))!=null&&r.isToastActive(t));let n=!1;return I.forEach(i=>{i.isToastActive(t)&&(n=!0)}),n}function ht(t){if(!bt()){F=F.filter(e=>t!=null&&e.options.toastId!==t);return}if(t==null||mt(t))I.forEach(e=>{e.removeToast(t)});else if(t&&("containerId"in t||"id"in t)){let e=I.get(t.containerId);e?e.removeToast(t.id):I.forEach(r=>{r.removeToast(t.id)})}}var Ct=(t={})=>{I.forEach(e=>{e.props.limit&&(!t.containerId||e.id===t.containerId)&&e.clearQueue()})};function nt(t,e){z(t)&&(bt()||F.push({content:t,options:e}),I.forEach(r=>{r.buildToast(t,e)}))}function xt(t){var e;(e=I.get(t.containerId||1))==null||e.setToggle(t.id,t.fn)}function rt(t,e){I.forEach(r=>{(e==null||!(e!=null&&e.containerId)||(e==null?void 0:e.containerId)===r.id)&&r.toggle(t,e==null?void 0:e.id)})}function Et(t){let e=t.containerId||1;return{subscribe(r){let n=_t(e,t,Vt);I.set(e,n);let i=n.observe(r);return Qt(),()=>{i(),I.delete(e)}},setProps(r){var n;(n=I.get(e))==null||n.setProps(r)},getSnapshot(){var r;return(r=I.get(e))==null?void 0:r.getSnapshot()}}}function Pt(t){return st.add(t),()=>{st.delete(t)}}function Wt(t){return t&&(N(t.toastId)||L$1(t.toastId))?t.toastId:at()}function U(t,e){return nt(t,e),e.toastId}function V(t,e){return Br(Er({},e),{type:e&&e.type||t,toastId:Wt(e)})}function Q(t){return(e,r)=>U(e,V(t,r))}function y(t,e){return U(t,V("default",e))}y.loading=(t,e)=>U(t,V("default",Er({isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1},e)));function Gt(t,{pending:e,error:r,success:n},i){let s;e&&(s=N(e)?y.loading(e,i):y.loading(e.render,Er(Er({},i),e)));let a={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},o=(u,h,f)=>{if(h==null){y.dismiss(s);return}let m=Br(Er(Er({type:u},a),i),{data:f}),E=N(h)?{render:h}:h;return s?y.update(s,Er(Er({},m),E)):y(E.render,Er(Er({},m),E)),f},c=P(t)?t():t;return c.then(u=>o("success",n,u)).catch(u=>o("error",r,u)),c}y.promise=Gt;y.success=Q("success");y.info=Q("info");y.error=Q("error");y.warning=Q("warning");y.warn=y.warning;y.dark=(t,e)=>U(t,V("default",Er({theme:"dark"},e)));function qt(t){ht(t)}y.dismiss=qt;y.clearWaitingQueue=Ct;y.isActive=X;y.update=(t,e={})=>{let r=vt(t,e);if(r){let{props:n,content:i}=r,s=Br(Er(Er({delay:100},n),e),{toastId:e.toastId||t,updateId:at()});s.toastId!==t&&(s.staleId=t);let a=s.render||i;delete s.render,U(a,s)}};y.done=t=>{y.update(t,{progress:1})};y.onChange=Pt;y.play=t=>rt(!0,t);y.pause=t=>rt(!1,t);function It(t){var e;let{subscribe:r,getSnapshot:n,setProps:i}=reactExports.useRef(Et(t)).current;i(t);let s=(e=reactExports.useSyncExternalStore(r,n,n))==null?void 0:e.slice();function a(o){if(!s)return[];let c=new Map;return t.newestOnTop&&s.reverse(),s.forEach(u=>{let{position:h}=u.props;c.has(h)||c.set(h,[]),c.get(h).push(u)}),Array.from(c,u=>o(u[0],u[1]))}return{getToastToRender:a,isToastActive:X,count:s==null?void 0:s.length}}function At(t){let[e,r]=reactExports.useState(!1),[n,i]=reactExports.useState(!1),s=reactExports.useRef(null),a=reactExports.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:o,pauseOnHover:c,closeToast:u,onClick:h,closeOnClick:f}=t;xt({id:t.toastId,containerId:t.containerId,fn:r}),reactExports.useEffect(()=>{if(t.pauseOnFocusLoss)return m(),()=>{E()}},[t.pauseOnFocusLoss]);function m(){document.hasFocus()||A(),window.addEventListener("focus",_),window.addEventListener("blur",A)}function E(){window.removeEventListener("focus",_),window.removeEventListener("blur",A)}function g(x){if(t.draggable===!0||t.draggable===x.pointerType){H();let M=s.current;a.canCloseOnClick=!0,a.canDrag=!0,M.style.transition="none",t.draggableDirection==="x"?(a.start=x.clientX,a.removalDistance=M.offsetWidth*(t.draggablePercent/100)):(a.start=x.clientY,a.removalDistance=M.offsetHeight*(t.draggablePercent===80?t.draggablePercent*1.5:t.draggablePercent)/100)}}function p(x){let{top:M,bottom:T,left:O,right:R}=s.current.getBoundingClientRect();x.nativeEvent.type!=="touchend"&&t.pauseOnHover&&x.clientX>=O&&x.clientX<=R&&x.clientY>=M&&x.clientY<=T?A():_()}function _(){r(!0)}function A(){r(!1)}function H(){a.didMove=!1,document.addEventListener("pointermove",ne),document.addEventListener("pointerup",j)}function te(){document.removeEventListener("pointermove",ne),document.removeEventListener("pointerup",j)}function ne(x){let M=s.current;if(a.canDrag&&M){a.didMove=!0,e&&A(),t.draggableDirection==="x"?a.delta=x.clientX-a.start:a.delta=x.clientY-a.start,a.start!==x.clientX&&(a.canCloseOnClick=!1);let T=t.draggableDirection==="x"?`${a.delta}px, var(--y)`:`0, calc(${a.delta}px + var(--y))`;M.style.transform=`translate3d(${T},0)`,M.style.opacity=`${1-Math.abs(a.delta/a.removalDistance)}`}}function j(){te();let x=s.current;if(a.canDrag&&a.didMove&&x){if(a.canDrag=!1,Math.abs(a.delta)>a.removalDistance){i(!0),t.closeToast(!0),t.collapseAll();return}x.style.transition="transform 0.2s, opacity 0.2s",x.style.removeProperty("transform"),x.style.removeProperty("opacity")}}let ee={onPointerDown:g,onPointerUp:p};return o&&c&&(ee.onMouseEnter=A,t.stacked||(ee.onMouseLeave=_)),f&&(ee.onClick=x=>{h&&h(x),a.canCloseOnClick&&u(!0)}),{playToast:_,pauseToast:A,isRunning:e,preventExitTransition:n,toastRef:s,eventHandlers:ee}}var Ot=typeof window!="undefined"?reactExports.useLayoutEffect:reactExports.useEffect,G=i=>{var s=i,{theme:t,type:e,isLoading:r}=s,n=Jn(s,["theme","type","isLoading"]);return React.createElement("svg",Er({viewBox:"0 0 24 24",width:"100%",height:"100%",fill:t==="colored"?"currentColor":`var(--toastify-icon-color-${e})`},n))};function ao(t){return React.createElement(G,Er({},t),React.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function so(t){return React.createElement(G,Er({},t),React.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function no(t){return React.createElement(G,Er({},t),React.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function ro(t){return React.createElement(G,Er({},t),React.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function io(){return React.createElement("div",{className:"Toastify__spinner"})}var W={info:so,warning:ao,success:no,error:ro,spinner:io},lo=t=>t in W;function Nt({theme:t,type:e,isLoading:r,icon:n}){let i=null,s={theme:t,type:e};return n===!1||(P(n)?i=n(Br(Er({},s),{isLoading:r})):reactExports.isValidElement(n)?i=reactExports.cloneElement(n,s):r?i=W.spinner():lo(e)&&(i=W[e](s))),i}var wt=t=>{let{isRunning:e,preventExitTransition:r,toastRef:n,eventHandlers:i,playToast:s}=At(t),{closeButton:a,children:o,autoClose:c,onClick:u,type:h,hideProgressBar:f,closeToast:m,transition:E,position:g,className:p,style:_,progressClassName:A,updateId:H,role:te,progress:ne,rtl:j,toastId:ee,deleteToast:x,isIn:M,isLoading:T,closeOnClick:O,theme:R,ariaLabel:Y}=t,q=clsx("Toastify__toast",`Toastify__toast-theme--${R}`,`Toastify__toast--${h}`,{"Toastify__toast--rtl":j},{"Toastify__toast--close-on-click":O}),me=P(p)?p({rtl:j,position:g,type:h,defaultClassName:q}):clsx(q,p),xe=Nt(t),Ee=!!ne||!c,se={closeToast:m,type:h,theme:R},Fe=null;return a===!1||(P(a)?Fe=a(se):reactExports.isValidElement(a)?Fe=reactExports.cloneElement(a,se):Fe=yt(se)),React.createElement(E,{isIn:M,done:x,position:g,preventExitTransition:r,nodeRef:n,playToast:s},React.createElement("div",Er(Br(Er({id:ee,tabIndex:0,onClick:u,"data-in":M,className:me},i),{style:_,ref:n}),M&&{role:te,"aria-label":Y}),xe!=null&&React.createElement("div",{className:clsx("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!T})},xe),tt(o,t,!e),Fe,!t.customProgressBar&&React.createElement(gt,Br(Er({},H&&!Ee?{key:`p-${H}`}:{}),{rtl:j,theme:R,delay:c,isRunning:e,isIn:M,closeToast:m,hide:f,type:h,className:A,controlledProgress:Ee,progress:ne||0}))))},K=(t,e=!1)=>({enter:`Toastify--animate Toastify__${t}-enter`,exit:`Toastify--animate Toastify__${t}-exit`,appendPosition:e}),lt=$$1(K("bounce",!0)),_o={position:"top-right",transition:lt,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:t=>t.altKey&&t.code==="KeyT"};function Lt(t){let e=Er(Er({},_o),t),r=t.stacked,[n,i]=reactExports.useState(!0),s=reactExports.useRef(null),{getToastToRender:a,isToastActive:o,count:c}=It(e),{className:u,style:h,rtl:f,containerId:m,hotKeys:E}=e;function g(_){let A=clsx("Toastify__toast-container",`Toastify__toast-container--${_}`,{"Toastify__toast-container--rtl":f});return P(u)?u({position:_,rtl:f,defaultClassName:A}):clsx(A,B(u))}function p(){r&&(i(!0),y.play())}return Ot(()=>{var _;if(r){let A=s.current.querySelectorAll('[data-in="true"]'),H=12,te=(_=e.position)==null?void 0:_.includes("top"),ne=0,j=0;Array.from(A).reverse().forEach((ee,x)=>{let M=ee;M.classList.add("Toastify__toast--stacked"),x>0&&(M.dataset.collapsed=`${n}`),M.dataset.pos||(M.dataset.pos=te?"top":"bot");let T=ne*(n?.2:1)+(n?0:H*x);M.style.setProperty("--y",`${te?T:T*-1}px`),M.style.setProperty("--g",`${H}`),M.style.setProperty("--s",`${1-(n?j:0)}`),ne+=M.offsetHeight,j+=.025})}},[n,c,r]),reactExports.useEffect(()=>{function _(A){var H;let te=s.current;E(A)&&((H=te.querySelector('[tabIndex="0"]'))==null||H.focus(),i(!1),y.pause()),A.key==="Escape"&&(document.activeElement===te||te!=null&&te.contains(document.activeElement))&&(i(!0),y.play())}return document.addEventListener("keydown",_),()=>{document.removeEventListener("keydown",_)}},[E]),React.createElement("section",{ref:s,className:"Toastify",id:m,onMouseEnter:()=>{r&&(i(!1),y.pause())},onMouseLeave:p,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":e["aria-label"]},a((_,A)=>{let H=A.length?Er({},h):Br(Er({},h),{pointerEvents:"none"});return React.createElement("div",{tabIndex:-1,className:g(_),"data-stacked":r,style:H,key:`c-${_}`},A.map(({content:te,props:ne})=>React.createElement(wt,Br(Er({},ne),{stacked:r,collapseAll:p,isIn:o(ne.toastId,ne.containerId),key:`t-${ne.key}`}),te)))}))}var leafletSrc$1={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var leafletSrc=leafletSrc$1.exports,hasRequiredLeafletSrc;function requireLeafletSrc(){return hasRequiredLeafletSrc||(hasRequiredLeafletSrc=1,function(t,e){(function(r,n){n(e)})(leafletSrc,function(r){var n="1.9.4";function i(l){var d,k,le,ge;for(k=1,le=arguments.length;k<le;k++){ge=arguments[k];for(d in ge)l[d]=ge[d]}return l}var s=Object.create||function(){function l(){}return function(d){return l.prototype=d,new l}}();function a(l,d){var k=Array.prototype.slice;if(l.bind)return l.bind.apply(l,k.call(arguments,1));var le=k.call(arguments,2);return function(){return l.apply(d,le.length?le.concat(k.call(arguments)):arguments)}}var o=0;function c(l){return"_leaflet_id"in l||(l._leaflet_id=++o),l._leaflet_id}function u(l,d,k){var le,ge,Pe,Ke;return Ke=function(){le=!1,ge&&(Pe.apply(k,ge),ge=!1)},Pe=function(){le?ge=arguments:(l.apply(k,arguments),setTimeout(Ke,d),le=!0)},Pe}function h(l,d,k){var le=d[1],ge=d[0],Pe=le-ge;return l===le&&k?l:((l-ge)%Pe+Pe)%Pe+ge}function f(){return!1}function m(l,d){if(d===!1)return l;var k=Math.pow(10,d===void 0?6:d);return Math.round(l*k)/k}function E(l){return l.trim?l.trim():l.replace(/^\s+|\s+$/g,"")}function g(l){return E(l).split(/\s+/)}function p(l,d){Object.prototype.hasOwnProperty.call(l,"options")||(l.options=l.options?s(l.options):{});for(var k in d)l.options[k]=d[k];return l.options}function _(l,d,k){var le=[];for(var ge in l)le.push(encodeURIComponent(k?ge.toUpperCase():ge)+"="+encodeURIComponent(l[ge]));return(!d||d.indexOf("?")===-1?"?":"&")+le.join("&")}var A=/\{ *([\w_ -]+) *\}/g;function H(l,d){return l.replace(A,function(k,le){var ge=d[le];if(ge===void 0)throw new Error("No value provided for variable "+k);return typeof ge=="function"&&(ge=ge(d)),ge})}var te=Array.isArray||function(l){return Object.prototype.toString.call(l)==="[object Array]"};function ne(l,d){for(var k=0;k<l.length;k++)if(l[k]===d)return k;return-1}var j="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function ee(l){return window["webkit"+l]||window["moz"+l]||window["ms"+l]}var x=0;function M(l){var d=+new Date,k=Math.max(0,16-(d-x));return x=d+k,window.setTimeout(l,k)}var T=window.requestAnimationFrame||ee("RequestAnimationFrame")||M,O=window.cancelAnimationFrame||ee("CancelAnimationFrame")||ee("CancelRequestAnimationFrame")||function(l){window.clearTimeout(l)};function R(l,d,k){if(k&&T===M)l.call(d);else return T.call(window,a(l,d))}function Y(l){l&&O.call(window,l)}var q={__proto__:null,extend:i,create:s,bind:a,get lastId(){return o},stamp:c,throttle:u,wrapNum:h,falseFn:f,formatNum:m,trim:E,splitWords:g,setOptions:p,getParamString:_,template:H,isArray:te,indexOf:ne,emptyImageUrl:j,requestFn:T,cancelFn:O,requestAnimFrame:R,cancelAnimFrame:Y};function me(){}me.extend=function(l){var d=function(){p(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},k=d.__super__=this.prototype,le=s(k);le.constructor=d,d.prototype=le;for(var ge in this)Object.prototype.hasOwnProperty.call(this,ge)&&ge!=="prototype"&&ge!=="__super__"&&(d[ge]=this[ge]);return l.statics&&i(d,l.statics),l.includes&&(xe(l.includes),i.apply(null,[le].concat(l.includes))),i(le,l),delete le.statics,delete le.includes,le.options&&(le.options=k.options?s(k.options):{},i(le.options,l.options)),le._initHooks=[],le.callInitHooks=function(){if(!this._initHooksCalled){k.callInitHooks&&k.callInitHooks.call(this),this._initHooksCalled=!0;for(var Pe=0,Ke=le._initHooks.length;Pe<Ke;Pe++)le._initHooks[Pe].call(this)}},d},me.include=function(l){var d=this.prototype.options;return i(this.prototype,l),l.options&&(this.prototype.options=d,this.mergeOptions(l.options)),this},me.mergeOptions=function(l){return i(this.prototype.options,l),this},me.addInitHook=function(l){var d=Array.prototype.slice.call(arguments,1),k=typeof l=="function"?l:function(){this[l].apply(this,d)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(k),this};function xe(l){if(!(typeof L=="undefined"||!L||!L.Mixin)){l=te(l)?l:[l];for(var d=0;d<l.length;d++)l[d]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Ee={on:function(l,d,k){if(typeof l=="object")for(var le in l)this._on(le,l[le],d);else{l=g(l);for(var ge=0,Pe=l.length;ge<Pe;ge++)this._on(l[ge],d,k)}return this},off:function(l,d,k){if(!arguments.length)delete this._events;else if(typeof l=="object")for(var le in l)this._off(le,l[le],d);else{l=g(l);for(var ge=arguments.length===1,Pe=0,Ke=l.length;Pe<Ke;Pe++)ge?this._off(l[Pe]):this._off(l[Pe],d,k)}return this},_on:function(l,d,k,le){if(typeof d!="function"){console.warn("wrong listener type: "+typeof d);return}if(this._listens(l,d,k)===!1){k===this&&(k=void 0);var ge={fn:d,ctx:k};le&&(ge.once=!0),this._events=this._events||{},this._events[l]=this._events[l]||[],this._events[l].push(ge)}},_off:function(l,d,k){var le,ge,Pe;if(this._events&&(le=this._events[l],!!le)){if(arguments.length===1){if(this._firingCount)for(ge=0,Pe=le.length;ge<Pe;ge++)le[ge].fn=f;delete this._events[l];return}if(typeof d!="function"){console.warn("wrong listener type: "+typeof d);return}var Ke=this._listens(l,d,k);if(Ke!==!1){var Bt=le[Ke];this._firingCount&&(Bt.fn=f,this._events[l]=le=le.slice()),le.splice(Ke,1)}}},fire:function(l,d,k){if(!this.listens(l,k))return this;var le=i({},d,{type:l,target:this,sourceTarget:d&&d.sourceTarget||this});if(this._events){var ge=this._events[l];if(ge){this._firingCount=this._firingCount+1||1;for(var Pe=0,Ke=ge.length;Pe<Ke;Pe++){var Bt=ge[Pe],er=Bt.fn;Bt.once&&this.off(l,er,Bt.ctx),er.call(Bt.ctx||this,le)}this._firingCount--}}return k&&this._propagateEvent(le),this},listens:function(l,d,k,le){typeof l!="string"&&console.warn('"string" type argument expected');var ge=d;typeof d!="function"&&(le=!!d,ge=void 0,k=void 0);var Pe=this._events&&this._events[l];if(Pe&&Pe.length&&this._listens(l,ge,k)!==!1)return!0;if(le){for(var Ke in this._eventParents)if(this._eventParents[Ke].listens(l,d,k,le))return!0}return!1},_listens:function(l,d,k){if(!this._events)return!1;var le=this._events[l]||[];if(!d)return!!le.length;k===this&&(k=void 0);for(var ge=0,Pe=le.length;ge<Pe;ge++)if(le[ge].fn===d&&le[ge].ctx===k)return ge;return!1},once:function(l,d,k){if(typeof l=="object")for(var le in l)this._on(le,l[le],d,!0);else{l=g(l);for(var ge=0,Pe=l.length;ge<Pe;ge++)this._on(l[ge],d,k,!0)}return this},addEventParent:function(l){return this._eventParents=this._eventParents||{},this._eventParents[c(l)]=l,this},removeEventParent:function(l){return this._eventParents&&delete this._eventParents[c(l)],this},_propagateEvent:function(l){for(var d in this._eventParents)this._eventParents[d].fire(l.type,i({layer:l.target,propagatedFrom:l.target},l),!0)}};Ee.addEventListener=Ee.on,Ee.removeEventListener=Ee.clearAllEventListeners=Ee.off,Ee.addOneTimeEventListener=Ee.once,Ee.fireEvent=Ee.fire,Ee.hasEventListeners=Ee.listens;var se=me.extend(Ee);function Fe(l,d,k){this.x=k?Math.round(l):l,this.y=k?Math.round(d):d}var ue=Math.trunc||function(l){return l>0?Math.floor(l):Math.ceil(l)};Fe.prototype={clone:function(){return new Fe(this.x,this.y)},add:function(l){return this.clone()._add(ae(l))},_add:function(l){return this.x+=l.x,this.y+=l.y,this},subtract:function(l){return this.clone()._subtract(ae(l))},_subtract:function(l){return this.x-=l.x,this.y-=l.y,this},divideBy:function(l){return this.clone()._divideBy(l)},_divideBy:function(l){return this.x/=l,this.y/=l,this},multiplyBy:function(l){return this.clone()._multiplyBy(l)},_multiplyBy:function(l){return this.x*=l,this.y*=l,this},scaleBy:function(l){return new Fe(this.x*l.x,this.y*l.y)},unscaleBy:function(l){return new Fe(this.x/l.x,this.y/l.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ue(this.x),this.y=ue(this.y),this},distanceTo:function(l){l=ae(l);var d=l.x-this.x,k=l.y-this.y;return Math.sqrt(d*d+k*k)},equals:function(l){return l=ae(l),l.x===this.x&&l.y===this.y},contains:function(l){return l=ae(l),Math.abs(l.x)<=Math.abs(this.x)&&Math.abs(l.y)<=Math.abs(this.y)},toString:function(){return"Point("+m(this.x)+", "+m(this.y)+")"}};function ae(l,d,k){return l instanceof Fe?l:te(l)?new Fe(l[0],l[1]):l==null?l:typeof l=="object"&&"x"in l&&"y"in l?new Fe(l.x,l.y):new Fe(l,d,k)}function _e(l,d){if(l)for(var k=d?[l,d]:l,le=0,ge=k.length;le<ge;le++)this.extend(k[le])}_e.prototype={extend:function(l){var d,k;if(!l)return this;if(l instanceof Fe||typeof l[0]=="number"||"x"in l)d=k=ae(l);else if(l=oe(l),d=l.min,k=l.max,!d||!k)return this;return!this.min&&!this.max?(this.min=d.clone(),this.max=k.clone()):(this.min.x=Math.min(d.x,this.min.x),this.max.x=Math.max(k.x,this.max.x),this.min.y=Math.min(d.y,this.min.y),this.max.y=Math.max(k.y,this.max.y)),this},getCenter:function(l){return ae((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,l)},getBottomLeft:function(){return ae(this.min.x,this.max.y)},getTopRight:function(){return ae(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(l){var d,k;return typeof l[0]=="number"||l instanceof Fe?l=ae(l):l=oe(l),l instanceof _e?(d=l.min,k=l.max):d=k=l,d.x>=this.min.x&&k.x<=this.max.x&&d.y>=this.min.y&&k.y<=this.max.y},intersects:function(l){l=oe(l);var d=this.min,k=this.max,le=l.min,ge=l.max,Pe=ge.x>=d.x&&le.x<=k.x,Ke=ge.y>=d.y&&le.y<=k.y;return Pe&&Ke},overlaps:function(l){l=oe(l);var d=this.min,k=this.max,le=l.min,ge=l.max,Pe=ge.x>d.x&&le.x<k.x,Ke=ge.y>d.y&&le.y<k.y;return Pe&&Ke},isValid:function(){return!!(this.min&&this.max)},pad:function(l){var d=this.min,k=this.max,le=Math.abs(d.x-k.x)*l,ge=Math.abs(d.y-k.y)*l;return oe(ae(d.x-le,d.y-ge),ae(k.x+le,k.y+ge))},equals:function(l){return l?(l=oe(l),this.min.equals(l.getTopLeft())&&this.max.equals(l.getBottomRight())):!1}};function oe(l,d){return!l||l instanceof _e?l:new _e(l,d)}function ie(l,d){if(l)for(var k=d?[l,d]:l,le=0,ge=k.length;le<ge;le++)this.extend(k[le])}ie.prototype={extend:function(l){var d=this._southWest,k=this._northEast,le,ge;if(l instanceof ce)le=l,ge=l;else if(l instanceof ie){if(le=l._southWest,ge=l._northEast,!le||!ge)return this}else return l?this.extend(fe(l)||re(l)):this;return!d&&!k?(this._southWest=new ce(le.lat,le.lng),this._northEast=new ce(ge.lat,ge.lng)):(d.lat=Math.min(le.lat,d.lat),d.lng=Math.min(le.lng,d.lng),k.lat=Math.max(ge.lat,k.lat),k.lng=Math.max(ge.lng,k.lng)),this},pad:function(l){var d=this._southWest,k=this._northEast,le=Math.abs(d.lat-k.lat)*l,ge=Math.abs(d.lng-k.lng)*l;return new ie(new ce(d.lat-le,d.lng-ge),new ce(k.lat+le,k.lng+ge))},getCenter:function(){return new ce((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ce(this.getNorth(),this.getWest())},getSouthEast:function(){return new ce(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(l){typeof l[0]=="number"||l instanceof ce||"lat"in l?l=fe(l):l=re(l);var d=this._southWest,k=this._northEast,le,ge;return l instanceof ie?(le=l.getSouthWest(),ge=l.getNorthEast()):le=ge=l,le.lat>=d.lat&&ge.lat<=k.lat&&le.lng>=d.lng&&ge.lng<=k.lng},intersects:function(l){l=re(l);var d=this._southWest,k=this._northEast,le=l.getSouthWest(),ge=l.getNorthEast(),Pe=ge.lat>=d.lat&&le.lat<=k.lat,Ke=ge.lng>=d.lng&&le.lng<=k.lng;return Pe&&Ke},overlaps:function(l){l=re(l);var d=this._southWest,k=this._northEast,le=l.getSouthWest(),ge=l.getNorthEast(),Pe=ge.lat>d.lat&&le.lat<k.lat,Ke=ge.lng>d.lng&&le.lng<k.lng;return Pe&&Ke},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(l,d){return l?(l=re(l),this._southWest.equals(l.getSouthWest(),d)&&this._northEast.equals(l.getNorthEast(),d)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function re(l,d){return l instanceof ie?l:new ie(l,d)}function ce(l,d,k){if(isNaN(l)||isNaN(d))throw new Error("Invalid LatLng object: ("+l+", "+d+")");this.lat=+l,this.lng=+d,k!==void 0&&(this.alt=+k)}ce.prototype={equals:function(l,d){if(!l)return!1;l=fe(l);var k=Math.max(Math.abs(this.lat-l.lat),Math.abs(this.lng-l.lng));return k<=(d===void 0?1e-9:d)},toString:function(l){return"LatLng("+m(this.lat,l)+", "+m(this.lng,l)+")"},distanceTo:function(l){return ve.distance(this,fe(l))},wrap:function(){return ve.wrapLatLng(this)},toBounds:function(l){var d=180*l/40075017,k=d/Math.cos(Math.PI/180*this.lat);return re([this.lat-d,this.lng-k],[this.lat+d,this.lng+k])},clone:function(){return new ce(this.lat,this.lng,this.alt)}};function fe(l,d,k){return l instanceof ce?l:te(l)&&typeof l[0]!="object"?l.length===3?new ce(l[0],l[1],l[2]):l.length===2?new ce(l[0],l[1]):null:l==null?l:typeof l=="object"&&"lat"in l?new ce(l.lat,"lng"in l?l.lng:l.lon,l.alt):d===void 0?null:new ce(l,d,k)}var pe={latLngToPoint:function(l,d){var k=this.projection.project(l),le=this.scale(d);return this.transformation._transform(k,le)},pointToLatLng:function(l,d){var k=this.scale(d),le=this.transformation.untransform(l,k);return this.projection.unproject(le)},project:function(l){return this.projection.project(l)},unproject:function(l){return this.projection.unproject(l)},scale:function(l){return 256*Math.pow(2,l)},zoom:function(l){return Math.log(l/256)/Math.LN2},getProjectedBounds:function(l){if(this.infinite)return null;var d=this.projection.bounds,k=this.scale(l),le=this.transformation.transform(d.min,k),ge=this.transformation.transform(d.max,k);return new _e(le,ge)},infinite:!1,wrapLatLng:function(l){var d=this.wrapLng?h(l.lng,this.wrapLng,!0):l.lng,k=this.wrapLat?h(l.lat,this.wrapLat,!0):l.lat,le=l.alt;return new ce(k,d,le)},wrapLatLngBounds:function(l){var d=l.getCenter(),k=this.wrapLatLng(d),le=d.lat-k.lat,ge=d.lng-k.lng;if(le===0&&ge===0)return l;var Pe=l.getSouthWest(),Ke=l.getNorthEast(),Bt=new ce(Pe.lat-le,Pe.lng-ge),er=new ce(Ke.lat-le,Ke.lng-ge);return new ie(Bt,er)}},ve=i({},pe,{wrapLng:[-180,180],R:6371e3,distance:function(l,d){var k=Math.PI/180,le=l.lat*k,ge=d.lat*k,Pe=Math.sin((d.lat-l.lat)*k/2),Ke=Math.sin((d.lng-l.lng)*k/2),Bt=Pe*Pe+Math.cos(le)*Math.cos(ge)*Ke*Ke,er=2*Math.atan2(Math.sqrt(Bt),Math.sqrt(1-Bt));return this.R*er}}),Ae=6378137,be={R:Ae,MAX_LATITUDE:85.0511287798,project:function(l){var d=Math.PI/180,k=this.MAX_LATITUDE,le=Math.max(Math.min(k,l.lat),-k),ge=Math.sin(le*d);return new Fe(this.R*l.lng*d,this.R*Math.log((1+ge)/(1-ge))/2)},unproject:function(l){var d=180/Math.PI;return new ce((2*Math.atan(Math.exp(l.y/this.R))-Math.PI/2)*d,l.x*d/this.R)},bounds:function(){var l=Ae*Math.PI;return new _e([-l,-l],[l,l])}()};function je(l,d,k,le){if(te(l)){this._a=l[0],this._b=l[1],this._c=l[2],this._d=l[3];return}this._a=l,this._b=d,this._c=k,this._d=le}je.prototype={transform:function(l,d){return this._transform(l.clone(),d)},_transform:function(l,d){return d=d||1,l.x=d*(this._a*l.x+this._b),l.y=d*(this._c*l.y+this._d),l},untransform:function(l,d){return d=d||1,new Fe((l.x/d-this._b)/this._a,(l.y/d-this._d)/this._c)}};function Se(l,d,k,le){return new je(l,d,k,le)}var Xe=i({},ve,{code:"EPSG:3857",projection:be,transformation:function(){var l=.5/(Math.PI*be.R);return Se(l,.5,-l,.5)}()}),qe=i({},Xe,{code:"EPSG:900913"});function Je(l){return document.createElementNS("http://www.w3.org/2000/svg",l)}function We(l,d){var k="",le,ge,Pe,Ke,Bt,er;for(le=0,Pe=l.length;le<Pe;le++){for(Bt=l[le],ge=0,Ke=Bt.length;ge<Ke;ge++)er=Bt[ge],k+=(ge?"L":"M")+er.x+" "+er.y;k+=d?sr.svg?"z":"x":""}return k||"M0 0"}var Ue=document.documentElement.style,Ce="ActiveXObject"in window,Le=Ce&&!document.addEventListener,Ve="msLaunchUri"in navigator&&!("documentMode"in document),Ge=_r("webkit"),ut=_r("android"),Jt=_r("android 2")||_r("android 3"),Kt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ze=ut&&_r("Google")&&Kt<537&&!("AudioNode"in window),tr=!!window.opera,nr=!Ve&&_r("chrome"),xr=_r("gecko")&&!Ge&&!tr&&!Ce,pr=!nr&&_r("safari"),vr=_r("phantom"),lr="OTransition"in Ue,mr=navigator.platform.indexOf("Win")===0,wr=Ce&&"transition"in Ue,Cr="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Jt,Rr="MozPerspective"in Ue,ar=!window.L_DISABLE_3D&&(wr||Cr||Rr)&&!lr&&!vr,it=typeof orientation!="undefined"||_r("mobile"),ot=it&&Ge,gr=it&&Cr,Tr=!window.PointerEvent&&window.MSPointerEvent,Te=!!(window.PointerEvent||Tr),ze="ontouchstart"in window||!!window.TouchEvent,zt=!window.L_NO_TOUCH&&(ze||Te),ir=it&&tr,cr=it&&xr,or=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ke=function(){var l=!1;try{var d=Object.defineProperty({},"passive",{get:function(){l=!0}});window.addEventListener("testPassiveEventSupport",f,d),window.removeEventListener("testPassiveEventSupport",f,d)}catch(k){}return l}(),Oe=function(){return!!document.createElement("canvas").getContext}(),He=!!(document.createElementNS&&Je("svg").createSVGRect),$e=!!He&&function(){var l=document.createElement("div");return l.innerHTML="<svg/>",(l.firstChild&&l.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),St=!He&&function(){try{var l=document.createElement("div");l.innerHTML='<v:shape adj="1"/>';var d=l.firstChild;return d.style.behavior="url(#default#VML)",d&&typeof d.adj=="object"}catch(k){return!1}}(),$t=navigator.platform.indexOf("Mac")===0,Yt=navigator.platform.indexOf("Linux")===0;function _r(l){return navigator.userAgent.toLowerCase().indexOf(l)>=0}var sr={ie:Ce,ielt9:Le,edge:Ve,webkit:Ge,android:ut,android23:Jt,androidStock:Ze,opera:tr,chrome:nr,gecko:xr,safari:pr,phantom:vr,opera12:lr,win:mr,ie3d:wr,webkit3d:Cr,gecko3d:Rr,any3d:ar,mobile:it,mobileWebkit:ot,mobileWebkit3d:gr,msPointer:Tr,pointer:Te,touch:zt,touchNative:ze,mobileOpera:ir,mobileGecko:cr,retina:or,passiveEvents:ke,canvas:Oe,svg:He,vml:St,inlineSvg:$e,mac:$t,linux:Yt},ye=sr.msPointer?"MSPointerDown":"pointerdown",De=sr.msPointer?"MSPointerMove":"pointermove",Re=sr.msPointer?"MSPointerUp":"pointerup",Ie=sr.msPointer?"MSPointerCancel":"pointercancel",Me={touchstart:ye,touchmove:De,touchend:Re,touchcancel:Ie},Ne={touchstart:br,touchmove:dr,touchend:dr,touchcancel:dr},et={},kt=!1;function Rt(l,d,k){return d==="touchstart"&&Sr(),Ne[d]?(k=Ne[d].bind(this,k),l.addEventListener(Me[d],k,!1),k):(console.warn("wrong event specified:",d),f)}function Tt(l,d,k){if(!Me[d]){console.warn("wrong event specified:",d);return}l.removeEventListener(Me[d],k,!1)}function Ut(l){et[l.pointerId]=l}function ur(l){et[l.pointerId]&&(et[l.pointerId]=l)}function fr(l){delete et[l.pointerId]}function Sr(){kt||(document.addEventListener(ye,Ut,!0),document.addEventListener(De,ur,!0),document.addEventListener(Re,fr,!0),document.addEventListener(Ie,fr,!0),kt=!0)}function dr(l,d){if(d.pointerType!==(d.MSPOINTER_TYPE_MOUSE||"mouse")){d.touches=[];for(var k in et)d.touches.push(et[k]);d.changedTouches=[d],l(d)}}function br(l,d){d.MSPOINTER_TYPE_TOUCH&&d.pointerType===d.MSPOINTER_TYPE_TOUCH&&Kr(d),dr(l,d)}function Pr(l){var d={},k,le;for(le in l)k=l[le],d[le]=k&&k.bind?k.bind(l):k;return l=d,d.type="dblclick",d.detail=2,d.isTrusted=!1,d._simulated=!0,d}var jr=200;function Ur(l,d){l.addEventListener("dblclick",d);var k=0,le;function ge(Pe){if(Pe.detail!==1){le=Pe.detail;return}if(!(Pe.pointerType==="mouse"||Pe.sourceCapabilities&&!Pe.sourceCapabilities.firesTouchEvents)){var Ke=Li(Pe);if(!(Ke.some(function(er){return er instanceof HTMLLabelElement&&er.attributes.for})&&!Ke.some(function(er){return er instanceof HTMLInputElement||er instanceof HTMLSelectElement}))){var Bt=Date.now();Bt-k<=jr?(le++,le===2&&d(Pr(Pe))):le=1,k=Bt}}}return l.addEventListener("click",ge),{dblclick:d,simDblclick:ge}}function Gr(l,d){l.removeEventListener("dblclick",d.dblclick),l.removeEventListener("click",d.simDblclick)}var un=Ln(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),hn=Ln(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),An=hn==="webkitTransition"||hn==="OTransition"?hn+"End":"transitionend";function dn(l){return typeof l=="string"?document.getElementById(l):l}function vn(l,d){var k=l.style[d]||l.currentStyle&&l.currentStyle[d];if((!k||k==="auto")&&document.defaultView){var le=document.defaultView.getComputedStyle(l,null);k=le?le[d]:null}return k==="auto"?null:k}function Or(l,d,k){var le=document.createElement(l);return le.className=d||"",k&&k.appendChild(le),le}function $r(l){var d=l.parentNode;d&&d.removeChild(l)}function Yn(l){for(;l.firstChild;)l.removeChild(l.firstChild)}function Fn(l){var d=l.parentNode;d&&d.lastChild!==l&&d.appendChild(l)}function Hn(l){var d=l.parentNode;d&&d.firstChild!==l&&d.insertBefore(l,d.firstChild)}function Ti(l,d){if(l.classList!==void 0)return l.classList.contains(d);var k=xn(l);return k.length>0&&new RegExp("(^|\\s)"+d+"(\\s|$)").test(k)}function Lr(l,d){if(l.classList!==void 0)for(var k=g(d),le=0,ge=k.length;le<ge;le++)l.classList.add(k[le]);else if(!Ti(l,d)){var Pe=xn(l);Ai(l,(Pe?Pe+" ":"")+d)}}function Xr(l,d){l.classList!==void 0?l.classList.remove(d):Ai(l,E((" "+xn(l)+" ").replace(" "+d+" "," ")))}function Ai(l,d){l.className.baseVal===void 0?l.className=d:l.className.baseVal=d}function xn(l){return l.correspondingElement&&(l=l.correspondingElement),l.className.baseVal===void 0?l.className:l.className.baseVal}function qr(l,d){"opacity"in l.style?l.style.opacity=d:"filter"in l.style&&ri(l,d)}function ri(l,d){var k=!1,le="DXImageTransform.Microsoft.Alpha";try{k=l.filters.item(le)}catch(ge){if(d===1)return}d=Math.round(d*100),k?(k.Enabled=d!==100,k.Opacity=d):l.style.filter+=" progid:"+le+"(opacity="+d+")"}function Ln(l){for(var d=document.documentElement.style,k=0;k<l.length;k++)if(l[k]in d)return l[k];return!1}function In(l,d,k){var le=d||new Fe(0,0);l.style[un]=(sr.ie3d?"translate("+le.x+"px,"+le.y+"px)":"translate3d("+le.x+"px,"+le.y+"px,0)")+(k?" scale("+k+")":"")}function Fr(l,d){l._leaflet_pos=d,sr.any3d?In(l,d):(l.style.left=d.x+"px",l.style.top=d.y+"px")}function yn(l){return l._leaflet_pos||new Fe(0,0)}var Cn,Rn,Ci;if("onselectstart"in document)Cn=function(){kr(window,"selectstart",Kr)},Rn=function(){zr(window,"selectstart",Kr)};else{var zn=Ln(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Cn=function(){if(zn){var l=document.documentElement.style;Ci=l[zn],l[zn]="none"}},Rn=function(){zn&&(document.documentElement.style[zn]=Ci,Ci=void 0)}}function Ri(){kr(window,"dragstart",Kr)}function ki(){zr(window,"dragstart",Kr)}var ni,Ii;function Dn(l){for(;l.tabIndex===-1;)l=l.parentNode;l.style&&(fn(),ni=l,Ii=l.style.outlineStyle,l.style.outlineStyle="none",kr(window,"keydown",fn))}function fn(){ni&&(ni.style.outlineStyle=Ii,ni=void 0,Ii=void 0,zr(window,"keydown",fn))}function Pi(l){do l=l.parentNode;while((!l.offsetWidth||!l.offsetHeight)&&l!==document.body);return l}function ii(l){var d=l.getBoundingClientRect();return{x:d.width/l.offsetWidth||1,y:d.height/l.offsetHeight||1,boundingClientRect:d}}var ts={__proto__:null,TRANSFORM:un,TRANSITION:hn,TRANSITION_END:An,get:dn,getStyle:vn,create:Or,remove:$r,empty:Yn,toFront:Fn,toBack:Hn,hasClass:Ti,addClass:Lr,removeClass:Xr,setClass:Ai,getClass:xn,setOpacity:qr,testProp:Ln,setTransform:In,setPosition:Fr,getPosition:yn,get disableTextSelection(){return Cn},get enableTextSelection(){return Rn},disableImageDrag:Ri,enableImageDrag:ki,preventOutline:Dn,restoreOutline:fn,getSizedParentNode:Pi,getScale:ii};function kr(l,d,k,le){if(d&&typeof d=="object")for(var ge in d)Oi(l,ge,d[ge],k);else{d=g(d);for(var Pe=0,Ke=d.length;Pe<Ke;Pe++)Oi(l,d[Pe],k,le)}return this}var En="_leaflet_events";function zr(l,d,k,le){if(arguments.length===1)rs(l),delete l[En];else if(d&&typeof d=="object")for(var ge in d)Fi(l,ge,d[ge],k);else if(d=g(d),arguments.length===2)rs(l,function(Bt){return ne(d,Bt)!==-1});else for(var Pe=0,Ke=d.length;Pe<Ke;Pe++)Fi(l,d[Pe],k,le);return this}function rs(l,d){for(var k in l[En]){var le=k.split(/\d/)[0];(!d||d(le))&&Fi(l,le,null,null,k)}}var wn={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Oi(l,d,k,le){var ge=d+c(k)+(le?"_"+c(le):"");if(l[En]&&l[En][ge])return this;var Pe=function(Bt){return k.call(le||l,Bt||window.event)},Ke=Pe;!sr.touchNative&&sr.pointer&&d.indexOf("touch")===0?Pe=Rt(l,d,Pe):sr.touch&&d==="dblclick"?Pe=Ur(l,Pe):"addEventListener"in l?d==="touchstart"||d==="touchmove"||d==="wheel"||d==="mousewheel"?l.addEventListener(wn[d]||d,Pe,sr.passiveEvents?{passive:!1}:!1):d==="mouseenter"||d==="mouseleave"?(Pe=function(Bt){Bt=Bt||window.event,Di(l,Bt)&&Ke(Bt)},l.addEventListener(wn[d],Pe,!1)):l.addEventListener(d,Ke,!1):l.attachEvent("on"+d,Pe),l[En]=l[En]||{},l[En][ge]=Pe}function Fi(l,d,k,le,ge){ge=ge||d+c(k)+(le?"_"+c(le):"");var Pe=l[En]&&l[En][ge];if(!Pe)return this;!sr.touchNative&&sr.pointer&&d.indexOf("touch")===0?Tt(l,d,Pe):sr.touch&&d==="dblclick"?Gr(l,Pe):"removeEventListener"in l?l.removeEventListener(wn[d]||d,Pe,!1):l.detachEvent("on"+d,Pe),l[En][ge]=null}function bn(l){return l.stopPropagation?l.stopPropagation():l.originalEvent?l.originalEvent._stopped=!0:l.cancelBubble=!0,this}function Vn(l){return Oi(l,"wheel",bn),this}function $n(l){return kr(l,"mousedown touchstart dblclick contextmenu",bn),l._leaflet_disable_click=!0,this}function Kr(l){return l.preventDefault?l.preventDefault():l.returnValue=!1,this}function pn(l){return Kr(l),bn(l),this}function Li(l){if(l.composedPath)return l.composedPath();for(var d=[],k=l.target;k;)d.push(k),k=k.parentNode;return d}function si(l,d){if(!d)return new Fe(l.clientX,l.clientY);var k=ii(d),le=k.boundingClientRect;return new Fe((l.clientX-le.left)/k.x-d.clientLeft,(l.clientY-le.top)/k.y-d.clientTop)}var Yr=sr.linux&&sr.chrome?window.devicePixelRatio:sr.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function ns(l){return sr.edge?l.wheelDeltaY/2:l.deltaY&&l.deltaMode===0?-l.deltaY/Yr:l.deltaY&&l.deltaMode===1?-l.deltaY*20:l.deltaY&&l.deltaMode===2?-l.deltaY*60:l.deltaX||l.deltaZ?0:l.wheelDelta?(l.wheelDeltaY||l.wheelDelta)/2:l.detail&&Math.abs(l.detail)<32765?-l.detail*20:l.detail?l.detail/-32765*60:0}function Di(l,d){var k=d.relatedTarget;if(!k)return!0;try{for(;k&&k!==l;)k=k.parentNode}catch(le){return!1}return k!==l}var is={__proto__:null,on:kr,off:zr,stopPropagation:bn,disableScrollPropagation:Vn,disableClickPropagation:$n,preventDefault:Kr,stop:pn,getPropagationPath:Li,getMousePosition:si,getWheelDelta:ns,isExternalTarget:Di,addListener:kr,removeListener:zr},Mi=se.extend({run:function(l,d,k,le){this.stop(),this._el=l,this._inProgress=!0,this._duration=k||.25,this._easeOutPower=1/Math.max(le||.5,.2),this._startPos=yn(l),this._offset=d.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=R(this._animate,this),this._step()},_step:function(l){var d=+new Date-this._startTime,k=this._duration*1e3;d<k?this._runFrame(this._easeOut(d/k),l):(this._runFrame(1),this._complete())},_runFrame:function(l,d){var k=this._startPos.add(this._offset.multiplyBy(l));d&&k._round(),Fr(this._el,k),this.fire("step")},_complete:function(){Y(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(l){return 1-Math.pow(1-l,this._easeOutPower)}}),Mr=se.extend({options:{crs:Xe,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(l,d){d=p(this,d),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(l),this._initLayout(),this._onResize=a(this._onResize,this),this._initEvents(),d.maxBounds&&this.setMaxBounds(d.maxBounds),d.zoom!==void 0&&(this._zoom=this._limitZoom(d.zoom)),d.center&&d.zoom!==void 0&&this.setView(fe(d.center),d.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=hn&&sr.any3d&&!sr.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),kr(this._proxy,An,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(l,d,k){if(d=d===void 0?this._zoom:this._limitZoom(d),l=this._limitCenter(fe(l),d,this.options.maxBounds),k=k||{},this._stop(),this._loaded&&!k.reset&&k!==!0){k.animate!==void 0&&(k.zoom=i({animate:k.animate},k.zoom),k.pan=i({animate:k.animate,duration:k.duration},k.pan));var le=this._zoom!==d?this._tryAnimatedZoom&&this._tryAnimatedZoom(l,d,k.zoom):this._tryAnimatedPan(l,k.pan);if(le)return clearTimeout(this._sizeTimer),this}return this._resetView(l,d,k.pan&&k.pan.noMoveStart),this},setZoom:function(l,d){return this._loaded?this.setView(this.getCenter(),l,{zoom:d}):(this._zoom=l,this)},zoomIn:function(l,d){return l=l||(sr.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+l,d)},zoomOut:function(l,d){return l=l||(sr.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-l,d)},setZoomAround:function(l,d,k){var le=this.getZoomScale(d),ge=this.getSize().divideBy(2),Pe=l instanceof Fe?l:this.latLngToContainerPoint(l),Ke=Pe.subtract(ge).multiplyBy(1-1/le),Bt=this.containerPointToLatLng(ge.add(Ke));return this.setView(Bt,d,{zoom:k})},_getBoundsCenterZoom:function(l,d){d=d||{},l=l.getBounds?l.getBounds():re(l);var k=ae(d.paddingTopLeft||d.padding||[0,0]),le=ae(d.paddingBottomRight||d.padding||[0,0]),ge=this.getBoundsZoom(l,!1,k.add(le));if(ge=typeof d.maxZoom=="number"?Math.min(d.maxZoom,ge):ge,ge===1/0)return{center:l.getCenter(),zoom:ge};var Pe=le.subtract(k).divideBy(2),Ke=this.project(l.getSouthWest(),ge),Bt=this.project(l.getNorthEast(),ge),er=this.unproject(Ke.add(Bt).divideBy(2).add(Pe),ge);return{center:er,zoom:ge}},fitBounds:function(l,d){if(l=re(l),!l.isValid())throw new Error("Bounds are not valid.");var k=this._getBoundsCenterZoom(l,d);return this.setView(k.center,k.zoom,d)},fitWorld:function(l){return this.fitBounds([[-90,-180],[90,180]],l)},panTo:function(l,d){return this.setView(l,this._zoom,{pan:d})},panBy:function(l,d){if(l=ae(l).round(),d=d||{},!l.x&&!l.y)return this.fire("moveend");if(d.animate!==!0&&!this.getSize().contains(l))return this._resetView(this.unproject(this.project(this.getCenter()).add(l)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Mi,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),d.noMoveStart||this.fire("movestart"),d.animate!==!1){Lr(this._mapPane,"leaflet-pan-anim");var k=this._getMapPanePos().subtract(l).round();this._panAnim.run(this._mapPane,k,d.duration||.25,d.easeLinearity)}else this._rawPanBy(l),this.fire("move").fire("moveend");return this},flyTo:function(l,d,k){if(k=k||{},k.animate===!1||!sr.any3d)return this.setView(l,d,k);this._stop();var le=this.project(this.getCenter()),ge=this.project(l),Pe=this.getSize(),Ke=this._zoom;l=fe(l),d=d===void 0?Ke:d;var Bt=Math.max(Pe.x,Pe.y),er=Bt*this.getZoomScale(Ke,d),hr=ge.distanceTo(le)||1,Ar=1.42,Ir=Ar*Ar;function Dr(Zr){var xs=Zr?-1:1,hl=Zr?er:Bt,dl=er*er-Bt*Bt+xs*Ir*Ir*hr*hr,fl=2*hl*Ir*hr,Ws=dl/fl,Ya=Math.sqrt(Ws*Ws+1)-Ws,pl=Ya<1e-9?-18:Math.log(Ya);return pl}function an(Zr){return(Math.exp(Zr)-Math.exp(-Zr))/2}function rn(Zr){return(Math.exp(Zr)+Math.exp(-Zr))/2}function Sn(Zr){return an(Zr)/rn(Zr)}var cn=Dr(0);function vi(Zr){return Bt*(rn(cn)/rn(cn+Ar*Zr))}function ol(Zr){return Bt*(rn(cn)*Sn(cn+Ar*Zr)-an(cn))/Ir}function ll(Zr){return 1-Math.pow(1-Zr,1.5)}var cl=Date.now(),Xa=(Dr(1)-cn)/Ar,ul=k.duration?1e3*k.duration:1e3*Xa*.8;function Ka(){var Zr=(Date.now()-cl)/ul,xs=ll(Zr)*Xa;Zr<=1?(this._flyToFrame=R(Ka,this),this._move(this.unproject(le.add(ge.subtract(le).multiplyBy(ol(xs)/hr)),Ke),this.getScaleZoom(Bt/vi(xs),Ke),{flyTo:!0})):this._move(l,d)._moveEnd(!0)}return this._moveStart(!0,k.noMoveStart),Ka.call(this),this},flyToBounds:function(l,d){var k=this._getBoundsCenterZoom(l,d);return this.flyTo(k.center,k.zoom,d)},setMaxBounds:function(l){return l=re(l),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),l.isValid()?(this.options.maxBounds=l,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(l){var d=this.options.minZoom;return this.options.minZoom=l,this._loaded&&d!==l&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(l):this},setMaxZoom:function(l){var d=this.options.maxZoom;return this.options.maxZoom=l,this._loaded&&d!==l&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(l):this},panInsideBounds:function(l,d){this._enforcingBounds=!0;var k=this.getCenter(),le=this._limitCenter(k,this._zoom,re(l));return k.equals(le)||this.panTo(le,d),this._enforcingBounds=!1,this},panInside:function(l,d){d=d||{};var k=ae(d.paddingTopLeft||d.padding||[0,0]),le=ae(d.paddingBottomRight||d.padding||[0,0]),ge=this.project(this.getCenter()),Pe=this.project(l),Ke=this.getPixelBounds(),Bt=oe([Ke.min.add(k),Ke.max.subtract(le)]),er=Bt.getSize();if(!Bt.contains(Pe)){this._enforcingBounds=!0;var hr=Pe.subtract(Bt.getCenter()),Ar=Bt.extend(Pe).getSize().subtract(er);ge.x+=hr.x<0?-Ar.x:Ar.x,ge.y+=hr.y<0?-Ar.y:Ar.y,this.panTo(this.unproject(ge),d),this._enforcingBounds=!1}return this},invalidateSize:function(l){if(!this._loaded)return this;l=i({animate:!1,pan:!0},l===!0?{animate:!0}:l);var d=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var k=this.getSize(),le=d.divideBy(2).round(),ge=k.divideBy(2).round(),Pe=le.subtract(ge);return!Pe.x&&!Pe.y?this:(l.animate&&l.pan?this.panBy(Pe):(l.pan&&this._rawPanBy(Pe),this.fire("move"),l.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(a(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:d,newSize:k}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(l){if(l=this._locateOptions=i({timeout:1e4,watch:!1},l),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var d=a(this._handleGeolocationResponse,this),k=a(this._handleGeolocationError,this);return l.watch?this._locationWatchId=navigator.geolocation.watchPosition(d,k,l):navigator.geolocation.getCurrentPosition(d,k,l),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(l){if(this._container._leaflet_id){var d=l.code,k=l.message||(d===1?"permission denied":d===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:d,message:"Geolocation error: "+k+"."})}},_handleGeolocationResponse:function(l){if(this._container._leaflet_id){var d=l.coords.latitude,k=l.coords.longitude,le=new ce(d,k),ge=le.toBounds(l.coords.accuracy*2),Pe=this._locateOptions;if(Pe.setView){var Ke=this.getBoundsZoom(ge);this.setView(le,Pe.maxZoom?Math.min(Ke,Pe.maxZoom):Ke)}var Bt={latlng:le,bounds:ge,timestamp:l.timestamp};for(var er in l.coords)typeof l.coords[er]=="number"&&(Bt[er]=l.coords[er]);this.fire("locationfound",Bt)}},addHandler:function(l,d){if(!d)return this;var k=this[l]=new d(this);return this._handlers.push(k),this.options[l]&&k.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(d){this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),$r(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Y(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var l;for(l in this._layers)this._layers[l].remove();for(l in this._panes)$r(this._panes[l]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(l,d){var k="leaflet-pane"+(l?" leaflet-"+l.replace("Pane","")+"-pane":""),le=Or("div",k,d||this._mapPane);return l&&(this._panes[l]=le),le},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var l=this.getPixelBounds(),d=this.unproject(l.getBottomLeft()),k=this.unproject(l.getTopRight());return new ie(d,k)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(l,d,k){l=re(l),k=ae(k||[0,0]);var le=this.getZoom()||0,ge=this.getMinZoom(),Pe=this.getMaxZoom(),Ke=l.getNorthWest(),Bt=l.getSouthEast(),er=this.getSize().subtract(k),hr=oe(this.project(Bt,le),this.project(Ke,le)).getSize(),Ar=sr.any3d?this.options.zoomSnap:1,Ir=er.x/hr.x,Dr=er.y/hr.y,an=d?Math.max(Ir,Dr):Math.min(Ir,Dr);return le=this.getScaleZoom(an,le),Ar&&(le=Math.round(le/(Ar/100))*(Ar/100),le=d?Math.ceil(le/Ar)*Ar:Math.floor(le/Ar)*Ar),Math.max(ge,Math.min(Pe,le))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Fe(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(l,d){var k=this._getTopLeftPoint(l,d);return new _e(k,k.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(l){return this.options.crs.getProjectedBounds(l===void 0?this.getZoom():l)},getPane:function(l){return typeof l=="string"?this._panes[l]:l},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(l,d){var k=this.options.crs;return d=d===void 0?this._zoom:d,k.scale(l)/k.scale(d)},getScaleZoom:function(l,d){var k=this.options.crs;d=d===void 0?this._zoom:d;var le=k.zoom(l*k.scale(d));return isNaN(le)?1/0:le},project:function(l,d){return d=d===void 0?this._zoom:d,this.options.crs.latLngToPoint(fe(l),d)},unproject:function(l,d){return d=d===void 0?this._zoom:d,this.options.crs.pointToLatLng(ae(l),d)},layerPointToLatLng:function(l){var d=ae(l).add(this.getPixelOrigin());return this.unproject(d)},latLngToLayerPoint:function(l){var d=this.project(fe(l))._round();return d._subtract(this.getPixelOrigin())},wrapLatLng:function(l){return this.options.crs.wrapLatLng(fe(l))},wrapLatLngBounds:function(l){return this.options.crs.wrapLatLngBounds(re(l))},distance:function(l,d){return this.options.crs.distance(fe(l),fe(d))},containerPointToLayerPoint:function(l){return ae(l).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(l){return ae(l).add(this._getMapPanePos())},containerPointToLatLng:function(l){var d=this.containerPointToLayerPoint(ae(l));return this.layerPointToLatLng(d)},latLngToContainerPoint:function(l){return this.layerPointToContainerPoint(this.latLngToLayerPoint(fe(l)))},mouseEventToContainerPoint:function(l){return si(l,this._container)},mouseEventToLayerPoint:function(l){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(l))},mouseEventToLatLng:function(l){return this.layerPointToLatLng(this.mouseEventToLayerPoint(l))},_initContainer:function(l){var d=this._container=dn(l);if(d){if(d._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");kr(d,"scroll",this._onScroll,this),this._containerId=c(d)},_initLayout:function(){var l=this._container;this._fadeAnimated=this.options.fadeAnimation&&sr.any3d,Lr(l,"leaflet-container"+(sr.touch?" leaflet-touch":"")+(sr.retina?" leaflet-retina":"")+(sr.ielt9?" leaflet-oldie":"")+(sr.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var d=vn(l,"position");d!=="absolute"&&d!=="relative"&&d!=="fixed"&&d!=="sticky"&&(l.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var l=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Fr(this._mapPane,new Fe(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Lr(l.markerPane,"leaflet-zoom-hide"),Lr(l.shadowPane,"leaflet-zoom-hide"))},_resetView:function(l,d,k){Fr(this._mapPane,new Fe(0,0));var le=!this._loaded;this._loaded=!0,d=this._limitZoom(d),this.fire("viewprereset");var ge=this._zoom!==d;this._moveStart(ge,k)._move(l,d)._moveEnd(ge),this.fire("viewreset"),le&&this.fire("load")},_moveStart:function(l,d){return l&&this.fire("zoomstart"),d||this.fire("movestart"),this},_move:function(l,d,k,le){d===void 0&&(d=this._zoom);var ge=this._zoom!==d;return this._zoom=d,this._lastCenter=l,this._pixelOrigin=this._getNewPixelOrigin(l),le?k&&k.pinch&&this.fire("zoom",k):((ge||k&&k.pinch)&&this.fire("zoom",k),this.fire("move",k)),this},_moveEnd:function(l){return l&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Y(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(l){Fr(this._mapPane,this._getMapPanePos().subtract(l))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(l){this._targets={},this._targets[c(this._container)]=this;var d=l?zr:kr;d(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&d(window,"resize",this._onResize,this),sr.any3d&&this.options.transform3DLimit&&(l?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Y(this._resizeRequest),this._resizeRequest=R(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var l=this._getMapPanePos();Math.max(Math.abs(l.x),Math.abs(l.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(l,d){for(var k=[],le,ge=d==="mouseout"||d==="mouseover",Pe=l.target||l.srcElement,Ke=!1;Pe;){if(le=this._targets[c(Pe)],le&&(d==="click"||d==="preclick")&&this._draggableMoved(le)){Ke=!0;break}if(le&&le.listens(d,!0)&&(ge&&!Di(Pe,l)||(k.push(le),ge))||Pe===this._container)break;Pe=Pe.parentNode}return!k.length&&!Ke&&!ge&&this.listens(d,!0)&&(k=[this]),k},_isClickDisabled:function(l){for(;l&&l!==this._container;){if(l._leaflet_disable_click)return!0;l=l.parentNode}},_handleDOMEvent:function(l){var d=l.target||l.srcElement;if(!(!this._loaded||d._leaflet_disable_events||l.type==="click"&&this._isClickDisabled(d))){var k=l.type;k==="mousedown"&&Dn(d),this._fireDOMEvent(l,k)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(l,d,k){if(l.type==="click"){var le=i({},l);le.type="preclick",this._fireDOMEvent(le,le.type,k)}var ge=this._findEventTargets(l,d);if(k){for(var Pe=[],Ke=0;Ke<k.length;Ke++)k[Ke].listens(d,!0)&&Pe.push(k[Ke]);ge=Pe.concat(ge)}if(ge.length){d==="contextmenu"&&Kr(l);var Bt=ge[0],er={originalEvent:l};if(l.type!=="keypress"&&l.type!=="keydown"&&l.type!=="keyup"){var hr=Bt.getLatLng&&(!Bt._radius||Bt._radius<=10);er.containerPoint=hr?this.latLngToContainerPoint(Bt.getLatLng()):this.mouseEventToContainerPoint(l),er.layerPoint=this.containerPointToLayerPoint(er.containerPoint),er.latlng=hr?Bt.getLatLng():this.layerPointToLatLng(er.layerPoint)}for(Ke=0;Ke<ge.length;Ke++)if(ge[Ke].fire(d,er,!0),er.originalEvent._stopped||ge[Ke].options.bubblingMouseEvents===!1&&ne(this._mouseEvents,d)!==-1)return}},_draggableMoved:function(l){return l=l.dragging&&l.dragging.enabled()?l:this,l.dragging&&l.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var l=0,d=this._handlers.length;l<d;l++)this._handlers[l].disable()},whenReady:function(l,d){return this._loaded?l.call(d||this,{target:this}):this.on("load",l,d),this},_getMapPanePos:function(){return yn(this._mapPane)||new Fe(0,0)},_moved:function(){var l=this._getMapPanePos();return l&&!l.equals([0,0])},_getTopLeftPoint:function(l,d){var k=l&&d!==void 0?this._getNewPixelOrigin(l,d):this.getPixelOrigin();return k.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(l,d){var k=this.getSize()._divideBy(2);return this.project(l,d)._subtract(k)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(l,d,k){var le=this._getNewPixelOrigin(k,d);return this.project(l,d)._subtract(le)},_latLngBoundsToNewLayerBounds:function(l,d,k){var le=this._getNewPixelOrigin(k,d);return oe([this.project(l.getSouthWest(),d)._subtract(le),this.project(l.getNorthWest(),d)._subtract(le),this.project(l.getSouthEast(),d)._subtract(le),this.project(l.getNorthEast(),d)._subtract(le)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(l){return this.latLngToLayerPoint(l).subtract(this._getCenterLayerPoint())},_limitCenter:function(l,d,k){if(!k)return l;var le=this.project(l,d),ge=this.getSize().divideBy(2),Pe=new _e(le.subtract(ge),le.add(ge)),Ke=this._getBoundsOffset(Pe,k,d);return Math.abs(Ke.x)<=1&&Math.abs(Ke.y)<=1?l:this.unproject(le.add(Ke),d)},_limitOffset:function(l,d){if(!d)return l;var k=this.getPixelBounds(),le=new _e(k.min.add(l),k.max.add(l));return l.add(this._getBoundsOffset(le,d))},_getBoundsOffset:function(l,d,k){var le=oe(this.project(d.getNorthEast(),k),this.project(d.getSouthWest(),k)),ge=le.min.subtract(l.min),Pe=le.max.subtract(l.max),Ke=this._rebound(ge.x,-Pe.x),Bt=this._rebound(ge.y,-Pe.y);return new Fe(Ke,Bt)},_rebound:function(l,d){return l+d>0?Math.round(l-d)/2:Math.max(0,Math.ceil(l))-Math.max(0,Math.floor(d))},_limitZoom:function(l){var d=this.getMinZoom(),k=this.getMaxZoom(),le=sr.any3d?this.options.zoomSnap:1;return le&&(l=Math.round(l/le)*le),Math.max(d,Math.min(k,l))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Xr(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(l,d){var k=this._getCenterOffset(l)._trunc();return(d&&d.animate)!==!0&&!this.getSize().contains(k)?!1:(this.panBy(k,d),!0)},_createAnimProxy:function(){var l=this._proxy=Or("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(l),this.on("zoomanim",function(d){var k=un,le=this._proxy.style[k];In(this._proxy,this.project(d.center,d.zoom),this.getZoomScale(d.zoom,1)),le===this._proxy.style[k]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){$r(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var l=this.getCenter(),d=this.getZoom();In(this._proxy,this.project(l,d),this.getZoomScale(d,1))},_catchTransitionEnd:function(l){this._animatingZoom&&l.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(l,d,k){if(this._animatingZoom)return!0;if(k=k||{},!this._zoomAnimated||k.animate===!1||this._nothingToAnimate()||Math.abs(d-this._zoom)>this.options.zoomAnimationThreshold)return!1;var le=this.getZoomScale(d),ge=this._getCenterOffset(l)._divideBy(1-1/le);return k.animate!==!0&&!this.getSize().contains(ge)?!1:(R(function(){this._moveStart(!0,k.noMoveStart||!1)._animateZoom(l,d,!0)},this),!0)},_animateZoom:function(l,d,k,le){this._mapPane&&(k&&(this._animatingZoom=!0,this._animateToCenter=l,this._animateToZoom=d,Lr(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:l,zoom:d,noUpdate:le}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(a(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Xr(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function ai(l,d){return new Mr(l,d)}var on=me.extend({options:{position:"topright"},initialize:function(l){p(this,l)},getPosition:function(){return this.options.position},setPosition:function(l){var d=this._map;return d&&d.removeControl(this),this.options.position=l,d&&d.addControl(this),this},getContainer:function(){return this._container},addTo:function(l){this.remove(),this._map=l;var d=this._container=this.onAdd(l),k=this.getPosition(),le=l._controlCorners[k];return Lr(d,"leaflet-control"),k.indexOf("bottom")!==-1?le.insertBefore(d,le.firstChild):le.appendChild(d),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?($r(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(l){this._map&&l&&l.screenX>0&&l.screenY>0&&this._map.getContainer().focus()}}),nn=function(l){return new on(l)};Mr.include({addControl:function(l){return l.addTo(this),this},removeControl:function(l){return l.remove(),this},_initControlPos:function(){var l=this._controlCorners={},d="leaflet-",k=this._controlContainer=Or("div",d+"control-container",this._container);function le(ge,Pe){var Ke=d+ge+" "+d+Pe;l[ge+Pe]=Or("div",Ke,k)}le("top","left"),le("top","right"),le("bottom","left"),le("bottom","right")},_clearControlPos:function(){for(var l in this._controlCorners)$r(this._controlCorners[l]);$r(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Ni=on.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(l,d,k,le){return k<le?-1:le<k?1:0}},initialize:function(l,d,k){p(this,k),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var le in l)this._addLayer(l[le],le);for(le in d)this._addLayer(d[le],le,!0)},onAdd:function(l){this._initLayout(),this._update(),this._map=l,l.on("zoomend",this._checkDisabledLayers,this);for(var d=0;d<this._layers.length;d++)this._layers[d].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(l){return on.prototype.addTo.call(this,l),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var l=0;l<this._layers.length;l++)this._layers[l].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(l,d){return this._addLayer(l,d),this._map?this._update():this},addOverlay:function(l,d){return this._addLayer(l,d,!0),this._map?this._update():this},removeLayer:function(l){l.off("add remove",this._onLayerChange,this);var d=this._getLayer(c(l));return d&&this._layers.splice(this._layers.indexOf(d),1),this._map?this._update():this},expand:function(){Lr(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var l=this._map.getSize().y-(this._container.offsetTop+50);return l<this._section.clientHeight?(Lr(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=l+"px"):Xr(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Xr(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var l="leaflet-control-layers",d=this._container=Or("div",l),k=this.options.collapsed;d.setAttribute("aria-haspopup",!0),$n(d),Vn(d);var le=this._section=Or("section",l+"-list");k&&(this._map.on("click",this.collapse,this),kr(d,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var ge=this._layersLink=Or("a",l+"-toggle",d);ge.href="#",ge.title="Layers",ge.setAttribute("role","button"),kr(ge,{keydown:function(Pe){Pe.keyCode===13&&this._expandSafely()},click:function(Pe){Kr(Pe),this._expandSafely()}},this),k||this.expand(),this._baseLayersList=Or("div",l+"-base",le),this._separator=Or("div",l+"-separator",le),this._overlaysList=Or("div",l+"-overlays",le),d.appendChild(le)},_getLayer:function(l){for(var d=0;d<this._layers.length;d++)if(this._layers[d]&&c(this._layers[d].layer)===l)return this._layers[d]},_addLayer:function(l,d,k){this._map&&l.on("add remove",this._onLayerChange,this),this._layers.push({layer:l,name:d,overlay:k}),this.options.sortLayers&&this._layers.sort(a(function(le,ge){return this.options.sortFunction(le.layer,ge.layer,le.name,ge.name)},this)),this.options.autoZIndex&&l.setZIndex&&(this._lastZIndex++,l.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Yn(this._baseLayersList),Yn(this._overlaysList),this._layerControlInputs=[];var l,d,k,le,ge=0;for(k=0;k<this._layers.length;k++)le=this._layers[k],this._addItem(le),d=d||le.overlay,l=l||!le.overlay,ge+=le.overlay?0:1;return this.options.hideSingleBase&&(l=l&&ge>1,this._baseLayersList.style.display=l?"":"none"),this._separator.style.display=d&&l?"":"none",this},_onLayerChange:function(l){this._handlingClick||this._update();var d=this._getLayer(c(l.target)),k=d.overlay?l.type==="add"?"overlayadd":"overlayremove":l.type==="add"?"baselayerchange":null;k&&this._map.fire(k,d)},_createRadioElement:function(l,d){var k='<input type="radio" class="leaflet-control-layers-selector" name="'+l+'"'+(d?' checked="checked"':"")+"/>",le=document.createElement("div");return le.innerHTML=k,le.firstChild},_addItem:function(l){var d=document.createElement("label"),k=this._map.hasLayer(l.layer),le;l.overlay?(le=document.createElement("input"),le.type="checkbox",le.className="leaflet-control-layers-selector",le.defaultChecked=k):le=this._createRadioElement("leaflet-base-layers_"+c(this),k),this._layerControlInputs.push(le),le.layerId=c(l.layer),kr(le,"click",this._onInputClick,this);var ge=document.createElement("span");ge.innerHTML=" "+l.name;var Pe=document.createElement("span");d.appendChild(Pe),Pe.appendChild(le),Pe.appendChild(ge);var Ke=l.overlay?this._overlaysList:this._baseLayersList;return Ke.appendChild(d),this._checkDisabledLayers(),d},_onInputClick:function(){if(!this._preventClick){var l=this._layerControlInputs,d,k,le=[],ge=[];this._handlingClick=!0;for(var Pe=l.length-1;Pe>=0;Pe--)d=l[Pe],k=this._getLayer(d.layerId).layer,d.checked?le.push(k):d.checked||ge.push(k);for(Pe=0;Pe<ge.length;Pe++)this._map.hasLayer(ge[Pe])&&this._map.removeLayer(ge[Pe]);for(Pe=0;Pe<le.length;Pe++)this._map.hasLayer(le[Pe])||this._map.addLayer(le[Pe]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var l=this._layerControlInputs,d,k,le=this._map.getZoom(),ge=l.length-1;ge>=0;ge--)d=l[ge],k=this._getLayer(d.layerId).layer,d.disabled=k.options.minZoom!==void 0&&le<k.options.minZoom||k.options.maxZoom!==void 0&&le>k.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var l=this._section;this._preventClick=!0,kr(l,"click",Kr),this.expand();var d=this;setTimeout(function(){zr(l,"click",Kr),d._preventClick=!1})}}),Ds=function(l,d,k){return new Ni(l,d,k)},Mn=on.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(l){var d="leaflet-control-zoom",k=Or("div",d+" leaflet-bar"),le=this.options;return this._zoomInButton=this._createButton(le.zoomInText,le.zoomInTitle,d+"-in",k,this._zoomIn),this._zoomOutButton=this._createButton(le.zoomOutText,le.zoomOutTitle,d+"-out",k,this._zoomOut),this._updateDisabled(),l.on("zoomend zoomlevelschange",this._updateDisabled,this),k},onRemove:function(l){l.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(l){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(l.shiftKey?3:1))},_zoomOut:function(l){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(l.shiftKey?3:1))},_createButton:function(l,d,k,le,ge){var Pe=Or("a",k,le);return Pe.innerHTML=l,Pe.href="#",Pe.title=d,Pe.setAttribute("role","button"),Pe.setAttribute("aria-label",d),$n(Pe),kr(Pe,"click",pn),kr(Pe,"click",ge,this),kr(Pe,"click",this._refocusOnMap,this),Pe},_updateDisabled:function(){var l=this._map,d="leaflet-disabled";Xr(this._zoomInButton,d),Xr(this._zoomOutButton,d),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||l._zoom===l.getMinZoom())&&(Lr(this._zoomOutButton,d),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||l._zoom===l.getMaxZoom())&&(Lr(this._zoomInButton,d),this._zoomInButton.setAttribute("aria-disabled","true"))}});Mr.mergeOptions({zoomControl:!0}),Mr.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Mn,this.addControl(this.zoomControl))});var ss=function(l){return new Mn(l)},oi=on.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(l){var d="leaflet-control-scale",k=Or("div",d),le=this.options;return this._addScales(le,d+"-line",k),l.on(le.updateWhenIdle?"moveend":"move",this._update,this),l.whenReady(this._update,this),k},onRemove:function(l){l.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(l,d,k){l.metric&&(this._mScale=Or("div",d,k)),l.imperial&&(this._iScale=Or("div",d,k))},_update:function(){var l=this._map,d=l.getSize().y/2,k=l.distance(l.containerPointToLatLng([0,d]),l.containerPointToLatLng([this.options.maxWidth,d]));this._updateScales(k)},_updateScales:function(l){this.options.metric&&l&&this._updateMetric(l),this.options.imperial&&l&&this._updateImperial(l)},_updateMetric:function(l){var d=this._getRoundNum(l),k=d<1e3?d+" m":d/1e3+" km";this._updateScale(this._mScale,k,d/l)},_updateImperial:function(l){var d=l*3.2808399,k,le,ge;d>5280?(k=d/5280,le=this._getRoundNum(k),this._updateScale(this._iScale,le+" mi",le/k)):(ge=this._getRoundNum(d),this._updateScale(this._iScale,ge+" ft",ge/d))},_updateScale:function(l,d,k){l.style.width=Math.round(this.options.maxWidth*k)+"px",l.innerHTML=d},_getRoundNum:function(l){var d=Math.pow(10,(Math.floor(l)+"").length-1),k=l/d;return k=k>=10?10:k>=5?5:k>=3?3:k>=2?2:1,d*k}}),li=function(l){return new oi(l)},as='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Gn=on.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(sr.inlineSvg?as+" ":"")+"Leaflet</a>"},initialize:function(l){p(this,l),this._attributions={}},onAdd:function(l){l.attributionControl=this,this._container=Or("div","leaflet-control-attribution"),$n(this._container);for(var d in l._layers)l._layers[d].getAttribution&&this.addAttribution(l._layers[d].getAttribution());return this._update(),l.on("layeradd",this._addAttribution,this),this._container},onRemove:function(l){l.off("layeradd",this._addAttribution,this)},_addAttribution:function(l){l.layer.getAttribution&&(this.addAttribution(l.layer.getAttribution()),l.layer.once("remove",function(){this.removeAttribution(l.layer.getAttribution())},this))},setPrefix:function(l){return this.options.prefix=l,this._update(),this},addAttribution:function(l){return l?(this._attributions[l]||(this._attributions[l]=0),this._attributions[l]++,this._update(),this):this},removeAttribution:function(l){return l?(this._attributions[l]&&(this._attributions[l]--,this._update()),this):this},_update:function(){if(this._map){var l=[];for(var d in this._attributions)this._attributions[d]&&l.push(d);var k=[];this.options.prefix&&k.push(this.options.prefix),l.length&&k.push(l.join(", ")),this._container.innerHTML=k.join(' <span aria-hidden="true">|</span> ')}}});Mr.mergeOptions({attributionControl:!0}),Mr.addInitHook(function(){this.options.attributionControl&&new Gn().addTo(this)});var Ms=function(l){return new Gn(l)};on.Layers=Ni,on.Zoom=Mn,on.Scale=oi,on.Attribution=Gn,nn.layers=Ds,nn.zoom=ss,nn.scale=li,nn.attribution=Ms;var mn=me.extend({initialize:function(l){this._map=l},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});mn.addTo=function(l,d){return l.addHandler(d,this),this};var qn={Events:Ee},Bi=sr.touch?"touchstart mousedown":"mousedown",kn=se.extend({options:{clickTolerance:3},initialize:function(l,d,k,le){p(this,le),this._element=l,this._dragStartTarget=d||l,this._preventOutline=k},enable:function(){this._enabled||(kr(this._dragStartTarget,Bi,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(kn._dragging===this&&this.finishDrag(!0),zr(this._dragStartTarget,Bi,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(l){if(this._enabled&&(this._moved=!1,!Ti(this._element,"leaflet-zoom-anim"))){if(l.touches&&l.touches.length!==1){kn._dragging===this&&this.finishDrag();return}if(!(kn._dragging||l.shiftKey||l.which!==1&&l.button!==1&&!l.touches)&&(kn._dragging=this,this._preventOutline&&Dn(this._element),Ri(),Cn(),!this._moving)){this.fire("down");var d=l.touches?l.touches[0]:l,k=Pi(this._element);this._startPoint=new Fe(d.clientX,d.clientY),this._startPos=yn(this._element),this._parentScale=ii(k);var le=l.type==="mousedown";kr(document,le?"mousemove":"touchmove",this._onMove,this),kr(document,le?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(l){if(this._enabled){if(l.touches&&l.touches.length>1){this._moved=!0;return}var d=l.touches&&l.touches.length===1?l.touches[0]:l,k=new Fe(d.clientX,d.clientY)._subtract(this._startPoint);!k.x&&!k.y||Math.abs(k.x)+Math.abs(k.y)<this.options.clickTolerance||(k.x/=this._parentScale.x,k.y/=this._parentScale.y,Kr(l),this._moved||(this.fire("dragstart"),this._moved=!0,Lr(document.body,"leaflet-dragging"),this._lastTarget=l.target||l.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Lr(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(k),this._moving=!0,this._lastEvent=l,this._updatePosition())}},_updatePosition:function(){var l={originalEvent:this._lastEvent};this.fire("predrag",l),Fr(this._element,this._newPos),this.fire("drag",l)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(l){Xr(document.body,"leaflet-dragging"),this._lastTarget&&(Xr(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),zr(document,"mousemove touchmove",this._onMove,this),zr(document,"mouseup touchend touchcancel",this._onUp,this),ki(),Rn();var d=this._moved&&this._moving;this._moving=!1,kn._dragging=!1,d&&this.fire("dragend",{noInertia:l,distance:this._newPos.distanceTo(this._startPos)})}});function ci(l,d,k){var le,ge=[1,4,2,8],Pe,Ke,Bt,er,hr,Ar,Ir,Dr;for(Pe=0,Ar=l.length;Pe<Ar;Pe++)l[Pe]._code=Pn(l[Pe],d);for(Bt=0;Bt<4;Bt++){for(Ir=ge[Bt],le=[],Pe=0,Ar=l.length,Ke=Ar-1;Pe<Ar;Ke=Pe++)er=l[Pe],hr=l[Ke],er._code&Ir?hr._code&Ir||(Dr=Zn(hr,er,Ir,d,k),Dr._code=Pn(Dr,d),le.push(Dr)):(hr._code&Ir&&(Dr=Zn(hr,er,Ir,d,k),Dr._code=Pn(Dr,d),le.push(Dr)),le.push(er));l=le}return l}function ui(l,d){var k,le,ge,Pe,Ke,Bt,er,hr,Ar;if(!l||l.length===0)throw new Error("latlngs not passed");he(l)||(console.warn("latlngs are not flat! Only the first ring will be used"),l=l[0]);var Ir=fe([0,0]),Dr=re(l),an=Dr.getNorthWest().distanceTo(Dr.getSouthWest())*Dr.getNorthEast().distanceTo(Dr.getNorthWest());an<1700&&(Ir=hi(l));var rn=l.length,Sn=[];for(k=0;k<rn;k++){var cn=fe(l[k]);Sn.push(d.project(fe([cn.lat-Ir.lat,cn.lng-Ir.lng])))}for(Bt=er=hr=0,k=0,le=rn-1;k<rn;le=k++)ge=Sn[k],Pe=Sn[le],Ke=ge.y*Pe.x-Pe.y*ge.x,er+=(ge.x+Pe.x)*Ke,hr+=(ge.y+Pe.y)*Ke,Bt+=Ke*3;Bt===0?Ar=Sn[0]:Ar=[er/Bt,hr/Bt];var vi=d.unproject(ae(Ar));return fe([vi.lat+Ir.lat,vi.lng+Ir.lng])}function hi(l){for(var d=0,k=0,le=0,ge=0;ge<l.length;ge++){var Pe=fe(l[ge]);d+=Pe.lat,k+=Pe.lng,le++}return fe([d/le,k/le])}var di={__proto__:null,clipPolygon:ci,polygonCenter:ui,centroid:hi};function Ui(l,d){if(!d||!l.length)return l.slice();var k=d*d;return l=ls(l,k),l=os(l,k),l}function ji(l,d,k){return Math.sqrt(w(l,d,k,!0))}function Nn(l,d,k){return w(l,d,k)}function os(l,d){var k=l.length,le=typeof Uint8Array!="undefined"?Uint8Array:Array,ge=new le(k);ge[0]=ge[k-1]=1,fi(l,ge,d,0,k-1);var Pe,Ke=[];for(Pe=0;Pe<k;Pe++)ge[Pe]&&Ke.push(l[Pe]);return Ke}function fi(l,d,k,le,ge){var Pe=0,Ke,Bt,er;for(Bt=le+1;Bt<=ge-1;Bt++)er=w(l[Bt],l[le],l[ge],!0),er>Pe&&(Ke=Bt,Pe=er);Pe>k&&(d[Ke]=1,fi(l,d,k,le,Ke),fi(l,d,k,Ke,ge))}function ls(l,d){for(var k=[l[0]],le=1,ge=0,Pe=l.length;le<Pe;le++)Xn(l[le],l[ge])>d&&(k.push(l[le]),ge=le);return ge<Pe-1&&k.push(l[Pe-1]),k}var Wi;function sn(l,d,k,le,ge){var Pe=le?Wi:Pn(l,k),Ke=Pn(d,k),Bt,er,hr;for(Wi=Ke;;){if(!(Pe|Ke))return[l,d];if(Pe&Ke)return!1;Bt=Pe||Ke,er=Zn(l,d,Bt,k,ge),hr=Pn(er,k),Bt===Pe?(l=er,Pe=hr):(d=er,Ke=hr)}}function Zn(l,d,k,le,ge){var Pe=d.x-l.x,Ke=d.y-l.y,Bt=le.min,er=le.max,hr,Ar;return k&8?(hr=l.x+Pe*(er.y-l.y)/Ke,Ar=er.y):k&4?(hr=l.x+Pe*(Bt.y-l.y)/Ke,Ar=Bt.y):k&2?(hr=er.x,Ar=l.y+Ke*(er.x-l.x)/Pe):k&1&&(hr=Bt.x,Ar=l.y+Ke*(Bt.x-l.x)/Pe),new Fe(hr,Ar,ge)}function Pn(l,d){var k=0;return l.x<d.min.x?k|=1:l.x>d.max.x&&(k|=2),l.y<d.min.y?k|=4:l.y>d.max.y&&(k|=8),k}function Xn(l,d){var k=d.x-l.x,le=d.y-l.y;return k*k+le*le}function w(l,d,k,le){var ge=d.x,Pe=d.y,Ke=k.x-ge,Bt=k.y-Pe,er=Ke*Ke+Bt*Bt,hr;return er>0&&(hr=((l.x-ge)*Ke+(l.y-Pe)*Bt)/er,hr>1?(ge=k.x,Pe=k.y):hr>0&&(ge+=Ke*hr,Pe+=Bt*hr)),Ke=l.x-ge,Bt=l.y-Pe,le?Ke*Ke+Bt*Bt:new Fe(ge,Pe)}function he(l){return!te(l[0])||typeof l[0][0]!="object"&&typeof l[0][0]!="undefined"}function we(l){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),he(l)}function Be(l,d){var k,le,ge,Pe,Ke,Bt,er,hr;if(!l||l.length===0)throw new Error("latlngs not passed");he(l)||(console.warn("latlngs are not flat! Only the first ring will be used"),l=l[0]);var Ar=fe([0,0]),Ir=re(l),Dr=Ir.getNorthWest().distanceTo(Ir.getSouthWest())*Ir.getNorthEast().distanceTo(Ir.getNorthWest());Dr<1700&&(Ar=hi(l));var an=l.length,rn=[];for(k=0;k<an;k++){var Sn=fe(l[k]);rn.push(d.project(fe([Sn.lat-Ar.lat,Sn.lng-Ar.lng])))}for(k=0,le=0;k<an-1;k++)le+=rn[k].distanceTo(rn[k+1])/2;if(le===0)hr=rn[0];else for(k=0,Pe=0;k<an-1;k++)if(Ke=rn[k],Bt=rn[k+1],ge=Ke.distanceTo(Bt),Pe+=ge,Pe>le){er=(Pe-le)/ge,hr=[Bt.x-er*(Bt.x-Ke.x),Bt.y-er*(Bt.y-Ke.y)];break}var cn=d.unproject(ae(hr));return fe([cn.lat+Ar.lat,cn.lng+Ar.lng])}var Ft={__proto__:null,simplify:Ui,pointToSegmentDistance:ji,closestPointOnSegment:Nn,clipSegment:sn,_getEdgeIntersection:Zn,_getBitCode:Pn,_sqClosestPointOnSegment:w,isFlat:he,_flat:we,polylineCenter:Be},rr={project:function(l){return new Fe(l.lng,l.lat)},unproject:function(l){return new ce(l.y,l.x)},bounds:new _e([-180,-90],[180,90])},yr={R:6378137,R_MINOR:6356752314245179e-9,bounds:new _e([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(l){var d=Math.PI/180,k=this.R,le=l.lat*d,ge=this.R_MINOR/k,Pe=Math.sqrt(1-ge*ge),Ke=Pe*Math.sin(le),Bt=Math.tan(Math.PI/4-le/2)/Math.pow((1-Ke)/(1+Ke),Pe/2);return le=-k*Math.log(Math.max(Bt,1e-10)),new Fe(l.lng*d*k,le)},unproject:function(l){for(var d=180/Math.PI,k=this.R,le=this.R_MINOR/k,ge=Math.sqrt(1-le*le),Pe=Math.exp(-l.y/k),Ke=Math.PI/2-2*Math.atan(Pe),Bt=0,er=.1,hr;Bt<15&&Math.abs(er)>1e-7;Bt++)hr=ge*Math.sin(Ke),hr=Math.pow((1-hr)/(1+hr),ge/2),er=Math.PI/2-2*Math.atan(Pe*hr)-Ke,Ke+=er;return new ce(Ke*d,l.x*d/k)}},Wr={__proto__:null,LonLat:rr,Mercator:yr,SphericalMercator:be},Jr=i({},ve,{code:"EPSG:3395",projection:yr,transformation:function(){var l=.5/(Math.PI*yr.R);return Se(l,.5,-l,.5)}()}),Nr=i({},ve,{code:"EPSG:4326",projection:rr,transformation:Se(1/180,1,-1/180,.5)}),Qr=i({},pe,{projection:rr,transformation:Se(1,0,-1,0),scale:function(l){return Math.pow(2,l)},zoom:function(l){return Math.log(l)/Math.LN2},distance:function(l,d){var k=d.lng-l.lng,le=d.lat-l.lat;return Math.sqrt(k*k+le*le)},infinite:!0});pe.Earth=ve,pe.EPSG3395=Jr,pe.EPSG3857=Xe,pe.EPSG900913=qe,pe.EPSG4326=Nr,pe.Simple=Qr;var Vr=se.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(l){return l.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(l){return l&&l.removeLayer(this),this},getPane:function(l){return this._map.getPane(l?this.options[l]||l:this.options.pane)},addInteractiveTarget:function(l){return this._map._targets[c(l)]=this,this},removeInteractiveTarget:function(l){return delete this._map._targets[c(l)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(l){var d=l.target;if(d.hasLayer(this)){if(this._map=d,this._zoomAnimated=d._zoomAnimated,this.getEvents){var k=this.getEvents();d.on(k,this),this.once("remove",function(){d.off(k,this)},this)}this.onAdd(d),this.fire("add"),d.fire("layeradd",{layer:this})}}});Mr.include({addLayer:function(l){if(!l._layerAdd)throw new Error("The provided object is not a Layer.");var d=c(l);return this._layers[d]?this:(this._layers[d]=l,l._mapToAdd=this,l.beforeAdd&&l.beforeAdd(this),this.whenReady(l._layerAdd,l),this)},removeLayer:function(l){var d=c(l);return this._layers[d]?(this._loaded&&l.onRemove(this),delete this._layers[d],this._loaded&&(this.fire("layerremove",{layer:l}),l.fire("remove")),l._map=l._mapToAdd=null,this):this},hasLayer:function(l){return c(l)in this._layers},eachLayer:function(l,d){for(var k in this._layers)l.call(d,this._layers[k]);return this},_addLayers:function(l){l=l?te(l)?l:[l]:[];for(var d=0,k=l.length;d<k;d++)this.addLayer(l[d])},_addZoomLimit:function(l){(!isNaN(l.options.maxZoom)||!isNaN(l.options.minZoom))&&(this._zoomBoundLayers[c(l)]=l,this._updateZoomLevels())},_removeZoomLimit:function(l){var d=c(l);this._zoomBoundLayers[d]&&(delete this._zoomBoundLayers[d],this._updateZoomLevels())},_updateZoomLevels:function(){var l=1/0,d=-1/0,k=this._getZoomSpan();for(var le in this._zoomBoundLayers){var ge=this._zoomBoundLayers[le].options;l=ge.minZoom===void 0?l:Math.min(l,ge.minZoom),d=ge.maxZoom===void 0?d:Math.max(d,ge.maxZoom)}this._layersMaxZoom=d===-1/0?void 0:d,this._layersMinZoom=l===1/0?void 0:l,k!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var gn=Vr.extend({initialize:function(l,d){p(this,d),this._layers={};var k,le;if(l)for(k=0,le=l.length;k<le;k++)this.addLayer(l[k])},addLayer:function(l){var d=this.getLayerId(l);return this._layers[d]=l,this._map&&this._map.addLayer(l),this},removeLayer:function(l){var d=l in this._layers?l:this.getLayerId(l);return this._map&&this._layers[d]&&this._map.removeLayer(this._layers[d]),delete this._layers[d],this},hasLayer:function(l){var d=typeof l=="number"?l:this.getLayerId(l);return d in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(l){var d=Array.prototype.slice.call(arguments,1),k,le;for(k in this._layers)le=this._layers[k],le[l]&&le[l].apply(le,d);return this},onAdd:function(l){this.eachLayer(l.addLayer,l)},onRemove:function(l){this.eachLayer(l.removeLayer,l)},eachLayer:function(l,d){for(var k in this._layers)l.call(d,this._layers[k]);return this},getLayer:function(l){return this._layers[l]},getLayers:function(){var l=[];return this.eachLayer(l.push,l),l},setZIndex:function(l){return this.invoke("setZIndex",l)},getLayerId:function(l){return c(l)}}),_n=function(l,d){return new gn(l,d)},ln=gn.extend({addLayer:function(l){return this.hasLayer(l)?this:(l.addEventParent(this),gn.prototype.addLayer.call(this,l),this.fire("layeradd",{layer:l}))},removeLayer:function(l){return this.hasLayer(l)?(l in this._layers&&(l=this._layers[l]),l.removeEventParent(this),gn.prototype.removeLayer.call(this,l),this.fire("layerremove",{layer:l})):this},setStyle:function(l){return this.invoke("setStyle",l)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var l=new ie;for(var d in this._layers){var k=this._layers[d];l.extend(k.getBounds?k.getBounds():k.getLatLng())}return l}}),Hi=function(l,d){return new ln(l,d)},pi=me.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(l){p(this,l)},createIcon:function(l){return this._createIcon("icon",l)},createShadow:function(l){return this._createIcon("shadow",l)},_createIcon:function(l,d){var k=this._getIconUrl(l);if(!k){if(l==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var le=this._createImg(k,d&&d.tagName==="IMG"?d:null);return this._setIconStyles(le,l),(this.options.crossOrigin||this.options.crossOrigin==="")&&(le.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),le},_setIconStyles:function(l,d){var k=this.options,le=k[d+"Size"];typeof le=="number"&&(le=[le,le]);var ge=ae(le),Pe=ae(d==="shadow"&&k.shadowAnchor||k.iconAnchor||ge&&ge.divideBy(2,!0));l.className="leaflet-marker-"+d+" "+(k.className||""),Pe&&(l.style.marginLeft=-Pe.x+"px",l.style.marginTop=-Pe.y+"px"),ge&&(l.style.width=ge.x+"px",l.style.height=ge.y+"px")},_createImg:function(l,d){return d=d||document.createElement("img"),d.src=l,d},_getIconUrl:function(l){return sr.retina&&this.options[l+"RetinaUrl"]||this.options[l+"Url"]}});function Ho(l){return new pi(l)}var zi=pi.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(l){return typeof zi.imagePath!="string"&&(zi.imagePath=this._detectIconPath()),(this.options.imagePath||zi.imagePath)+pi.prototype._getIconUrl.call(this,l)},_stripUrl:function(l){var d=function(k,le,ge){var Pe=le.exec(k);return Pe&&Pe[ge]};return l=d(l,/^url\((['"])?(.+)\1\)$/,2),l&&d(l,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var l=Or("div","leaflet-default-icon-path",document.body),d=vn(l,"background-image")||vn(l,"backgroundImage");if(document.body.removeChild(l),d=this._stripUrl(d),d)return d;var k=document.querySelector('link[href$="leaflet.css"]');return k?k.href.substring(0,k.href.length-11-1):""}}),Ra=mn.extend({initialize:function(l){this._marker=l},addHooks:function(){var l=this._marker._icon;this._draggable||(this._draggable=new kn(l,l,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Lr(l,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Xr(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(l){var d=this._marker,k=d._map,le=this._marker.options.autoPanSpeed,ge=this._marker.options.autoPanPadding,Pe=yn(d._icon),Ke=k.getPixelBounds(),Bt=k.getPixelOrigin(),er=oe(Ke.min._subtract(Bt).add(ge),Ke.max._subtract(Bt).subtract(ge));if(!er.contains(Pe)){var hr=ae((Math.max(er.max.x,Pe.x)-er.max.x)/(Ke.max.x-er.max.x)-(Math.min(er.min.x,Pe.x)-er.min.x)/(Ke.min.x-er.min.x),(Math.max(er.max.y,Pe.y)-er.max.y)/(Ke.max.y-er.max.y)-(Math.min(er.min.y,Pe.y)-er.min.y)/(Ke.min.y-er.min.y)).multiplyBy(le);k.panBy(hr,{animate:!1}),this._draggable._newPos._add(hr),this._draggable._startPos._add(hr),Fr(d._icon,this._draggable._newPos),this._onDrag(l),this._panRequest=R(this._adjustPan.bind(this,l))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(l){this._marker.options.autoPan&&(Y(this._panRequest),this._panRequest=R(this._adjustPan.bind(this,l)))},_onDrag:function(l){var d=this._marker,k=d._shadow,le=yn(d._icon),ge=d._map.layerPointToLatLng(le);k&&Fr(k,le),d._latlng=ge,l.latlng=ge,l.oldLatLng=this._oldLatLng,d.fire("move",l).fire("drag",l)},_onDragEnd:function(l){Y(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",l)}}),cs=Vr.extend({options:{icon:new zi,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(l,d){p(this,d),this._latlng=fe(l)},onAdd:function(l){this._zoomAnimated=this._zoomAnimated&&l.options.markerZoomAnimation,this._zoomAnimated&&l.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(l){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&l.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(l){var d=this._latlng;return this._latlng=fe(l),this.update(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},setZIndexOffset:function(l){return this.options.zIndexOffset=l,this.update()},getIcon:function(){return this.options.icon},setIcon:function(l){return this.options.icon=l,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var l=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(l)}return this},_initIcon:function(){var l=this.options,d="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),k=l.icon.createIcon(this._icon),le=!1;k!==this._icon&&(this._icon&&this._removeIcon(),le=!0,l.title&&(k.title=l.title),k.tagName==="IMG"&&(k.alt=l.alt||"")),Lr(k,d),l.keyboard&&(k.tabIndex="0",k.setAttribute("role","button")),this._icon=k,l.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&kr(k,"focus",this._panOnFocus,this);var ge=l.icon.createShadow(this._shadow),Pe=!1;ge!==this._shadow&&(this._removeShadow(),Pe=!0),ge&&(Lr(ge,d),ge.alt=""),this._shadow=ge,l.opacity<1&&this._updateOpacity(),le&&this.getPane().appendChild(this._icon),this._initInteraction(),ge&&Pe&&this.getPane(l.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&zr(this._icon,"focus",this._panOnFocus,this),$r(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&$r(this._shadow),this._shadow=null},_setPos:function(l){this._icon&&Fr(this._icon,l),this._shadow&&Fr(this._shadow,l),this._zIndex=l.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(l){this._icon&&(this._icon.style.zIndex=this._zIndex+l)},_animateZoom:function(l){var d=this._map._latLngToNewLayerPoint(this._latlng,l.zoom,l.center).round();this._setPos(d)},_initInteraction:function(){if(this.options.interactive&&(Lr(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ra)){var l=this.options.draggable;this.dragging&&(l=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ra(this),l&&this.dragging.enable()}},setOpacity:function(l){return this.options.opacity=l,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var l=this.options.opacity;this._icon&&qr(this._icon,l),this._shadow&&qr(this._shadow,l)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var l=this._map;if(l){var d=this.options.icon.options,k=d.iconSize?ae(d.iconSize):ae(0,0),le=d.iconAnchor?ae(d.iconAnchor):ae(0,0);l.panInside(this._latlng,{paddingTopLeft:le,paddingBottomRight:k.subtract(le)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function zo(l,d){return new cs(l,d)}var Kn=Vr.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(l){this._renderer=l.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(l){return p(this,l),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&l&&Object.prototype.hasOwnProperty.call(l,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),us=Kn.extend({options:{fill:!0,radius:10},initialize:function(l,d){p(this,d),this._latlng=fe(l),this._radius=this.options.radius},setLatLng:function(l){var d=this._latlng;return this._latlng=fe(l),this.redraw(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(l){return this.options.radius=this._radius=l,this.redraw()},getRadius:function(){return this._radius},setStyle:function(l){var d=l&&l.radius||this._radius;return Kn.prototype.setStyle.call(this,l),this.setRadius(d),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var l=this._radius,d=this._radiusY||l,k=this._clickTolerance(),le=[l+k,d+k];this._pxBounds=new _e(this._point.subtract(le),this._point.add(le))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(l){return l.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Vo(l,d){return new us(l,d)}var Ns=us.extend({initialize:function(l,d,k){if(typeof d=="number"&&(d=i({},k,{radius:d})),p(this,d),this._latlng=fe(l),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(l){return this._mRadius=l,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var l=[this._radius,this._radiusY||this._radius];return new ie(this._map.layerPointToLatLng(this._point.subtract(l)),this._map.layerPointToLatLng(this._point.add(l)))},setStyle:Kn.prototype.setStyle,_project:function(){var l=this._latlng.lng,d=this._latlng.lat,k=this._map,le=k.options.crs;if(le.distance===ve.distance){var ge=Math.PI/180,Pe=this._mRadius/ve.R/ge,Ke=k.project([d+Pe,l]),Bt=k.project([d-Pe,l]),er=Ke.add(Bt).divideBy(2),hr=k.unproject(er).lat,Ar=Math.acos((Math.cos(Pe*ge)-Math.sin(d*ge)*Math.sin(hr*ge))/(Math.cos(d*ge)*Math.cos(hr*ge)))/ge;(isNaN(Ar)||Ar===0)&&(Ar=Pe/Math.cos(Math.PI/180*d)),this._point=er.subtract(k.getPixelOrigin()),this._radius=isNaN(Ar)?0:er.x-k.project([hr,l-Ar]).x,this._radiusY=er.y-Ke.y}else{var Ir=le.unproject(le.project(this._latlng).subtract([this._mRadius,0]));this._point=k.latLngToLayerPoint(this._latlng),this._radius=this._point.x-k.latLngToLayerPoint(Ir).x}this._updateBounds()}});function $o(l,d,k){return new Ns(l,d,k)}var Bn=Kn.extend({options:{smoothFactor:1,noClip:!1},initialize:function(l,d){p(this,d),this._setLatLngs(l)},getLatLngs:function(){return this._latlngs},setLatLngs:function(l){return this._setLatLngs(l),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(l){for(var d=1/0,k=null,le=w,ge,Pe,Ke=0,Bt=this._parts.length;Ke<Bt;Ke++)for(var er=this._parts[Ke],hr=1,Ar=er.length;hr<Ar;hr++){ge=er[hr-1],Pe=er[hr];var Ir=le(l,ge,Pe,!0);Ir<d&&(d=Ir,k=le(l,ge,Pe))}return k&&(k.distance=Math.sqrt(d)),k},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Be(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(l,d){return d=d||this._defaultShape(),l=fe(l),d.push(l),this._bounds.extend(l),this.redraw()},_setLatLngs:function(l){this._bounds=new ie,this._latlngs=this._convertLatLngs(l)},_defaultShape:function(){return he(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(l){for(var d=[],k=he(l),le=0,ge=l.length;le<ge;le++)k?(d[le]=fe(l[le]),this._bounds.extend(d[le])):d[le]=this._convertLatLngs(l[le]);return d},_project:function(){var l=new _e;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,l),this._bounds.isValid()&&l.isValid()&&(this._rawPxBounds=l,this._updateBounds())},_updateBounds:function(){var l=this._clickTolerance(),d=new Fe(l,l);this._rawPxBounds&&(this._pxBounds=new _e([this._rawPxBounds.min.subtract(d),this._rawPxBounds.max.add(d)]))},_projectLatlngs:function(l,d,k){var le=l[0]instanceof ce,ge=l.length,Pe,Ke;if(le){for(Ke=[],Pe=0;Pe<ge;Pe++)Ke[Pe]=this._map.latLngToLayerPoint(l[Pe]),k.extend(Ke[Pe]);d.push(Ke)}else for(Pe=0;Pe<ge;Pe++)this._projectLatlngs(l[Pe],d,k)},_clipPoints:function(){var l=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(l))){if(this.options.noClip){this._parts=this._rings;return}var d=this._parts,k,le,ge,Pe,Ke,Bt,er;for(k=0,ge=0,Pe=this._rings.length;k<Pe;k++)for(er=this._rings[k],le=0,Ke=er.length;le<Ke-1;le++)Bt=sn(er[le],er[le+1],l,le,!0),Bt&&(d[ge]=d[ge]||[],d[ge].push(Bt[0]),(Bt[1]!==er[le+1]||le===Ke-2)&&(d[ge].push(Bt[1]),ge++))}},_simplifyPoints:function(){for(var l=this._parts,d=this.options.smoothFactor,k=0,le=l.length;k<le;k++)l[k]=Ui(l[k],d)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(l,d){var k,le,ge,Pe,Ke,Bt,er=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(l))return!1;for(k=0,Pe=this._parts.length;k<Pe;k++)for(Bt=this._parts[k],le=0,Ke=Bt.length,ge=Ke-1;le<Ke;ge=le++)if(!(!d&&le===0)&&ji(l,Bt[ge],Bt[le])<=er)return!0;return!1}});function Go(l,d){return new Bn(l,d)}Bn._flat=we;var mi=Bn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ui(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(l){var d=Bn.prototype._convertLatLngs.call(this,l),k=d.length;return k>=2&&d[0]instanceof ce&&d[0].equals(d[k-1])&&d.pop(),d},_setLatLngs:function(l){Bn.prototype._setLatLngs.call(this,l),he(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return he(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var l=this._renderer._bounds,d=this.options.weight,k=new Fe(d,d);if(l=new _e(l.min.subtract(k),l.max.add(k)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(l))){if(this.options.noClip){this._parts=this._rings;return}for(var le=0,ge=this._rings.length,Pe;le<ge;le++)Pe=ci(this._rings[le],l,!0),Pe.length&&this._parts.push(Pe)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(l){var d=!1,k,le,ge,Pe,Ke,Bt,er,hr;if(!this._pxBounds||!this._pxBounds.contains(l))return!1;for(Pe=0,er=this._parts.length;Pe<er;Pe++)for(k=this._parts[Pe],Ke=0,hr=k.length,Bt=hr-1;Ke<hr;Bt=Ke++)le=k[Ke],ge=k[Bt],le.y>l.y!=ge.y>l.y&&l.x<(ge.x-le.x)*(l.y-le.y)/(ge.y-le.y)+le.x&&(d=!d);return d||Bn.prototype._containsPoint.call(this,l,!0)}});function Xo(l,d){return new mi(l,d)}var Un=ln.extend({initialize:function(l,d){p(this,d),this._layers={},l&&this.addData(l)},addData:function(l){var d=te(l)?l:l.features,k,le,ge;if(d){for(k=0,le=d.length;k<le;k++)ge=d[k],(ge.geometries||ge.geometry||ge.features||ge.coordinates)&&this.addData(ge);return this}var Pe=this.options;if(Pe.filter&&!Pe.filter(l))return this;var Ke=hs(l,Pe);return Ke?(Ke.feature=ps(l),Ke.defaultOptions=Ke.options,this.resetStyle(Ke),Pe.onEachFeature&&Pe.onEachFeature(l,Ke),this.addLayer(Ke)):this},resetStyle:function(l){return l===void 0?this.eachLayer(this.resetStyle,this):(l.options=i({},l.defaultOptions),this._setLayerStyle(l,this.options.style),this)},setStyle:function(l){return this.eachLayer(function(d){this._setLayerStyle(d,l)},this)},_setLayerStyle:function(l,d){l.setStyle&&(typeof d=="function"&&(d=d(l.feature)),l.setStyle(d))}});function hs(l,d){var k=l.type==="Feature"?l.geometry:l,le=k?k.coordinates:null,ge=[],Pe=d&&d.pointToLayer,Ke=d&&d.coordsToLatLng||Bs,Bt,er,hr,Ar;if(!le&&!k)return null;switch(k.type){case"Point":return Bt=Ke(le),ka(Pe,l,Bt,d);case"MultiPoint":for(hr=0,Ar=le.length;hr<Ar;hr++)Bt=Ke(le[hr]),ge.push(ka(Pe,l,Bt,d));return new ln(ge);case"LineString":case"MultiLineString":return er=ds(le,k.type==="LineString"?0:1,Ke),new Bn(er,d);case"Polygon":case"MultiPolygon":return er=ds(le,k.type==="Polygon"?1:2,Ke),new mi(er,d);case"GeometryCollection":for(hr=0,Ar=k.geometries.length;hr<Ar;hr++){var Ir=hs({geometry:k.geometries[hr],type:"Feature",properties:l.properties},d);Ir&&ge.push(Ir)}return new ln(ge);case"FeatureCollection":for(hr=0,Ar=k.features.length;hr<Ar;hr++){var Dr=hs(k.features[hr],d);Dr&&ge.push(Dr)}return new ln(ge);default:throw new Error("Invalid GeoJSON object.")}}function ka(l,d,k,le){return l?l(d,k):new cs(k,le&&le.markersInheritOptions&&le)}function Bs(l){return new ce(l[1],l[0],l[2])}function ds(l,d,k){for(var le=[],ge=0,Pe=l.length,Ke;ge<Pe;ge++)Ke=d?ds(l[ge],d-1,k):(k||Bs)(l[ge]),le.push(Ke);return le}function Us(l,d){return l=fe(l),l.alt!==void 0?[m(l.lng,d),m(l.lat,d),m(l.alt,d)]:[m(l.lng,d),m(l.lat,d)]}function fs(l,d,k,le){for(var ge=[],Pe=0,Ke=l.length;Pe<Ke;Pe++)ge.push(d?fs(l[Pe],he(l[Pe])?0:d-1,k,le):Us(l[Pe],le));return!d&&k&&ge.length>0&&ge.push(ge[0].slice()),ge}function gi(l,d){return l.feature?i({},l.feature,{geometry:d}):ps(d)}function ps(l){return l.type==="Feature"||l.type==="FeatureCollection"?l:{type:"Feature",properties:{},geometry:l}}var js={toGeoJSON:function(l){return gi(this,{type:"Point",coordinates:Us(this.getLatLng(),l)})}};cs.include(js),Ns.include(js),us.include(js),Bn.include({toGeoJSON:function(l){var d=!he(this._latlngs),k=fs(this._latlngs,d?1:0,!1,l);return gi(this,{type:(d?"Multi":"")+"LineString",coordinates:k})}}),mi.include({toGeoJSON:function(l){var d=!he(this._latlngs),k=d&&!he(this._latlngs[0]),le=fs(this._latlngs,k?2:d?1:0,!0,l);return d||(le=[le]),gi(this,{type:(k?"Multi":"")+"Polygon",coordinates:le})}}),gn.include({toMultiPoint:function(l){var d=[];return this.eachLayer(function(k){d.push(k.toGeoJSON(l).geometry.coordinates)}),gi(this,{type:"MultiPoint",coordinates:d})},toGeoJSON:function(l){var d=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(d==="MultiPoint")return this.toMultiPoint(l);var k=d==="GeometryCollection",le=[];return this.eachLayer(function(ge){if(ge.toGeoJSON){var Pe=ge.toGeoJSON(l);if(k)le.push(Pe.geometry);else{var Ke=ps(Pe);Ke.type==="FeatureCollection"?le.push.apply(le,Ke.features):le.push(Ke)}}}),k?gi(this,{geometries:le,type:"GeometryCollection"}):{type:"FeatureCollection",features:le}}});function Ia(l,d){return new Un(l,d)}var Ko=Ia,ms=Vr.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(l,d,k){this._url=l,this._bounds=re(d),p(this,k)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Lr(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){$r(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(l){return this.options.opacity=l,this._image&&this._updateOpacity(),this},setStyle:function(l){return l.opacity&&this.setOpacity(l.opacity),this},bringToFront:function(){return this._map&&Fn(this._image),this},bringToBack:function(){return this._map&&Hn(this._image),this},setUrl:function(l){return this._url=l,this._image&&(this._image.src=l),this},setBounds:function(l){return this._bounds=re(l),this._map&&this._reset(),this},getEvents:function(){var l={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(l.zoomanim=this._animateZoom),l},setZIndex:function(l){return this.options.zIndex=l,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var l=this._url.tagName==="IMG",d=this._image=l?this._url:Or("img");if(Lr(d,"leaflet-image-layer"),this._zoomAnimated&&Lr(d,"leaflet-zoom-animated"),this.options.className&&Lr(d,this.options.className),d.onselectstart=f,d.onmousemove=f,d.onload=a(this.fire,this,"load"),d.onerror=a(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),l){this._url=d.src;return}d.src=this._url,d.alt=this.options.alt},_animateZoom:function(l){var d=this._map.getZoomScale(l.zoom),k=this._map._latLngBoundsToNewLayerBounds(this._bounds,l.zoom,l.center).min;In(this._image,k,d)},_reset:function(){var l=this._image,d=new _e(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),k=d.getSize();Fr(l,d.min),l.style.width=k.x+"px",l.style.height=k.y+"px"},_updateOpacity:function(){qr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var l=this.options.errorOverlayUrl;l&&this._url!==l&&(this._url=l,this._image.src=l)},getCenter:function(){return this._bounds.getCenter()}}),Yo=function(l,d,k){return new ms(l,d,k)},Pa=ms.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var l=this._url.tagName==="VIDEO",d=this._image=l?this._url:Or("video");if(Lr(d,"leaflet-image-layer"),this._zoomAnimated&&Lr(d,"leaflet-zoom-animated"),this.options.className&&Lr(d,this.options.className),d.onselectstart=f,d.onmousemove=f,d.onloadeddata=a(this.fire,this,"load"),l){for(var k=d.getElementsByTagName("source"),le=[],ge=0;ge<k.length;ge++)le.push(k[ge].src);this._url=k.length>0?le:[d.src];return}te(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(d.style,"objectFit")&&(d.style.objectFit="fill"),d.autoplay=!!this.options.autoplay,d.loop=!!this.options.loop,d.muted=!!this.options.muted,d.playsInline=!!this.options.playsInline;for(var Pe=0;Pe<this._url.length;Pe++){var Ke=Or("source");Ke.src=this._url[Pe],d.appendChild(Ke)}}});function qo(l,d,k){return new Pa(l,d,k)}var Oa=ms.extend({_initImage:function(){var l=this._image=this._url;Lr(l,"leaflet-image-layer"),this._zoomAnimated&&Lr(l,"leaflet-zoom-animated"),this.options.className&&Lr(l,this.options.className),l.onselectstart=f,l.onmousemove=f}});function Zo(l,d,k){return new Oa(l,d,k)}var On=Vr.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(l,d){l&&(l instanceof ce||te(l))?(this._latlng=fe(l),p(this,d)):(p(this,l),this._source=d),this.options.content&&(this._content=this.options.content)},openOn:function(l){return l=arguments.length?l:this._source._map,l.hasLayer(this)||l.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(l){return this._map?this.close():(arguments.length?this._source=l:l=this._source,this._prepareOpen(),this.openOn(l._map)),this},onAdd:function(l){this._zoomAnimated=l._zoomAnimated,this._container||this._initLayout(),l._fadeAnimated&&qr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),l._fadeAnimated&&qr(this._container,1),this.bringToFront(),this.options.interactive&&(Lr(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(l){l._fadeAnimated?(qr(this._container,0),this._removeTimeout=setTimeout(a($r,void 0,this._container),200)):$r(this._container),this.options.interactive&&(Xr(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(l){return this._latlng=fe(l),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(l){return this._content=l,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var l={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(l.zoomanim=this._animateZoom),l},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Fn(this._container),this},bringToBack:function(){return this._map&&Hn(this._container),this},_prepareOpen:function(l){var d=this._source;if(!d._map)return!1;if(d instanceof ln){d=null;var k=this._source._layers;for(var le in k)if(k[le]._map){d=k[le];break}if(!d)return!1;this._source=d}if(!l)if(d.getCenter)l=d.getCenter();else if(d.getLatLng)l=d.getLatLng();else if(d.getBounds)l=d.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(l),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var l=this._contentNode,d=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof d=="string")l.innerHTML=d;else{for(;l.hasChildNodes();)l.removeChild(l.firstChild);l.appendChild(d)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var l=this._map.latLngToLayerPoint(this._latlng),d=ae(this.options.offset),k=this._getAnchor();this._zoomAnimated?Fr(this._container,l.add(k)):d=d.add(l).add(k);var le=this._containerBottom=-d.y,ge=this._containerLeft=-Math.round(this._containerWidth/2)+d.x;this._container.style.bottom=le+"px",this._container.style.left=ge+"px"}},_getAnchor:function(){return[0,0]}});Mr.include({_initOverlay:function(l,d,k,le){var ge=d;return ge instanceof l||(ge=new l(le).setContent(d)),k&&ge.setLatLng(k),ge}}),Vr.include({_initOverlay:function(l,d,k,le){var ge=k;return ge instanceof l?(p(ge,le),ge._source=this):(ge=d&&!le?d:new l(le,this),ge.setContent(k)),ge}});var gs=On.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(l){return l=arguments.length?l:this._source._map,!l.hasLayer(this)&&l._popup&&l._popup.options.autoClose&&l.removeLayer(l._popup),l._popup=this,On.prototype.openOn.call(this,l)},onAdd:function(l){On.prototype.onAdd.call(this,l),l.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Kn||this._source.on("preclick",bn))},onRemove:function(l){On.prototype.onRemove.call(this,l),l.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Kn||this._source.off("preclick",bn))},getEvents:function(){var l=On.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(l.preclick=this.close),this.options.keepInView&&(l.moveend=this._adjustPan),l},_initLayout:function(){var l="leaflet-popup",d=this._container=Or("div",l+" "+(this.options.className||"")+" leaflet-zoom-animated"),k=this._wrapper=Or("div",l+"-content-wrapper",d);if(this._contentNode=Or("div",l+"-content",k),$n(d),Vn(this._contentNode),kr(d,"contextmenu",bn),this._tipContainer=Or("div",l+"-tip-container",d),this._tip=Or("div",l+"-tip",this._tipContainer),this.options.closeButton){var le=this._closeButton=Or("a",l+"-close-button",d);le.setAttribute("role","button"),le.setAttribute("aria-label","Close popup"),le.href="#close",le.innerHTML='<span aria-hidden="true">&#215;</span>',kr(le,"click",function(ge){Kr(ge),this.close()},this)}},_updateLayout:function(){var l=this._contentNode,d=l.style;d.width="",d.whiteSpace="nowrap";var k=l.offsetWidth;k=Math.min(k,this.options.maxWidth),k=Math.max(k,this.options.minWidth),d.width=k+1+"px",d.whiteSpace="",d.height="";var le=l.offsetHeight,ge=this.options.maxHeight,Pe="leaflet-popup-scrolled";ge&&le>ge?(d.height=ge+"px",Lr(l,Pe)):Xr(l,Pe),this._containerWidth=this._container.offsetWidth},_animateZoom:function(l){var d=this._map._latLngToNewLayerPoint(this._latlng,l.zoom,l.center),k=this._getAnchor();Fr(this._container,d.add(k))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var l=this._map,d=parseInt(vn(this._container,"marginBottom"),10)||0,k=this._container.offsetHeight+d,le=this._containerWidth,ge=new Fe(this._containerLeft,-k-this._containerBottom);ge._add(yn(this._container));var Pe=l.layerPointToContainerPoint(ge),Ke=ae(this.options.autoPanPadding),Bt=ae(this.options.autoPanPaddingTopLeft||Ke),er=ae(this.options.autoPanPaddingBottomRight||Ke),hr=l.getSize(),Ar=0,Ir=0;Pe.x+le+er.x>hr.x&&(Ar=Pe.x+le-hr.x+er.x),Pe.x-Ar-Bt.x<0&&(Ar=Pe.x-Bt.x),Pe.y+k+er.y>hr.y&&(Ir=Pe.y+k-hr.y+er.y),Pe.y-Ir-Bt.y<0&&(Ir=Pe.y-Bt.y),(Ar||Ir)&&(this.options.keepInView&&(this._autopanning=!0),l.fire("autopanstart").panBy([Ar,Ir]))}},_getAnchor:function(){return ae(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Jo=function(l,d){return new gs(l,d)};Mr.mergeOptions({closePopupOnClick:!0}),Mr.include({openPopup:function(l,d,k){return this._initOverlay(gs,l,d,k).openOn(this),this},closePopup:function(l){return l=arguments.length?l:this._popup,l&&l.close(),this}}),Vr.include({bindPopup:function(l,d){return this._popup=this._initOverlay(gs,this._popup,l,d),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(l){return this._popup&&(this instanceof ln||(this._popup._source=this),this._popup._prepareOpen(l||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(l){return this._popup&&this._popup.setContent(l),this},getPopup:function(){return this._popup},_openPopup:function(l){if(!(!this._popup||!this._map)){pn(l);var d=l.layer||l.target;if(this._popup._source===d&&!(d instanceof Kn)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(l.latlng);return}this._popup._source=d,this.openPopup(l.latlng)}},_movePopup:function(l){this._popup.setLatLng(l.latlng)},_onKeyPress:function(l){l.originalEvent.keyCode===13&&this._openPopup(l)}});var _s=On.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(l){On.prototype.onAdd.call(this,l),this.setOpacity(this.options.opacity),l.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(l){On.prototype.onRemove.call(this,l),l.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var l=On.prototype.getEvents.call(this);return this.options.permanent||(l.preclick=this.close),l},_initLayout:function(){var l="leaflet-tooltip",d=l+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Or("div",d),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+c(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(l){var d,k,le=this._map,ge=this._container,Pe=le.latLngToContainerPoint(le.getCenter()),Ke=le.layerPointToContainerPoint(l),Bt=this.options.direction,er=ge.offsetWidth,hr=ge.offsetHeight,Ar=ae(this.options.offset),Ir=this._getAnchor();Bt==="top"?(d=er/2,k=hr):Bt==="bottom"?(d=er/2,k=0):Bt==="center"?(d=er/2,k=hr/2):Bt==="right"?(d=0,k=hr/2):Bt==="left"?(d=er,k=hr/2):Ke.x<Pe.x?(Bt="right",d=0,k=hr/2):(Bt="left",d=er+(Ar.x+Ir.x)*2,k=hr/2),l=l.subtract(ae(d,k,!0)).add(Ar).add(Ir),Xr(ge,"leaflet-tooltip-right"),Xr(ge,"leaflet-tooltip-left"),Xr(ge,"leaflet-tooltip-top"),Xr(ge,"leaflet-tooltip-bottom"),Lr(ge,"leaflet-tooltip-"+Bt),Fr(ge,l)},_updatePosition:function(){var l=this._map.latLngToLayerPoint(this._latlng);this._setPosition(l)},setOpacity:function(l){this.options.opacity=l,this._container&&qr(this._container,l)},_animateZoom:function(l){var d=this._map._latLngToNewLayerPoint(this._latlng,l.zoom,l.center);this._setPosition(d)},_getAnchor:function(){return ae(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Qo=function(l,d){return new _s(l,d)};Mr.include({openTooltip:function(l,d,k){return this._initOverlay(_s,l,d,k).openOn(this),this},closeTooltip:function(l){return l.close(),this}}),Vr.include({bindTooltip:function(l,d){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(_s,this._tooltip,l,d),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(l){if(!(!l&&this._tooltipHandlersAdded)){var d=l?"off":"on",k={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?k.add=this._openTooltip:(k.mouseover=this._openTooltip,k.mouseout=this.closeTooltip,k.click=this._openTooltip,this._map?this._addFocusListeners():k.add=this._addFocusListeners),this._tooltip.options.sticky&&(k.mousemove=this._moveTooltip),this[d](k),this._tooltipHandlersAdded=!l}},openTooltip:function(l){return this._tooltip&&(this instanceof ln||(this._tooltip._source=this),this._tooltip._prepareOpen(l)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(l){return this._tooltip&&this._tooltip.setContent(l),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(l){var d=typeof l.getElement=="function"&&l.getElement();d&&(kr(d,"focus",function(){this._tooltip._source=l,this.openTooltip()},this),kr(d,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(l){var d=typeof l.getElement=="function"&&l.getElement();d&&d.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(l){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var d=this;this._map.once("moveend",function(){d._openOnceFlag=!1,d._openTooltip(l)});return}this._tooltip._source=l.layer||l.target,this.openTooltip(this._tooltip.options.sticky?l.latlng:void 0)}},_moveTooltip:function(l){var d=l.latlng,k,le;this._tooltip.options.sticky&&l.originalEvent&&(k=this._map.mouseEventToContainerPoint(l.originalEvent),le=this._map.containerPointToLayerPoint(k),d=this._map.layerPointToLatLng(le)),this._tooltip.setLatLng(d)}});var Fa=pi.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(l){var d=l&&l.tagName==="DIV"?l:document.createElement("div"),k=this.options;if(k.html instanceof Element?(Yn(d),d.appendChild(k.html)):d.innerHTML=k.html!==!1?k.html:"",k.bgPos){var le=ae(k.bgPos);d.style.backgroundPosition=-le.x+"px "+-le.y+"px"}return this._setIconStyles(d,"icon"),d},createShadow:function(){return null}});function el(l){return new Fa(l)}pi.Default=zi;var Vi=Vr.extend({options:{tileSize:256,opacity:1,updateWhenIdle:sr.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(l){p(this,l)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(l){l._addZoomLimit(this)},onRemove:function(l){this._removeAllTiles(),$r(this._container),l._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Fn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Hn(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(l){return this.options.opacity=l,this._updateOpacity(),this},setZIndex:function(l){return this.options.zIndex=l,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var l=this._clampZoom(this._map.getZoom());l!==this._tileZoom&&(this._tileZoom=l,this._updateLevels()),this._update()}return this},getEvents:function(){var l={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=u(this._onMoveEnd,this.options.updateInterval,this)),l.move=this._onMove),this._zoomAnimated&&(l.zoomanim=this._animateZoom),l},createTile:function(){return document.createElement("div")},getTileSize:function(){var l=this.options.tileSize;return l instanceof Fe?l:new Fe(l,l)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(l){for(var d=this.getPane().children,k=-l(-1/0,1/0),le=0,ge=d.length,Pe;le<ge;le++)Pe=d[le].style.zIndex,d[le]!==this._container&&Pe&&(k=l(k,+Pe));isFinite(k)&&(this.options.zIndex=k+l(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!sr.ielt9){qr(this._container,this.options.opacity);var l=+new Date,d=!1,k=!1;for(var le in this._tiles){var ge=this._tiles[le];if(!(!ge.current||!ge.loaded)){var Pe=Math.min(1,(l-ge.loaded)/200);qr(ge.el,Pe),Pe<1?d=!0:(ge.active?k=!0:this._onOpaqueTile(ge),ge.active=!0)}}k&&!this._noPrune&&this._pruneTiles(),d&&(Y(this._fadeFrame),this._fadeFrame=R(this._updateOpacity,this))}},_onOpaqueTile:f,_initContainer:function(){this._container||(this._container=Or("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var l=this._tileZoom,d=this.options.maxZoom;if(l!==void 0){for(var k in this._levels)k=Number(k),this._levels[k].el.children.length||k===l?(this._levels[k].el.style.zIndex=d-Math.abs(l-k),this._onUpdateLevel(k)):($r(this._levels[k].el),this._removeTilesAtZoom(k),this._onRemoveLevel(k),delete this._levels[k]);var le=this._levels[l],ge=this._map;return le||(le=this._levels[l]={},le.el=Or("div","leaflet-tile-container leaflet-zoom-animated",this._container),le.el.style.zIndex=d,le.origin=ge.project(ge.unproject(ge.getPixelOrigin()),l).round(),le.zoom=l,this._setZoomTransform(le,ge.getCenter(),ge.getZoom()),f(le.el.offsetWidth),this._onCreateLevel(le)),this._level=le,le}},_onUpdateLevel:f,_onRemoveLevel:f,_onCreateLevel:f,_pruneTiles:function(){if(this._map){var l,d,k=this._map.getZoom();if(k>this.options.maxZoom||k<this.options.minZoom){this._removeAllTiles();return}for(l in this._tiles)d=this._tiles[l],d.retain=d.current;for(l in this._tiles)if(d=this._tiles[l],d.current&&!d.active){var le=d.coords;this._retainParent(le.x,le.y,le.z,le.z-5)||this._retainChildren(le.x,le.y,le.z,le.z+2)}for(l in this._tiles)this._tiles[l].retain||this._removeTile(l)}},_removeTilesAtZoom:function(l){for(var d in this._tiles)this._tiles[d].coords.z===l&&this._removeTile(d)},_removeAllTiles:function(){for(var l in this._tiles)this._removeTile(l)},_invalidateAll:function(){for(var l in this._levels)$r(this._levels[l].el),this._onRemoveLevel(Number(l)),delete this._levels[l];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(l,d,k,le){var ge=Math.floor(l/2),Pe=Math.floor(d/2),Ke=k-1,Bt=new Fe(+ge,+Pe);Bt.z=+Ke;var er=this._tileCoordsToKey(Bt),hr=this._tiles[er];return hr&&hr.active?(hr.retain=!0,!0):(hr&&hr.loaded&&(hr.retain=!0),Ke>le?this._retainParent(ge,Pe,Ke,le):!1)},_retainChildren:function(l,d,k,le){for(var ge=2*l;ge<2*l+2;ge++)for(var Pe=2*d;Pe<2*d+2;Pe++){var Ke=new Fe(ge,Pe);Ke.z=k+1;var Bt=this._tileCoordsToKey(Ke),er=this._tiles[Bt];if(er&&er.active){er.retain=!0;continue}else er&&er.loaded&&(er.retain=!0);k+1<le&&this._retainChildren(ge,Pe,k+1,le)}},_resetView:function(l){var d=l&&(l.pinch||l.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),d,d)},_animateZoom:function(l){this._setView(l.center,l.zoom,!0,l.noUpdate)},_clampZoom:function(l){var d=this.options;return d.minNativeZoom!==void 0&&l<d.minNativeZoom?d.minNativeZoom:d.maxNativeZoom!==void 0&&d.maxNativeZoom<l?d.maxNativeZoom:l},_setView:function(l,d,k,le){var ge=Math.round(d);this.options.maxZoom!==void 0&&ge>this.options.maxZoom||this.options.minZoom!==void 0&&ge<this.options.minZoom?ge=void 0:ge=this._clampZoom(ge);var Pe=this.options.updateWhenZooming&&ge!==this._tileZoom;(!le||Pe)&&(this._tileZoom=ge,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),ge!==void 0&&this._update(l),k||this._pruneTiles(),this._noPrune=!!k),this._setZoomTransforms(l,d)},_setZoomTransforms:function(l,d){for(var k in this._levels)this._setZoomTransform(this._levels[k],l,d)},_setZoomTransform:function(l,d,k){var le=this._map.getZoomScale(k,l.zoom),ge=l.origin.multiplyBy(le).subtract(this._map._getNewPixelOrigin(d,k)).round();sr.any3d?In(l.el,ge,le):Fr(l.el,ge)},_resetGrid:function(){var l=this._map,d=l.options.crs,k=this._tileSize=this.getTileSize(),le=this._tileZoom,ge=this._map.getPixelWorldBounds(this._tileZoom);ge&&(this._globalTileRange=this._pxBoundsToTileRange(ge)),this._wrapX=d.wrapLng&&!this.options.noWrap&&[Math.floor(l.project([0,d.wrapLng[0]],le).x/k.x),Math.ceil(l.project([0,d.wrapLng[1]],le).x/k.y)],this._wrapY=d.wrapLat&&!this.options.noWrap&&[Math.floor(l.project([d.wrapLat[0],0],le).y/k.x),Math.ceil(l.project([d.wrapLat[1],0],le).y/k.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(l){var d=this._map,k=d._animatingZoom?Math.max(d._animateToZoom,d.getZoom()):d.getZoom(),le=d.getZoomScale(k,this._tileZoom),ge=d.project(l,this._tileZoom).floor(),Pe=d.getSize().divideBy(le*2);return new _e(ge.subtract(Pe),ge.add(Pe))},_update:function(l){var d=this._map;if(d){var k=this._clampZoom(d.getZoom());if(l===void 0&&(l=d.getCenter()),this._tileZoom!==void 0){var le=this._getTiledPixelBounds(l),ge=this._pxBoundsToTileRange(le),Pe=ge.getCenter(),Ke=[],Bt=this.options.keepBuffer,er=new _e(ge.getBottomLeft().subtract([Bt,-Bt]),ge.getTopRight().add([Bt,-Bt]));if(!(isFinite(ge.min.x)&&isFinite(ge.min.y)&&isFinite(ge.max.x)&&isFinite(ge.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var hr in this._tiles){var Ar=this._tiles[hr].coords;(Ar.z!==this._tileZoom||!er.contains(new Fe(Ar.x,Ar.y)))&&(this._tiles[hr].current=!1)}if(Math.abs(k-this._tileZoom)>1){this._setView(l,k);return}for(var Ir=ge.min.y;Ir<=ge.max.y;Ir++)for(var Dr=ge.min.x;Dr<=ge.max.x;Dr++){var an=new Fe(Dr,Ir);if(an.z=this._tileZoom,!!this._isValidTile(an)){var rn=this._tiles[this._tileCoordsToKey(an)];rn?rn.current=!0:Ke.push(an)}}if(Ke.sort(function(cn,vi){return cn.distanceTo(Pe)-vi.distanceTo(Pe)}),Ke.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Sn=document.createDocumentFragment();for(Dr=0;Dr<Ke.length;Dr++)this._addTile(Ke[Dr],Sn);this._level.el.appendChild(Sn)}}}},_isValidTile:function(l){var d=this._map.options.crs;if(!d.infinite){var k=this._globalTileRange;if(!d.wrapLng&&(l.x<k.min.x||l.x>k.max.x)||!d.wrapLat&&(l.y<k.min.y||l.y>k.max.y))return!1}if(!this.options.bounds)return!0;var le=this._tileCoordsToBounds(l);return re(this.options.bounds).overlaps(le)},_keyToBounds:function(l){return this._tileCoordsToBounds(this._keyToTileCoords(l))},_tileCoordsToNwSe:function(l){var d=this._map,k=this.getTileSize(),le=l.scaleBy(k),ge=le.add(k),Pe=d.unproject(le,l.z),Ke=d.unproject(ge,l.z);return[Pe,Ke]},_tileCoordsToBounds:function(l){var d=this._tileCoordsToNwSe(l),k=new ie(d[0],d[1]);return this.options.noWrap||(k=this._map.wrapLatLngBounds(k)),k},_tileCoordsToKey:function(l){return l.x+":"+l.y+":"+l.z},_keyToTileCoords:function(l){var d=l.split(":"),k=new Fe(+d[0],+d[1]);return k.z=+d[2],k},_removeTile:function(l){var d=this._tiles[l];d&&($r(d.el),delete this._tiles[l],this.fire("tileunload",{tile:d.el,coords:this._keyToTileCoords(l)}))},_initTile:function(l){Lr(l,"leaflet-tile");var d=this.getTileSize();l.style.width=d.x+"px",l.style.height=d.y+"px",l.onselectstart=f,l.onmousemove=f,sr.ielt9&&this.options.opacity<1&&qr(l,this.options.opacity)},_addTile:function(l,d){var k=this._getTilePos(l),le=this._tileCoordsToKey(l),ge=this.createTile(this._wrapCoords(l),a(this._tileReady,this,l));this._initTile(ge),this.createTile.length<2&&R(a(this._tileReady,this,l,null,ge)),Fr(ge,k),this._tiles[le]={el:ge,coords:l,current:!0},d.appendChild(ge),this.fire("tileloadstart",{tile:ge,coords:l})},_tileReady:function(l,d,k){d&&this.fire("tileerror",{error:d,tile:k,coords:l});var le=this._tileCoordsToKey(l);k=this._tiles[le],k&&(k.loaded=+new Date,this._map._fadeAnimated?(qr(k.el,0),Y(this._fadeFrame),this._fadeFrame=R(this._updateOpacity,this)):(k.active=!0,this._pruneTiles()),d||(Lr(k.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:k.el,coords:l})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),sr.ielt9||!this._map._fadeAnimated?R(this._pruneTiles,this):setTimeout(a(this._pruneTiles,this),250)))},_getTilePos:function(l){return l.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(l){var d=new Fe(this._wrapX?h(l.x,this._wrapX):l.x,this._wrapY?h(l.y,this._wrapY):l.y);return d.z=l.z,d},_pxBoundsToTileRange:function(l){var d=this.getTileSize();return new _e(l.min.unscaleBy(d).floor(),l.max.unscaleBy(d).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var l in this._tiles)if(!this._tiles[l].loaded)return!1;return!0}});function tl(l){return new Vi(l)}var _i=Vi.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(l,d){this._url=l,d=p(this,d),d.detectRetina&&sr.retina&&d.maxZoom>0?(d.tileSize=Math.floor(d.tileSize/2),d.zoomReverse?(d.zoomOffset--,d.minZoom=Math.min(d.maxZoom,d.minZoom+1)):(d.zoomOffset++,d.maxZoom=Math.max(d.minZoom,d.maxZoom-1)),d.minZoom=Math.max(0,d.minZoom)):d.zoomReverse?d.minZoom=Math.min(d.maxZoom,d.minZoom):d.maxZoom=Math.max(d.minZoom,d.maxZoom),typeof d.subdomains=="string"&&(d.subdomains=d.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(l,d){return this._url===l&&d===void 0&&(d=!0),this._url=l,d||this.redraw(),this},createTile:function(l,d){var k=document.createElement("img");return kr(k,"load",a(this._tileOnLoad,this,d,k)),kr(k,"error",a(this._tileOnError,this,d,k)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(k.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(k.referrerPolicy=this.options.referrerPolicy),k.alt="",k.src=this.getTileUrl(l),k},getTileUrl:function(l){var d={r:sr.retina?"@2x":"",s:this._getSubdomain(l),x:l.x,y:l.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var k=this._globalTileRange.max.y-l.y;this.options.tms&&(d.y=k),d["-y"]=k}return H(this._url,i(d,this.options))},_tileOnLoad:function(l,d){sr.ielt9?setTimeout(a(l,this,null,d),0):l(null,d)},_tileOnError:function(l,d,k){var le=this.options.errorTileUrl;le&&d.getAttribute("src")!==le&&(d.src=le),l(k,d)},_onTileRemove:function(l){l.tile.onload=null},_getZoomForUrl:function(){var l=this._tileZoom,d=this.options.maxZoom,k=this.options.zoomReverse,le=this.options.zoomOffset;return k&&(l=d-l),l+le},_getSubdomain:function(l){var d=Math.abs(l.x+l.y)%this.options.subdomains.length;return this.options.subdomains[d]},_abortLoading:function(){var l,d;for(l in this._tiles)if(this._tiles[l].coords.z!==this._tileZoom&&(d=this._tiles[l].el,d.onload=f,d.onerror=f,!d.complete)){d.src=j;var k=this._tiles[l].coords;$r(d),delete this._tiles[l],this.fire("tileabort",{tile:d,coords:k})}},_removeTile:function(l){var d=this._tiles[l];if(d)return d.el.setAttribute("src",j),Vi.prototype._removeTile.call(this,l)},_tileReady:function(l,d,k){if(!(!this._map||k&&k.getAttribute("src")===j))return Vi.prototype._tileReady.call(this,l,d,k)}});function La(l,d){return new _i(l,d)}var Da=_i.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(l,d){this._url=l;var k=i({},this.defaultWmsParams);for(var le in d)le in this.options||(k[le]=d[le]);d=p(this,d);var ge=d.detectRetina&&sr.retina?2:1,Pe=this.getTileSize();k.width=Pe.x*ge,k.height=Pe.y*ge,this.wmsParams=k},onAdd:function(l){this._crs=this.options.crs||l.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var d=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[d]=this._crs.code,_i.prototype.onAdd.call(this,l)},getTileUrl:function(l){var d=this._tileCoordsToNwSe(l),k=this._crs,le=oe(k.project(d[0]),k.project(d[1])),ge=le.min,Pe=le.max,Ke=(this._wmsVersion>=1.3&&this._crs===Nr?[ge.y,ge.x,Pe.y,Pe.x]:[ge.x,ge.y,Pe.x,Pe.y]).join(","),Bt=_i.prototype.getTileUrl.call(this,l);return Bt+_(this.wmsParams,Bt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Ke},setParams:function(l,d){return i(this.wmsParams,l),d||this.redraw(),this}});function rl(l,d){return new Da(l,d)}_i.WMS=Da,La.wms=rl;var jn=Vr.extend({options:{padding:.1},initialize:function(l){p(this,l),c(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Lr(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var l={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(l.zoomanim=this._onAnimZoom),l},_onAnimZoom:function(l){this._updateTransform(l.center,l.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(l,d){var k=this._map.getZoomScale(d,this._zoom),le=this._map.getSize().multiplyBy(.5+this.options.padding),ge=this._map.project(this._center,d),Pe=le.multiplyBy(-k).add(ge).subtract(this._map._getNewPixelOrigin(l,d));sr.any3d?In(this._container,Pe,k):Fr(this._container,Pe)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var l in this._layers)this._layers[l]._reset()},_onZoomEnd:function(){for(var l in this._layers)this._layers[l]._project()},_updatePaths:function(){for(var l in this._layers)this._layers[l]._update()},_update:function(){var l=this.options.padding,d=this._map.getSize(),k=this._map.containerPointToLayerPoint(d.multiplyBy(-l)).round();this._bounds=new _e(k,k.add(d.multiplyBy(1+l*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Ma=jn.extend({options:{tolerance:0},getEvents:function(){var l=jn.prototype.getEvents.call(this);return l.viewprereset=this._onViewPreReset,l},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){jn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var l=this._container=document.createElement("canvas");kr(l,"mousemove",this._onMouseMove,this),kr(l,"click dblclick mousedown mouseup contextmenu",this._onClick,this),kr(l,"mouseout",this._handleMouseOut,this),l._leaflet_disable_events=!0,this._ctx=l.getContext("2d")},_destroyContainer:function(){Y(this._redrawRequest),delete this._ctx,$r(this._container),zr(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var l;this._redrawBounds=null;for(var d in this._layers)l=this._layers[d],l._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){jn.prototype._update.call(this);var l=this._bounds,d=this._container,k=l.getSize(),le=sr.retina?2:1;Fr(d,l.min),d.width=le*k.x,d.height=le*k.y,d.style.width=k.x+"px",d.style.height=k.y+"px",sr.retina&&this._ctx.scale(2,2),this._ctx.translate(-l.min.x,-l.min.y),this.fire("update")}},_reset:function(){jn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(l){this._updateDashArray(l),this._layers[c(l)]=l;var d=l._order={layer:l,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=d),this._drawLast=d,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(l){this._requestRedraw(l)},_removePath:function(l){var d=l._order,k=d.next,le=d.prev;k?k.prev=le:this._drawLast=le,le?le.next=k:this._drawFirst=k,delete l._order,delete this._layers[c(l)],this._requestRedraw(l)},_updatePath:function(l){this._extendRedrawBounds(l),l._project(),l._update(),this._requestRedraw(l)},_updateStyle:function(l){this._updateDashArray(l),this._requestRedraw(l)},_updateDashArray:function(l){if(typeof l.options.dashArray=="string"){var d=l.options.dashArray.split(/[, ]+/),k=[],le,ge;for(ge=0;ge<d.length;ge++){if(le=Number(d[ge]),isNaN(le))return;k.push(le)}l.options._dashArray=k}else l.options._dashArray=l.options.dashArray},_requestRedraw:function(l){this._map&&(this._extendRedrawBounds(l),this._redrawRequest=this._redrawRequest||R(this._redraw,this))},_extendRedrawBounds:function(l){if(l._pxBounds){var d=(l.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new _e,this._redrawBounds.extend(l._pxBounds.min.subtract([d,d])),this._redrawBounds.extend(l._pxBounds.max.add([d,d]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var l=this._redrawBounds;if(l){var d=l.getSize();this._ctx.clearRect(l.min.x,l.min.y,d.x,d.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var l,d=this._redrawBounds;if(this._ctx.save(),d){var k=d.getSize();this._ctx.beginPath(),this._ctx.rect(d.min.x,d.min.y,k.x,k.y),this._ctx.clip()}this._drawing=!0;for(var le=this._drawFirst;le;le=le.next)l=le.layer,(!d||l._pxBounds&&l._pxBounds.intersects(d))&&l._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(l,d){if(this._drawing){var k,le,ge,Pe,Ke=l._parts,Bt=Ke.length,er=this._ctx;if(Bt){for(er.beginPath(),k=0;k<Bt;k++){for(le=0,ge=Ke[k].length;le<ge;le++)Pe=Ke[k][le],er[le?"lineTo":"moveTo"](Pe.x,Pe.y);d&&er.closePath()}this._fillStroke(er,l)}}},_updateCircle:function(l){if(!(!this._drawing||l._empty())){var d=l._point,k=this._ctx,le=Math.max(Math.round(l._radius),1),ge=(Math.max(Math.round(l._radiusY),1)||le)/le;ge!==1&&(k.save(),k.scale(1,ge)),k.beginPath(),k.arc(d.x,d.y/ge,le,0,Math.PI*2,!1),ge!==1&&k.restore(),this._fillStroke(k,l)}},_fillStroke:function(l,d){var k=d.options;k.fill&&(l.globalAlpha=k.fillOpacity,l.fillStyle=k.fillColor||k.color,l.fill(k.fillRule||"evenodd")),k.stroke&&k.weight!==0&&(l.setLineDash&&l.setLineDash(d.options&&d.options._dashArray||[]),l.globalAlpha=k.opacity,l.lineWidth=k.weight,l.strokeStyle=k.color,l.lineCap=k.lineCap,l.lineJoin=k.lineJoin,l.stroke())},_onClick:function(l){for(var d=this._map.mouseEventToLayerPoint(l),k,le,ge=this._drawFirst;ge;ge=ge.next)k=ge.layer,k.options.interactive&&k._containsPoint(d)&&(!(l.type==="click"||l.type==="preclick")||!this._map._draggableMoved(k))&&(le=k);this._fireEvent(le?[le]:!1,l)},_onMouseMove:function(l){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var d=this._map.mouseEventToLayerPoint(l);this._handleMouseHover(l,d)}},_handleMouseOut:function(l){var d=this._hoveredLayer;d&&(Xr(this._container,"leaflet-interactive"),this._fireEvent([d],l,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(l,d){if(!this._mouseHoverThrottled){for(var k,le,ge=this._drawFirst;ge;ge=ge.next)k=ge.layer,k.options.interactive&&k._containsPoint(d)&&(le=k);le!==this._hoveredLayer&&(this._handleMouseOut(l),le&&(Lr(this._container,"leaflet-interactive"),this._fireEvent([le],l,"mouseover"),this._hoveredLayer=le)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,l),this._mouseHoverThrottled=!0,setTimeout(a(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(l,d,k){this._map._fireDOMEvent(d,k||d.type,l)},_bringToFront:function(l){var d=l._order;if(d){var k=d.next,le=d.prev;if(k)k.prev=le;else return;le?le.next=k:k&&(this._drawFirst=k),d.prev=this._drawLast,this._drawLast.next=d,d.next=null,this._drawLast=d,this._requestRedraw(l)}},_bringToBack:function(l){var d=l._order;if(d){var k=d.next,le=d.prev;if(le)le.next=k;else return;k?k.prev=le:le&&(this._drawLast=le),d.prev=null,d.next=this._drawFirst,this._drawFirst.prev=d,this._drawFirst=d,this._requestRedraw(l)}}});function Na(l){return sr.canvas?new Ma(l):null}var $i=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(l){return document.createElement("<lvml:"+l+' class="lvml">')}}catch(l){}return function(l){return document.createElement("<"+l+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),nl={_initContainer:function(){this._container=Or("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(jn.prototype._update.call(this),this.fire("update"))},_initPath:function(l){var d=l._container=$i("shape");Lr(d,"leaflet-vml-shape "+(this.options.className||"")),d.coordsize="1 1",l._path=$i("path"),d.appendChild(l._path),this._updateStyle(l),this._layers[c(l)]=l},_addPath:function(l){var d=l._container;this._container.appendChild(d),l.options.interactive&&l.addInteractiveTarget(d)},_removePath:function(l){var d=l._container;$r(d),l.removeInteractiveTarget(d),delete this._layers[c(l)]},_updateStyle:function(l){var d=l._stroke,k=l._fill,le=l.options,ge=l._container;ge.stroked=!!le.stroke,ge.filled=!!le.fill,le.stroke?(d||(d=l._stroke=$i("stroke")),ge.appendChild(d),d.weight=le.weight+"px",d.color=le.color,d.opacity=le.opacity,le.dashArray?d.dashStyle=te(le.dashArray)?le.dashArray.join(" "):le.dashArray.replace(/( *, *)/g," "):d.dashStyle="",d.endcap=le.lineCap.replace("butt","flat"),d.joinstyle=le.lineJoin):d&&(ge.removeChild(d),l._stroke=null),le.fill?(k||(k=l._fill=$i("fill")),ge.appendChild(k),k.color=le.fillColor||le.color,k.opacity=le.fillOpacity):k&&(ge.removeChild(k),l._fill=null)},_updateCircle:function(l){var d=l._point.round(),k=Math.round(l._radius),le=Math.round(l._radiusY||k);this._setPath(l,l._empty()?"M0 0":"AL "+d.x+","+d.y+" "+k+","+le+" 0,"+65535*360)},_setPath:function(l,d){l._path.v=d},_bringToFront:function(l){Fn(l._container)},_bringToBack:function(l){Hn(l._container)}},vs=sr.vml?$i:Je,Gi=jn.extend({_initContainer:function(){this._container=vs("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=vs("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){$r(this._container),zr(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){jn.prototype._update.call(this);var l=this._bounds,d=l.getSize(),k=this._container;(!this._svgSize||!this._svgSize.equals(d))&&(this._svgSize=d,k.setAttribute("width",d.x),k.setAttribute("height",d.y)),Fr(k,l.min),k.setAttribute("viewBox",[l.min.x,l.min.y,d.x,d.y].join(" ")),this.fire("update")}},_initPath:function(l){var d=l._path=vs("path");l.options.className&&Lr(d,l.options.className),l.options.interactive&&Lr(d,"leaflet-interactive"),this._updateStyle(l),this._layers[c(l)]=l},_addPath:function(l){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(l._path),l.addInteractiveTarget(l._path)},_removePath:function(l){$r(l._path),l.removeInteractiveTarget(l._path),delete this._layers[c(l)]},_updatePath:function(l){l._project(),l._update()},_updateStyle:function(l){var d=l._path,k=l.options;d&&(k.stroke?(d.setAttribute("stroke",k.color),d.setAttribute("stroke-opacity",k.opacity),d.setAttribute("stroke-width",k.weight),d.setAttribute("stroke-linecap",k.lineCap),d.setAttribute("stroke-linejoin",k.lineJoin),k.dashArray?d.setAttribute("stroke-dasharray",k.dashArray):d.removeAttribute("stroke-dasharray"),k.dashOffset?d.setAttribute("stroke-dashoffset",k.dashOffset):d.removeAttribute("stroke-dashoffset")):d.setAttribute("stroke","none"),k.fill?(d.setAttribute("fill",k.fillColor||k.color),d.setAttribute("fill-opacity",k.fillOpacity),d.setAttribute("fill-rule",k.fillRule||"evenodd")):d.setAttribute("fill","none"))},_updatePoly:function(l,d){this._setPath(l,We(l._parts,d))},_updateCircle:function(l){var d=l._point,k=Math.max(Math.round(l._radius),1),le=Math.max(Math.round(l._radiusY),1)||k,ge="a"+k+","+le+" 0 1,0 ",Pe=l._empty()?"M0 0":"M"+(d.x-k)+","+d.y+ge+k*2+",0 "+ge+-k*2+",0 ";this._setPath(l,Pe)},_setPath:function(l,d){l._path.setAttribute("d",d)},_bringToFront:function(l){Fn(l._path)},_bringToBack:function(l){Hn(l._path)}});sr.vml&&Gi.include(nl);function Ba(l){return sr.svg||sr.vml?new Gi(l):null}Mr.include({getRenderer:function(l){var d=l.options.renderer||this._getPaneRenderer(l.options.pane)||this.options.renderer||this._renderer;return d||(d=this._renderer=this._createRenderer()),this.hasLayer(d)||this.addLayer(d),d},_getPaneRenderer:function(l){if(l==="overlayPane"||l===void 0)return!1;var d=this._paneRenderers[l];return d===void 0&&(d=this._createRenderer({pane:l}),this._paneRenderers[l]=d),d},_createRenderer:function(l){return this.options.preferCanvas&&Na(l)||Ba(l)}});var Ua=mi.extend({initialize:function(l,d){mi.prototype.initialize.call(this,this._boundsToLatLngs(l),d)},setBounds:function(l){return this.setLatLngs(this._boundsToLatLngs(l))},_boundsToLatLngs:function(l){return l=re(l),[l.getSouthWest(),l.getNorthWest(),l.getNorthEast(),l.getSouthEast()]}});function il(l,d){return new Ua(l,d)}Gi.create=vs,Gi.pointsToPath=We,Un.geometryToLayer=hs,Un.coordsToLatLng=Bs,Un.coordsToLatLngs=ds,Un.latLngToCoords=Us,Un.latLngsToCoords=fs,Un.getFeature=gi,Un.asFeature=ps,Mr.mergeOptions({boxZoom:!0});var ja=mn.extend({initialize:function(l){this._map=l,this._container=l._container,this._pane=l._panes.overlayPane,this._resetStateTimeout=0,l.on("unload",this._destroy,this)},addHooks:function(){kr(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){zr(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){$r(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(l){if(!l.shiftKey||l.which!==1&&l.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Cn(),Ri(),this._startPoint=this._map.mouseEventToContainerPoint(l),kr(document,{contextmenu:pn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(l){this._moved||(this._moved=!0,this._box=Or("div","leaflet-zoom-box",this._container),Lr(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(l);var d=new _e(this._point,this._startPoint),k=d.getSize();Fr(this._box,d.min),this._box.style.width=k.x+"px",this._box.style.height=k.y+"px"},_finish:function(){this._moved&&($r(this._box),Xr(this._container,"leaflet-crosshair")),Rn(),ki(),zr(document,{contextmenu:pn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(l){if(!(l.which!==1&&l.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(a(this._resetState,this),0);var d=new ie(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(d).fire("boxzoomend",{boxZoomBounds:d})}},_onKeyDown:function(l){l.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Mr.addInitHook("addHandler","boxZoom",ja),Mr.mergeOptions({doubleClickZoom:!0});var Wa=mn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(l){var d=this._map,k=d.getZoom(),le=d.options.zoomDelta,ge=l.originalEvent.shiftKey?k-le:k+le;d.options.doubleClickZoom==="center"?d.setZoom(ge):d.setZoomAround(l.containerPoint,ge)}});Mr.addInitHook("addHandler","doubleClickZoom",Wa),Mr.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Ha=mn.extend({addHooks:function(){if(!this._draggable){var l=this._map;this._draggable=new kn(l._mapPane,l._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),l.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),l.on("zoomend",this._onZoomEnd,this),l.whenReady(this._onZoomEnd,this))}Lr(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Xr(this._map._container,"leaflet-grab"),Xr(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var l=this._map;if(l._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var d=re(this._map.options.maxBounds);this._offsetLimit=oe(this._map.latLngToContainerPoint(d.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(d.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;l.fire("movestart").fire("dragstart"),l.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(l){if(this._map.options.inertia){var d=this._lastTime=+new Date,k=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(k),this._times.push(d),this._prunePositions(d)}this._map.fire("move",l).fire("drag",l)},_prunePositions:function(l){for(;this._positions.length>1&&l-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var l=this._map.getSize().divideBy(2),d=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=d.subtract(l).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(l,d){return l-(l-d)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var l=this._draggable._newPos.subtract(this._draggable._startPos),d=this._offsetLimit;l.x<d.min.x&&(l.x=this._viscousLimit(l.x,d.min.x)),l.y<d.min.y&&(l.y=this._viscousLimit(l.y,d.min.y)),l.x>d.max.x&&(l.x=this._viscousLimit(l.x,d.max.x)),l.y>d.max.y&&(l.y=this._viscousLimit(l.y,d.max.y)),this._draggable._newPos=this._draggable._startPos.add(l)}},_onPreDragWrap:function(){var l=this._worldWidth,d=Math.round(l/2),k=this._initialWorldOffset,le=this._draggable._newPos.x,ge=(le-d+k)%l+d-k,Pe=(le+d+k)%l-d-k,Ke=Math.abs(ge+k)<Math.abs(Pe+k)?ge:Pe;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Ke},_onDragEnd:function(l){var d=this._map,k=d.options,le=!k.inertia||l.noInertia||this._times.length<2;if(d.fire("dragend",l),le)d.fire("moveend");else{this._prunePositions(+new Date);var ge=this._lastPos.subtract(this._positions[0]),Pe=(this._lastTime-this._times[0])/1e3,Ke=k.easeLinearity,Bt=ge.multiplyBy(Ke/Pe),er=Bt.distanceTo([0,0]),hr=Math.min(k.inertiaMaxSpeed,er),Ar=Bt.multiplyBy(hr/er),Ir=hr/(k.inertiaDeceleration*Ke),Dr=Ar.multiplyBy(-Ir/2).round();!Dr.x&&!Dr.y?d.fire("moveend"):(Dr=d._limitOffset(Dr,d.options.maxBounds),R(function(){d.panBy(Dr,{duration:Ir,easeLinearity:Ke,noMoveStart:!0,animate:!0})}))}}});Mr.addInitHook("addHandler","dragging",Ha),Mr.mergeOptions({keyboard:!0,keyboardPanDelta:80});var za=mn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(l){this._map=l,this._setPanDelta(l.options.keyboardPanDelta),this._setZoomDelta(l.options.zoomDelta)},addHooks:function(){var l=this._map._container;l.tabIndex<=0&&(l.tabIndex="0"),kr(l,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),zr(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var l=document.body,d=document.documentElement,k=l.scrollTop||d.scrollTop,le=l.scrollLeft||d.scrollLeft;this._map._container.focus(),window.scrollTo(le,k)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(l){var d=this._panKeys={},k=this.keyCodes,le,ge;for(le=0,ge=k.left.length;le<ge;le++)d[k.left[le]]=[-1*l,0];for(le=0,ge=k.right.length;le<ge;le++)d[k.right[le]]=[l,0];for(le=0,ge=k.down.length;le<ge;le++)d[k.down[le]]=[0,l];for(le=0,ge=k.up.length;le<ge;le++)d[k.up[le]]=[0,-1*l]},_setZoomDelta:function(l){var d=this._zoomKeys={},k=this.keyCodes,le,ge;for(le=0,ge=k.zoomIn.length;le<ge;le++)d[k.zoomIn[le]]=l;for(le=0,ge=k.zoomOut.length;le<ge;le++)d[k.zoomOut[le]]=-l},_addHooks:function(){kr(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){zr(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(l){if(!(l.altKey||l.ctrlKey||l.metaKey)){var d=l.keyCode,k=this._map,le;if(d in this._panKeys){if(!k._panAnim||!k._panAnim._inProgress)if(le=this._panKeys[d],l.shiftKey&&(le=ae(le).multiplyBy(3)),k.options.maxBounds&&(le=k._limitOffset(ae(le),k.options.maxBounds)),k.options.worldCopyJump){var ge=k.wrapLatLng(k.unproject(k.project(k.getCenter()).add(le)));k.panTo(ge)}else k.panBy(le)}else if(d in this._zoomKeys)k.setZoom(k.getZoom()+(l.shiftKey?3:1)*this._zoomKeys[d]);else if(d===27&&k._popup&&k._popup.options.closeOnEscapeKey)k.closePopup();else return;pn(l)}}});Mr.addInitHook("addHandler","keyboard",za),Mr.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Va=mn.extend({addHooks:function(){kr(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){zr(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(l){var d=ns(l),k=this._map.options.wheelDebounceTime;this._delta+=d,this._lastMousePos=this._map.mouseEventToContainerPoint(l),this._startTime||(this._startTime=+new Date);var le=Math.max(k-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(a(this._performZoom,this),le),pn(l)},_performZoom:function(){var l=this._map,d=l.getZoom(),k=this._map.options.zoomSnap||0;l._stop();var le=this._delta/(this._map.options.wheelPxPerZoomLevel*4),ge=4*Math.log(2/(1+Math.exp(-Math.abs(le))))/Math.LN2,Pe=k?Math.ceil(ge/k)*k:ge,Ke=l._limitZoom(d+(this._delta>0?Pe:-Pe))-d;this._delta=0,this._startTime=null,Ke&&(l.options.scrollWheelZoom==="center"?l.setZoom(d+Ke):l.setZoomAround(this._lastMousePos,d+Ke))}});Mr.addInitHook("addHandler","scrollWheelZoom",Va);var sl=600;Mr.mergeOptions({tapHold:sr.touchNative&&sr.safari&&sr.mobile,tapTolerance:15});var $a=mn.extend({addHooks:function(){kr(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){zr(this._map._container,"touchstart",this._onDown,this)},_onDown:function(l){if(clearTimeout(this._holdTimeout),l.touches.length===1){var d=l.touches[0];this._startPos=this._newPos=new Fe(d.clientX,d.clientY),this._holdTimeout=setTimeout(a(function(){this._cancel(),this._isTapValid()&&(kr(document,"touchend",Kr),kr(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",d))},this),sl),kr(document,"touchend touchcancel contextmenu",this._cancel,this),kr(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function l(){zr(document,"touchend",Kr),zr(document,"touchend touchcancel",l)},_cancel:function(){clearTimeout(this._holdTimeout),zr(document,"touchend touchcancel contextmenu",this._cancel,this),zr(document,"touchmove",this._onMove,this)},_onMove:function(l){var d=l.touches[0];this._newPos=new Fe(d.clientX,d.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(l,d){var k=new MouseEvent(l,{bubbles:!0,cancelable:!0,view:window,screenX:d.screenX,screenY:d.screenY,clientX:d.clientX,clientY:d.clientY});k._simulated=!0,d.target.dispatchEvent(k)}});Mr.addInitHook("addHandler","tapHold",$a),Mr.mergeOptions({touchZoom:sr.touch,bounceAtZoomLimits:!0});var Ga=mn.extend({addHooks:function(){Lr(this._map._container,"leaflet-touch-zoom"),kr(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Xr(this._map._container,"leaflet-touch-zoom"),zr(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(l){var d=this._map;if(!(!l.touches||l.touches.length!==2||d._animatingZoom||this._zooming)){var k=d.mouseEventToContainerPoint(l.touches[0]),le=d.mouseEventToContainerPoint(l.touches[1]);this._centerPoint=d.getSize()._divideBy(2),this._startLatLng=d.containerPointToLatLng(this._centerPoint),d.options.touchZoom!=="center"&&(this._pinchStartLatLng=d.containerPointToLatLng(k.add(le)._divideBy(2))),this._startDist=k.distanceTo(le),this._startZoom=d.getZoom(),this._moved=!1,this._zooming=!0,d._stop(),kr(document,"touchmove",this._onTouchMove,this),kr(document,"touchend touchcancel",this._onTouchEnd,this),Kr(l)}},_onTouchMove:function(l){if(!(!l.touches||l.touches.length!==2||!this._zooming)){var d=this._map,k=d.mouseEventToContainerPoint(l.touches[0]),le=d.mouseEventToContainerPoint(l.touches[1]),ge=k.distanceTo(le)/this._startDist;if(this._zoom=d.getScaleZoom(ge,this._startZoom),!d.options.bounceAtZoomLimits&&(this._zoom<d.getMinZoom()&&ge<1||this._zoom>d.getMaxZoom()&&ge>1)&&(this._zoom=d._limitZoom(this._zoom)),d.options.touchZoom==="center"){if(this._center=this._startLatLng,ge===1)return}else{var Pe=k._add(le)._divideBy(2)._subtract(this._centerPoint);if(ge===1&&Pe.x===0&&Pe.y===0)return;this._center=d.unproject(d.project(this._pinchStartLatLng,this._zoom).subtract(Pe),this._zoom)}this._moved||(d._moveStart(!0,!1),this._moved=!0),Y(this._animRequest);var Ke=a(d._move,d,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=R(Ke,this,!0),Kr(l)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Y(this._animRequest),zr(document,"touchmove",this._onTouchMove,this),zr(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Mr.addInitHook("addHandler","touchZoom",Ga),Mr.BoxZoom=ja,Mr.DoubleClickZoom=Wa,Mr.Drag=Ha,Mr.Keyboard=za,Mr.ScrollWheelZoom=Va,Mr.TapHold=$a,Mr.TouchZoom=Ga,r.Bounds=_e,r.Browser=sr,r.CRS=pe,r.Canvas=Ma,r.Circle=Ns,r.CircleMarker=us,r.Class=me,r.Control=on,r.DivIcon=Fa,r.DivOverlay=On,r.DomEvent=is,r.DomUtil=ts,r.Draggable=kn,r.Evented=se,r.FeatureGroup=ln,r.GeoJSON=Un,r.GridLayer=Vi,r.Handler=mn,r.Icon=pi,r.ImageOverlay=ms,r.LatLng=ce,r.LatLngBounds=ie,r.Layer=Vr,r.LayerGroup=gn,r.LineUtil=Ft,r.Map=Mr,r.Marker=cs,r.Mixin=qn,r.Path=Kn,r.Point=Fe,r.PolyUtil=di,r.Polygon=mi,r.Polyline=Bn,r.Popup=gs,r.PosAnimation=Mi,r.Projection=Wr,r.Rectangle=Ua,r.Renderer=jn,r.SVG=Gi,r.SVGOverlay=Oa,r.TileLayer=_i,r.Tooltip=_s,r.Transformation=je,r.Util=q,r.VideoOverlay=Pa,r.bind=a,r.bounds=oe,r.canvas=Na,r.circle=$o,r.circleMarker=Vo,r.control=nn,r.divIcon=el,r.extend=i,r.featureGroup=Hi,r.geoJSON=Ia,r.geoJson=Ko,r.gridLayer=tl,r.icon=Ho,r.imageOverlay=Yo,r.latLng=fe,r.latLngBounds=re,r.layerGroup=_n,r.map=ai,r.marker=zo,r.point=ae,r.polygon=Xo,r.polyline=Go,r.popup=Jo,r.rectangle=il,r.setOptions=p,r.stamp=c,r.svg=Ba,r.svgOverlay=Zo,r.tileLayer=La,r.tooltip=Qo,r.transformation=Se,r.version=n,r.videoOverlay=qo;var al=window.L;r.noConflict=function(){return window.L=al,this},window.L=r})}(leafletSrc$1,leafletSrc$1.exports)),leafletSrc$1.exports}var leafletSrcExports=requireLeafletSrc();const createMuiIcon=(t="red",e=36)=>leafletSrcExports.divIcon({className:"",html:`<svg xmlns="http://www.w3.org/2000/svg" height="${e}" viewBox="0 -960 960 960" width="${e}" fill="${t}">
             <path d="M480-80q-140-121-210-230.5T200-480q0-115 82.5-197.5T480-760q115 0 197.5 82.5T760-480q0 87-70 196.5T480-80Zm0-420Zm0 116q48 0 82-34t34-82q0-48-34-82t-82-34q-48 0-82 34t-34 82q0 48 34 82t82 34Z"/>
           </svg>`,iconSize:[e,e],iconAnchor:[e/2,e],popupAnchor:[0,-e]}),style={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"80%",height:"80%",bgcolor:"background.paper",boxShadow:24,p:4,zIndex:1300};function MapaModal({open:t,cerrarModal:e}){const[r,n]=reactExports.useState(null);return reactExports.useEffect(()=>{if(t){const i=setTimeout(()=>{const s=document.getElementById("map");if(!s){console.error("Â¡El contenedor del mapa no se encontrÃ³!");return}r&&(r.remove(),n(null));const a=leafletSrcExports.map(s).setView([33,-3],6);leafletSrcExports.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(a);let o=null;const c=JSON.parse(sessionStorage.getItem("excelData"));if(c&&c.Coordenadas){const u=c.Coordenadas[1][1],h=c.Coordenadas[2][1];o=leafletSrcExports.marker([u,h],{icon:createMuiIcon("red",36)}).addTo(a).bindPopup(`Coordenadas: ${u.toFixed(4)}, ${h.toFixed(4)}`).openPopup()}a.on("click",u=>{const{lat:h,lng:f}=u.latlng,m=JSON.parse(sessionStorage.getItem("excelData"))||{};m.Coordenadas=[["ParÃ¡metro","Valor"],["lat",h],["lng",f]],sessionStorage.setItem("excelData",JSON.stringify(m)),o&&a.removeLayer(o),o=leafletSrcExports.marker([h,f],{icon:createMuiIcon("red",36)}).addTo(a).bindPopup(`Coordenadas: ${h.toFixed(4)}, ${f.toFixed(4)}`).openPopup()}),n(a)},100);return()=>clearTimeout(i)}else r&&(r.remove(),n(null))},[t]),jsxRuntimeExports.jsx(Modal,{open:t,onClose:e,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",sx:{zIndex:1300},children:jsxRuntimeExports.jsxs(Box,{sx:style,children:[jsxRuntimeExports.jsx(IconButton,{"aria-label":"close",onClick:e,sx:{position:"absolute",right:3,top:3,color:"text.primary"},children:jsxRuntimeExports.jsx(CloseIcon,{})}),jsxRuntimeExports.jsx("div",{id:"map",style:{height:"100%",width:"100%"}})]})})}const JsonEditorModal=({jsonPopup:t,setJsonPopup:e,localJsonData:r={},setLocalJsonData:n,handleSaveJson:i,refreshParentData:s})=>{const[a,o]=reactExports.useState(null),[c,u]=reactExports.useState(null),[h,f]=reactExports.useState({}),[m,E]=reactExports.useState({});reactExports.useEffect(()=>{if(t.open&&r&&Object.keys(r).length>0)try{const O=Object.keys(r)[0],R=Object.keys(r[O]||{})[0]||null;o(O||null),u(R||null),f(O&&R?Er({},r[O][R]):{}),E({})}catch(O){console.error("Error al inicializar:",O),o(null),u(null),f({}),E({})}},[t.open,r]),reactExports.useEffect(()=>{var O;a&&c&&((O=r==null?void 0:r[a])!=null&&O[c])&&(f(Er({},r[a][c])),E({}))},[a,c,r]);const g=O=>{try{JSON.parse(O)}catch(R){return!1}return!0},p=O=>{if(typeof O=="string"&&g(O))try{return JSON.parse(O)}catch(R){return O}return O},_=(O,R)=>{f(Y=>{const q=Er({},Y);let me=q;for(let xe=0;xe<O.length-1;xe++){const Ee=O[xe];typeof me[Ee]=="string"&&g(me[Ee])&&(me[Ee]=JSON.parse(me[Ee])),me[Ee]=Er({},me[Ee]),me=me[Ee]}return me[O[O.length-1]]=R,q})},A=O=>{const R=O.join(".");E(Y=>Br(Er({},Y),{[R]:!Y[R]}))},H=O=>{const R=O.join(".");return m[R]||!1},te=(O,R)=>{const Y=Er({},r[O]),q=Y[R],me=Er({[R]:q},Object.fromEntries(Object.entries(Y).filter(([xe])=>xe!==R)));return Br(Er({},r),{[O]:me})},ne=O=>Er({[O]:r[O]},Object.fromEntries(Object.entries(r).filter(([R])=>R!==O))),j=O=>{const R=O.target.value;if(o(R),R&&r[R]){const Y=Object.keys(r[R])[0]||null;u(Y),n(ne(R))}else u(null)},ee=O=>{const R=O.target.value;u(R),n(te(a,R))},x=(O,R,Y=[O])=>{const q=p(R);if(typeof q=="object"&&q!==null&&!Array.isArray(q)){const me=H(Y);return jsxRuntimeExports.jsxs(Box,{sx:{border:"1px solid #ddd",borderRadius:1,p:1,mt:1},children:[jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",alignItems:"center",cursor:"pointer",backgroundColor:"#f5f5f5",p:1,borderRadius:1},onClick:()=>A(Y),children:[jsxRuntimeExports.jsx(Typography,{variant:"body2",sx:{fontWeight:"bold"},children:O}),jsxRuntimeExports.jsx(IconButton,{size:"small",sx:{ml:"auto"},children:me?jsxRuntimeExports.jsx(ExpandLessIcon,{}):jsxRuntimeExports.jsx(ExpandMoreIcon,{})})]}),jsxRuntimeExports.jsx(Collapse,{in:me,children:jsxRuntimeExports.jsx(Box,{sx:{mt:1,pl:2},children:Object.entries(q).map(([xe,Ee])=>x(xe,Ee,[...Y,xe]))})})]},Y.join("."))}return jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",flexDirection:"column",mb:2,width:"100%"},children:[jsxRuntimeExports.jsx(Typography,{variant:"caption",sx:{fontWeight:"medium",color:"text.secondary",mb:.5},children:O}),(()=>{if(typeof q=="string"){const me=q.split(";").map(Ee=>Ee.trim());if(me.includes("True")&&me.includes("False")&&me.length===2){const Ee=me[0]==="True";return jsxRuntimeExports.jsx(Checkbox,{checked:Ee,onChange:se=>{const Fe=se.target.checked?"True;False":"False;True";_(Y,Fe)}})}return me.length>1?jsxRuntimeExports.jsx(Select,{size:"small",value:me[0],onChange:Ee=>{const se=Ee.target.value,Fe=[se,...me.filter(ue=>ue!==se)].join(";");_(Y,Fe)},fullWidth:!0,children:me.map((Ee,se)=>jsxRuntimeExports.jsx(MenuItem,{value:Ee,children:Ee},se))}):jsxRuntimeExports.jsx(TextField,{size:"small",value:q,onChange:Ee=>_(Y,Ee.target.value),fullWidth:!0})}return typeof q=="number"?jsxRuntimeExports.jsx(TextField,{size:"small",type:"number",value:q,onChange:me=>_(Y,Number(me.target.value)),fullWidth:!0}):jsxRuntimeExports.jsx(TextField,{size:"small",value:q,onChange:me=>_(Y,me.target.value),fullWidth:!0})})()]},Y.join("."))},M=()=>{if(!t.sheetName||t.rowIndex===null||t.cellIndex===null){console.error("Faltan datos para guardar en sessionStorage");return}const O=Br(Er({},r[a]),{[c]:h}),R=Br(Er({},r),{[a]:O}),Y=JSON.parse(sessionStorage.getItem("excelData"))||{},q=[...Y[t.sheetName]||[]];q[t.rowIndex+1]||(q[t.rowIndex+1]=[]),q[t.rowIndex+1][t.cellIndex]=JSON.stringify(R),sessionStorage.setItem("excelData",JSON.stringify(Br(Er({},Y),{[t.sheetName]:q}))),n(R),s&&s(),e(me=>Br(Er({},me),{open:!1}))},T=()=>{e(O=>Br(Er({},O),{open:!1}))};return!t.open||!a||!c?null:jsxRuntimeExports.jsx(Modal,{open:t.open,onClose:T,sx:{display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(4px)"},children:jsxRuntimeExports.jsxs(Box,{sx:{backgroundColor:"background.paper",boxShadow:24,borderRadius:2,width:"80%",maxWidth:800,p:4,maxHeight:"90vh",display:"flex",flexDirection:"column"},onClick:O=>O.stopPropagation(),children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",gutterBottom:!0,children:"Editor JSON"}),jsxRuntimeExports.jsxs(Box,{sx:{mb:2,display:"flex",gap:2},children:[jsxRuntimeExports.jsx(FormControl,{fullWidth:!0,size:"small",children:jsxRuntimeExports.jsx(Select,{value:a||"",onChange:j,children:r&&Object.keys(r).map(O=>jsxRuntimeExports.jsx(MenuItem,{value:O,children:O},O))})}),jsxRuntimeExports.jsx(FormControl,{fullWidth:!0,size:"small",children:jsxRuntimeExports.jsx(Select,{value:c||"",onChange:ee,disabled:!a,children:a&&(r==null?void 0:r[a])&&Object.keys(r[a]).map(O=>jsxRuntimeExports.jsx(MenuItem,{value:O,children:O},O))})})]}),jsxRuntimeExports.jsx(Box,{sx:{flex:1,overflowY:"auto",mb:2,width:"100%"},children:jsxRuntimeExports.jsx(Table,{size:"small",sx:{width:"100%"},children:jsxRuntimeExports.jsx(TableBody,{children:Object.entries(h||{}).filter(([O])=>O!=="subject").map(([O,R])=>jsxRuntimeExports.jsx(TableRow,{children:jsxRuntimeExports.jsx(TableCell,{colSpan:2,sx:{padding:"4px 8px",border:"none"},children:x(O,R)})},O))})})}),jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",justifyContent:"flex-end",gap:2},children:[jsxRuntimeExports.jsx(Button,{variant:"outlined",onClick:T,startIcon:jsxRuntimeExports.jsx(CancelIcon,{}),children:"Cancelar"}),jsxRuntimeExports.jsx(Button,{variant:"contained",onClick:M,startIcon:jsxRuntimeExports.jsx(SaveIcon,{}),children:"Guardar"})]})]})})},JSONButtonRenderer=({cellValue:t,rowIndex:e,cellIndex:r,handleOpenJsonPopup:n})=>{try{const i=JSON.parse(t);if(!i||typeof i!="object")return null;const s=Object.keys(i)[0];if(!s)return null;const a=i[s],c=(a&&typeof a=="object"?Object.keys(a):[])[0];if(!c)return null;const u=a[c],h=u&&typeof u=="object"?Object.keys(u):[];return jsxRuntimeExports.jsx(Button,{variant:"text",onClick:()=>n(i,e,r),sx:{all:"unset",display:"block",width:"100%",cursor:"pointer",padding:"8px",margin:0,border:"1px solid #e0e0e0",borderRadius:"4px",backgroundColor:"#fafafa","&:hover":{backgroundColor:"#f0f0f0",borderColor:"#bdbdbd"}},children:jsxRuntimeExports.jsxs(Box,{sx:{fontFamily:"'Monaco', 'Consolas', 'Courier New', monospace",fontSize:"0.7rem",lineHeight:"1.3",whiteSpace:"pre-wrap",wordBreak:"break-all",overflow:"visible",textAlign:"left",width:"100%",maxHeight:"none"},children:[jsxRuntimeExports.jsx(Box,{sx:{backgroundColor:"#e0e0e0",padding:"4px 8px",borderRadius:"4px",marginBottom:"4px",border:"1px solid #bdbdbd"},children:jsxRuntimeExports.jsx("span",{style:{fontWeight:"bold",color:"#000"},children:s})}),jsxRuntimeExports.jsxs(Box,{sx:{paddingLeft:"16px"},children:[jsxRuntimeExports.jsx(Box,{sx:{backgroundColor:"#f5f5f5",padding:"3px 6px",borderRadius:"3px",marginBottom:"2px",border:"1px solid #ddd"},children:jsxRuntimeExports.jsx("span",{style:{fontWeight:"bold",color:"#000"},children:c})}),jsxRuntimeExports.jsx(Box,{sx:{paddingLeft:"12px"},children:h.map(f=>{const m=u[f];return jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",marginBottom:"1px"},children:[jsxRuntimeExports.jsxs("span",{style:{fontWeight:"bold",color:"#000",marginRight:"4px"},children:[f,":"]}),jsxRuntimeExports.jsx("span",{style:{color:"#d32f2f"},children:typeof m=="string"||typeof m=="number"?m:JSON.stringify(m)})]},f)})})]})]})},`${e}-${r}`)}catch(i){return console.error("Error parsing JSON:",i),jsxRuntimeExports.jsxs(Box,{sx:{padding:"8px",fontFamily:"monospace",fontSize:"0.7rem",color:"#d32f2f",backgroundColor:"#ffebee",border:"1px solid #ffcdd2",borderRadius:"4px",width:"100%"},children:["JSON invÃ¡lido: ",i.message]})}},Editors=({cellValue:t,editingValue:e,setEditingValue:r,saveEditing:n,setEditingCell:i,isSheetEditable:s})=>{const a=String(t).trim();if(typeof t=="string"){if(a.includes(";")){const o=a.split(";").map(u=>u.trim());return o.length===2&&o.some(u=>u.toLowerCase()==="true")&&o.some(u=>u.toLowerCase()==="false")?jsxRuntimeExports.jsx(Checkbox,{checked:e.toLowerCase()==="true",onChange:u=>{const h=u.target.checked?"True;False":"False;True";r(h)},disabled:!s}):jsxRuntimeExports.jsx(Select,{value:e,onChange:u=>r(u.target.value),size:"small",sx:{width:"100%"},autoFocus:!0,children:o.map((u,h)=>jsxRuntimeExports.jsx(MenuItem,{value:u,children:u},h))})}return a.startsWith("!")?jsxRuntimeExports.jsx(TextField,{autoFocus:!0,fullWidth:!0,size:"small",value:e,onChange:o=>r(o.target.value),onBlur:()=>n(),onKeyDown:o=>{o.key==="Enter"?n():o.key==="Escape"&&i(null)},variant:"outlined"}):jsxRuntimeExports.jsx(TextField,{autoFocus:!0,fullWidth:!0,size:"small",value:e,onChange:o=>r(o.target.value),onBlur:()=>n(),onKeyDown:o=>{o.key==="Enter"?n():o.key==="Escape"&&i(null)},variant:"outlined"})}return typeof t=="number"?jsxRuntimeExports.jsx(TextField,{autoFocus:!0,fullWidth:!0,size:"small",type:"number",value:e,onChange:o=>r(o.target.value),onBlur:()=>n(),onKeyDown:o=>{o.key==="Enter"?n():o.key==="Escape"&&i(null)},variant:"outlined"}):typeof t=="object"&&t!==null?jsxRuntimeExports.jsx(TextField,{autoFocus:!0,fullWidth:!0,multiline:!0,minRows:3,value:e,onChange:o=>r(o.target.value),onBlur:()=>{try{const o=JSON.parse(e);n(o)}catch(o){}},onKeyDown:o=>{if(o.key==="Enter")try{const c=JSON.parse(e);n(c)}catch(c){}else o.key==="Escape"&&i(null)},variant:"outlined"}):null},CellRenderer=({activeSheet:t,rowIndex:e,cellIndex:r,dataFromSession:n,editingCell:i,setEditingCell:s,handleOpenJsonPopup:a,updateSessionData:o})=>{const[c,u]=reactExports.useState(""),h=H=>H&&H.length>0,f=()=>{const H=n[t];return!H||!H[e+1]?null:H[e+1][r]},m=(H,te=!1)=>{const ne=Er({},n),j=[...ne[t]];j[e+1][r]=te&&typeof H=="string"?`!${H}`:H,o(ne)},E=()=>{if(!h(t))return;const H=Er({},n),te=[...H[t]],x=te[e+1][r].split(";").map(M=>M.trim())[0].toLowerCase()==="true"?"False;True":"True;False";te[e+1][r]=x,o(H)},g=()=>{if(!h(t))return;const H=f(),te=String(H).trim();typeof H=="string"&&!te.includes(";")&&!te.startsWith("!")&&!te.startsWith("{")||(typeof H=="string"&&H.startsWith("!")?u(H.substring(1)):u(H),s({row:e,cell:r}))},p=(H=null)=>{const te=f(),ne=typeof te=="string"&&te.startsWith("!");let j=H!==null?H:c;if(typeof te=="number"){const ee=Number(j);j=isNaN(ee)?0:ee}m(j,ne),s(null)},_=f();if(_==null)return null;const A=String(_).trim();if(A.startsWith("{")&&A.endsWith("}"))return jsxRuntimeExports.jsx(JSONButtonRenderer,{cellValue:_,rowIndex:e,cellIndex:r,handleOpenJsonPopup:a});if((i==null?void 0:i.row)===e&&i.cell===r)return jsxRuntimeExports.jsx(Editors,{cellValue:_,editingValue:c,setEditingValue:u,saveEditing:p,setEditingCell:s,isSheetEditable:h(t)});if(typeof _=="string"&&A.includes(";")){const H=A.split(";").map(ne=>ne.trim());return H.length===2&&H.some(ne=>ne.toLowerCase()==="true")&&H.some(ne=>ne.toLowerCase()==="false")?jsxRuntimeExports.jsx(Checkbox,{checked:H[0].toLowerCase()==="true",onChange:E,disabled:!h(t)}):h(t)?jsxRuntimeExports.jsx(Select,{value:H[0],onChange:ne=>{const j=ne.target.value,ee=Er({},n),x=[...ee[t]],T=x[e+1][r].split(";").map(R=>R.trim()),O=[j,...T.filter(R=>R!==j)].join(";");x[e+1][r]=O,o(ee)},size:"small",sx:{width:"100%",color:"black"},children:H.map((ne,j)=>jsxRuntimeExports.jsx(MenuItem,{value:ne,children:ne},j))}):jsxRuntimeExports.jsx("div",{style:{color:"gray"},children:H[0]})}return typeof _=="string"&&A.startsWith("!")?jsxRuntimeExports.jsx("div",{onClick:g,style:{cursor:h(t)?"pointer":"default",padding:"8px"},children:A.substring(1)}):!isNaN(parseFloat(_))&&isFinite(_)?jsxRuntimeExports.jsx("div",{onClick:g,style:{cursor:h(t)?"pointer":"default",padding:"8px"},children:_}):jsxRuntimeExports.jsx("div",{onClick:g,style:{cursor:h(t)?"pointer":"default",padding:"8px",color:"black"},children:_})},TableControls=({activeSheet:t,editingCell:e,setEditingCell:r,handleOpenJsonPopup:n,refreshData:i})=>{const[s,a]=reactExports.useState({}),c=t===(t==null?void 0:t.toUpperCase()),u=()=>{const A=JSON.parse(sessionStorage.getItem("excelData"))||{};a(A)};reactExports.useEffect(()=>{u();const A=()=>u();return window.addEventListener("storage",A),()=>window.removeEventListener("storage",A)},[i]);const h=A=>{sessionStorage.setItem("excelData",JSON.stringify(A)),a(A),window.dispatchEvent(new Event("storage"))},f=reactExports.useMemo(()=>{const A=s[t];return A&&A.length>0?A[0].map((H,te)=>({Header:A[0][te],accessor:te.toString()})):[]},[t,s]),m=reactExports.useMemo(()=>{const A=s[t];return A?A.slice(1):[]},[t,s]),E=A=>{if(!c||A==null)return;const H=Er({},s),te=[...H[t]],ne=te[A+1];te.splice(A+1,0,[...ne]),H[t]=te,h(H)},g=A=>{if(!c||A==null)return;const H=Er({},s),te=[...H[t]];if(te.slice(1).length<=1){alert("No se puede eliminar la Ãºltima fila.");return}te.splice(A+1,1),H[t]=te,h(H)},p=A=>{if(!c||A<=0)return;const H=Er({},s),te=[...H[t]],ne=te[A+1];te.splice(A+1,1),te.splice(A,0,ne),H[t]=te,h(H)},_=A=>{if(!c||A>=m.length-1)return;const H=Er({},s),te=[...H[t]],ne=te[A+1];te.splice(A+1,1),te.splice(A+2,0,ne),H[t]=te,h(H)};return jsxRuntimeExports.jsx(TableContainer,{component:Paper,children:jsxRuntimeExports.jsx(Box,{sx:{overflowX:"auto"},children:jsxRuntimeExports.jsxs(Table,{stickyHeader:!0,size:"small","aria-label":"controlled table",children:[jsxRuntimeExports.jsx(TableHead,{children:jsxRuntimeExports.jsxs(TableRow,{children:[jsxRuntimeExports.jsx(TableCell,{sx:{padding:0,width:"4px",backgroundColor:"transparent",borderLeft:"2px solid black"}}),f.map((A,H)=>jsxRuntimeExports.jsx(TableCell,{sx:{fontWeight:"bold",backgroundColor:"#ddd",maxWidth:200,width:"auto",wordBreak:"break-word"},children:A.Header},H)),c&&jsxRuntimeExports.jsx(TableCell,{sx:{fontWeight:"bold",backgroundColor:"#ddd",textAlign:"center",width:"auto",minWidth:80,maxWidth:200,whiteSpace:"normal"},children:"Acciones"})]})}),jsxRuntimeExports.jsx(TableBody,{children:m.map((A,H)=>jsxRuntimeExports.jsxs(TableRow,{hover:!0,children:[jsxRuntimeExports.jsx(TableCell,{sx:{padding:0,width:"4px",backgroundColor:"transparent",borderLeft:"2px solid black"}}),A.map((te,ne)=>jsxRuntimeExports.jsx(TableCell,{sx:{maxWidth:200,width:"auto",wordBreak:"break-word",verticalAlign:"middle",padding:"0 !important"},children:jsxRuntimeExports.jsx(CellRenderer,{activeSheet:t,rowIndex:H,cellIndex:ne,dataFromSession:s,editingCell:e,setEditingCell:r,handleOpenJsonPopup:n,updateSessionData:h})},ne)),c&&jsxRuntimeExports.jsx(TableCell,{padding:"none",sx:{width:40,minWidth:40,maxWidth:40,whiteSpace:"normal",textAlign:"center",verticalAlign:"middle"},children:jsxRuntimeExports.jsxs(Box,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",gap:.5,children:[jsxRuntimeExports.jsxs(Box,{display:"flex",flexDirection:"row",gap:.5,children:[jsxRuntimeExports.jsx(IconButton,{size:"small",onClick:()=>p(H),"aria-label":"mover arriba",children:jsxRuntimeExports.jsx(ArrowUpwardIcon,{fontSize:"small",sx:{color:"#007bff"}})}),jsxRuntimeExports.jsx(IconButton,{size:"small",onClick:()=>_(H),"aria-label":"mover abajo",children:jsxRuntimeExports.jsx(ArrowDownwardIcon,{fontSize:"small",sx:{color:"#007bff"}})})]}),jsxRuntimeExports.jsxs(Box,{display:"flex",flexDirection:"row",gap:.5,children:[jsxRuntimeExports.jsx(IconButton,{size:"small",onClick:()=>E(H),"aria-label":"duplicar fila",children:jsxRuntimeExports.jsx(ContentCopyIcon,{fontSize:"small",sx:{color:"green"}})}),jsxRuntimeExports.jsx(IconButton,{size:"small",onClick:()=>g(H),"aria-label":"borrar fila",children:jsxRuntimeExports.jsx(DeleteIcon,{fontSize:"small",sx:{color:"red"}})})]})]})})]},H))})]})})})},fuchsiaColor$1="#D100D1",BottomMenuResponsive=({handleImportar:t,handleExport:e,handleOpenMapaModal:r,handleRecalculate:n,handleClose:i})=>{useLocation();const[s,a]=reactExports.useState(0),[o,c]=reactExports.useState(!1);reactExports.useEffect(()=>{try{const h=JSON.parse(sessionStorage.getItem("excelData"));c((h==null?void 0:h.Coordenadas)!==void 0&&(h==null?void 0:h.Coordenadas)!==null)}catch(h){c(!1)}},[]);const u=[{label:"Importar",icon:jsxRuntimeExports.jsx(CloudUploadIcon,{}),onClick:t},{label:"Exportar",icon:jsxRuntimeExports.jsx(CloudDownloadIcon,{}),onClick:e},...o?[{label:"UbicaciÃ³n",icon:jsxRuntimeExports.jsx(MapIcon,{}),onClick:r}]:[],{label:"Recalcular",icon:jsxRuntimeExports.jsx(CalculateIcon,{}),onClick:n},{label:"Cerrar",icon:jsxRuntimeExports.jsx(CloseIcon,{}),onClick:i}];return jsxRuntimeExports.jsx(BottomNavigation,{value:s,onChange:(h,f)=>{var m;a(f),(m=u[f])==null||m.onClick()},showLabels:!0,sx:{width:"100%",position:"fixed",bottom:0,bgcolor:"#fff",borderTop:"1px solid #ddd",zIndex:2e3,boxShadow:"0 -2px 8px rgba(0,0,0,0.1)"},children:u.map(({label:h,icon:f},m)=>jsxRuntimeExports.jsx(BottomNavigationAction,{label:h,icon:f,sx:{color:s===m?fuchsiaColor$1:"gray","&.Mui-selected":{color:fuchsiaColor$1}}},h))})},LargeTableWarning=({columns:t,data:e})=>jsxRuntimeExports.jsxs(Box,{sx:{mt:2,p:3,textAlign:"center"},children:[jsxRuntimeExports.jsx(TableContainer,{component:Paper,sx:{mb:2},children:jsxRuntimeExports.jsxs(Table,{size:"small",children:[jsxRuntimeExports.jsx(TableHead,{children:jsxRuntimeExports.jsx(TableRow,{children:t.map(r=>jsxRuntimeExports.jsx(TableCell,{sx:{fontWeight:"bold",textAlign:"center"},children:r.Header},r.accessor))})}),jsxRuntimeExports.jsx(TableBody,{children:e.slice(0,4).map((r,n)=>jsxRuntimeExports.jsx(TableRow,{children:r.map((i,s)=>jsxRuntimeExports.jsx(TableCell,{children:i},s))},n))})]})}),jsxRuntimeExports.jsx(MoreVertIcon,{sx:{color:"gray"}}),jsxRuntimeExports.jsx(Box,{sx:{fontWeight:"bold",color:"gray",mt:1},children:"editar offline"}),jsxRuntimeExports.jsxs(List,{dense:!0,sx:{color:"red",mt:2,textAlign:"left",display:"inline-block"},children:[jsxRuntimeExports.jsx(ListItem,{children:jsxRuntimeExports.jsx(ListItemText,{primary:"* Esta hoja es muy larga y no puede editarse directamente en la aplicaciÃ³n."})}),jsxRuntimeExports.jsx(ListItem,{children:jsxRuntimeExports.jsx(ListItemText,{primary:"* Puedes exportarla, editarla externamente, e importarla."})}),jsxRuntimeExports.jsx(ListItem,{children:jsxRuntimeExports.jsx(ListItemText,{primary:"* Se debe mantener la estructura de la hoja, los nombres del cabecero, etc., cambiar solo los valores y la fecha."})})]})]}),ExcelUploaderStorage=({openx:t,cerrarModalx:e,handleRecalculate:r})=>{const[n,i]=reactExports.useState(0),[s,a]=reactExports.useState(!1),[o,c]=reactExports.useState(null),[u,h]=reactExports.useState(null),[f,m]=reactExports.useState({open:!1,data:null,rowIndex:null,cellIndex:null,sheetName:null,storageKey:"excelData"}),[E,g]=reactExports.useState(null),[p,_]=reactExports.useState(0),A=useMediaQuery("(max-width: 600px)"),H=()=>{const R=sessionStorage.getItem("excelData");R&&c(JSON.parse(R))};reactExports.useEffect(()=>{H()},[t,p]),reactExports.useEffect(()=>{if(o){const R=Object.keys(o).filter(Y=>Y!=="Coordenadas");n>=R.length&&i(0)}},[o]);const te=(R,Y)=>i(Y),ne=()=>a(!0),j=()=>a(!1),ee=R=>{if(!R)return;sessionStorage.removeItem("excelData"),c(null);const Y=new FileReader;Y.onload=q=>{const me=new Uint8Array(q.target.result),xe=readSync(me,{type:"array"}),Ee={};xe.SheetNames.forEach(se=>{const ae=utils.sheet_to_json(xe.Sheets[se],{header:1}).map(_e=>_e.map(oe=>oe==null?" ":typeof oe=="string"&&!isNaN(oe)&&oe.trim()!==""?Number(oe):oe)).filter(_e=>_e.some(oe=>oe!==""));Ee[se]=ae}),sessionStorage.setItem("excelData",JSON.stringify(Ee)),c(Ee),_(se=>se+1),y.success("Â¡Archivo cargado correctamente!")},Y.readAsArrayBuffer(R)},x=()=>{const R=JSON.parse(sessionStorage.getItem("selectedFicha")||"null");if(!R||!R.cod){y.error("No se encontrÃ³ el cÃ³digo de referencia para validar el archivo.");return}const Y=document.createElement("input");Y.type="file",Y.accept=".xlsx, .xls",Y.style.display="none",Y.addEventListener("change",q=>{const me=q.target.files[0];if(!me||!me.name.toLowerCase().includes(R.cod.toLowerCase())){y.error(`El archivo debe ser 'WB_${R.cod}_******** '.`),document.body.removeChild(Y);return}ee(me),document.body.removeChild(Y)}),document.body.appendChild(Y),Y.click()},M=()=>{const R=JSON.parse(sessionStorage.getItem("excelData")),Y=utils.book_new(),q=se=>{if(!isNaN(se)&&se!==null&&se!==""){const Fe=Number(se);return isFinite(Fe)?Fe:se}return se};Object.keys(R).forEach(se=>{const Fe=R[se].map(ae=>ae.map(_e=>q(_e))),ue=utils.aoa_to_sheet(Fe);utils.book_append_sheet(Y,ue,se)});const me=JSON.parse(sessionStorage.getItem("selectedFicha")||"null"),xe=new Date().toISOString().slice(0,10),Ee=`Vatiaco_${(me==null?void 0:me.cod)||"Export"}_${xe}.xlsx`;writeFileSync(Y,Ee)},T=()=>{const R=JSON.parse(sessionStorage.getItem("excelData")),Y=Er({},R),q=[...Y[f.sheetName]],me=q[f.rowIndex+1][f.cellIndex];let xe;try{xe=typeof me=="string"?JSON.parse(me):me}catch(se){xe={}}const Ee={};Object.keys(xe).forEach(se=>{Ee[se]=E[se]!==void 0?E[se]:xe[se]}),q[f.rowIndex+1][f.cellIndex]=JSON.stringify(Ee),Y[f.sheetName]=q,sessionStorage.setItem("excelData",JSON.stringify(Y)),c(Y),m(Br(Er({},f),{open:!1,data:Ee})),_(se=>se+1)},O=()=>{const R=JSON.parse(sessionStorage.getItem("excelData"));c(R),_(Y=>Y+1)};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(Drawer,{anchor:"left",open:t,onClose:e,transitionDuration:300,PaperProps:{sx:{width:"99%",height:"calc(100% - 110px)",borderRadius:A?"16px 16px 0 0":0,top:A?"auto":"55px",bottom:A?"auto":"55px",margin:A?"auto":0,boxShadow:A?"0px -5px 20px rgba(0,0,0,0.3)":"none",p:1,position:"fixed",overflow:"hidden"}},ModalProps:{sx:{zIndex:1300}},children:[jsxRuntimeExports.jsx(IconButton,{onClick:e,sx:{position:"absolute",top:8,right:22,zIndex:1500,backgroundColor:"rgba(0,0,0,0.1)","&:hover":{backgroundColor:"rgba(0,0,0,0.2)"},width:40,height:40},children:jsxRuntimeExports.jsx(CloseIcon,{fontSize:"medium"})}),jsxRuntimeExports.jsx(BottomMenuResponsive,{isMobile:A,handleImportar:x,handleExport:M,handleOpenMapaModal:ne,handleRecalculate:r,handleClose:e}),o&&jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",flexDirection:"column",height:"100%",width:"100%"},children:[jsxRuntimeExports.jsx(Box,{sx:{overflowX:"auto",borderBottom:1,borderColor:"divider",flexShrink:0},children:jsxRuntimeExports.jsx(Tabs,{value:n,onChange:te,variant:"scrollable",scrollButtons:"auto",sx:{minHeight:48,"& .MuiTab-root":{minWidth:100,fontSize:"0.8rem",px:1,py:1.5,maxWidth:"150px"}},children:Object.keys(o).filter(R=>R!=="Coordenadas").map((R,Y)=>jsxRuntimeExports.jsx(Tab,{label:R.length>15?`${R.substring(0,12)}...`:R},Y))})}),jsxRuntimeExports.jsx(Box,{sx:{flex:1,overflowX:"auto",overflowY:"auto",p:.5,"&::-webkit-scrollbar":{width:"8px",height:"8px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#bdbdbd",borderRadius:"4px"},"&::-webkit-scrollbar-thumb:hover":{backgroundColor:"#9e9e9e"}},children:(()=>{var Ee;const Y=Object.keys(o).filter(se=>se!=="Coordenadas")[n],q=o[Y]||[],me=((Ee=q[0])==null?void 0:Ee.map((se,Fe)=>`C${Fe+1}`))||[];return q.length>100?jsxRuntimeExports.jsx(LargeTableWarning,{columns:me,data:q.slice(0,3),isMobile:!0}):jsxRuntimeExports.jsxs(Box,{sx:{minWidth:"100%",width:"max-content",border:"2px solid #e0e0e0",borderRadius:"8px",backgroundColor:"background.paper",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column"},children:[jsxRuntimeExports.jsx(TableControls,{activeSheet:Y,editingCell:u,setEditingCell:h,handleOpenJsonPopup:(se,Fe,ue)=>{g(se),m({open:!0,data:se,rowIndex:Fe,cellIndex:ue,sheetName:Y,storageKey:"excelData"})},jsonPopup:f,setJsonPopup:m,refreshData:p,isMobile:!0,containerWidth:"100%",forceMobileLayout:!0}),q.length>6&&jsxRuntimeExports.jsx(Box,{sx:{textAlign:"center",py:.5,color:"text.secondary",fontSize:"0.7rem",background:"linear-gradient(transparent, #f5f5f5)"},children:"â¬…ï¸ Desliza para ver mÃ¡s datos âž¡ï¸"}),jsxRuntimeExports.jsxs(Box,{sx:{flexShrink:0,px:1,py:.5,backgroundColor:"primary.light",color:"white",fontSize:"0.7rem",borderRadius:"0 0 4px 4px",textAlign:"center"},children:[q.length," filas â€¢ ",me.length," columnas"]})]})})()})]})]}),jsxRuntimeExports.jsx(JsonEditorModal,{jsonPopup:f,setJsonPopup:m,localJsonData:E,setLocalJsonData:g,handleSaveJson:T,refreshParentData:O}),jsxRuntimeExports.jsx(MapaModal,{open:s,cerrarModal:j}),jsxRuntimeExports.jsx(Lt,{})]})};var pdf={exports:{}},path2dPolyfill_esm={},hasRequiredPath2dPolyfill_esm;function requirePath2dPolyfill_esm(){if(hasRequiredPath2dPolyfill_esm)return path2dPolyfill_esm;hasRequiredPath2dPolyfill_esm=1;function t(g,p,_){for(var A=0,H=p.length,te;A<H;A++)(te||!(A in p))&&(te||(te=Array.prototype.slice.call(p,0,A)),te[A]=p[A]);return g.concat(te||Array.prototype.slice.call(p))}var e={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},r=/([astvzqmhlc])([^astvzqmhlc]*)/gi,n=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;function i(g){var p=g.match(n);return p?p.map(Number):[]}function s(g){var p=[],_=String(g).trim();return _[0]!=="M"&&_[0]!=="m"||_.replace(r,function(A,H,te){var ne=i(te),j=H.toLowerCase(),ee=H;if(j==="m"&&ne.length>2&&(p.push(t([ee],ne.splice(0,2))),j="l",ee=ee==="m"?"l":"L"),ne.length<e[j])return"";for(p.push(t([ee],ne.splice(0,e[j])));ne.length>=e[j]&&ne.length&&e[j];)p.push(t([ee],ne.splice(0,e[j])));return""}),p}function a(g,p){var _=g.x*Math.cos(p)-g.y*Math.sin(p),A=g.y*Math.cos(p)+g.x*Math.sin(p);g.x=_,g.y=A}function o(g,p,_){g.x+=p,g.y+=_}function c(g,p){g.x*=p,g.y*=p}var u=function(){function g(p){var _;this.commands=[],p&&p instanceof g?(_=this.commands).push.apply(_,p.commands):p&&(this.commands=s(p))}return g.prototype.addPath=function(p){var _;p&&p instanceof g&&(_=this.commands).push.apply(_,p.commands)},g.prototype.moveTo=function(p,_){this.commands.push(["M",p,_])},g.prototype.lineTo=function(p,_){this.commands.push(["L",p,_])},g.prototype.arc=function(p,_,A,H,te,ne){this.commands.push(["AC",p,_,A,H,te,!!ne])},g.prototype.arcTo=function(p,_,A,H,te){this.commands.push(["AT",p,_,A,H,te])},g.prototype.ellipse=function(p,_,A,H,te,ne,j,ee){this.commands.push(["E",p,_,A,H,te,ne,j,!!ee])},g.prototype.closePath=function(){this.commands.push(["Z"])},g.prototype.bezierCurveTo=function(p,_,A,H,te,ne){this.commands.push(["C",p,_,A,H,te,ne])},g.prototype.quadraticCurveTo=function(p,_,A,H){this.commands.push(["Q",p,_,A,H])},g.prototype.rect=function(p,_,A,H){this.commands.push(["R",p,_,A,H])},g.prototype.roundRect=function(p,_,A,H,te){typeof te=="undefined"?this.commands.push(["RR",p,_,A,H,0]):this.commands.push(["RR",p,_,A,H,te])},g}();function h(g,p){var _=0,A=0,H,te,ne,j,ee,x,M,T,O,R,Y,q,me,xe,Ee,se,Fe,ue,ae,_e,oe,ie=null,re=null,ce=null,fe=null,pe=null,ve=null;g.beginPath();for(var Ae=0;Ae<p.length;++Ae){ue=p[Ae][0],ue!=="S"&&ue!=="s"&&ue!=="C"&&ue!=="c"&&(ie=null,re=null),ue!=="T"&&ue!=="t"&&ue!=="Q"&&ue!=="q"&&(ce=null,fe=null);var be=void 0;switch(ue){case"m":case"M":be=p[Ae],ue==="m"?(_+=be[1],A+=be[2]):(_=be[1],A=be[2]),(ue==="M"||!pe)&&(pe={x:_,y:A}),g.moveTo(_,A);break;case"l":be=p[Ae],_+=be[1],A+=be[2],g.lineTo(_,A);break;case"L":be=p[Ae],_=be[1],A=be[2],g.lineTo(_,A);break;case"H":be=p[Ae],_=be[1],g.lineTo(_,A);break;case"h":be=p[Ae],_+=be[1],g.lineTo(_,A);break;case"V":be=p[Ae],A=be[1],g.lineTo(_,A);break;case"v":be=p[Ae],A+=be[1],g.lineTo(_,A);break;case"a":case"A":if(be=p[Ae],ve===null)throw new Error("This should never happen");ue==="a"?(_+=be[6],A+=be[7]):(_=be[6],A=be[7]),xe=be[1],Ee=be[2],M=be[3]*Math.PI/180,ne=!!be[4],j=!!be[5],ee={x:_,y:A},x={x:(ve.x-ee.x)/2,y:(ve.y-ee.y)/2},a(x,-M),T=x.x*x.x/(xe*xe)+x.y*x.y/(Ee*Ee),T>1&&(T=Math.sqrt(T),xe*=T,Ee*=T),ae={x:xe*x.y/Ee,y:-(Ee*x.x)/xe},O=xe*xe*Ee*Ee,R=xe*xe*x.y*x.y+Ee*Ee*x.x*x.x,j!==ne?c(ae,Math.sqrt((O-R)/R)||0):c(ae,-Math.sqrt((O-R)/R)||0),te=Math.atan2((x.y-ae.y)/Ee,(x.x-ae.x)/xe),H=Math.atan2(-(x.y+ae.y)/Ee,-(x.x+ae.x)/xe),a(ae,M),o(ae,(ee.x+ve.x)/2,(ee.y+ve.y)/2),g.save(),g.translate(ae.x,ae.y),g.rotate(M),g.scale(xe,Ee),g.arc(0,0,1,te,H,!j),g.restore();break;case"C":be=p[Ae],ie=be[3],re=be[4],_=be[5],A=be[6],g.bezierCurveTo(be[1],be[2],ie,re,_,A);break;case"c":be=p[Ae],g.bezierCurveTo(be[1]+_,be[2]+A,be[3]+_,be[4]+A,be[5]+_,be[6]+A),ie=be[3]+_,re=be[4]+A,_+=be[5],A+=be[6];break;case"S":be=p[Ae],(ie===null||re===null)&&(ie=_,re=A),g.bezierCurveTo(2*_-ie,2*A-re,be[1],be[2],be[3],be[4]),ie=be[1],re=be[2],_=be[3],A=be[4];break;case"s":be=p[Ae],(ie===null||re===null)&&(ie=_,re=A),g.bezierCurveTo(2*_-ie,2*A-re,be[1]+_,be[2]+A,be[3]+_,be[4]+A),ie=be[1]+_,re=be[2]+A,_+=be[3],A+=be[4];break;case"Q":be=p[Ae],ce=be[1],fe=be[2],_=be[3],A=be[4],g.quadraticCurveTo(ce,fe,_,A);break;case"q":be=p[Ae],ce=be[1]+_,fe=be[2]+A,_+=be[3],A+=be[4],g.quadraticCurveTo(ce,fe,_,A);break;case"T":be=p[Ae],(ce===null||fe===null)&&(ce=_,fe=A),ce=2*_-ce,fe=2*A-fe,_=be[1],A=be[2],g.quadraticCurveTo(ce,fe,_,A);break;case"t":be=p[Ae],(ce===null||fe===null)&&(ce=_,fe=A),ce=2*_-ce,fe=2*A-fe,_+=be[1],A+=be[2],g.quadraticCurveTo(ce,fe,_,A);break;case"z":case"Z":pe&&(_=pe.x,A=pe.y),pe=null,g.closePath();break;case"AC":be=p[Ae],_=be[1],A=be[2],me=be[3],te=be[4],H=be[5],_e=be[6],g.arc(_,A,me,te,H,_e);break;case"AT":be=p[Ae],Y=be[1],q=be[2],_=be[3],A=be[4],me=be[5],g.arcTo(Y,q,_,A,me);break;case"E":be=p[Ae],_=be[1],A=be[2],xe=be[3],Ee=be[4],M=be[5],te=be[6],H=be[7],_e=be[8],g.save(),g.translate(_,A),g.rotate(M),g.scale(xe,Ee),g.arc(0,0,1,te,H,_e),g.restore();break;case"R":be=p[Ae],_=be[1],A=be[2],se=be[3],Fe=be[4],pe={x:_,y:A},g.rect(_,A,se,Fe);break;case"RR":be=p[Ae],_=be[1],A=be[2],se=be[3],Fe=be[4],oe=be[5],pe={x:_,y:A},g.roundRect(_,A,se,Fe,oe);break}ve?(ve.x=_,ve.y=A):ve={x:_,y:A}}}function f(g){if(!(!g||!g.CanvasRenderingContext2D||g.Path2D)){var p=g.CanvasRenderingContext2D,_=p.prototype.fill,A=p.prototype.stroke,H=p.prototype.isPointInPath;p.prototype.fill=function(){for(var ne=[],j=0;j<arguments.length;j++)ne[j]=arguments[j];if(ne[0]instanceof u){var ee=ne[0],x=ne[1]||"nonzero";h(this,ee.commands),_.apply(this,[x])}else{var x=ne[0]||"nonzero";return _.apply(this,[x])}},p.prototype.stroke=function(ne){ne&&h(this,ne.commands),A.apply(this)},p.prototype.isPointInPath=function(){for(var ne=[],j=0;j<arguments.length;j++)ne[j]=arguments[j];if(ne[0]instanceof u){var ee=ne[0],x=ne[1],M=ne[2],T=ne[3]||"nonzero";return h(this,ee.commands),H.apply(this,[x,M,T])}else return H.apply(this,ne)},g.Path2D=u}}function m(g,p,_,A,H){var te=this;if(H===void 0&&(H=0),typeof H=="number"&&(H=[H]),Array.isArray(H)){if(H.length===0||H.length>4)throw new RangeError("Failed to execute 'roundRect' on '".concat(this.constructor.name,"': ").concat(H.length," radii provided. Between one and four radii are necessary."));H.forEach(function(T){if(T<0)throw new RangeError("Failed to execute 'roundRect' on '".concat(te.constructor.name,"': Radius value ").concat(T," is negative."))})}else return;if(H.length===1&&H[0]===0)return this.rect(g,p,_,A);var ne=Math.min(_,A)/2,j,ee,x,M=j=ee=x=Math.min(ne,H[0]);H.length===2&&(j=x=Math.min(ne,H[1])),H.length===3&&(j=x=Math.min(ne,H[1]),ee=Math.min(ne,H[2])),H.length===4&&(j=Math.min(ne,H[1]),ee=Math.min(ne,H[2]),x=Math.min(ne,H[3])),this.moveTo(g,p+A-x),this.arcTo(g,p,g+M,p,M),this.arcTo(g+_,p,g+_,p+j,j),this.arcTo(g+_,p+A,g+_-ee,p+A,ee),this.arcTo(g,p+A,g,p+A-x,x),this.moveTo(g,p)}function E(g){if(!(!g||!g.CanvasRenderingContext2D)){var p=g.CanvasRenderingContext2D,_=g.Path2D;p&&!p.prototype.roundRect&&(p.prototype.roundRect=m),_&&!_.prototype.roundRect&&(_.prototype.roundRect=m)}}return f(window),E(window),path2dPolyfill_esm}var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,function(module,exports){(function(e,r){module.exports=e.pdfjsLib=r()})(globalThis,()=>(()=>{var __webpack_modules__=[,(t,e,r)=>{var Rr;Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationReplyType=e.AnnotationPrefix=e.AnnotationMode=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.assert=ae,e.bytesToString=Se,e.createValidAbsoluteUrl=oe,e.getModificationDate=xr,e.getUuid=wr,e.getVerbosityLevel=Ee,e.info=se,e.isArrayBuffer=tr,e.isArrayEqual=nr,e.isNodeJS=void 0,e.normalizeUnicode=mr,e.objectFromMap=We,e.objectSize=Je,e.setVerbosityLevel=xe,e.shadow=ie,e.string32=qe,e.stringToBytes=Xe,e.stringToPDFString=Jt,e.stringToUTF8String=Kt,e.unreachable=ue,e.utf8StringToString=Ze,e.warn=Fe,r(2),r(84),r(86),r(87),r(89),r(93),r(101),r(102),r(105),r(107),r(109),r(113),r(116),r(123);const n=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=n;const i=[1,0,0,1,0,0];e.IDENTITY_MATRIX=i;const s=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=s;const a=1e7;e.MAX_IMAGE_SIZE_TO_CACHE=a;const o=1.35;e.LINE_FACTOR=o;const c=.35;e.LINE_DESCENT_FACTOR=c;const u=c/o;e.BASELINE_FACTOR=u;const h={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=h;const f={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=f;const m="pdfjs_internal_editor_";e.AnnotationEditorPrefix=m;const E={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};e.AnnotationEditorType=E;const g={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};e.AnnotationEditorParamsType=g;const p={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=p;const _={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=_;const A={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=A;const H={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=H;const te={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=te;const ne={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=ne;const j={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=j;const ee={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=ee;const x={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=x;const M={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=M;const T={O:"PageOpen",C:"PageClose"};e.PageActionEventType=T;const O={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=O;const R={NONE:0,BINARY:1};e.CMapCompressionType=R;const Y={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=Y;const q={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=q;let me=O.WARNINGS;function xe(ar){Number.isInteger(ar)&&(me=ar)}function Ee(){return me}function se(ar){me>=O.INFOS&&console.log(`Info: ${ar}`)}function Fe(ar){me>=O.WARNINGS&&console.log(`Warning: ${ar}`)}function ue(ar){throw new Error(ar)}function ae(ar,it){ar||ue(it)}function _e(ar){switch(ar==null?void 0:ar.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function oe(ar){let it=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,ot=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!ar)return null;try{if(ot&&typeof ar=="string"){if(ot.addDefaultProtocol&&ar.startsWith("www.")){const Tr=ar.match(/\./g);(Tr==null?void 0:Tr.length)>=2&&(ar=`http://${ar}`)}if(ot.tryConvertEncoding)try{ar=Kt(ar)}catch(Tr){}}const gr=it?new URL(ar,it):new URL(ar);if(_e(gr))return gr}catch(gr){}return null}function ie(ar,it,ot){let gr=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return Object.defineProperty(ar,it,{value:ot,enumerable:!gr,configurable:!0,writable:!1}),ot}const re=function(){function it(ot,gr){this.constructor===it&&ue("Cannot initialize BaseException."),this.message=ot,this.name=gr}return it.prototype=new Error,it.constructor=it,it}();e.BaseException=re;class ce extends re{constructor(it,ot){super(it,"PasswordException"),this.code=ot}}e.PasswordException=ce;class fe extends re{constructor(it,ot){super(it,"UnknownErrorException"),this.details=ot}}e.UnknownErrorException=fe;class pe extends re{constructor(it){super(it,"InvalidPDFException")}}e.InvalidPDFException=pe;class ve extends re{constructor(it){super(it,"MissingPDFException")}}e.MissingPDFException=ve;class Ae extends re{constructor(it,ot){super(it,"UnexpectedResponseException"),this.status=ot}}e.UnexpectedResponseException=Ae;class be extends re{constructor(it){super(it,"FormatError")}}e.FormatError=be;class je extends re{constructor(it){super(it,"AbortException")}}e.AbortException=je;function Se(ar){(typeof ar!="object"||(ar==null?void 0:ar.length)===void 0)&&ue("Invalid argument for bytesToString");const it=ar.length,ot=8192;if(it<ot)return String.fromCharCode.apply(null,ar);const gr=[];for(let Tr=0;Tr<it;Tr+=ot){const Te=Math.min(Tr+ot,it),ze=ar.subarray(Tr,Te);gr.push(String.fromCharCode.apply(null,ze))}return gr.join("")}function Xe(ar){typeof ar!="string"&&ue("Invalid argument for stringToBytes");const it=ar.length,ot=new Uint8Array(it);for(let gr=0;gr<it;++gr)ot[gr]=ar.charCodeAt(gr)&255;return ot}function qe(ar){return String.fromCharCode(ar>>24&255,ar>>16&255,ar>>8&255,ar&255)}function Je(ar){return Object.keys(ar).length}function We(ar){const it=Object.create(null);for(const[ot,gr]of ar)it[ot]=gr;return it}function Ue(){const ar=new Uint8Array(4);return ar[0]=1,new Uint32Array(ar.buffer,0,1)[0]===1}function Ce(){try{return new Function(""),!0}catch(ar){return!1}}class Le{static get isLittleEndian(){return ie(this,"isLittleEndian",Ue())}static get isEvalSupported(){return ie(this,"isEvalSupported",Ce())}static get isOffscreenCanvasSupported(){return ie(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas!="undefined")}static get platform(){return typeof navigator=="undefined"?ie(this,"platform",{isWin:!1,isMac:!1}):ie(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var it,ot;return ie(this,"isCSSRoundSupported",(ot=(it=globalThis.CSS)==null?void 0:it.supports)==null?void 0:ot.call(it,"width: round(1.5px, 1px)"))}}e.FeatureTest=Le;const Ve=[...Array(256).keys()].map(ar=>ar.toString(16).padStart(2,"0"));class Ge{static makeHexColor(it,ot,gr){return`#${Ve[it]}${Ve[ot]}${Ve[gr]}`}static scaleMinMax(it,ot){let gr;it[0]?(it[0]<0&&(gr=ot[0],ot[0]=ot[1],ot[1]=gr),ot[0]*=it[0],ot[1]*=it[0],it[3]<0&&(gr=ot[2],ot[2]=ot[3],ot[3]=gr),ot[2]*=it[3],ot[3]*=it[3]):(gr=ot[0],ot[0]=ot[2],ot[2]=gr,gr=ot[1],ot[1]=ot[3],ot[3]=gr,it[1]<0&&(gr=ot[2],ot[2]=ot[3],ot[3]=gr),ot[2]*=it[1],ot[3]*=it[1],it[2]<0&&(gr=ot[0],ot[0]=ot[1],ot[1]=gr),ot[0]*=it[2],ot[1]*=it[2]),ot[0]+=it[4],ot[1]+=it[4],ot[2]+=it[5],ot[3]+=it[5]}static transform(it,ot){return[it[0]*ot[0]+it[2]*ot[1],it[1]*ot[0]+it[3]*ot[1],it[0]*ot[2]+it[2]*ot[3],it[1]*ot[2]+it[3]*ot[3],it[0]*ot[4]+it[2]*ot[5]+it[4],it[1]*ot[4]+it[3]*ot[5]+it[5]]}static applyTransform(it,ot){const gr=it[0]*ot[0]+it[1]*ot[2]+ot[4],Tr=it[0]*ot[1]+it[1]*ot[3]+ot[5];return[gr,Tr]}static applyInverseTransform(it,ot){const gr=ot[0]*ot[3]-ot[1]*ot[2],Tr=(it[0]*ot[3]-it[1]*ot[2]+ot[2]*ot[5]-ot[4]*ot[3])/gr,Te=(-it[0]*ot[1]+it[1]*ot[0]+ot[4]*ot[1]-ot[5]*ot[0])/gr;return[Tr,Te]}static getAxialAlignedBoundingBox(it,ot){const gr=this.applyTransform(it,ot),Tr=this.applyTransform(it.slice(2,4),ot),Te=this.applyTransform([it[0],it[3]],ot),ze=this.applyTransform([it[2],it[1]],ot);return[Math.min(gr[0],Tr[0],Te[0],ze[0]),Math.min(gr[1],Tr[1],Te[1],ze[1]),Math.max(gr[0],Tr[0],Te[0],ze[0]),Math.max(gr[1],Tr[1],Te[1],ze[1])]}static inverseTransform(it){const ot=it[0]*it[3]-it[1]*it[2];return[it[3]/ot,-it[1]/ot,-it[2]/ot,it[0]/ot,(it[2]*it[5]-it[4]*it[3])/ot,(it[4]*it[1]-it[5]*it[0])/ot]}static singularValueDecompose2dScale(it){const ot=[it[0],it[2],it[1],it[3]],gr=it[0]*ot[0]+it[1]*ot[2],Tr=it[0]*ot[1]+it[1]*ot[3],Te=it[2]*ot[0]+it[3]*ot[2],ze=it[2]*ot[1]+it[3]*ot[3],zt=(gr+ze)/2,ir=Math.sqrt(Vs(gr+ze,2)-4*(gr*ze-Te*Tr))/2,cr=zt+ir||1,or=zt-ir||1;return[Math.sqrt(cr),Math.sqrt(or)]}static normalizeRect(it){const ot=it.slice(0);return it[0]>it[2]&&(ot[0]=it[2],ot[2]=it[0]),it[1]>it[3]&&(ot[1]=it[3],ot[3]=it[1]),ot}static intersect(it,ot){const gr=Math.max(Math.min(it[0],it[2]),Math.min(ot[0],ot[2])),Tr=Math.min(Math.max(it[0],it[2]),Math.max(ot[0],ot[2]));if(gr>Tr)return null;const Te=Math.max(Math.min(it[1],it[3]),Math.min(ot[1],ot[3])),ze=Math.min(Math.max(it[1],it[3]),Math.max(ot[1],ot[3]));return Te>ze?null:[gr,Te,Tr,ze]}static bezierBoundingBox(it,ot,gr,Tr,Te,ze,zt,ir){const cr=[],or=[[],[]];let ke,Oe,He,$e,St,$t,Yt,_r;for(let Re=0;Re<2;++Re){if(Re===0?(Oe=6*it-12*gr+6*Te,ke=-3*it+9*gr-9*Te+3*zt,He=3*gr-3*it):(Oe=6*ot-12*Tr+6*ze,ke=-3*ot+9*Tr-9*ze+3*ir,He=3*Tr-3*ot),Math.abs(ke)<1e-12){if(Math.abs(Oe)<1e-12)continue;$e=-He/Oe,0<$e&&$e<1&&cr.push($e);continue}Yt=Oe*Oe-4*He*ke,_r=Math.sqrt(Yt),!(Yt<0)&&(St=(-Oe+_r)/(2*ke),0<St&&St<1&&cr.push(St),$t=(-Oe-_r)/(2*ke),0<$t&&$t<1&&cr.push($t))}let sr=cr.length,ye;const De=sr;for(;sr--;)$e=cr[sr],ye=1-$e,or[0][sr]=ye*ye*ye*it+3*ye*ye*$e*gr+3*ye*$e*$e*Te+$e*$e*$e*zt,or[1][sr]=ye*ye*ye*ot+3*ye*ye*$e*Tr+3*ye*$e*$e*ze+$e*$e*$e*ir;return or[0][De]=it,or[1][De]=ot,or[0][De+1]=zt,or[1][De+1]=ir,or[0].length=or[1].length=De+2,[Math.min(...or[0]),Math.min(...or[1]),Math.max(...or[0]),Math.max(...or[1])]}}e.Util=Ge;const ut=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Jt(ar){if(ar[0]>="Ã¯"){let ot;if(ar[0]==="Ã¾"&&ar[1]==="Ã¿"?ot="utf-16be":ar[0]==="Ã¿"&&ar[1]==="Ã¾"?ot="utf-16le":ar[0]==="Ã¯"&&ar[1]==="Â»"&&ar[2]==="Â¿"&&(ot="utf-8"),ot)try{const gr=new TextDecoder(ot,{fatal:!0}),Tr=Xe(ar);return gr.decode(Tr)}catch(gr){Fe(`stringToPDFString: "${gr}".`)}}const it=[];for(let ot=0,gr=ar.length;ot<gr;ot++){const Tr=ut[ar.charCodeAt(ot)];it.push(Tr?String.fromCharCode(Tr):ar.charAt(ot))}return it.join("")}function Kt(ar){return decodeURIComponent(escape(ar))}function Ze(ar){return unescape(encodeURIComponent(ar))}function tr(ar){return typeof ar=="object"&&(ar==null?void 0:ar.byteLength)!==void 0}function nr(ar,it){if(ar.length!==it.length)return!1;for(let ot=0,gr=ar.length;ot<gr;ot++)if(ar[ot]!==it[ot])return!1;return!0}function xr(){let ar=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Date;return[ar.getUTCFullYear().toString(),(ar.getUTCMonth()+1).toString().padStart(2,"0"),ar.getUTCDate().toString().padStart(2,"0"),ar.getUTCHours().toString().padStart(2,"0"),ar.getUTCMinutes().toString().padStart(2,"0"),ar.getUTCSeconds().toString().padStart(2,"0")].join("")}class pr{constructor(){ct(this,Rr,!1);this.promise=new Promise((it,ot)=>{this.resolve=gr=>{ft(this,Rr,!0),it(gr)},this.reject=gr=>{ft(this,Rr,!0),ot(gr)}})}get settled(){return de(this,Rr)}}Rr=new WeakMap,e.PromiseCapability=pr;let vr=null,lr=null;function mr(ar){return vr||(vr=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,lr=new Map([["ï¬…","Å¿t"]])),ar.replaceAll(vr,(it,ot,gr)=>ot?ot.normalize("NFKC"):lr.get(gr))}function wr(){if(typeof crypto!="undefined"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const ar=new Uint8Array(32);if(typeof crypto!="undefined"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(ar);else for(let it=0;it<32;it++)ar[it]=Math.floor(Math.random()*255);return Se(ar)}const Cr="pdfjs_internal_id_";e.AnnotationPrefix=Cr},(t,e,r)=>{var n=r(3),i=r(4),s=r(69),a=r(70),o="WebAssembly",c=i[o],u=Error("e",{cause:7}).cause!==7,h=function(m,E){var g={};g[m]=a(m,E,u),n({global:!0,constructor:!0,arity:1,forced:u},g)},f=function(m,E){if(c&&c[m]){var g={};g[m]=a(o+"."+m,E,u),n({target:o,stat:!0,constructor:!0,arity:1,forced:u},g)}};h("Error",function(m){return function(g){return s(m,this,arguments)}}),h("EvalError",function(m){return function(g){return s(m,this,arguments)}}),h("RangeError",function(m){return function(g){return s(m,this,arguments)}}),h("ReferenceError",function(m){return function(g){return s(m,this,arguments)}}),h("SyntaxError",function(m){return function(g){return s(m,this,arguments)}}),h("TypeError",function(m){return function(g){return s(m,this,arguments)}}),h("URIError",function(m){return function(g){return s(m,this,arguments)}}),f("CompileError",function(m){return function(g){return s(m,this,arguments)}}),f("LinkError",function(m){return function(g){return s(m,this,arguments)}}),f("RuntimeError",function(m){return function(g){return s(m,this,arguments)}})},(t,e,r)=>{var n=r(4),i=r(5).f,s=r(44),a=r(48),o=r(38),c=r(56),u=r(68);t.exports=function(h,f){var m=h.target,E=h.global,g=h.stat,p,_,A,H,te,ne;if(E?_=n:g?_=n[m]||o(m,{}):_=(n[m]||{}).prototype,_)for(A in f){if(te=f[A],h.dontCallGetSet?(ne=i(_,A),H=ne&&ne.value):H=_[A],p=u(E?A:m+(g?".":"#")+A,h.forced),!p&&H!==void 0){if(typeof te==typeof H)continue;c(te,H)}(h.sham||H&&H.sham)&&s(te,"sham",!0),a(_,A,te,h)}}},function(t){var e=function(r){return r&&r.Math===Math&&r};t.exports=e(typeof globalThis=="object"&&globalThis)||e(typeof window=="object"&&window)||e(typeof self=="object"&&self)||e(typeof commonjsGlobal$2=="object"&&commonjsGlobal$2)||function(){return this}()||this||Function("return this")()},(t,e,r)=>{var n=r(6),i=r(8),s=r(10),a=r(11),o=r(12),c=r(18),u=r(39),h=r(42),f=Object.getOwnPropertyDescriptor;e.f=n?f:function(E,g){if(E=o(E),g=c(g),h)try{return f(E,g)}catch(p){}if(u(E,g))return a(!i(s.f,E,g),E[g])}},(t,e,r)=>{var n=r(7);t.exports=!n(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},t=>{t.exports=function(e){try{return!!e()}catch(r){return!0}}},(t,e,r)=>{var n=r(9),i=Function.prototype.call;t.exports=n?i.bind(i):function(){return i.apply(i,arguments)}},(t,e,r)=>{var n=r(7);t.exports=!n(function(){var i=function(){}.bind();return typeof i!="function"||i.hasOwnProperty("prototype")})},(t,e)=>{var r={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,i=n&&!r.call({1:2},1);e.f=i?function(a){var o=n(this,a);return!!o&&o.enumerable}:r},t=>{t.exports=function(e,r){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:r}}},(t,e,r)=>{var n=r(13),i=r(16);t.exports=function(s){return n(i(s))}},(t,e,r)=>{var n=r(14),i=r(7),s=r(15),a=Object,o=n("".split);t.exports=i(function(){return!a("z").propertyIsEnumerable(0)})?function(c){return s(c)==="String"?o(c,""):a(c)}:a},(t,e,r)=>{var n=r(9),i=Function.prototype,s=i.call,a=n&&i.bind.bind(s,s);t.exports=n?a:function(o){return function(){return s.apply(o,arguments)}}},(t,e,r)=>{var n=r(14),i=n({}.toString),s=n("".slice);t.exports=function(a){return s(i(a),8,-1)}},(t,e,r)=>{var n=r(17),i=TypeError;t.exports=function(s){if(n(s))throw i("Can't call method on "+s);return s}},t=>{t.exports=function(e){return e==null}},(t,e,r)=>{var n=r(19),i=r(23);t.exports=function(s){var a=n(s,"string");return i(a)?a:a+""}},(t,e,r)=>{var n=r(8),i=r(20),s=r(23),a=r(30),o=r(33),c=r(34),u=TypeError,h=c("toPrimitive");t.exports=function(f,m){if(!i(f)||s(f))return f;var E=a(f,h),g;if(E){if(m===void 0&&(m="default"),g=n(E,f,m),!i(g)||s(g))return g;throw u("Can't convert object to primitive value")}return m===void 0&&(m="number"),o(f,m)}},(t,e,r)=>{var n=r(21),i=r(22),s=i.all;t.exports=i.IS_HTMLDDA?function(a){return typeof a=="object"?a!==null:n(a)||a===s}:function(a){return typeof a=="object"?a!==null:n(a)}},(t,e,r)=>{var n=r(22),i=n.all;t.exports=n.IS_HTMLDDA?function(s){return typeof s=="function"||s===i}:function(s){return typeof s=="function"}},t=>{var e=typeof document=="object"&&document.all,r=typeof e=="undefined"&&e!==void 0;t.exports={all:e,IS_HTMLDDA:r}},(t,e,r)=>{var n=r(24),i=r(21),s=r(25),a=r(26),o=Object;t.exports=a?function(c){return typeof c=="symbol"}:function(c){var u=n("Symbol");return i(u)&&s(u.prototype,o(c))}},(t,e,r)=>{var n=r(4),i=r(21),s=function(a){return i(a)?a:void 0};t.exports=function(a,o){return arguments.length<2?s(n[a]):n[a]&&n[a][o]}},(t,e,r)=>{var n=r(14);t.exports=n({}.isPrototypeOf)},(t,e,r)=>{var n=r(27);t.exports=n&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},(t,e,r)=>{var n=r(28),i=r(7),s=r(4),a=s.String;t.exports=!!Object.getOwnPropertySymbols&&!i(function(){var o=Symbol("symbol detection");return!a(o)||!(Object(o)instanceof Symbol)||!Symbol.sham&&n&&n<41})},(t,e,r)=>{var n=r(4),i=r(29),s=n.process,a=n.Deno,o=s&&s.versions||a&&a.version,c=o&&o.v8,u,h;c&&(u=c.split("."),h=u[0]>0&&u[0]<4?1:+(u[0]+u[1])),!h&&i&&(u=i.match(/Edge\/(\d+)/),(!u||u[1]>=74)&&(u=i.match(/Chrome\/(\d+)/),u&&(h=+u[1]))),t.exports=h},t=>{t.exports=typeof navigator!="undefined"&&String(navigator.userAgent)||""},(t,e,r)=>{var n=r(31),i=r(17);t.exports=function(s,a){var o=s[a];return i(o)?void 0:n(o)}},(t,e,r)=>{var n=r(21),i=r(32),s=TypeError;t.exports=function(a){if(n(a))return a;throw s(i(a)+" is not a function")}},t=>{var e=String;t.exports=function(r){try{return e(r)}catch(n){return"Object"}}},(t,e,r)=>{var n=r(8),i=r(21),s=r(20),a=TypeError;t.exports=function(o,c){var u,h;if(c==="string"&&i(u=o.toString)&&!s(h=n(u,o))||i(u=o.valueOf)&&!s(h=n(u,o))||c!=="string"&&i(u=o.toString)&&!s(h=n(u,o)))return h;throw a("Can't convert object to primitive value")}},(t,e,r)=>{var n=r(4),i=r(35),s=r(39),a=r(41),o=r(27),c=r(26),u=n.Symbol,h=i("wks"),f=c?u.for||u:u&&u.withoutSetter||a;t.exports=function(m){return s(h,m)||(h[m]=o&&s(u,m)?u[m]:f("Symbol."+m)),h[m]}},(t,e,r)=>{var n=r(36),i=r(37);(t.exports=function(s,a){return i[s]||(i[s]=a!==void 0?a:{})})("versions",[]).push({version:"3.32.2",mode:n?"pure":"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.32.2/LICENSE",source:"https://github.com/zloirock/core-js"})},t=>{t.exports=!1},(t,e,r)=>{var n=r(4),i=r(38),s="__core-js_shared__",a=n[s]||i(s,{});t.exports=a},(t,e,r)=>{var n=r(4),i=Object.defineProperty;t.exports=function(s,a){try{i(n,s,{value:a,configurable:!0,writable:!0})}catch(o){n[s]=a}return a}},(t,e,r)=>{var n=r(14),i=r(40),s=n({}.hasOwnProperty);t.exports=Object.hasOwn||function(o,c){return s(i(o),c)}},(t,e,r)=>{var n=r(16),i=Object;t.exports=function(s){return i(n(s))}},(t,e,r)=>{var n=r(14),i=0,s=Math.random(),a=n(1 .toString);t.exports=function(o){return"Symbol("+(o===void 0?"":o)+")_"+a(++i+s,36)}},(t,e,r)=>{var n=r(6),i=r(7),s=r(43);t.exports=!n&&!i(function(){return Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a!==7})},(t,e,r)=>{var n=r(4),i=r(20),s=n.document,a=i(s)&&i(s.createElement);t.exports=function(o){return a?s.createElement(o):{}}},(t,e,r)=>{var n=r(6),i=r(45),s=r(11);t.exports=n?function(a,o,c){return i.f(a,o,s(1,c))}:function(a,o,c){return a[o]=c,a}},(t,e,r)=>{var n=r(6),i=r(42),s=r(46),a=r(47),o=r(18),c=TypeError,u=Object.defineProperty,h=Object.getOwnPropertyDescriptor,f="enumerable",m="configurable",E="writable";e.f=n?s?function(p,_,A){if(a(p),_=o(_),a(A),typeof p=="function"&&_==="prototype"&&"value"in A&&E in A&&!A[E]){var H=h(p,_);H&&H[E]&&(p[_]=A.value,A={configurable:m in A?A[m]:H[m],enumerable:f in A?A[f]:H[f],writable:!1})}return u(p,_,A)}:u:function(p,_,A){if(a(p),_=o(_),a(A),i)try{return u(p,_,A)}catch(H){}if("get"in A||"set"in A)throw c("Accessors not supported");return"value"in A&&(p[_]=A.value),p}},(t,e,r)=>{var n=r(6),i=r(7);t.exports=n&&i(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},(t,e,r)=>{var n=r(20),i=String,s=TypeError;t.exports=function(a){if(n(a))return a;throw s(i(a)+" is not an object")}},(t,e,r)=>{var n=r(21),i=r(45),s=r(49),a=r(38);t.exports=function(o,c,u,h){h||(h={});var f=h.enumerable,m=h.name!==void 0?h.name:c;if(n(u)&&s(u,m,h),h.global)f?o[c]=u:a(c,u);else{try{h.unsafe?o[c]&&(f=!0):delete o[c]}catch(E){}f?o[c]=u:i.f(o,c,{value:u,enumerable:!1,configurable:!h.nonConfigurable,writable:!h.nonWritable})}return o}},(t,e,r)=>{var n=r(14),i=r(7),s=r(21),a=r(39),o=r(6),c=r(50).CONFIGURABLE,u=r(51),h=r(52),f=h.enforce,m=h.get,E=String,g=Object.defineProperty,p=n("".slice),_=n("".replace),A=n([].join),H=o&&!i(function(){return g(function(){},"length",{value:8}).length!==8}),te=String(String).split("String"),ne=t.exports=function(j,ee,x){p(E(ee),0,7)==="Symbol("&&(ee="["+_(E(ee),/^Symbol\(([^)]*)\)/,"$1")+"]"),x&&x.getter&&(ee="get "+ee),x&&x.setter&&(ee="set "+ee),(!a(j,"name")||c&&j.name!==ee)&&(o?g(j,"name",{value:ee,configurable:!0}):j.name=ee),H&&x&&a(x,"arity")&&j.length!==x.arity&&g(j,"length",{value:x.arity});try{x&&a(x,"constructor")&&x.constructor?o&&g(j,"prototype",{writable:!1}):j.prototype&&(j.prototype=void 0)}catch(T){}var M=f(j);return a(M,"source")||(M.source=A(te,typeof ee=="string"?ee:"")),j};Function.prototype.toString=ne(function(){return s(this)&&m(this).source||u(this)},"toString")},(t,e,r)=>{var n=r(6),i=r(39),s=Function.prototype,a=n&&Object.getOwnPropertyDescriptor,o=i(s,"name"),c=o&&function(){}.name==="something",u=o&&(!n||n&&a(s,"name").configurable);t.exports={EXISTS:o,PROPER:c,CONFIGURABLE:u}},(t,e,r)=>{var n=r(14),i=r(21),s=r(37),a=n(Function.toString);i(s.inspectSource)||(s.inspectSource=function(o){return a(o)}),t.exports=s.inspectSource},(t,e,r)=>{var n=r(53),i=r(4),s=r(20),a=r(44),o=r(39),c=r(37),u=r(54),h=r(55),f="Object already initialized",m=i.TypeError,E=i.WeakMap,g,p,_,A=function(j){return _(j)?p(j):g(j,{})},H=function(j){return function(ee){var x;if(!s(ee)||(x=p(ee)).type!==j)throw m("Incompatible receiver, "+j+" required");return x}};if(n||c.state){var te=c.state||(c.state=new E);te.get=te.get,te.has=te.has,te.set=te.set,g=function(j,ee){if(te.has(j))throw m(f);return ee.facade=j,te.set(j,ee),ee},p=function(j){return te.get(j)||{}},_=function(j){return te.has(j)}}else{var ne=u("state");h[ne]=!0,g=function(j,ee){if(o(j,ne))throw m(f);return ee.facade=j,a(j,ne,ee),ee},p=function(j){return o(j,ne)?j[ne]:{}},_=function(j){return o(j,ne)}}t.exports={set:g,get:p,has:_,enforce:A,getterFor:H}},(t,e,r)=>{var n=r(4),i=r(21),s=n.WeakMap;t.exports=i(s)&&/native code/.test(String(s))},(t,e,r)=>{var n=r(35),i=r(41),s=n("keys");t.exports=function(a){return s[a]||(s[a]=i(a))}},t=>{t.exports={}},(t,e,r)=>{var n=r(39),i=r(57),s=r(5),a=r(45);t.exports=function(o,c,u){for(var h=i(c),f=a.f,m=s.f,E=0;E<h.length;E++){var g=h[E];!n(o,g)&&!(u&&n(u,g))&&f(o,g,m(c,g))}}},(t,e,r)=>{var n=r(24),i=r(14),s=r(58),a=r(67),o=r(47),c=i([].concat);t.exports=n("Reflect","ownKeys")||function(h){var f=s.f(o(h)),m=a.f;return m?c(f,m(h)):f}},(t,e,r)=>{var n=r(59),i=r(66),s=i.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(o){return n(o,s)}},(t,e,r)=>{var n=r(14),i=r(39),s=r(12),a=r(60).indexOf,o=r(55),c=n([].push);t.exports=function(u,h){var f=s(u),m=0,E=[],g;for(g in f)!i(o,g)&&i(f,g)&&c(E,g);for(;h.length>m;)i(f,g=h[m++])&&(~a(E,g)||c(E,g));return E}},(t,e,r)=>{var n=r(12),i=r(61),s=r(64),a=function(o){return function(c,u,h){var f=n(c),m=s(f),E=i(h,m),g;if(o&&u!==u){for(;m>E;)if(g=f[E++],g!==g)return!0}else for(;m>E;E++)if((o||E in f)&&f[E]===u)return o||E||0;return!o&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},(t,e,r)=>{var n=r(62),i=Math.max,s=Math.min;t.exports=function(a,o){var c=n(a);return c<0?i(c+o,0):s(c,o)}},(t,e,r)=>{var n=r(63);t.exports=function(i){var s=+i;return s!==s||s===0?0:n(s)}},t=>{var e=Math.ceil,r=Math.floor;t.exports=Math.trunc||function(i){var s=+i;return(s>0?r:e)(s)}},(t,e,r)=>{var n=r(65);t.exports=function(i){return n(i.length)}},(t,e,r)=>{var n=r(62),i=Math.min;t.exports=function(s){return s>0?i(n(s),9007199254740991):0}},t=>{t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},(t,e)=>{e.f=Object.getOwnPropertySymbols},(t,e,r)=>{var n=r(7),i=r(21),s=/#|\.prototype\./,a=function(f,m){var E=c[o(f)];return E===h?!0:E===u?!1:i(m)?n(m):!!m},o=a.normalize=function(f){return String(f).replace(s,".").toLowerCase()},c=a.data={},u=a.NATIVE="N",h=a.POLYFILL="P";t.exports=a},(t,e,r)=>{var n=r(9),i=Function.prototype,s=i.apply,a=i.call;t.exports=typeof Reflect=="object"&&Reflect.apply||(n?a.bind(s):function(){return a.apply(s,arguments)})},(t,e,r)=>{var n=r(24),i=r(39),s=r(44),a=r(25),o=r(71),c=r(56),u=r(74),h=r(75),f=r(76),m=r(80),E=r(81),g=r(6),p=r(36);t.exports=function(_,A,H,te){var ne="stackTraceLimit",j=te?2:1,ee=_.split("."),x=ee[ee.length-1],M=n.apply(null,ee);if(M){var T=M.prototype;if(!p&&i(T,"cause")&&delete T.cause,!H)return M;var O=n("Error"),R=A(function(Y,q){var me=f(te?q:Y,void 0),xe=te?new M(Y):new M;return me!==void 0&&s(xe,"message",me),E(xe,R,xe.stack,2),this&&a(T,this)&&h(xe,this,R),arguments.length>j&&m(xe,arguments[j]),xe});if(R.prototype=T,x!=="Error"?o?o(R,O):c(R,O,{name:!0}):g&&ne in M&&(u(R,M,ne),u(R,M,"prepareStackTrace")),c(R,M),!p)try{T.name!==x&&s(T,"name",x),T.constructor=R}catch(Y){}return R}}},(t,e,r)=>{var n=r(72),i=r(47),s=r(73);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var a=!1,o={},c;try{c=n(Object.prototype,"__proto__","set"),c(o,[]),a=o instanceof Array}catch(u){}return function(h,f){return i(h),s(f),a?c(h,f):h.__proto__=f,h}}():void 0)},(t,e,r)=>{var n=r(14),i=r(31);t.exports=function(s,a,o){try{return n(i(Object.getOwnPropertyDescriptor(s,a)[o]))}catch(c){}}},(t,e,r)=>{var n=r(21),i=String,s=TypeError;t.exports=function(a){if(typeof a=="object"||n(a))return a;throw s("Can't set "+i(a)+" as a prototype")}},(t,e,r)=>{var n=r(45).f;t.exports=function(i,s,a){a in i||n(i,a,{configurable:!0,get:function(){return s[a]},set:function(o){s[a]=o}})}},(t,e,r)=>{var n=r(21),i=r(20),s=r(71);t.exports=function(a,o,c){var u,h;return s&&n(u=o.constructor)&&u!==c&&i(h=u.prototype)&&h!==c.prototype&&s(a,h),a}},(t,e,r)=>{var n=r(77);t.exports=function(i,s){return i===void 0?arguments.length<2?"":s:n(i)}},(t,e,r)=>{var n=r(78),i=String;t.exports=function(s){if(n(s)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return i(s)}},(t,e,r)=>{var n=r(79),i=r(21),s=r(15),a=r(34),o=a("toStringTag"),c=Object,u=s(function(){return arguments}())==="Arguments",h=function(f,m){try{return f[m]}catch(E){}};t.exports=n?s:function(f){var m,E,g;return f===void 0?"Undefined":f===null?"Null":typeof(E=h(m=c(f),o))=="string"?E:u?s(m):(g=s(m))==="Object"&&i(m.callee)?"Arguments":g}},(t,e,r)=>{var n=r(34),i=n("toStringTag"),s={};s[i]="z",t.exports=String(s)==="[object z]"},(t,e,r)=>{var n=r(20),i=r(44);t.exports=function(s,a){n(a)&&"cause"in a&&i(s,"cause",a.cause)}},(t,e,r)=>{var n=r(44),i=r(82),s=r(83),a=Error.captureStackTrace;t.exports=function(o,c,u,h){s&&(a?a(o,c):n(o,"stack",i(u,h)))}},(t,e,r)=>{var n=r(14),i=Error,s=n("".replace),a=function(u){return String(i(u).stack)}("zxcasd"),o=/\n\s*at [^:]*:[^\n]*/,c=o.test(a);t.exports=function(u,h){if(c&&typeof u=="string"&&!i.prepareStackTrace)for(;h--;)u=s(u,o,"");return u}},(t,e,r)=>{var n=r(7),i=r(11);t.exports=!n(function(){var s=Error("a");return"stack"in s?(Object.defineProperty(s,"stack",i(1,7)),s.stack!==7):!0})},(t,e,r)=>{var n=r(48),i=r(14),s=r(77),a=r(85),o=URLSearchParams,c=o.prototype,u=i(c.append),h=i(c.delete),f=i(c.forEach),m=i([].push),E=new o("a=1&a=2&b=3");E.delete("a",1),E.delete("b",void 0),E+""!="a=2"&&n(c,"delete",function(g){var p=arguments.length,_=p<2?void 0:arguments[1];if(p&&_===void 0)return h(this,g);var A=[];f(this,function(T,O){m(A,{key:O,value:T})}),a(p,1);for(var H=s(g),te=s(_),ne=0,j=0,ee=!1,x=A.length,M;ne<x;)M=A[ne++],ee||M.key===H?(ee=!0,h(this,M.key)):j++;for(;j<x;)M=A[j++],M.key===H&&M.value===te||u(this,M.key,M.value)},{enumerable:!0,unsafe:!0})},t=>{var e=TypeError;t.exports=function(r,n){if(r<n)throw e("Not enough arguments");return r}},(t,e,r)=>{var n=r(48),i=r(14),s=r(77),a=r(85),o=URLSearchParams,c=o.prototype,u=i(c.getAll),h=i(c.has),f=new o("a=1");(f.has("a",2)||!f.has("a",void 0))&&n(c,"has",function(E){var g=arguments.length,p=g<2?void 0:arguments[1];if(g&&p===void 0)return h(this,E);var _=u(this,E);a(g,1);for(var A=s(p),H=0;H<_.length;)if(_[H++]===A)return!0;return!1},{enumerable:!0,unsafe:!0})},(t,e,r)=>{var n=r(6),i=r(14),s=r(88),a=URLSearchParams.prototype,o=i(a.forEach);n&&!("size"in a)&&s(a,"size",{get:function(){var u=0;return o(this,function(){u++}),u},configurable:!0,enumerable:!0})},(t,e,r)=>{var n=r(49),i=r(45);t.exports=function(s,a,o){return o.get&&n(o.get,a,{getter:!0}),o.set&&n(o.set,a,{setter:!0}),i.f(s,a,o)}},(t,e,r)=>{var n=r(3),i=r(40),s=r(64),a=r(90),o=r(92),c=r(7),u=c(function(){return[].push.call({length:4294967296},1)!==4294967297}),h=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(m){return m instanceof TypeError}},f=u||!h();n({target:"Array",proto:!0,arity:1,forced:f},{push:function(E){var g=i(this),p=s(g),_=arguments.length;o(p+_);for(var A=0;A<_;A++)g[p]=arguments[A],p++;return a(g,p),p}})},(t,e,r)=>{var n=r(6),i=r(91),s=TypeError,a=Object.getOwnPropertyDescriptor,o=n&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(c){return c instanceof TypeError}}();t.exports=o?function(c,u){if(i(c)&&!a(c,"length").writable)throw s("Cannot set read only .length");return c.length=u}:function(c,u){return c.length=u}},(t,e,r)=>{var n=r(15);t.exports=Array.isArray||function(s){return n(s)==="Array"}},t=>{var e=TypeError,r=9007199254740991;t.exports=function(n){if(n>r)throw e("Maximum allowed index exceeded");return n}},(t,e,r)=>{var n=r(94),i=r(98).findLast,s=n.aTypedArray,a=n.exportTypedArrayMethod;a("findLast",function(c){return i(s(this),c,arguments.length>1?arguments[1]:void 0)})},(t,e,r)=>{var n=r(95),i=r(6),s=r(4),a=r(21),o=r(20),c=r(39),u=r(78),h=r(32),f=r(44),m=r(48),E=r(88),g=r(25),p=r(96),_=r(71),A=r(34),H=r(41),te=r(52),ne=te.enforce,j=te.get,ee=s.Int8Array,x=ee&&ee.prototype,M=s.Uint8ClampedArray,T=M&&M.prototype,O=ee&&p(ee),R=x&&p(x),Y=Object.prototype,q=s.TypeError,me=A("toStringTag"),xe=H("TYPED_ARRAY_TAG"),Ee="TypedArrayConstructor",se=n&&!!_&&u(s.opera)!=="Opera",Fe=!1,ue,ae,_e,oe={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},ie={BigInt64Array:8,BigUint64Array:8},re=function(Se){if(!o(Se))return!1;var Xe=u(Se);return Xe==="DataView"||c(oe,Xe)||c(ie,Xe)},ce=function(je){var Se=p(je);if(o(Se)){var Xe=j(Se);return Xe&&c(Xe,Ee)?Xe[Ee]:ce(Se)}},fe=function(je){if(!o(je))return!1;var Se=u(je);return c(oe,Se)||c(ie,Se)},pe=function(je){if(fe(je))return je;throw q("Target is not a typed array")},ve=function(je){if(a(je)&&(!_||g(O,je)))return je;throw q(h(je)+" is not a typed array constructor")},Ae=function(je,Se,Xe,qe){if(i){if(Xe)for(var Je in oe){var We=s[Je];if(We&&c(We.prototype,je))try{delete We.prototype[je]}catch(Ue){try{We.prototype[je]=Se}catch(Ce){}}}(!R[je]||Xe)&&m(R,je,Xe?Se:se&&x[je]||Se,qe)}},be=function(je,Se,Xe){var qe,Je;if(i){if(_){if(Xe){for(qe in oe)if(Je=s[qe],Je&&c(Je,je))try{delete Je[je]}catch(We){}}if(!O[je]||Xe)try{return m(O,je,Xe?Se:se&&O[je]||Se)}catch(We){}else return}for(qe in oe)Je=s[qe],Je&&(!Je[je]||Xe)&&m(Je,je,Se)}};for(ue in oe)ae=s[ue],_e=ae&&ae.prototype,_e?ne(_e)[Ee]=ae:se=!1;for(ue in ie)ae=s[ue],_e=ae&&ae.prototype,_e&&(ne(_e)[Ee]=ae);if((!se||!a(O)||O===Function.prototype)&&(O=function(){throw q("Incorrect invocation")},se))for(ue in oe)s[ue]&&_(s[ue],O);if((!se||!R||R===Y)&&(R=O.prototype,se))for(ue in oe)s[ue]&&_(s[ue].prototype,R);if(se&&p(T)!==R&&_(T,R),i&&!c(R,me)){Fe=!0,E(R,me,{configurable:!0,get:function(){return o(this)?this[xe]:void 0}});for(ue in oe)s[ue]&&f(s[ue],xe,ue)}t.exports={NATIVE_ARRAY_BUFFER_VIEWS:se,TYPED_ARRAY_TAG:Fe&&xe,aTypedArray:pe,aTypedArrayConstructor:ve,exportTypedArrayMethod:Ae,exportTypedArrayStaticMethod:be,getTypedArrayConstructor:ce,isView:re,isTypedArray:fe,TypedArray:O,TypedArrayPrototype:R}},t=>{t.exports=typeof ArrayBuffer!="undefined"&&typeof DataView!="undefined"},(t,e,r)=>{var n=r(39),i=r(21),s=r(40),a=r(54),o=r(97),c=a("IE_PROTO"),u=Object,h=u.prototype;t.exports=o?u.getPrototypeOf:function(f){var m=s(f);if(n(m,c))return m[c];var E=m.constructor;return i(E)&&m instanceof E?E.prototype:m instanceof u?h:null}},(t,e,r)=>{var n=r(7);t.exports=!n(function(){function i(){}return i.prototype.constructor=null,Object.getPrototypeOf(new i)!==i.prototype})},(t,e,r)=>{var n=r(99),i=r(13),s=r(40),a=r(64),o=function(c){var u=c===1;return function(h,f,m){for(var E=s(h),g=i(E),p=n(f,m),_=a(g),A,H;_-- >0;)if(A=g[_],H=p(A,_,E),H)switch(c){case 0:return A;case 1:return _}return u?-1:void 0}};t.exports={findLast:o(0),findLastIndex:o(1)}},(t,e,r)=>{var n=r(100),i=r(31),s=r(9),a=n(n.bind);t.exports=function(o,c){return i(o),c===void 0?o:s?a(o,c):function(){return o.apply(c,arguments)}}},(t,e,r)=>{var n=r(15),i=r(14);t.exports=function(s){if(n(s)==="Function")return i(s)}},(t,e,r)=>{var n=r(94),i=r(98).findLastIndex,s=n.aTypedArray,a=n.exportTypedArrayMethod;a("findLastIndex",function(c){return i(s(this),c,arguments.length>1?arguments[1]:void 0)})},(t,e,r)=>{var n=r(4),i=r(8),s=r(94),a=r(64),o=r(103),c=r(40),u=r(7),h=n.RangeError,f=n.Int8Array,m=f&&f.prototype,E=m&&m.set,g=s.aTypedArray,p=s.exportTypedArrayMethod,_=!u(function(){var H=new Uint8ClampedArray(2);return i(E,H,{length:1,0:3},1),H[1]!==3}),A=_&&s.NATIVE_ARRAY_BUFFER_VIEWS&&u(function(){var H=new f(2);return H.set(1),H.set("2",1),H[0]!==0||H[1]!==2});p("set",function(te){g(this);var ne=o(arguments.length>1?arguments[1]:void 0,1),j=c(te);if(_)return i(E,this,j,ne);var ee=this.length,x=a(j),M=0;if(x+ne>ee)throw h("Wrong length");for(;M<x;)this[ne+M]=j[M++]},!_||A)},(t,e,r)=>{var n=r(104),i=RangeError;t.exports=function(s,a){var o=n(s);if(o%a)throw i("Wrong offset");return o}},(t,e,r)=>{var n=r(62),i=RangeError;t.exports=function(s){var a=n(s);if(a<0)throw i("The argument can't be less than 0");return a}},(t,e,r)=>{var n=r(106),i=r(94),s=i.aTypedArray,a=i.exportTypedArrayMethod,o=i.getTypedArrayConstructor;a("toReversed",function(){return n(s(this),o(this))})},(t,e,r)=>{var n=r(64);t.exports=function(i,s){for(var a=n(i),o=new s(a),c=0;c<a;c++)o[c]=i[a-c-1];return o}},(t,e,r)=>{var n=r(94),i=r(14),s=r(31),a=r(108),o=n.aTypedArray,c=n.getTypedArrayConstructor,u=n.exportTypedArrayMethod,h=i(n.TypedArrayPrototype.sort);u("toSorted",function(m){m!==void 0&&s(m);var E=o(this),g=a(c(E),E);return h(g,m)})},(t,e,r)=>{var n=r(64);t.exports=function(i,s){for(var a=0,o=n(s),c=new i(o);o>a;)c[a]=s[a++];return c}},(t,e,r)=>{var n=r(110),i=r(94),s=r(111),a=r(62),o=r(112),c=i.aTypedArray,u=i.getTypedArrayConstructor,h=i.exportTypedArrayMethod,f=!!function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(m){return m===8}}();h("with",function(m,E){var g=c(this),p=a(m),_=s(g)?o(E):+E;return n(g,u(g),p,_)},!f)},(t,e,r)=>{var n=r(64),i=r(62),s=RangeError;t.exports=function(a,o,c,u){var h=n(a),f=i(c),m=f<0?h+f:f;if(m>=h||m<0)throw s("Incorrect index");for(var E=new o(h),g=0;g<h;g++)E[g]=g===m?u:a[g];return E}},(t,e,r)=>{var n=r(78);t.exports=function(i){var s=n(i);return s==="BigInt64Array"||s==="BigUint64Array"}},(t,e,r)=>{var n=r(19),i=TypeError;t.exports=function(s){var a=n(s,"number");if(typeof a=="number")throw i("Can't convert number to bigint");return BigInt(a)}},(t,e,r)=>{var n=r(6),i=r(88),s=r(114),a=ArrayBuffer.prototype;n&&!("detached"in a)&&i(a,"detached",{configurable:!0,get:function(){return s(this)}})},(t,e,r)=>{var n=r(14),i=r(115),s=n(ArrayBuffer.prototype.slice);t.exports=function(a){if(i(a)!==0)return!1;try{return s(a,0,0),!1}catch(o){return!0}}},(t,e,r)=>{var n=r(72),i=r(15),s=TypeError;t.exports=n(ArrayBuffer.prototype,"byteLength","get")||function(a){if(i(a)!=="ArrayBuffer")throw s("ArrayBuffer expected");return a.byteLength}},(t,e,r)=>{var n=r(3),i=r(117);i&&n({target:"ArrayBuffer",proto:!0},{transfer:function(){return i(this,arguments.length?arguments[0]:void 0,!0)}})},(t,e,r)=>{var n=r(4),i=r(14),s=r(72),a=r(118),o=r(114),c=r(115),u=r(119),h=n.TypeError,f=n.structuredClone,m=n.ArrayBuffer,E=n.DataView,g=Math.min,p=m.prototype,_=E.prototype,A=i(p.slice),H=s(p,"resizable","get"),te=s(p,"maxByteLength","get"),ne=i(_.getInt8),j=i(_.setInt8);t.exports=u&&function(ee,x,M){var T=c(ee),O=x===void 0?T:a(x),R=!H||!H(ee);if(o(ee))throw h("ArrayBuffer is detached");var Y=f(ee,{transfer:[ee]});if(T===O&&(M||R))return Y;if(T>=O&&(!M||R))return A(Y,0,O);for(var q=M&&!R&&te?{maxByteLength:te(Y)}:void 0,me=new m(O,q),xe=new E(Y),Ee=new E(me),se=g(O,T),Fe=0;Fe<se;Fe++)j(Ee,Fe,ne(xe,Fe));return me}},(t,e,r)=>{var n=r(62),i=r(65),s=RangeError;t.exports=function(a){if(a===void 0)return 0;var o=n(a),c=i(o);if(o!==c)throw s("Wrong length or index");return c}},(t,e,r)=>{var n=r(4),i=r(7),s=r(28),a=r(120),o=r(121),c=r(122),u=n.structuredClone;t.exports=!!u&&!i(function(){if(o&&s>92||c&&s>94||a&&s>97)return!1;var h=new ArrayBuffer(8),f=u(h,{transfer:[h]});return h.byteLength!==0||f.byteLength!==8})},(t,e,r)=>{var n=r(121),i=r(122);t.exports=!n&&!i&&typeof window=="object"&&typeof document=="object"},t=>{t.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},(t,e,r)=>{var n=r(4),i=r(15);t.exports=i(n.process)==="process"},(t,e,r)=>{var n=r(3),i=r(117);i&&n({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return i(this,arguments.length?arguments[0]:void 0,!1)}})},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var t,r,n,i,yi,Es,o,c,u,h,f,m,E,g,p,ws,A,H,Ks,ne,j;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0,__w_pdfjs_require__(84),__w_pdfjs_require__(86),__w_pdfjs_require__(87),__w_pdfjs_require__(2),__w_pdfjs_require__(93),__w_pdfjs_require__(101),__w_pdfjs_require__(102),__w_pdfjs_require__(105),__w_pdfjs_require__(107),__w_pdfjs_require__(109),__w_pdfjs_require__(113),__w_pdfjs_require__(116),__w_pdfjs_require__(123),__w_pdfjs_require__(89),__w_pdfjs_require__(125),__w_pdfjs_require__(136),__w_pdfjs_require__(138),__w_pdfjs_require__(141),__w_pdfjs_require__(143),__w_pdfjs_require__(145),__w_pdfjs_require__(147),__w_pdfjs_require__(149),__w_pdfjs_require__(152);var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(163),_display_utils=__w_pdfjs_require__(168),_font_loader=__w_pdfjs_require__(171),_displayNode_utils=__w_pdfjs_require__(172),_canvas=__w_pdfjs_require__(173),_worker_options=__w_pdfjs_require__(176),_message_handler=__w_pdfjs_require__(177),_metadata=__w_pdfjs_require__(178),_optional_content_config=__w_pdfjs_require__(179),_transport_stream=__w_pdfjs_require__(180),_displayFetch_stream=__w_pdfjs_require__(181),_displayNetwork=__w_pdfjs_require__(184),_displayNode_stream=__w_pdfjs_require__(185),_displaySvg=__w_pdfjs_require__(186),_xfa_text=__w_pdfjs_require__(194);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(x){var nr,xr;if(typeof x=="string"||x instanceof URL?x={url:x}:(0,_util.isArrayBuffer)(x)&&(x={data:x}),typeof x!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!x.url&&!x.data&&!x.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const M=new PDFDocumentLoadingTask,{docId:T}=M,O=x.url?getUrlProp(x.url):null,R=x.data?getDataProp(x.data):null,Y=x.httpHeaders||null,q=x.withCredentials===!0,me=(nr=x.password)!=null?nr:null,xe=x.range instanceof PDFDataRangeTransport?x.range:null,Ee=Number.isInteger(x.rangeChunkSize)&&x.rangeChunkSize>0?x.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let se=x.worker instanceof PDFWorker?x.worker:null;const Fe=x.verbosity,ue=typeof x.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(x.docBaseUrl)?x.docBaseUrl:null,ae=typeof x.cMapUrl=="string"?x.cMapUrl:null,_e=x.cMapPacked!==!1,oe=x.CMapReaderFactory||DefaultCMapReaderFactory,ie=typeof x.standardFontDataUrl=="string"?x.standardFontDataUrl:null,re=x.StandardFontDataFactory||DefaultStandardFontDataFactory,ce=x.stopAtErrors!==!0,fe=Number.isInteger(x.maxImageSize)&&x.maxImageSize>-1?x.maxImageSize:-1,pe=x.isEvalSupported!==!1,ve=typeof x.isOffscreenCanvasSupported=="boolean"?x.isOffscreenCanvasSupported:!_util.isNodeJS,Ae=Number.isInteger(x.canvasMaxAreaInBytes)?x.canvasMaxAreaInBytes:-1,be=typeof x.disableFontFace=="boolean"?x.disableFontFace:_util.isNodeJS,je=x.fontExtraProperties===!0,Se=x.enableXfa===!0,Xe=x.ownerDocument||globalThis.document,qe=x.disableRange===!0,Je=x.disableStream===!0,We=x.disableAutoFetch===!0,Ue=x.pdfBug===!0,Ce=xe?xe.length:(xr=x.length)!=null?xr:NaN,Le=typeof x.useSystemFonts=="boolean"?x.useSystemFonts:!_util.isNodeJS&&!be,Ve=typeof x.useWorkerFetch=="boolean"?x.useWorkerFetch:oe===_display_utils.DOMCMapReaderFactory&&re===_display_utils.DOMStandardFontDataFactory&&ae&&ie&&(0,_display_utils.isValidFetchUrl)(ae,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(ie,document.baseURI),Ge=x.canvasFactory||new DefaultCanvasFactory({ownerDocument:Xe}),ut=x.filterFactory||new DefaultFilterFactory({docId:T,ownerDocument:Xe}),Jt=null;(0,_util.setVerbosityLevel)(Fe);const Kt={canvasFactory:Ge,filterFactory:ut};if(Ve||(Kt.cMapReaderFactory=new oe({baseUrl:ae,isCompressed:_e}),Kt.standardFontDataFactory=new re({baseUrl:ie})),!se){const pr={verbosity:Fe,port:_worker_options.GlobalWorkerOptions.workerPort};se=pr.port?PDFWorker.fromPort(pr):new PDFWorker(pr),M._worker=se}const Ze={docId:T,apiVersion:"3.11.174",data:R,password:me,disableAutoFetch:We,rangeChunkSize:Ee,length:Ce,docBaseUrl:ue,enableXfa:Se,evaluatorOptions:{maxImageSize:fe,disableFontFace:be,ignoreErrors:ce,isEvalSupported:pe,isOffscreenCanvasSupported:ve,canvasMaxAreaInBytes:Ae,fontExtraProperties:je,useSystemFonts:Le,cMapUrl:Ve?ae:null,standardFontDataUrl:Ve?ie:null}},tr={ignoreErrors:ce,isEvalSupported:pe,disableFontFace:be,fontExtraProperties:je,enableXfa:Se,ownerDocument:Xe,disableAutoFetch:We,pdfBug:Ue,styleElement:Jt};return se.promise.then(function(){if(M.destroyed)throw new Error("Loading aborted");const pr=_fetchDocument(se,Ze),vr=new Promise(function(lr){let mr;xe?mr=new _transport_stream.PDFDataTransportStream({length:Ce,initialData:xe.initialData,progressiveDone:xe.progressiveDone,contentDispositionFilename:xe.contentDispositionFilename,disableRange:qe,disableStream:Je},xe):R||(mr=(Cr=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(Cr):(0,_display_utils.isValidFetchUrl)(Cr.url)?new _displayFetch_stream.PDFFetchStream(Cr):new _displayNetwork.PDFNetworkStream(Cr))({url:O,length:Ce,httpHeaders:Y,withCredentials:q,rangeChunkSize:Ee,disableRange:qe,disableStream:Je})),lr(mr)});return Promise.all([pr,vr]).then(function(lr){let[mr,wr]=lr;if(M.destroyed)throw new Error("Loading aborted");const Cr=new _message_handler.MessageHandler(T,mr,se.port),Rr=new WorkerTransport(Cr,M,wr,tr,Kt);M._transport=Rr,Cr.send("Ready",null)})}).catch(M._capability.reject),M}function _fetchDocument(x,M){return Ye(this,null,function*(){if(x.destroyed)throw new Error("Worker was destroyed");const T=yield x.messageHandler.sendWithPromise("GetDocRequest",M,M.data?[M.data.buffer]:null);if(x.destroyed)throw new Error("Worker was destroyed");return T})}function getUrlProp(x){if(x instanceof URL)return x.href;try{return new URL(x,window.location).href}catch(M){if(_util.isNodeJS&&typeof x=="string")return x}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(x){if(_util.isNodeJS&&typeof Buffer!="undefined"&&x instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(x instanceof Uint8Array&&x.byteLength===x.buffer.byteLength)return x;if(typeof x=="string")return(0,_util.stringToBytes)(x);if(typeof x=="object"&&!isNaN(x==null?void 0:x.length)||(0,_util.isArrayBuffer)(x))return new Uint8Array(x);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const e=class e{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${Xi(e,t)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}destroy(){return Ye(this,null,function*(){var M,T,O;this.destroyed=!0;try{(M=this._worker)!=null&&M.port&&(this._worker._pendingDestroy=!0),yield(T=this._transport)==null?void 0:T.destroy()}catch(R){throw(O=this._worker)!=null&&O.port&&delete this._worker._pendingDestroy,R}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)})}};t=new WeakMap,ct(e,t,0);let PDFDocumentLoadingTask=e;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(M,T){let O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,R=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;this.length=M,this.initialData=T,this.progressiveDone=O,this.contentDispositionFilename=R,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(M){this._rangeListeners.push(M)}addProgressListener(M){this._progressListeners.push(M)}addProgressiveReadListener(M){this._progressiveReadListeners.push(M)}addProgressiveDoneListener(M){this._progressiveDoneListeners.push(M)}onDataRange(M,T){for(const O of this._rangeListeners)O(M,T)}onDataProgress(M,T){this._readyCapability.promise.then(()=>{for(const O of this._progressListeners)O(M,T)})}onDataProgressiveRead(M){this._readyCapability.promise.then(()=>{for(const T of this._progressiveReadListeners)T(M)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const M of this._progressiveDoneListeners)M()})}transportReady(){this._readyCapability.resolve()}requestDataRange(M,T){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(M,T){this._pdfInfo=M,this._transport=T,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(O=>{if(!O)return O;const R=[];for(const Y in O)R.push(...O[Y]);return R}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(M){return this._transport.getPage(M)}getPageIndex(M){return this._transport.getPageIndex(M)}getDestinations(){return this._transport.getDestinations()}getDestination(M){return this._transport.getDestination(M)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(){let M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._transport.startCleanup(M||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(M,T,O){ct(this,i);ct(this,r,null);ct(this,n,!1);let R=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;this._pageIndex=M,this._pageInfo=T,this._transport=O,this._stats=R?new _display_utils.StatTimer:null,this._pdfBug=R,this.commonObjs=O.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport(){let{scale:M,rotation:T=this.rotate,offsetX:O=0,offsetY:R=0,dontFlip:Y=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new _display_utils.PageViewport({viewBox:this.view,scale:M,rotation:T,offsetX:O,offsetY:R,dontFlip:Y})}getAnnotations(){let{intent:M="display"}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const T=this._transport.getRenderingIntent(M);return this._transport.getAnnotations(this._pageIndex,T.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}getXfa(){return Ye(this,null,function*(){var M;return((M=this._transport._htmlForXfa)==null?void 0:M.children[this._pageIndex])||null})}render(M){var ce,fe;let{canvasContext:T,viewport:O,intent:R="display",annotationMode:Y=_util.AnnotationMode.ENABLE,transform:q=null,background:me=null,optionalContentConfigPromise:xe=null,annotationCanvasMap:Ee=null,pageColors:se=null,printAnnotationStorage:Fe=null}=M;(ce=this._stats)==null||ce.time("Overall");const ue=this._transport.getRenderingIntent(R,Y,Fe);ft(this,n,!1),Qe(this,i,Es).call(this),xe||(xe=this._transport.getOptionalContentConfig());let ae=this._intentStates.get(ue.cacheKey);ae||(ae=Object.create(null),this._intentStates.set(ue.cacheKey,ae)),ae.streamReaderCancelTimeout&&(clearTimeout(ae.streamReaderCancelTimeout),ae.streamReaderCancelTimeout=null);const _e=!!(ue.renderingIntent&_util.RenderingIntentFlag.PRINT);ae.displayReadyCapability||(ae.displayReadyCapability=new _util.PromiseCapability,ae.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(fe=this._stats)==null||fe.time("Page Request"),this._pumpOperatorList(ue));const oe=pe=>{var ve,Ae;ae.renderTasks.delete(ie),(this._maybeCleanupAfterRender||_e)&&ft(this,n,!0),Qe(this,i,yi).call(this,!_e),pe?(ie.capability.reject(pe),this._abortOperatorList({intentState:ae,reason:pe instanceof Error?pe:new Error(pe)})):ie.capability.resolve(),(ve=this._stats)==null||ve.timeEnd("Rendering"),(Ae=this._stats)==null||Ae.timeEnd("Overall")},ie=new InternalRenderTask({callback:oe,params:{canvasContext:T,viewport:O,transform:q,background:me},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:Ee,operatorList:ae.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!_e,pdfBug:this._pdfBug,pageColors:se});(ae.renderTasks||(ae.renderTasks=new Set)).add(ie);const re=ie.task;return Promise.all([ae.displayReadyCapability.promise,xe]).then(pe=>{var be;let[ve,Ae]=pe;if(this.destroyed){oe();return}(be=this._stats)==null||be.time("Rendering"),ie.initializeGraphics({transparency:ve,optionalContentConfig:Ae}),ie.operatorListChanged()}).catch(oe),re}getOperatorList(){var xe;let{intent:M="display",annotationMode:T=_util.AnnotationMode.ENABLE,printAnnotationStorage:O=null}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};function R(){q.operatorList.lastChunk&&(q.opListReadCapability.resolve(q.operatorList),q.renderTasks.delete(me))}const Y=this._transport.getRenderingIntent(M,T,O,!0);let q=this._intentStates.get(Y.cacheKey);q||(q=Object.create(null),this._intentStates.set(Y.cacheKey,q));let me;return q.opListReadCapability||(me=Object.create(null),me.operatorListChanged=R,q.opListReadCapability=new _util.PromiseCapability,(q.renderTasks||(q.renderTasks=new Set)).add(me),q.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(xe=this._stats)==null||xe.time("Page Request"),this._pumpOperatorList(Y)),q.opListReadCapability.promise}streamTextContent(){let{includeMarkedContent:M=!1,disableNormalization:T=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:M===!0,disableNormalization:T===!0},{highWaterMark:100,size(R){return R.items.length}})}getTextContent(){let M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._transport._htmlForXfa)return this.getXfa().then(O=>_xfa_text.XfaText.textContent(O));const T=this.streamTextContent(M);return new Promise(function(O,R){function Y(){q.read().then(function(xe){let{value:Ee,done:se}=xe;if(se){O(me);return}Object.assign(me.styles,Ee.styles),me.items.push(...Ee.items),Y()},R)}const q=T.getReader(),me={items:[],styles:Object.create(null)};Y()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const M=[];for(const T of this._intentStates.values())if(this._abortOperatorList({intentState:T,reason:new Error("Page was destroyed."),force:!0}),!T.opListReadCapability)for(const O of T.renderTasks)M.push(O.completed),O.cancel();return this.objs.clear(),ft(this,n,!1),Qe(this,i,Es).call(this),Promise.all(M)}cleanup(){let M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;ft(this,n,!0);const T=Qe(this,i,yi).call(this,!1);return M&&T&&this._stats&&(this._stats=new _display_utils.StatTimer),T}_startRenderPage(M,T){var R,Y;const O=this._intentStates.get(T);O&&((R=this._stats)==null||R.timeEnd("Page Request"),(Y=O.displayReadyCapability)==null||Y.resolve(M))}_renderPageChunk(M,T){for(let O=0,R=M.length;O<R;O++)T.operatorList.fnArray.push(M.fnArray[O]),T.operatorList.argsArray.push(M.argsArray[O]);T.operatorList.lastChunk=M.lastChunk,T.operatorList.separateAnnots=M.separateAnnots;for(const O of T.renderTasks)O.operatorListChanged();M.lastChunk&&Qe(this,i,yi).call(this,!0)}_pumpOperatorList(M){let{renderingIntent:T,cacheKey:O,annotationStorageSerializable:R}=M;const{map:Y,transfers:q}=R,xe=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:T,cacheKey:O,annotationStorage:Y},q).getReader(),Ee=this._intentStates.get(O);Ee.streamReader=xe;const se=()=>{xe.read().then(Fe=>{let{value:ue,done:ae}=Fe;if(ae){Ee.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(ue,Ee),se())},Fe=>{if(Ee.streamReader=null,!this._transport.destroyed){if(Ee.operatorList){Ee.operatorList.lastChunk=!0;for(const ue of Ee.renderTasks)ue.operatorListChanged();Qe(this,i,yi).call(this,!0)}if(Ee.displayReadyCapability)Ee.displayReadyCapability.reject(Fe);else if(Ee.opListReadCapability)Ee.opListReadCapability.reject(Fe);else throw Fe}})};se()}_abortOperatorList(M){let{intentState:T,reason:O,force:R=!1}=M;if(T.streamReader){if(T.streamReaderCancelTimeout&&(clearTimeout(T.streamReaderCancelTimeout),T.streamReaderCancelTimeout=null),!R){if(T.renderTasks.size>0)return;if(O instanceof _display_utils.RenderingCancelledException){let Y=RENDERING_CANCELLED_TIMEOUT;O.extraDelay>0&&O.extraDelay<1e3&&(Y+=O.extraDelay),T.streamReaderCancelTimeout=setTimeout(()=>{T.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:T,reason:O,force:!0})},Y);return}}if(T.streamReader.cancel(new _util.AbortException(O.message)).catch(()=>{}),T.streamReader=null,!this._transport.destroyed){for(const[Y,q]of this._intentStates)if(q===T){this._intentStates.delete(Y);break}this.cleanup()}}}get stats(){return this._stats}}r=new WeakMap,n=new WeakMap,i=new WeakSet,yi=function(){let M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(Qe(this,i,Es).call(this),!de(this,n)||this.destroyed)return!1;if(M)return ft(this,r,setTimeout(()=>{ft(this,r,null),Qe(this,i,yi).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:T,operatorList:O}of this._intentStates.values())if(T.size>0||!O.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),ft(this,n,!1),!0},Es=function(){de(this,r)&&(clearTimeout(de(this,r)),ft(this,r,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){ct(this,o,new Set);ct(this,c,Promise.resolve())}postMessage(M,T){const O={data:structuredClone(M,null)};de(this,c).then(()=>{for(const R of de(this,o))R.call(this,O)})}addEventListener(M,T){de(this,o).add(T)}removeEventListener(M,T){de(this,o).delete(T)}terminate(){de(this,o).clear()}}o=new WeakMap,c=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const x=(u=document==null?void 0:document.currentScript)==null?void 0:u.src;x&&(PDFWorkerUtil.fallbackWorkerSrc=x.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(x,M){let T;try{if(T=new URL(x),!T.origin||T.origin==="null")return!1}catch(R){return!1}const O=new URL(M,T);return T.origin===O.origin},PDFWorkerUtil.createCDNWrapper=function(x){const M=`importScripts("${x}");`;return URL.createObjectURL(new Blob([M]))}}const _PDFWorker=class _PDFWorker{constructor(){var O;let{name:x=null,port:M=null,verbosity:T=(0,_util.getVerbosityLevel)()}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.name=x,this.destroyed=!1,this.verbosity=T,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,M){if((O=de(_PDFWorker,h))!=null&&O.has(M))throw new Error("Cannot use more than one PDFWorker per port.");(de(_PDFWorker,h)||ft(_PDFWorker,h,new WeakMap)).set(M,this),this._initializeFromPort(M);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(x){this._port=x,this._messageHandler=new _message_handler.MessageHandler("main","worker",x),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:x}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,x)||(x=PDFWorkerUtil.createCDNWrapper(new URL(x,window.location).href));const M=new Worker(x),T=new _message_handler.MessageHandler("main","worker",M),O=()=>{M.removeEventListener("error",R),T.destroy(),M.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},R=()=>{this._webWorker||O()};M.addEventListener("error",R),T.on("test",q=>{if(M.removeEventListener("error",R),this.destroyed){O();return}q?(this._messageHandler=T,this._port=M,this._webWorker=M,this._readyCapability.resolve(),T.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),T.destroy(),M.terminate())}),T.on("ready",q=>{if(M.removeEventListener("error",R),this.destroyed){O();return}try{Y()}catch(me){this._setupFakeWorker()}});const Y=()=>{const q=new Uint8Array;T.send("test",q,[q.buffer])};Y();return}catch(M){(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(x=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const M=new LoopbackPort;this._port=M;const T=`fake${PDFWorkerUtil.fakeWorkerId++}`,O=new _message_handler.MessageHandler(T+"_worker",T,M);x.setup(O,M);const R=new _message_handler.MessageHandler(T,T+"_worker",M);this._messageHandler=R,this._readyCapability.resolve(),R.send("configure",{verbosity:this.verbosity})}).catch(x=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${x.message}".`))})}destroy(){var x;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(x=de(_PDFWorker,h))==null||x.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(x){var T;if(!(x!=null&&x.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const M=(T=de(this,h))==null?void 0:T.get(x.port);if(M){if(M._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return M}return new _PDFWorker(x)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var x;try{return((x=globalThis.pdfjsWorker)==null?void 0:x.WorkerMessageHandler)||null}catch(M){return null}}static get _setupFakeWorkerGlobal(){const loader=()=>Ye(this,null,function*(){const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return yield(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler});return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};h=new WeakMap,ct(_PDFWorker,h);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(M,T,O,R,Y){ct(this,p);ct(this,f,new Map);ct(this,m,new Map);ct(this,E,new Map);ct(this,g,null);this.messageHandler=M,this.loadingTask=T,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:R.ownerDocument,styleElement:R.styleElement}),this._params=R,this.canvasFactory=Y.canvasFactory,this.filterFactory=Y.filterFactory,this.cMapReaderFactory=Y.cMapReaderFactory,this.standardFontDataFactory=Y.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=O,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(M){let T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_util.AnnotationMode.ENABLE,O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,R=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,Y=_util.RenderingIntentFlag.DISPLAY,q=_annotation_storage.SerializableEmpty;switch(M){case"any":Y=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":Y=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${M}`)}switch(T){case _util.AnnotationMode.DISABLE:Y+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:Y+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:Y+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,q=(Y&_util.RenderingIntentFlag.PRINT&&O instanceof _annotation_storage.PrintAnnotationStorage?O:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${T}`)}return R&&(Y+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:Y,cacheKey:`${Y}_${q.hash}`,annotationStorageSerializable:q}}destroy(){var O;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(O=de(this,g))==null||O.reject(new Error("Worker was destroyed during onPassword callback"));const M=[];for(const R of de(this,m).values())M.push(R._destroy());de(this,m).clear(),de(this,E).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const T=this.messageHandler.sendWithPromise("Terminate",null);return M.push(T),Promise.all(M).then(()=>{var R;this.commonObjs.clear(),this.fontLoader.clear(),de(this,f).clear(),this.filterFactory.destroy(),(R=this._networkStream)==null||R.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:M,loadingTask:T}=this;M.on("GetReader",(O,R)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=Y=>{this._lastProgress={loaded:Y.loaded,total:Y.total}},R.onPull=()=>{this._fullReader.read().then(function(Y){let{value:q,done:me}=Y;if(me){R.close();return}(0,_util.assert)(q instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),R.enqueue(new Uint8Array(q),1,[q])}).catch(Y=>{R.error(Y)})},R.onCancel=Y=>{this._fullReader.cancel(Y),R.ready.catch(q=>{if(!this.destroyed)throw q})}}),M.on("ReaderHeadersReady",O=>{const R=new _util.PromiseCapability,Y=this._fullReader;return Y.headersReady.then(()=>{var q;(!Y.isStreamingSupported||!Y.isRangeSupported)&&(this._lastProgress&&((q=T.onProgress)==null||q.call(T,this._lastProgress)),Y.onProgress=me=>{var xe;(xe=T.onProgress)==null||xe.call(T,{loaded:me.loaded,total:me.total})}),R.resolve({isStreamingSupported:Y.isStreamingSupported,isRangeSupported:Y.isRangeSupported,contentLength:Y.contentLength})},R.reject),R.promise}),M.on("GetRangeReader",(O,R)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const Y=this._networkStream.getRangeReader(O.begin,O.end);if(!Y){R.close();return}R.onPull=()=>{Y.read().then(function(q){let{value:me,done:xe}=q;if(xe){R.close();return}(0,_util.assert)(me instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),R.enqueue(new Uint8Array(me),1,[me])}).catch(q=>{R.error(q)})},R.onCancel=q=>{Y.cancel(q),R.ready.catch(me=>{if(!this.destroyed)throw me})}}),M.on("GetDoc",O=>{let{pdfInfo:R}=O;this._numPages=R.numPages,this._htmlForXfa=R.htmlForXfa,delete R.htmlForXfa,T._capability.resolve(new PDFDocumentProxy(R,this))}),M.on("DocException",function(O){let R;switch(O.name){case"PasswordException":R=new _util.PasswordException(O.message,O.code);break;case"InvalidPDFException":R=new _util.InvalidPDFException(O.message);break;case"MissingPDFException":R=new _util.MissingPDFException(O.message);break;case"UnexpectedResponseException":R=new _util.UnexpectedResponseException(O.message,O.status);break;case"UnknownErrorException":R=new _util.UnknownErrorException(O.message,O.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}T._capability.reject(R)}),M.on("PasswordRequest",O=>{if(ft(this,g,new _util.PromiseCapability),T.onPassword){const R=Y=>{Y instanceof Error?de(this,g).reject(Y):de(this,g).resolve({password:Y})};try{T.onPassword(R,O.code)}catch(Y){de(this,g).reject(Y)}}else de(this,g).reject(new _util.PasswordException(O.message,O.code));return de(this,g).promise}),M.on("DataLoaded",O=>{var R;(R=T.onProgress)==null||R.call(T,{loaded:O.length,total:O.length}),this.downloadInfoCapability.resolve(O)}),M.on("StartRenderPage",O=>{if(this.destroyed)return;de(this,m).get(O.pageIndex)._startRenderPage(O.transparency,O.cacheKey)}),M.on("commonobj",O=>{var me;let[R,Y,q]=O;if(!this.destroyed&&!this.commonObjs.has(R))switch(Y){case"Font":const xe=this._params;if("error"in q){const Fe=q.error;(0,_util.warn)(`Error during font loading: ${Fe}`),this.commonObjs.resolve(R,Fe);break}const Ee=xe.pdfBug&&((me=globalThis.FontInspector)!=null&&me.enabled)?(Fe,ue)=>globalThis.FontInspector.fontAdded(Fe,ue):null,se=new _font_loader.FontFaceObject(q,{isEvalSupported:xe.isEvalSupported,disableFontFace:xe.disableFontFace,ignoreErrors:xe.ignoreErrors,inspectFont:Ee});this.fontLoader.bind(se).catch(Fe=>M.sendWithPromise("FontFallback",{id:R})).finally(()=>{!xe.fontExtraProperties&&se.data&&(se.data=null),this.commonObjs.resolve(R,se)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(R,q);break;default:throw new Error(`Got unknown common object type ${Y}`)}}),M.on("obj",O=>{var Ee;let[R,Y,q,me]=O;if(this.destroyed)return;const xe=de(this,m).get(Y);if(!xe.objs.has(R))switch(q){case"Image":if(xe.objs.resolve(R,me),me){let se;if(me.bitmap){const{width:Fe,height:ue}=me;se=Fe*ue*4}else se=((Ee=me.data)==null?void 0:Ee.length)||0;se>_util.MAX_IMAGE_SIZE_TO_CACHE&&(xe._maybeCleanupAfterRender=!0)}break;case"Pattern":xe.objs.resolve(R,me);break;default:throw new Error(`Got unknown object type ${q}`)}}),M.on("DocProgress",O=>{var R;this.destroyed||(R=T.onProgress)==null||R.call(T,{loaded:O.loaded,total:O.total})}),M.on("FetchBuiltInCMap",O=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(O):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),M.on("FetchStandardFontData",O=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(O):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var O,R;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:M,transfers:T}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:M,filename:(R=(O=this._fullReader)==null?void 0:O.filename)!=null?R:null},T).finally(()=>{this.annotationStorage.resetModified()})}getPage(M){if(!Number.isInteger(M)||M<=0||M>this._numPages)return Promise.reject(new Error("Invalid page request."));const T=M-1,O=de(this,E).get(T);if(O)return O;const R=this.messageHandler.sendWithPromise("GetPage",{pageIndex:T}).then(Y=>{if(this.destroyed)throw new Error("Transport destroyed");const q=new PDFPageProxy(T,Y,this,this._params.pdfBug);return de(this,m).set(T,q),q});return de(this,E).set(T,R),R}getPageIndex(M){return typeof M!="object"||M===null||!Number.isInteger(M.num)||M.num<0||!Number.isInteger(M.gen)||M.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:M.num,gen:M.gen})}getAnnotations(M,T){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:M,intent:T})}getFieldObjects(){return Qe(this,p,ws).call(this,"GetFieldObjects")}hasJSActions(){return Qe(this,p,ws).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(M){return typeof M!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:M})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return Qe(this,p,ws).call(this,"GetDocJSActions")}getPageJSActions(M){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:M})}getStructTree(M){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:M})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(M=>new _optional_content_config.OptionalContentConfig(M))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const M="GetMetadata",T=de(this,f).get(M);if(T)return T;const O=this.messageHandler.sendWithPromise(M,null).then(R=>{var Y,q,me,xe;return{info:R[0],metadata:R[1]?new _metadata.Metadata(R[1]):null,contentDispositionFilename:(q=(Y=this._fullReader)==null?void 0:Y.filename)!=null?q:null,contentLength:(xe=(me=this._fullReader)==null?void 0:me.contentLength)!=null?xe:null}});return de(this,f).set(M,O),O}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}startCleanup(){return Ye(this,arguments,function*(){let M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.destroyed){yield this.messageHandler.sendWithPromise("Cleanup",null);for(const T of de(this,m).values())if(!T.cleanup())throw new Error(`startCleanup: Page ${T.pageNumber} is currently rendering.`);this.commonObjs.clear(),M||this.fontLoader.clear(),de(this,f).clear(),this.filterFactory.destroy(!0)}})}get loadingParams(){const{disableAutoFetch:M,enableXfa:T}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:M,enableXfa:T})}}f=new WeakMap,m=new WeakMap,E=new WeakMap,g=new WeakMap,p=new WeakSet,ws=function(M){let T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const O=de(this,f).get(M);if(O)return O;const R=this.messageHandler.sendWithPromise(M,T);return de(this,f).set(M,R),R};class PDFObjects{constructor(){ct(this,H);ct(this,A,Object.create(null))}get(M){let T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(T){const R=Qe(this,H,Ks).call(this,M);return R.capability.promise.then(()=>T(R.data)),null}const O=de(this,A)[M];if(!(O!=null&&O.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${M}.`);return O.data}has(M){const T=de(this,A)[M];return(T==null?void 0:T.capability.settled)||!1}resolve(M){let T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const O=Qe(this,H,Ks).call(this,M);O.data=T,O.capability.resolve()}clear(){var M;for(const T in de(this,A)){const{data:O}=de(this,A)[T];(M=O==null?void 0:O.bitmap)==null||M.close()}ft(this,A,Object.create(null))}}A=new WeakMap,H=new WeakSet,Ks=function(M){var T;return(T=de(this,A))[M]||(T[M]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(M){ct(this,ne,null);ft(this,ne,M),this.onContinue=null}get promise(){return de(this,ne).capability.promise}cancel(){let M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;de(this,ne).cancel(null,M)}get separateAnnots(){const{separateAnnots:M}=de(this,ne).operatorList;if(!M)return!1;const{annotationCanvasMap:T}=de(this,ne);return M.form||M.canvas&&(T==null?void 0:T.size)>0}}ne=new WeakMap,exports.RenderTask=RenderTask;const ee=class ee{constructor(M){let{callback:T,params:O,objs:R,commonObjs:Y,annotationCanvasMap:q,operatorList:me,pageIndex:xe,canvasFactory:Ee,filterFactory:se,useRequestAnimationFrame:Fe=!1,pdfBug:ue=!1,pageColors:ae=null}=M;this.callback=T,this.params=O,this.objs=R,this.commonObjs=Y,this.annotationCanvasMap=q,this.operatorListIdx=null,this.operatorList=me,this._pageIndex=xe,this.canvasFactory=Ee,this.filterFactory=se,this._pdfBug=ue,this.pageColors=ae,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=Fe===!0&&typeof window!="undefined",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=O.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics(M){var xe,Ee;let{transparency:T=!1,optionalContentConfig:O}=M;if(this.cancelled)return;if(this._canvas){if(de(ee,j).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");de(ee,j).add(this._canvas)}this._pdfBug&&((xe=globalThis.StepperManager)!=null&&xe.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:R,viewport:Y,transform:q,background:me}=this.params;this.gfx=new _canvas.CanvasGraphics(R,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:O},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:q,viewport:Y,transparency:T,background:me}),this.operatorListIdx=0,this.graphicsReady=!0,(Ee=this.graphicsReadyCallback)==null||Ee.call(this)}cancel(){var O;let M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.running=!1,this.cancelled=!0,(O=this.gfx)==null||O.endDrawing(),de(ee,j).delete(this._canvas),this.callback(M||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,T))}operatorListChanged(){var M;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(M=this.stepper)==null||M.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}_next(){return Ye(this,null,function*(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),de(ee,j).delete(this._canvas),this.callback())))})}};j=new WeakMap,ct(ee,j,new WeakSet);let InternalRenderTask=ee;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(t,e,r)=>{var n=r(3),i=r(126),s=r(135);n({target:"Set",proto:!0,real:!0,forced:!s("difference")},{difference:i})},(t,e,r)=>{var n=r(127),i=r(128),s=r(129),a=r(132),o=r(133),c=r(130),u=r(131),h=i.has,f=i.remove;t.exports=function(E){var g=n(this),p=o(E),_=s(g);return a(g)<=p.size?c(g,function(A){p.includes(A)&&f(_,A)}):u(p.getIterator(),function(A){h(g,A)&&f(_,A)}),_}},(t,e,r)=>{var n=r(128).has;t.exports=function(i){return n(i),i}},(t,e,r)=>{var n=r(14),i=Set.prototype;t.exports={Set,add:n(i.add),has:n(i.has),remove:n(i.delete),proto:i}},(t,e,r)=>{var n=r(128),i=r(130),s=n.Set,a=n.add;t.exports=function(o){var c=new s;return i(o,function(u){a(c,u)}),c}},(t,e,r)=>{var n=r(14),i=r(131),s=r(128),a=s.Set,o=s.proto,c=n(o.forEach),u=n(o.keys),h=u(new a).next;t.exports=function(f,m,E){return E?i({iterator:u(f),next:h},m):c(f,m)}},(t,e,r)=>{var n=r(8);t.exports=function(i,s,a){for(var o=a?i:i.iterator,c=i.next,u,h;!(u=n(c,o)).done;)if(h=s(u.value),h!==void 0)return h}},(t,e,r)=>{var n=r(72),i=r(128);t.exports=n(i.proto,"size","get")||function(s){return s.size}},(t,e,r)=>{var n=r(31),i=r(47),s=r(8),a=r(62),o=r(134),c="Invalid size",u=RangeError,h=TypeError,f=Math.max,m=function(E,g,p,_){this.set=E,this.size=g,this.has=p,this.keys=_};m.prototype={getIterator:function(){return o(i(s(this.keys,this.set)))},includes:function(E){return s(this.has,this.set,E)}},t.exports=function(E){i(E);var g=+E.size;if(g!==g)throw h(c);var p=a(g);if(p<0)throw u(c);return new m(E,f(p,0),n(E.has),n(E.keys))}},t=>{t.exports=function(e){return{iterator:e,next:e.next,done:!1}}},(t,e,r)=>{var n=r(24),i=function(s){return{size:s,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}};t.exports=function(s){var a=n("Set");try{new a()[s](i(0));try{return new a()[s](i(-1)),!1}catch(o){return!0}}catch(o){return!1}}},(t,e,r)=>{var n=r(3),i=r(7),s=r(137),a=r(135),o=!a("intersection")||i(function(){return Array.from(new Set([1,2,3]).intersection(new Set([3,2])))!=="3,2"});n({target:"Set",proto:!0,real:!0,forced:o},{intersection:s})},(t,e,r)=>{var n=r(127),i=r(128),s=r(132),a=r(133),o=r(130),c=r(131),u=i.Set,h=i.add,f=i.has;t.exports=function(E){var g=n(this),p=a(E),_=new u;return s(g)>p.size?c(p.getIterator(),function(A){f(g,A)&&h(_,A)}):o(g,function(A){p.includes(A)&&h(_,A)}),_}},(t,e,r)=>{var n=r(3),i=r(139),s=r(135);n({target:"Set",proto:!0,real:!0,forced:!s("isDisjointFrom")},{isDisjointFrom:i})},(t,e,r)=>{var n=r(127),i=r(128).has,s=r(132),a=r(133),o=r(130),c=r(131),u=r(140);t.exports=function(f){var m=n(this),E=a(f);if(s(m)<=E.size)return o(m,function(p){if(E.includes(p))return!1},!0)!==!1;var g=E.getIterator();return c(g,function(p){if(i(m,p))return u(g,"normal",!1)})!==!1}},(t,e,r)=>{var n=r(8),i=r(47),s=r(30);t.exports=function(a,o,c){var u,h;i(a);try{if(u=s(a,"return"),!u){if(o==="throw")throw c;return c}u=n(u,a)}catch(f){h=!0,u=f}if(o==="throw")throw c;if(h)throw u;return i(u),c}},(t,e,r)=>{var n=r(3),i=r(142),s=r(135);n({target:"Set",proto:!0,real:!0,forced:!s("isSubsetOf")},{isSubsetOf:i})},(t,e,r)=>{var n=r(127),i=r(132),s=r(130),a=r(133);t.exports=function(c){var u=n(this),h=a(c);return i(u)>h.size?!1:s(u,function(f){if(!h.includes(f))return!1},!0)!==!1}},(t,e,r)=>{var n=r(3),i=r(144),s=r(135);n({target:"Set",proto:!0,real:!0,forced:!s("isSupersetOf")},{isSupersetOf:i})},(t,e,r)=>{var n=r(127),i=r(128).has,s=r(132),a=r(133),o=r(131),c=r(140);t.exports=function(h){var f=n(this),m=a(h);if(s(f)<m.size)return!1;var E=m.getIterator();return o(E,function(g){if(!i(f,g))return c(E,"normal",!1)})!==!1}},(t,e,r)=>{var n=r(3),i=r(146),s=r(135);n({target:"Set",proto:!0,real:!0,forced:!s("symmetricDifference")},{symmetricDifference:i})},(t,e,r)=>{var n=r(127),i=r(128),s=r(129),a=r(133),o=r(131),c=i.add,u=i.has,h=i.remove;t.exports=function(m){var E=n(this),g=a(m).getIterator(),p=s(E);return o(g,function(_){u(E,_)?h(p,_):c(p,_)}),p}},(t,e,r)=>{var n=r(3),i=r(148),s=r(135);n({target:"Set",proto:!0,real:!0,forced:!s("union")},{union:i})},(t,e,r)=>{var n=r(127),i=r(128).add,s=r(129),a=r(133),o=r(131);t.exports=function(u){var h=n(this),f=a(u).getIterator(),m=s(h);return o(f,function(E){i(m,E)}),m}},(t,e,r)=>{var n=r(3),i=r(4),s=r(24),a=r(11),o=r(45).f,c=r(39),u=r(150),h=r(75),f=r(76),m=r(151),E=r(82),g=r(6),p=r(36),_="DOMException",A=s("Error"),H=s(_),te=function(){u(this,ne);var Ee=arguments.length,se=f(Ee<1?void 0:arguments[0]),Fe=f(Ee<2?void 0:arguments[1],"Error"),ue=new H(se,Fe),ae=A(se);return ae.name=_,o(ue,"stack",a(1,E(ae.stack,1))),h(ue,this,te),ue},ne=te.prototype=H.prototype,j="stack"in A(_),ee="stack"in new H(1,2),x=H&&g&&Object.getOwnPropertyDescriptor(i,_),M=!!x&&!(x.writable&&x.configurable),T=j&&!M&&!ee;n({global:!0,constructor:!0,forced:p||T},{DOMException:T?te:H});var O=s(_),R=O.prototype;if(R.constructor!==O){p||o(R,"constructor",a(1,O));for(var Y in m)if(c(m,Y)){var q=m[Y],me=q.s;c(O,me)||o(O,me,a(6,q.c))}}},(t,e,r)=>{var n=r(25),i=TypeError;t.exports=function(s,a){if(n(a,s))return s;throw i("Incorrect invocation")}},t=>{t.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},(t,e,r)=>{var n=r(36),i=r(3),s=r(4),a=r(24),o=r(14),c=r(7),u=r(41),h=r(21),f=r(153),m=r(17),E=r(20),g=r(23),p=r(154),_=r(47),A=r(78),H=r(39),te=r(159),ne=r(44),j=r(64),ee=r(85),x=r(160),M=r(162),T=r(128),O=r(83),R=r(119),Y=s.Object,q=s.Array,me=s.Date,xe=s.Error,Ee=s.EvalError,se=s.RangeError,Fe=s.ReferenceError,ue=s.SyntaxError,ae=s.TypeError,_e=s.URIError,oe=s.PerformanceMark,ie=s.WebAssembly,re=ie&&ie.CompileError||xe,ce=ie&&ie.LinkError||xe,fe=ie&&ie.RuntimeError||xe,pe=a("DOMException"),ve=M.Map,Ae=M.has,be=M.get,je=M.set,Se=T.Set,Xe=T.add,qe=a("Object","keys"),Je=o([].push),We=o((!0).valueOf),Ue=o(1 .valueOf),Ce=o("".valueOf),Le=o(me.prototype.getTime),Ve=u("structuredClone"),Ge="DataCloneError",ut="Transferring",Jt=function(Te){return!c(function(){var ze=new s.Set([7]),zt=Te(ze),ir=Te(Y(7));return zt===ze||!zt.has(7)||typeof ir!="object"||+ir!=7})&&Te},Kt=function(Te,ze){return!c(function(){var zt=new ze,ir=Te({a:zt,b:zt});return!(ir&&ir.a===ir.b&&ir.a instanceof ze&&ir.a.stack===zt.stack)})},Ze=function(Te){return!c(function(){var ze=Te(new s.AggregateError([1],Ve,{cause:3}));return ze.name!=="AggregateError"||ze.errors[0]!==1||ze.message!==Ve||ze.cause!==3})},tr=s.structuredClone,nr=n||!Kt(tr,xe)||!Kt(tr,pe)||!Ze(tr),xr=!tr&&Jt(function(Te){return new oe(Ve,{detail:Te}).detail}),pr=Jt(tr)||xr,vr=function(Te){throw new pe("Uncloneable type: "+Te,Ge)},lr=function(Te,ze){throw new pe((ze||"Cloning")+" of "+Te+" cannot be properly polyfilled in this engine",Ge)},mr=function(Te,ze){return pr||lr(ze),pr(Te)},wr=function(){var Te;try{Te=new s.DataTransfer}catch(ze){try{Te=new s.ClipboardEvent("").clipboardData}catch(zt){}}return Te&&Te.items&&Te.files?Te:null},Cr=function(Te,ze,zt){if(Ae(ze,Te))return be(ze,Te);var ir=zt||A(Te),cr,or,ke,Oe,He,$e;if(ir==="SharedArrayBuffer")pr?cr=pr(Te):cr=Te;else{var St=s.DataView;!St&&typeof Te.slice!="function"&&lr("ArrayBuffer");try{if(typeof Te.slice=="function"&&!Te.resizable)cr=Te.slice(0);else for(or=Te.byteLength,ke=("maxByteLength"in Te)?{maxByteLength:Te.maxByteLength}:void 0,cr=new ArrayBuffer(or,ke),Oe=new St(Te),He=new St(cr),$e=0;$e<or;$e++)He.setUint8($e,Oe.getUint8($e))}catch($t){throw new pe("ArrayBuffer is detached",Ge)}}return je(ze,Te,cr),cr},Rr=function(Te,ze,zt,ir,cr){var or=s[ze];return E(or)||lr(ze),new or(Cr(Te.buffer,cr),zt,ir)},ar=function(Te,ze,zt){this.object=Te,this.type=ze,this.metadata=zt},it=function(Te,ze,zt){if(g(Te)&&vr("Symbol"),!E(Te))return Te;if(ze){if(Ae(ze,Te))return be(ze,Te)}else ze=new ve;var ir=A(Te),cr,or,ke,Oe,He,$e,St,$t;switch(ir){case"Array":ke=q(j(Te));break;case"Object":ke={};break;case"Map":ke=new ve;break;case"Set":ke=new Se;break;case"RegExp":ke=new RegExp(Te.source,x(Te));break;case"Error":switch(or=Te.name,or){case"AggregateError":ke=a("AggregateError")([]);break;case"EvalError":ke=Ee();break;case"RangeError":ke=se();break;case"ReferenceError":ke=Fe();break;case"SyntaxError":ke=ue();break;case"TypeError":ke=ae();break;case"URIError":ke=_e();break;case"CompileError":ke=re();break;case"LinkError":ke=ce();break;case"RuntimeError":ke=fe();break;default:ke=xe()}break;case"DOMException":ke=new pe(Te.message,Te.name);break;case"ArrayBuffer":case"SharedArrayBuffer":ke=zt?new ar(Te,ir):Cr(Te,ze,ir);break;case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float16Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":$e=ir==="DataView"?Te.byteLength:Te.length,ke=zt?new ar(Te,ir,{offset:Te.byteOffset,length:$e}):Rr(Te,ir,Te.byteOffset,$e,ze);break;case"DOMQuad":try{ke=new DOMQuad(it(Te.p1,ze,zt),it(Te.p2,ze,zt),it(Te.p3,ze,zt),it(Te.p4,ze,zt))}catch(Yt){ke=mr(Te,ir)}break;case"File":if(pr)try{ke=pr(Te),A(ke)!==ir&&(ke=void 0)}catch(Yt){}if(!ke)try{ke=new File([Te],Te.name,Te)}catch(Yt){}ke||lr(ir);break;case"FileList":if(Oe=wr(),Oe){for(He=0,$e=j(Te);He<$e;He++)Oe.items.add(it(Te[He],ze,zt));ke=Oe.files}else ke=mr(Te,ir);break;case"ImageData":try{ke=new ImageData(it(Te.data,ze,zt),Te.width,Te.height,{colorSpace:Te.colorSpace})}catch(Yt){ke=mr(Te,ir)}break;default:if(pr)ke=pr(Te);else switch(ir){case"BigInt":ke=Y(Te.valueOf());break;case"Boolean":ke=Y(We(Te));break;case"Number":ke=Y(Ue(Te));break;case"String":ke=Y(Ce(Te));break;case"Date":ke=new me(Le(Te));break;case"Blob":try{ke=Te.slice(0,Te.size,Te.type)}catch(Yt){lr(ir)}break;case"DOMPoint":case"DOMPointReadOnly":cr=s[ir];try{ke=cr.fromPoint?cr.fromPoint(Te):new cr(Te.x,Te.y,Te.z,Te.w)}catch(Yt){lr(ir)}break;case"DOMRect":case"DOMRectReadOnly":cr=s[ir];try{ke=cr.fromRect?cr.fromRect(Te):new cr(Te.x,Te.y,Te.width,Te.height)}catch(Yt){lr(ir)}break;case"DOMMatrix":case"DOMMatrixReadOnly":cr=s[ir];try{ke=cr.fromMatrix?cr.fromMatrix(Te):new cr(Te)}catch(Yt){lr(ir)}break;case"AudioData":case"VideoFrame":h(Te.clone)||lr(ir);try{ke=Te.clone()}catch(Yt){vr(ir)}break;case"CropTarget":case"CryptoKey":case"FileSystemDirectoryHandle":case"FileSystemFileHandle":case"FileSystemHandle":case"GPUCompilationInfo":case"GPUCompilationMessage":case"ImageBitmap":case"RTCCertificate":case"WebAssembly.Module":lr(ir);default:vr(ir)}}switch(je(ze,Te,ke),ir){case"Array":case"Object":for(St=qe(Te),He=0,$e=j(St);He<$e;He++)$t=St[He],te(ke,$t,it(Te[$t],ze,zt));break;case"Map":Te.forEach(function(Yt,_r){je(ke,it(_r,ze,zt),it(Yt,ze,zt))});break;case"Set":Te.forEach(function(Yt){Xe(ke,it(Yt,ze,zt))});break;case"Error":ne(ke,"message",it(Te.message,ze,zt)),H(Te,"cause")&&ne(ke,"cause",it(Te.cause,ze,zt)),or==="AggregateError"&&(ke.errors=it(Te.errors,ze,zt));case"DOMException":O&&ne(ke,"stack",it(Te.stack,ze,zt))}return ke},ot=function(Te,ze){if(!E(Te))return Te;if(Ae(ze,Te))return be(ze,Te);var zt,ir,cr,or,ke,Oe,He,$e;if(Te instanceof ar)switch(zt=Te.type,ir=Te.object,zt){case"ArrayBuffer":case"SharedArrayBuffer":$e=Cr(ir,ze,zt);break;case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float16Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":cr=Te.metadata,$e=Rr(ir,zt,cr.offset,cr.length,ze)}else switch(A(Te)){case"Array":case"Object":for(Oe=qe(Te),or=0,ke=j(Oe);or<ke;or++)He=Oe[or],Te[He]=ot(Te[He],ze);break;case"Map":$e=new ve,Te.forEach(function(St,$t){je($e,ot($t,ze),ot(St,ze))});break;case"Set":$e=new Se,Te.forEach(function(St){Xe($e,ot(St,ze))});break;case"Error":Te.message=ot(Te.message,ze),H(Te,"cause")&&(Te.cause=ot(Te.cause,ze)),Te.name==="AggregateError"&&(Te.errors=ot(Te.errors,ze));case"DOMException":O&&(Te.stack=ot(Te.stack,ze))}return je(ze,Te,$e||Te),$e||Te},gr=function(Te,ze){if(!E(Te))throw ae("Transfer option cannot be converted to a sequence");var zt=[];p(Te,function(Yt){Je(zt,_(Yt))});for(var ir=0,cr=j(zt),or=[],ke,Oe,He,$e,St,$t;ir<cr;){if(ke=zt[ir++],Oe=A(ke),Oe==="ArrayBuffer"){Je(or,ke);continue}if(Ae(ze,ke))throw new pe("Duplicate transferable",Ge);if(R)$e=tr(ke,{transfer:[ke]});else switch(Oe){case"ImageBitmap":He=s.OffscreenCanvas,f(He)||lr(Oe,ut);try{St=new He(ke.width,ke.height),$t=St.getContext("bitmaprenderer"),$t.transferFromImageBitmap(ke),$e=St.transferToImageBitmap()}catch(Yt){}break;case"AudioData":case"VideoFrame":(!h(ke.clone)||!h(ke.close))&&lr(Oe,ut);try{$e=ke.clone(),ke.close()}catch(Yt){}break;case"MediaSourceHandle":case"MessagePort":case"OffscreenCanvas":case"ReadableStream":case"TransformStream":case"WritableStream":lr(Oe,ut)}if($e===void 0)throw new pe("This object cannot be transferred: "+Oe,Ge);je(ze,ke,$e)}return or},Tr=function(Te,ze){for(var zt=0,ir=j(Te),cr,or;zt<ir;){if(cr=Te[zt++],Ae(ze,cr))throw new pe("Duplicate transferable",Ge);R?or=tr(cr,{transfer:[cr]}):(h(cr.transfer)||lr("ArrayBuffer",ut),or=cr.transfer()),je(ze,cr,or)}};i({global:!0,enumerable:!0,sham:!R,forced:nr},{structuredClone:function(ze){var zt=ee(arguments.length,1)>1&&!m(arguments[1])?_(arguments[1]):void 0,ir=zt?zt.transfer:void 0,cr=!1,or,ke;ir!==void 0&&(or=new ve,ke=gr(ir,or),cr=!!j(ke));var Oe=it(ze,or,cr);return cr&&(or=new ve,Tr(ir,or),Oe=ot(Oe,or)),Oe}})},(t,e,r)=>{var n=r(14),i=r(7),s=r(21),a=r(78),o=r(24),c=r(51),u=function(){},h=[],f=o("Reflect","construct"),m=/^\s*(?:class|function)\b/,E=n(m.exec),g=!m.exec(u),p=function(H){if(!s(H))return!1;try{return f(u,h,H),!0}catch(te){return!1}},_=function(H){if(!s(H))return!1;switch(a(H)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return g||!!E(m,c(H))}catch(te){return!0}};_.sham=!0,t.exports=!f||i(function(){var A;return p(p.call)||!p(Object)||!p(function(){A=!0})||A})?_:p},(t,e,r)=>{var n=r(99),i=r(8),s=r(47),a=r(32),o=r(155),c=r(64),u=r(25),h=r(157),f=r(158),m=r(140),E=TypeError,g=function(_,A){this.stopped=_,this.result=A},p=g.prototype;t.exports=function(_,A,H){var te=H&&H.that,ne=!!(H&&H.AS_ENTRIES),j=!!(H&&H.IS_RECORD),ee=!!(H&&H.IS_ITERATOR),x=!!(H&&H.INTERRUPTED),M=n(A,te),T,O,R,Y,q,me,xe,Ee=function(Fe){return T&&m(T,"normal",Fe),new g(!0,Fe)},se=function(Fe){return ne?(s(Fe),x?M(Fe[0],Fe[1],Ee):M(Fe[0],Fe[1])):x?M(Fe,Ee):M(Fe)};if(j)T=_.iterator;else if(ee)T=_;else{if(O=f(_),!O)throw E(a(_)+" is not iterable");if(o(O)){for(R=0,Y=c(_);Y>R;R++)if(q=se(_[R]),q&&u(p,q))return q;return new g(!1)}T=h(_,O)}for(me=j?_.next:T.next;!(xe=i(me,T)).done;){try{q=se(xe.value)}catch(Fe){m(T,"throw",Fe)}if(typeof q=="object"&&q&&u(p,q))return q}return new g(!1)}},(t,e,r)=>{var n=r(34),i=r(156),s=n("iterator"),a=Array.prototype;t.exports=function(o){return o!==void 0&&(i.Array===o||a[s]===o)}},t=>{t.exports={}},(t,e,r)=>{var n=r(8),i=r(31),s=r(47),a=r(32),o=r(158),c=TypeError;t.exports=function(u,h){var f=arguments.length<2?o(u):h;if(i(f))return s(n(f,u));throw c(a(u)+" is not iterable")}},(t,e,r)=>{var n=r(78),i=r(30),s=r(17),a=r(156),o=r(34),c=o("iterator");t.exports=function(u){if(!s(u))return i(u,c)||i(u,"@@iterator")||a[n(u)]}},(t,e,r)=>{var n=r(18),i=r(45),s=r(11);t.exports=function(a,o,c){var u=n(o);u in a?i.f(a,u,s(0,c)):a[u]=c}},(t,e,r)=>{var n=r(8),i=r(39),s=r(25),a=r(161),o=RegExp.prototype;t.exports=function(c){var u=c.flags;return u===void 0&&!("flags"in o)&&!i(c,"flags")&&s(o,c)?n(a,c):u}},(t,e,r)=>{var n=r(47);t.exports=function(){var i=n(this),s="";return i.hasIndices&&(s+="d"),i.global&&(s+="g"),i.ignoreCase&&(s+="i"),i.multiline&&(s+="m"),i.dotAll&&(s+="s"),i.unicode&&(s+="u"),i.unicodeSets&&(s+="v"),i.sticky&&(s+="y"),s}},(t,e,r)=>{var n=r(14),i=Map.prototype;t.exports={Map,set:n(i.set),get:n(i.get),has:n(i.has),remove:n(i.delete),proto:i}},(t,e,r)=>{var u,h,f,eo,E;Object.defineProperty(e,"__esModule",{value:!0}),e.SerializableEmpty=e.PrintAnnotationStorage=e.AnnotationStorage=void 0,r(89),r(149),r(152);var n=r(1),i=r(164),s=r(170);const a=Object.freeze({map:null,hash:"",transfers:void 0});e.SerializableEmpty=a;class o{constructor(){ct(this,f);ct(this,u,!1);ct(this,h,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(p,_){const A=de(this,h).get(p);return A===void 0?_:Object.assign(_,A)}getRawValue(p){return de(this,h).get(p)}remove(p){if(de(this,h).delete(p),de(this,h).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const _ of de(this,h).values())if(_ instanceof i.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(p,_){const A=de(this,h).get(p);let H=!1;if(A!==void 0)for(const[te,ne]of Object.entries(_))A[te]!==ne&&(H=!0,A[te]=ne);else H=!0,de(this,h).set(p,_);H&&Qe(this,f,eo).call(this),_ instanceof i.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(_.constructor._type)}has(p){return de(this,h).has(p)}getAll(){return de(this,h).size>0?(0,n.objectFromMap)(de(this,h)):null}setAll(p){for(const[_,A]of Object.entries(p))this.setValue(_,A)}get size(){return de(this,h).size}resetModified(){de(this,u)&&(ft(this,u,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new c(this)}get serializable(){if(de(this,h).size===0)return a;const p=new Map,_=new s.MurmurHash3_64,A=[],H=Object.create(null);let te=!1;for(const[ne,j]of de(this,h)){const ee=j instanceof i.AnnotationEditor?j.serialize(!1,H):j;ee&&(p.set(ne,ee),_.update(`${ne}:${JSON.stringify(ee)}`),te||(te=!!ee.bitmap))}if(te)for(const ne of p.values())ne.bitmap&&A.push(ne.bitmap);return p.size>0?{map:p,hash:_.hexdigest(),transfers:A}:a}}u=new WeakMap,h=new WeakMap,f=new WeakSet,eo=function(){de(this,u)||(ft(this,u,!0),typeof this.onSetModified=="function"&&this.onSetModified())},e.AnnotationStorage=o;class c extends o{constructor(_){super();ct(this,E);const{map:A,hash:H,transfers:te}=_.serializable,ne=structuredClone(A,null);ft(this,E,{map:ne,hash:H,transfers:te})}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return de(this,E)}}E=new WeakMap,e.PrintAnnotationStorage=c},(t,e,r)=>{var c,u,h,f,m,E,g,p,_,A,H,te,ne,j,ee,Ys,qs,T,Zs,Js,to,oo,co,Qs,uo;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0,r(89),r(2);var n=r(165),i=r(1),s=r(168);const se=class se{constructor(ue){ct(this,ee);ct(this,c,"");ct(this,u,!1);ct(this,h,null);ct(this,f,null);ct(this,m,null);ct(this,E,!1);ct(this,g,null);ct(this,p,this.focusin.bind(this));ct(this,_,this.focusout.bind(this));ct(this,A,!1);ct(this,H,!1);ct(this,te,!1);Hr(this,"_initialOptions",Object.create(null));Hr(this,"_uiManager",null);Hr(this,"_focusEventsAllowed",!0);Hr(this,"_l10nPromise",null);ct(this,ne,!1);ct(this,j,se._zIndex++);this.constructor===se&&(0,i.unreachable)("Cannot initialize AnnotationEditor."),this.parent=ue.parent,this.id=ue.id,this.width=this.height=null,this.pageIndex=ue.parent.pageIndex,this.name=ue.name,this.div=null,this._uiManager=ue.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=ue.isCentered,this._structTreeParentId=null;const{rotation:ae,rawDims:{pageWidth:_e,pageHeight:oe,pageX:ie,pageY:re}}=this.parent.viewport;this.rotation=ae,this.pageRotation=(360+ae-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[_e,oe],this.pageTranslation=[ie,re];const[ce,fe]=this.parentDimensions;this.x=ue.x/ce,this.y=ue.y/fe,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,i.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(ue){const ae=new o({id:ue.parent.getNextId(),parent:ue.parent,uiManager:ue._uiManager});ae.annotationElementId=ue.annotationElementId,ae.deleted=!0,ae._uiManager.addToAnnotationStorage(ae)}static initialize(ue){let ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(se._l10nPromise||(se._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(oe=>[oe,ue.get(oe)]))),ae!=null&&ae.strings)for(const oe of ae.strings)se._l10nPromise.set(oe,ue.get(oe));if(se._borderLineWidth!==-1)return;const _e=getComputedStyle(document.documentElement);se._borderLineWidth=parseFloat(_e.getPropertyValue("--outline-width"))||0}static updateDefaultParams(ue,ae){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(ue){return!1}static paste(ue,ae){(0,i.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return de(this,ne)}set _isDraggable(ue){var ae;ft(this,ne,ue),(ae=this.div)==null||ae.classList.toggle("draggable",ue)}center(){const[ue,ae]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*ae/(ue*2),this.y+=this.width*ue/(ae*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*ae/(ue*2),this.y-=this.width*ue/(ae*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(ue){this._uiManager.addCommands(ue)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=de(this,j)}setParent(ue){ue!==null&&(this.pageIndex=ue.pageIndex,this.pageDimensions=ue.pageDimensions),this.parent=ue}focusin(ue){this._focusEventsAllowed&&(de(this,A)?ft(this,A,!1):this.parent.setSelected(this))}focusout(ue){var _e;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const ae=ue.relatedTarget;ae!=null&&ae.closest(`#${this.id}`)||(ue.preventDefault(),(_e=this.parent)!=null&&_e.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(ue,ae,_e,oe){const[ie,re]=this.parentDimensions;[_e,oe]=this.screenToPageTranslation(_e,oe),this.x=(ue+_e)/ie,this.y=(ae+oe)/re,this.fixAndSetPosition()}translate(ue,ae){Qe(this,ee,Ys).call(this,this.parentDimensions,ue,ae)}translateInPage(ue,ae){Qe(this,ee,Ys).call(this,this.pageDimensions,ue,ae),this.div.scrollIntoView({block:"nearest"})}drag(ue,ae){const[_e,oe]=this.parentDimensions;if(this.x+=ue/_e,this.y+=ae/oe,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:pe,y:ve}=this.div.getBoundingClientRect();this.parent.findNewParent(this,pe,ve)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:ie,y:re}=this;const[ce,fe]=Qe(this,ee,qs).call(this);ie+=ce,re+=fe,this.div.style.left=`${(100*ie).toFixed(2)}%`,this.div.style.top=`${(100*re).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[ue,ae]=this.pageDimensions;let{x:_e,y:oe,width:ie,height:re}=this;switch(ie*=ue,re*=ae,_e*=ue,oe*=ae,this.rotation){case 0:_e=Math.max(0,Math.min(ue-ie,_e)),oe=Math.max(0,Math.min(ae-re,oe));break;case 90:_e=Math.max(0,Math.min(ue-re,_e)),oe=Math.min(ae,Math.max(ie,oe));break;case 180:_e=Math.min(ue,Math.max(ie,_e)),oe=Math.min(ae,Math.max(re,oe));break;case 270:_e=Math.min(ue,Math.max(re,_e)),oe=Math.max(0,Math.min(ae-ie,oe));break}this.x=_e/=ue,this.y=oe/=ae;const[ce,fe]=Qe(this,ee,qs).call(this);_e+=ce,oe+=fe;const{style:pe}=this.div;pe.left=`${(100*_e).toFixed(2)}%`,pe.top=`${(100*oe).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(ue,ae){var _e;return Qe(_e=se,T,Zs).call(_e,ue,ae,this.parentRotation)}pageTranslationToScreen(ue,ae){var _e;return Qe(_e=se,T,Zs).call(_e,ue,ae,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:ue,pageDimensions:[ae,_e]}=this,oe=ae*ue,ie=_e*ue;return i.FeatureTest.isCSSRoundSupported?[Math.round(oe),Math.round(ie)]:[oe,ie]}setDims(ue,ae){var ie;const[_e,oe]=this.parentDimensions;this.div.style.width=`${(100*ue/_e).toFixed(2)}%`,de(this,E)||(this.div.style.height=`${(100*ae/oe).toFixed(2)}%`),(ie=de(this,h))==null||ie.classList.toggle("small",ue<se.SMALL_EDITOR_SIZE||ae<se.SMALL_EDITOR_SIZE)}fixDims(){const{style:ue}=this.div,{height:ae,width:_e}=ue,oe=_e.endsWith("%"),ie=!de(this,E)&&ae.endsWith("%");if(oe&&ie)return;const[re,ce]=this.parentDimensions;oe||(ue.width=`${(100*parseFloat(_e)/re).toFixed(2)}%`),!de(this,E)&&!ie&&(ue.height=`${(100*parseFloat(ae)/ce).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}addAltTextButton(){return Ye(this,null,function*(){if(de(this,h))return;const ue=ft(this,h,document.createElement("button"));ue.className="altText";const ae=yield se._l10nPromise.get("editor_alt_text_button_label");ue.textContent=ae,ue.setAttribute("aria-label",ae),ue.tabIndex="0",ue.addEventListener("contextmenu",s.noContextMenu),ue.addEventListener("pointerdown",_e=>_e.stopPropagation()),ue.addEventListener("click",_e=>{_e.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),ue.addEventListener("keydown",_e=>{_e.target===ue&&_e.key==="Enter"&&(_e.preventDefault(),this._uiManager.editAltText(this))}),Qe(this,ee,Qs).call(this),this.div.append(ue),se.SMALL_EDITOR_SIZE||(se.SMALL_EDITOR_SIZE=Math.min(128,Math.round(ue.getBoundingClientRect().width*1.4)))})}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:de(this,c),decorative:de(this,u)}}set altTextData(ue){let{altText:ae,decorative:_e}=ue;de(this,c)===ae&&de(this,u)===_e||(ft(this,c,ae),ft(this,u,_e),Qe(this,ee,Qs).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",de(this,p)),this.div.addEventListener("focusout",de(this,_));const[ue,ae]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*ae/ue).toFixed(2)}%`,this.div.style.maxHeight=`${(100*ue/ae).toFixed(2)}%`);const[_e,oe]=this.getInitialTranslation();return this.translate(_e,oe),(0,n.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(ue){const{isMac:ae}=i.FeatureTest.platform;if(ue.button!==0||ue.ctrlKey&&ae){ue.preventDefault();return}ft(this,A,!0),Qe(this,ee,uo).call(this,ue)}moveInDOM(){var ue;(ue=this.parent)==null||ue.moveEditorInDOM(this)}_setParentAndPosition(ue,ae,_e){ue.changeParent(this),this.x=ae,this.y=_e,this.fixAndSetPosition()}getRect(ue,ae){const _e=this.parentScale,[oe,ie]=this.pageDimensions,[re,ce]=this.pageTranslation,fe=ue/_e,pe=ae/_e,ve=this.x*oe,Ae=this.y*ie,be=this.width*oe,je=this.height*ie;switch(this.rotation){case 0:return[ve+fe+re,ie-Ae-pe-je+ce,ve+fe+be+re,ie-Ae-pe+ce];case 90:return[ve+pe+re,ie-Ae+fe+ce,ve+pe+je+re,ie-Ae+fe+be+ce];case 180:return[ve-fe-be+re,ie-Ae+pe+ce,ve-fe+re,ie-Ae+pe+je+ce];case 270:return[ve-pe-je+re,ie-Ae-fe-be+ce,ve-pe+re,ie-Ae-fe+ce];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(ue,ae){const[_e,oe,ie,re]=ue,ce=ie-_e,fe=re-oe;switch(this.rotation){case 0:return[_e,ae-re,ce,fe];case 90:return[_e,ae-oe,fe,ce];case 180:return[ie,ae-oe,ce,fe];case 270:return[ie,ae-re,fe,ce];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){ft(this,te,!0)}disableEditMode(){ft(this,te,!1)}isInEditMode(){return de(this,te)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var ue,ae;(ue=this.div)==null||ue.addEventListener("focusin",de(this,p)),(ae=this.div)==null||ae.addEventListener("focusout",de(this,_))}serialize(){(0,i.unreachable)("An editor must be serializable")}static deserialize(ue,ae,_e){const oe=new this.prototype.constructor({parent:ae,id:ae.getNextId(),uiManager:_e});oe.rotation=ue.rotation;const[ie,re]=oe.pageDimensions,[ce,fe,pe,ve]=oe.getRectInCurrentCoords(ue.rect,re);return oe.x=ce/ie,oe.y=fe/re,oe.width=pe/ie,oe.height=ve/re,oe}remove(){var ue;this.div.removeEventListener("focusin",de(this,p)),this.div.removeEventListener("focusout",de(this,_)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(ue=de(this,h))==null||ue.remove(),ft(this,h,null),ft(this,f,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(Qe(this,ee,to).call(this),de(this,g).classList.remove("hidden"))}select(){var ue;this.makeResizable(),(ue=this.div)==null||ue.classList.add("selectedEditor")}unselect(){var ue,ae,_e;(ue=de(this,g))==null||ue.classList.add("hidden"),(ae=this.div)==null||ae.classList.remove("selectedEditor"),(_e=this.div)!=null&&_e.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(ue,ae){}disableEditing(){de(this,h)&&(de(this,h).hidden=!0)}enableEditing(){de(this,h)&&(de(this,h).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return de(this,H)}set isEditing(ue){ft(this,H,ue),this.parent&&(ue?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(ue,ae){ft(this,E,!0);const _e=ue/ae,{style:oe}=this.div;oe.aspectRatio=_e,oe.height="auto"}static get MIN_SIZE(){return 16}};c=new WeakMap,u=new WeakMap,h=new WeakMap,f=new WeakMap,m=new WeakMap,E=new WeakMap,g=new WeakMap,p=new WeakMap,_=new WeakMap,A=new WeakMap,H=new WeakMap,te=new WeakMap,ne=new WeakMap,j=new WeakMap,ee=new WeakSet,Ys=function(ue,ae,_e){let[oe,ie]=ue;[ae,_e]=this.screenToPageTranslation(ae,_e),this.x+=ae/oe,this.y+=_e/ie,this.fixAndSetPosition()},qs=function(){const[ue,ae]=this.parentDimensions,{_borderLineWidth:_e}=se,oe=_e/ue,ie=_e/ae;switch(this.rotation){case 90:return[-oe,ie];case 180:return[oe,ie];case 270:return[oe,-ie];default:return[-oe,-ie]}},T=new WeakSet,Zs=function(ue,ae,_e){switch(_e){case 90:return[ae,-ue];case 180:return[-ue,-ae];case 270:return[-ae,ue];default:return[ue,ae]}},Js=function(ue){switch(ue){case 90:{const[ae,_e]=this.pageDimensions;return[0,-ae/_e,_e/ae,0]}case 180:return[-1,0,0,-1];case 270:{const[ae,_e]=this.pageDimensions;return[0,ae/_e,-_e/ae,0]}default:return[1,0,0,1]}},to=function(){if(de(this,g))return;ft(this,g,document.createElement("div")),de(this,g).classList.add("resizers");const ue=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||ue.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const ae of ue){const _e=document.createElement("div");de(this,g).append(_e),_e.classList.add("resizer",ae),_e.addEventListener("pointerdown",Qe(this,ee,oo).bind(this,ae)),_e.addEventListener("contextmenu",s.noContextMenu)}this.div.prepend(de(this,g))},oo=function(ue,ae){ae.preventDefault();const{isMac:_e}=i.FeatureTest.platform;if(ae.button!==0||ae.ctrlKey&&_e)return;const oe=Qe(this,ee,co).bind(this,ue),ie=this._isDraggable;this._isDraggable=!1;const re={passive:!0,capture:!0};window.addEventListener("pointermove",oe,re);const ce=this.x,fe=this.y,pe=this.width,ve=this.height,Ae=this.parent.div.style.cursor,be=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(ae.target).cursor;const je=()=>{this._isDraggable=ie,window.removeEventListener("pointerup",je),window.removeEventListener("blur",je),window.removeEventListener("pointermove",oe,re),this.parent.div.style.cursor=Ae,this.div.style.cursor=be;const Se=this.x,Xe=this.y,qe=this.width,Je=this.height;Se===ce&&Xe===fe&&qe===pe&&Je===ve||this.addCommands({cmd:()=>{this.width=qe,this.height=Je,this.x=Se,this.y=Xe;const[We,Ue]=this.parentDimensions;this.setDims(We*qe,Ue*Je),this.fixAndSetPosition()},undo:()=>{this.width=pe,this.height=ve,this.x=ce,this.y=fe;const[We,Ue]=this.parentDimensions;this.setDims(We*pe,Ue*ve),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",je),window.addEventListener("blur",je)},co=function(ue,ae){const[_e,oe]=this.parentDimensions,ie=this.x,re=this.y,ce=this.width,fe=this.height,pe=se.MIN_SIZE/_e,ve=se.MIN_SIZE/oe,Ae=lr=>Math.round(lr*1e4)/1e4,be=Qe(this,ee,Js).call(this,this.rotation),je=(lr,mr)=>[be[0]*lr+be[2]*mr,be[1]*lr+be[3]*mr],Se=Qe(this,ee,Js).call(this,360-this.rotation),Xe=(lr,mr)=>[Se[0]*lr+Se[2]*mr,Se[1]*lr+Se[3]*mr];let qe,Je,We=!1,Ue=!1;switch(ue){case"topLeft":We=!0,qe=(lr,mr)=>[0,0],Je=(lr,mr)=>[lr,mr];break;case"topMiddle":qe=(lr,mr)=>[lr/2,0],Je=(lr,mr)=>[lr/2,mr];break;case"topRight":We=!0,qe=(lr,mr)=>[lr,0],Je=(lr,mr)=>[0,mr];break;case"middleRight":Ue=!0,qe=(lr,mr)=>[lr,mr/2],Je=(lr,mr)=>[0,mr/2];break;case"bottomRight":We=!0,qe=(lr,mr)=>[lr,mr],Je=(lr,mr)=>[0,0];break;case"bottomMiddle":qe=(lr,mr)=>[lr/2,mr],Je=(lr,mr)=>[lr/2,0];break;case"bottomLeft":We=!0,qe=(lr,mr)=>[0,mr],Je=(lr,mr)=>[lr,0];break;case"middleLeft":Ue=!0,qe=(lr,mr)=>[0,mr/2],Je=(lr,mr)=>[lr,mr/2];break}const Ce=qe(ce,fe),Le=Je(ce,fe);let Ve=je(...Le);const Ge=Ae(ie+Ve[0]),ut=Ae(re+Ve[1]);let Jt=1,Kt=1,[Ze,tr]=this.screenToPageTranslation(ae.movementX,ae.movementY);if([Ze,tr]=Xe(Ze/_e,tr/oe),We){const lr=Math.hypot(ce,fe);Jt=Kt=Math.max(Math.min(Math.hypot(Le[0]-Ce[0]-Ze,Le[1]-Ce[1]-tr)/lr,1/ce,1/fe),pe/ce,ve/fe)}else Ue?Jt=Math.max(pe,Math.min(1,Math.abs(Le[0]-Ce[0]-Ze)))/ce:Kt=Math.max(ve,Math.min(1,Math.abs(Le[1]-Ce[1]-tr)))/fe;const nr=Ae(ce*Jt),xr=Ae(fe*Kt);Ve=je(...Je(nr,xr));const pr=Ge-Ve[0],vr=ut-Ve[1];this.width=nr,this.height=xr,this.x=pr,this.y=vr,this.setDims(_e*nr,oe*xr),this.fixAndSetPosition()},Qs=function(){return Ye(this,null,function*(){var _e;const ue=de(this,h);if(!ue)return;if(!de(this,c)&&!de(this,u)){ue.classList.remove("done"),(_e=de(this,f))==null||_e.remove();return}se._l10nPromise.get("editor_alt_text_edit_button_label").then(oe=>{ue.setAttribute("aria-label",oe)});let ae=de(this,f);if(!ae){ft(this,f,ae=document.createElement("span")),ae.className="tooltip",ae.setAttribute("role","tooltip");const oe=ae.id=`alt-text-tooltip-${this.id}`;ue.setAttribute("aria-describedby",oe);const ie=100;ue.addEventListener("mouseenter",()=>{ft(this,m,setTimeout(()=>{ft(this,m,null),de(this,f).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},ie))}),ue.addEventListener("mouseleave",()=>{var re;clearTimeout(de(this,m)),ft(this,m,null),(re=de(this,f))==null||re.classList.remove("show")})}ue.classList.add("done"),ae.innerText=de(this,u)?yield se._l10nPromise.get("editor_alt_text_decorative_tooltip"):de(this,c),ae.parentNode||ue.append(ae)})},uo=function(ue){if(!this._isDraggable)return;const ae=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let _e,oe;ae&&(_e={passive:!0,capture:!0},oe=re=>{const[ce,fe]=this.screenToPageTranslation(re.movementX,re.movementY);this._uiManager.dragSelectedEditors(ce,fe)},window.addEventListener("pointermove",oe,_e));const ie=()=>{if(window.removeEventListener("pointerup",ie),window.removeEventListener("blur",ie),ae&&window.removeEventListener("pointermove",oe,_e),ft(this,A,!1),!this._uiManager.endDragSession()){const{isMac:re}=i.FeatureTest.platform;ue.ctrlKey&&!re||ue.shiftKey||ue.metaKey&&re?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",ie),window.addEventListener("blur",ie)},ct(se,T),Hr(se,"_borderLineWidth",-1),Hr(se,"_colorManager",new n.ColorManager),Hr(se,"_zIndex",1),Hr(se,"SMALL_EDITOR_SIZE",0);let a=se;e.AnnotationEditor=a;class o extends a{constructor(ue){super(ue),this.annotationElementId=ue.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(t,e,r)=>{var E,g,p,_,A,ea,ne,j,ee,x,M,ho,R,Y,q,me,xe,Ee,se,Fe,ue,ae,_e,oe,ie,re,ce,fe,pe,ve,Ae,be,je,Se,Xe,qe,Je,We,Ue,Ce,Le,Ve,Ge,ut,Jt,Kt,Ze,fo,ta,ra,bs,na,ia,Tn,Ki,po,mo,sa,Yi,aa;Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=s,e.opacityToHex=a,r(93),r(101),r(102),r(105),r(107),r(109),r(113),r(116),r(123),r(2),r(89),r(125),r(136),r(138),r(141),r(143),r(145),r(147),r(166);var n=r(1),i=r(168);function s(Tr,Te,ze){for(const zt of ze)Te.addEventListener(zt,Tr[zt].bind(Tr))}function a(Tr){return Math.round(Math.min(255,Math.max(1,255*Tr))).toString(16).padStart(2,"0")}class o{constructor(){ct(this,E,0)}getId(){return`${n.AnnotationEditorPrefix}${Xi(this,E)._++}`}}E=new WeakMap;const te=class te{constructor(){ct(this,A);ct(this,g,(0,n.getUuid)());ct(this,p,0);ct(this,_,null)}static get _isSVGFittingCanvas(){const Te='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',zt=new OffscreenCanvas(1,3).getContext("2d"),ir=new Image;ir.src=Te;const cr=ir.decode().then(()=>(zt.drawImage(ir,0,0,1,1,0,0,1,3),new Uint32Array(zt.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,n.shadow)(this,"_isSVGFittingCanvas",cr)}getFromFile(Te){return Ye(this,null,function*(){const{lastModified:ze,name:zt,size:ir,type:cr}=Te;return Qe(this,A,ea).call(this,`${ze}_${zt}_${ir}_${cr}`,Te)})}getFromUrl(Te){return Ye(this,null,function*(){return Qe(this,A,ea).call(this,Te,Te)})}getFromId(Te){return Ye(this,null,function*(){de(this,_)||ft(this,_,new Map);const ze=de(this,_).get(Te);return ze?ze.bitmap?(ze.refCounter+=1,ze):ze.file?this.getFromFile(ze.file):this.getFromUrl(ze.url):null})}getSvgUrl(Te){const ze=de(this,_).get(Te);return ze!=null&&ze.isSvg?ze.svgUrl:null}deleteId(Te){de(this,_)||ft(this,_,new Map);const ze=de(this,_).get(Te);ze&&(ze.refCounter-=1,ze.refCounter===0&&(ze.bitmap=null))}isValidId(Te){return Te.startsWith(`image_${de(this,g)}_`)}};g=new WeakMap,p=new WeakMap,_=new WeakMap,A=new WeakSet,ea=function(Te,ze){return Ye(this,null,function*(){de(this,_)||ft(this,_,new Map);let zt=de(this,_).get(Te);if(zt===null)return null;if(zt!=null&&zt.bitmap)return zt.refCounter+=1,zt;try{zt||(zt={bitmap:null,id:`image_${de(this,g)}_${Xi(this,p)._++}`,refCounter:0,isSvg:!1});let ir;if(typeof ze=="string"){zt.url=ze;const cr=yield fetch(ze);if(!cr.ok)throw new Error(cr.statusText);ir=yield cr.blob()}else ir=zt.file=ze;if(ir.type==="image/svg+xml"){const cr=te._isSVGFittingCanvas,or=new FileReader,ke=new Image,Oe=new Promise((He,$e)=>{ke.onload=()=>{zt.bitmap=ke,zt.isSvg=!0,He()},or.onload=()=>Ye(this,null,function*(){const St=zt.svgUrl=or.result;ke.src=(yield cr)?`${St}#svgView(preserveAspectRatio(none))`:St}),ke.onerror=or.onerror=$e});or.readAsDataURL(ir),yield Oe}else zt.bitmap=yield createImageBitmap(ir);zt.refCounter=1}catch(ir){console.error(ir),zt=null}return de(this,_).set(Te,zt),zt&&de(this,_).set(zt.id,zt),zt})};let c=te;class u{constructor(){ct(this,ne,[]);ct(this,j,!1);ct(this,ee);ct(this,x,-1);let Te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:128;ft(this,ee,Te)}add(Te){let{cmd:ze,undo:zt,mustExec:ir,type:cr=NaN,overwriteIfSameType:or=!1,keepUndo:ke=!1}=Te;if(ir&&ze(),de(this,j))return;const Oe={cmd:ze,undo:zt,type:cr};if(de(this,x)===-1){de(this,ne).length>0&&(de(this,ne).length=0),ft(this,x,0),de(this,ne).push(Oe);return}if(or&&de(this,ne)[de(this,x)].type===cr){ke&&(Oe.undo=de(this,ne)[de(this,x)].undo),de(this,ne)[de(this,x)]=Oe;return}const He=de(this,x)+1;He===de(this,ee)?de(this,ne).splice(0,1):(ft(this,x,He),He<de(this,ne).length&&de(this,ne).splice(He)),de(this,ne).push(Oe)}undo(){de(this,x)!==-1&&(ft(this,j,!0),de(this,ne)[de(this,x)].undo(),ft(this,j,!1),ft(this,x,de(this,x)-1))}redo(){de(this,x)<de(this,ne).length-1&&(ft(this,x,de(this,x)+1),ft(this,j,!0),de(this,ne)[de(this,x)].cmd(),ft(this,j,!1))}hasSomethingToUndo(){return de(this,x)!==-1}hasSomethingToRedo(){return de(this,x)<de(this,ne).length-1}destroy(){ft(this,ne,null)}}ne=new WeakMap,j=new WeakMap,ee=new WeakMap,x=new WeakMap,e.CommandManager=u;class h{constructor(Te){ct(this,M);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:ze}=n.FeatureTest.platform;for(const[zt,ir,cr={}]of Te)for(const or of zt){const ke=or.startsWith("mac+");ze&&ke?(this.callbacks.set(or.slice(4),{callback:ir,options:cr}),this.allKeys.add(or.split("+").at(-1))):!ze&&!ke&&(this.callbacks.set(or,{callback:ir,options:cr}),this.allKeys.add(or.split("+").at(-1)))}}exec(Te,ze){if(!this.allKeys.has(ze.key))return;const zt=this.callbacks.get(Qe(this,M,ho).call(this,ze));if(!zt)return;const{callback:ir,options:{bubbles:cr=!1,args:or=[],checker:ke=null}}=zt;ke&&!ke(Te,ze)||(ir.bind(Te,...or)(),cr||(ze.stopPropagation(),ze.preventDefault()))}}M=new WeakSet,ho=function(Te){Te.altKey&&this.buffer.push("alt"),Te.ctrlKey&&this.buffer.push("ctrl"),Te.metaKey&&this.buffer.push("meta"),Te.shiftKey&&this.buffer.push("shift"),this.buffer.push(Te.key);const ze=this.buffer.join("+");return this.buffer.length=0,ze},e.KeyboardManager=h;const O=class O{get _colors(){const Te=new Map([["CanvasText",null],["Canvas",null]]);return(0,i.getColorValues)(Te),(0,n.shadow)(this,"_colors",Te)}convert(Te){const ze=(0,i.getRGB)(Te);if(!window.matchMedia("(forced-colors: active)").matches)return ze;for(const[zt,ir]of this._colors)if(ir.every((cr,or)=>cr===ze[or]))return O._colorsMapping.get(zt);return ze}getHexCode(Te){const ze=this._colors.get(Te);return ze?n.Util.makeHexColor(...ze):Te}};Hr(O,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let f=O;e.ColorManager=f;const gr=class gr{constructor(Te,ze,zt,ir,cr,or){ct(this,Ze);ct(this,R,null);ct(this,Y,new Map);ct(this,q,new Map);ct(this,me,null);ct(this,xe,null);ct(this,Ee,new u);ct(this,se,0);ct(this,Fe,new Set);ct(this,ue,null);ct(this,ae,null);ct(this,_e,new Set);ct(this,oe,null);ct(this,ie,new o);ct(this,re,!1);ct(this,ce,!1);ct(this,fe,null);ct(this,pe,n.AnnotationEditorType.NONE);ct(this,ve,new Set);ct(this,Ae,null);ct(this,be,this.blur.bind(this));ct(this,je,this.focus.bind(this));ct(this,Se,this.copy.bind(this));ct(this,Xe,this.cut.bind(this));ct(this,qe,this.paste.bind(this));ct(this,Je,this.keydown.bind(this));ct(this,We,this.onEditingAction.bind(this));ct(this,Ue,this.onPageChanging.bind(this));ct(this,Ce,this.onScaleChanging.bind(this));ct(this,Le,this.onRotationChanging.bind(this));ct(this,Ve,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});ct(this,Ge,[0,0]);ct(this,ut,null);ct(this,Jt,null);ct(this,Kt,null);ft(this,Jt,Te),ft(this,Kt,ze),ft(this,me,zt),this._eventBus=ir,this._eventBus._on("editingaction",de(this,We)),this._eventBus._on("pagechanging",de(this,Ue)),this._eventBus._on("scalechanging",de(this,Ce)),this._eventBus._on("rotationchanging",de(this,Le)),ft(this,xe,cr.annotationStorage),ft(this,oe,cr.filterFactory),ft(this,Ae,or),this.viewParameters={realScale:i.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const Te=gr.prototype,ze=cr=>{const{activeElement:or}=document;return or&&de(cr,Jt).contains(or)&&cr.hasSomethingToControl()},zt=this.TRANSLATE_SMALL,ir=this.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new h([[["ctrl+a","mac+meta+a"],Te.selectAll],[["ctrl+z","mac+meta+z"],Te.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],Te.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],Te.delete],[["Escape","mac+Escape"],Te.unselectAll],[["ArrowLeft","mac+ArrowLeft"],Te.translateSelectedEditors,{args:[-zt,0],checker:ze}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],Te.translateSelectedEditors,{args:[-ir,0],checker:ze}],[["ArrowRight","mac+ArrowRight"],Te.translateSelectedEditors,{args:[zt,0],checker:ze}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],Te.translateSelectedEditors,{args:[ir,0],checker:ze}],[["ArrowUp","mac+ArrowUp"],Te.translateSelectedEditors,{args:[0,-zt],checker:ze}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],Te.translateSelectedEditors,{args:[0,-ir],checker:ze}],[["ArrowDown","mac+ArrowDown"],Te.translateSelectedEditors,{args:[0,zt],checker:ze}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],Te.translateSelectedEditors,{args:[0,ir],checker:ze}]]))}destroy(){Qe(this,Ze,bs).call(this),Qe(this,Ze,ta).call(this),this._eventBus._off("editingaction",de(this,We)),this._eventBus._off("pagechanging",de(this,Ue)),this._eventBus._off("scalechanging",de(this,Ce)),this._eventBus._off("rotationchanging",de(this,Le));for(const Te of de(this,q).values())Te.destroy();de(this,q).clear(),de(this,Y).clear(),de(this,_e).clear(),ft(this,R,null),de(this,ve).clear(),de(this,Ee).destroy(),de(this,me).destroy()}get hcmFilter(){return(0,n.shadow)(this,"hcmFilter",de(this,Ae)?de(this,oe).addHCMFilter(de(this,Ae).foreground,de(this,Ae).background):"none")}get direction(){return(0,n.shadow)(this,"direction",getComputedStyle(de(this,Jt)).direction)}editAltText(Te){var ze;(ze=de(this,me))==null||ze.editAltText(this,Te)}onPageChanging(Te){let{pageNumber:ze}=Te;ft(this,se,ze-1)}focusMainContainer(){de(this,Jt).focus()}findParent(Te,ze){for(const zt of de(this,q).values()){const{x:ir,y:cr,width:or,height:ke}=zt.div.getBoundingClientRect();if(Te>=ir&&Te<=ir+or&&ze>=cr&&ze<=cr+ke)return zt}return null}disableUserSelect(){let Te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;de(this,Kt).classList.toggle("noUserSelect",Te)}addShouldRescale(Te){de(this,_e).add(Te)}removeShouldRescale(Te){de(this,_e).delete(Te)}onScaleChanging(Te){let{scale:ze}=Te;this.commitOrRemove(),this.viewParameters.realScale=ze*i.PixelsPerInch.PDF_TO_CSS_UNITS;for(const zt of de(this,_e))zt.onScaleChanging()}onRotationChanging(Te){let{pagesRotation:ze}=Te;this.commitOrRemove(),this.viewParameters.rotation=ze}addToAnnotationStorage(Te){!Te.isEmpty()&&de(this,xe)&&!de(this,xe).has(Te.id)&&de(this,xe).setValue(Te.id,Te)}blur(){if(!this.hasSelection)return;const{activeElement:Te}=document;for(const ze of de(this,ve))if(ze.div.contains(Te)){ft(this,fe,[ze,Te]),ze._focusEventsAllowed=!1;break}}focus(){if(!de(this,fe))return;const[Te,ze]=de(this,fe);ft(this,fe,null),ze.addEventListener("focusin",()=>{Te._focusEventsAllowed=!0},{once:!0}),ze.focus()}addEditListeners(){Qe(this,Ze,ra).call(this),Qe(this,Ze,na).call(this)}removeEditListeners(){Qe(this,Ze,bs).call(this),Qe(this,Ze,ia).call(this)}copy(Te){var zt;if(Te.preventDefault(),(zt=de(this,R))==null||zt.commitOrRemove(),!this.hasSelection)return;const ze=[];for(const ir of de(this,ve)){const cr=ir.serialize(!0);cr&&ze.push(cr)}ze.length!==0&&Te.clipboardData.setData("application/pdfjs",JSON.stringify(ze))}cut(Te){this.copy(Te),this.delete()}paste(Te){Te.preventDefault();const{clipboardData:ze}=Te;for(const cr of ze.items)for(const or of de(this,ae))if(or.isHandlingMimeForPasting(cr.type)){or.paste(cr,this.currentLayer);return}let zt=ze.getData("application/pdfjs");if(!zt)return;try{zt=JSON.parse(zt)}catch(cr){(0,n.warn)(`paste: "${cr.message}".`);return}if(!Array.isArray(zt))return;this.unselectAll();const ir=this.currentLayer;try{const cr=[];for(const Oe of zt){const He=ir.deserialize(Oe);if(!He)return;cr.push(He)}const or=()=>{for(const Oe of cr)Qe(this,Ze,sa).call(this,Oe);Qe(this,Ze,aa).call(this,cr)},ke=()=>{for(const Oe of cr)Oe.remove()};this.addCommands({cmd:or,undo:ke,mustExec:!0})}catch(cr){(0,n.warn)(`paste: "${cr.message}".`)}}keydown(Te){var ze;(ze=this.getActive())!=null&&ze.shouldGetKeyboardEvents()||gr._keyboardManager.exec(this,Te)}onEditingAction(Te){["undo","redo","delete","selectAll"].includes(Te.name)&&this[Te.name]()}setEditingState(Te){Te?(Qe(this,Ze,fo).call(this),Qe(this,Ze,ra).call(this),Qe(this,Ze,na).call(this),Qe(this,Ze,Tn).call(this,{isEditing:de(this,pe)!==n.AnnotationEditorType.NONE,isEmpty:Qe(this,Ze,Yi).call(this),hasSomethingToUndo:de(this,Ee).hasSomethingToUndo(),hasSomethingToRedo:de(this,Ee).hasSomethingToRedo(),hasSelectedEditor:!1})):(Qe(this,Ze,ta).call(this),Qe(this,Ze,bs).call(this),Qe(this,Ze,ia).call(this),Qe(this,Ze,Tn).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(Te){if(!de(this,ae)){ft(this,ae,Te);for(const ze of de(this,ae))Qe(this,Ze,Ki).call(this,ze.defaultPropertiesToUpdate)}}getId(){return de(this,ie).getId()}get currentLayer(){return de(this,q).get(de(this,se))}getLayer(Te){return de(this,q).get(Te)}get currentPageIndex(){return de(this,se)}addLayer(Te){de(this,q).set(Te.pageIndex,Te),de(this,re)?Te.enable():Te.disable()}removeLayer(Te){de(this,q).delete(Te.pageIndex)}updateMode(Te){let ze=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(de(this,pe)!==Te){if(ft(this,pe,Te),Te===n.AnnotationEditorType.NONE){this.setEditingState(!1),Qe(this,Ze,mo).call(this);return}this.setEditingState(!0),Qe(this,Ze,po).call(this),this.unselectAll();for(const zt of de(this,q).values())zt.updateMode(Te);if(ze){for(const zt of de(this,Y).values())if(zt.annotationElementId===ze){this.setSelected(zt),zt.enterInEditMode();break}}}}updateToolbar(Te){Te!==de(this,pe)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:Te})}updateParams(Te,ze){if(de(this,ae)){if(Te===n.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(Te);return}for(const zt of de(this,ve))zt.updateParams(Te,ze);for(const zt of de(this,ae))zt.updateDefaultParams(Te,ze)}}enableWaiting(){let Te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(de(this,ce)!==Te){ft(this,ce,Te);for(const ze of de(this,q).values())Te?ze.disableClick():ze.enableClick(),ze.div.classList.toggle("waiting",Te)}}getEditors(Te){const ze=[];for(const zt of de(this,Y).values())zt.pageIndex===Te&&ze.push(zt);return ze}getEditor(Te){return de(this,Y).get(Te)}addEditor(Te){de(this,Y).set(Te.id,Te)}removeEditor(Te){var ze;de(this,Y).delete(Te.id),this.unselect(Te),(!Te.annotationElementId||!de(this,Fe).has(Te.annotationElementId))&&((ze=de(this,xe))==null||ze.remove(Te.id))}addDeletedAnnotationElement(Te){de(this,Fe).add(Te.annotationElementId),Te.deleted=!0}isDeletedAnnotationElement(Te){return de(this,Fe).has(Te)}removeDeletedAnnotationElement(Te){de(this,Fe).delete(Te.annotationElementId),Te.deleted=!1}setActiveEditor(Te){de(this,R)!==Te&&(ft(this,R,Te),Te&&Qe(this,Ze,Ki).call(this,Te.propertiesToUpdate))}toggleSelected(Te){if(de(this,ve).has(Te)){de(this,ve).delete(Te),Te.unselect(),Qe(this,Ze,Tn).call(this,{hasSelectedEditor:this.hasSelection});return}de(this,ve).add(Te),Te.select(),Qe(this,Ze,Ki).call(this,Te.propertiesToUpdate),Qe(this,Ze,Tn).call(this,{hasSelectedEditor:!0})}setSelected(Te){for(const ze of de(this,ve))ze!==Te&&ze.unselect();de(this,ve).clear(),de(this,ve).add(Te),Te.select(),Qe(this,Ze,Ki).call(this,Te.propertiesToUpdate),Qe(this,Ze,Tn).call(this,{hasSelectedEditor:!0})}isSelected(Te){return de(this,ve).has(Te)}unselect(Te){Te.unselect(),de(this,ve).delete(Te),Qe(this,Ze,Tn).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return de(this,ve).size!==0}undo(){de(this,Ee).undo(),Qe(this,Ze,Tn).call(this,{hasSomethingToUndo:de(this,Ee).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Qe(this,Ze,Yi).call(this)})}redo(){de(this,Ee).redo(),Qe(this,Ze,Tn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:de(this,Ee).hasSomethingToRedo(),isEmpty:Qe(this,Ze,Yi).call(this)})}addCommands(Te){de(this,Ee).add(Te),Qe(this,Ze,Tn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Qe(this,Ze,Yi).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const Te=[...de(this,ve)],ze=()=>{for(const ir of Te)ir.remove()},zt=()=>{for(const ir of Te)Qe(this,Ze,sa).call(this,ir)};this.addCommands({cmd:ze,undo:zt,mustExec:!0})}commitOrRemove(){var Te;(Te=de(this,R))==null||Te.commitOrRemove()}hasSomethingToControl(){return de(this,R)||this.hasSelection}selectAll(){for(const Te of de(this,ve))Te.commit();Qe(this,Ze,aa).call(this,de(this,Y).values())}unselectAll(){if(de(this,R)){de(this,R).commitOrRemove();return}if(this.hasSelection){for(const Te of de(this,ve))Te.unselect();de(this,ve).clear(),Qe(this,Ze,Tn).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(Te,ze){if((arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1)||this.commitOrRemove(),!this.hasSelection)return;de(this,Ge)[0]+=Te,de(this,Ge)[1]+=ze;const[ir,cr]=de(this,Ge),or=[...de(this,ve)],ke=1e3;de(this,ut)&&clearTimeout(de(this,ut)),ft(this,ut,setTimeout(()=>{ft(this,ut,null),de(this,Ge)[0]=de(this,Ge)[1]=0,this.addCommands({cmd:()=>{for(const Oe of or)de(this,Y).has(Oe.id)&&Oe.translateInPage(ir,cr)},undo:()=>{for(const Oe of or)de(this,Y).has(Oe.id)&&Oe.translateInPage(-ir,-cr)},mustExec:!1})},ke));for(const Oe of or)Oe.translateInPage(Te,ze)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),ft(this,ue,new Map);for(const Te of de(this,ve))de(this,ue).set(Te,{savedX:Te.x,savedY:Te.y,savedPageIndex:Te.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!de(this,ue))return!1;this.disableUserSelect(!1);const Te=de(this,ue);ft(this,ue,null);let ze=!1;for(const[{x:ir,y:cr,pageIndex:or},ke]of Te)ke.newX=ir,ke.newY=cr,ke.newPageIndex=or,ze||(ze=ir!==ke.savedX||cr!==ke.savedY||or!==ke.savedPageIndex);if(!ze)return!1;const zt=(ir,cr,or,ke)=>{if(de(this,Y).has(ir.id)){const Oe=de(this,q).get(ke);Oe?ir._setParentAndPosition(Oe,cr,or):(ir.pageIndex=ke,ir.x=cr,ir.y=or)}};return this.addCommands({cmd:()=>{for(const[ir,{newX:cr,newY:or,newPageIndex:ke}]of Te)zt(ir,cr,or,ke)},undo:()=>{for(const[ir,{savedX:cr,savedY:or,savedPageIndex:ke}]of Te)zt(ir,cr,or,ke)},mustExec:!0}),!0}dragSelectedEditors(Te,ze){if(de(this,ue))for(const zt of de(this,ue).keys())zt.drag(Te,ze)}rebuild(Te){if(Te.parent===null){const ze=this.getLayer(Te.pageIndex);ze?(ze.changeParent(Te),ze.addOrRebuild(Te)):(this.addEditor(Te),this.addToAnnotationStorage(Te),Te.rebuild())}else Te.parent.addOrRebuild(Te)}isActive(Te){return de(this,R)===Te}getActive(){return de(this,R)}getMode(){return de(this,pe)}get imageManager(){return(0,n.shadow)(this,"imageManager",new c)}};R=new WeakMap,Y=new WeakMap,q=new WeakMap,me=new WeakMap,xe=new WeakMap,Ee=new WeakMap,se=new WeakMap,Fe=new WeakMap,ue=new WeakMap,ae=new WeakMap,_e=new WeakMap,oe=new WeakMap,ie=new WeakMap,re=new WeakMap,ce=new WeakMap,fe=new WeakMap,pe=new WeakMap,ve=new WeakMap,Ae=new WeakMap,be=new WeakMap,je=new WeakMap,Se=new WeakMap,Xe=new WeakMap,qe=new WeakMap,Je=new WeakMap,We=new WeakMap,Ue=new WeakMap,Ce=new WeakMap,Le=new WeakMap,Ve=new WeakMap,Ge=new WeakMap,ut=new WeakMap,Jt=new WeakMap,Kt=new WeakMap,Ze=new WeakSet,fo=function(){window.addEventListener("focus",de(this,je)),window.addEventListener("blur",de(this,be))},ta=function(){window.removeEventListener("focus",de(this,je)),window.removeEventListener("blur",de(this,be))},ra=function(){window.addEventListener("keydown",de(this,Je),{capture:!0})},bs=function(){window.removeEventListener("keydown",de(this,Je),{capture:!0})},na=function(){document.addEventListener("copy",de(this,Se)),document.addEventListener("cut",de(this,Xe)),document.addEventListener("paste",de(this,qe))},ia=function(){document.removeEventListener("copy",de(this,Se)),document.removeEventListener("cut",de(this,Xe)),document.removeEventListener("paste",de(this,qe))},Tn=function(Te){Object.entries(Te).some(zt=>{let[ir,cr]=zt;return de(this,Ve)[ir]!==cr})&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(de(this,Ve),Te)})},Ki=function(Te){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:Te})},po=function(){if(!de(this,re)){ft(this,re,!0);for(const Te of de(this,q).values())Te.enable()}},mo=function(){if(this.unselectAll(),de(this,re)){ft(this,re,!1);for(const Te of de(this,q).values())Te.disable()}},sa=function(Te){const ze=de(this,q).get(Te.pageIndex);ze?ze.addOrRebuild(Te):this.addEditor(Te)},Yi=function(){if(de(this,Y).size===0)return!0;if(de(this,Y).size===1)for(const Te of de(this,Y).values())return Te.isEmpty();return!1},aa=function(Te){de(this,ve).clear();for(const ze of Te)ze.isEmpty()||(de(this,ve).add(ze),ze.select());Qe(this,Ze,Tn).call(this,{hasSelectedEditor:!0})},Hr(gr,"TRANSLATE_SMALL",1),Hr(gr,"TRANSLATE_BIG",10);let m=gr;e.AnnotationEditorUIManager=m},(t,e,r)=>{var n=r(3),i=r(6),s=r(4),a=r(24),o=r(14),c=r(8),u=r(21),h=r(20),f=r(91),m=r(39),E=r(77),g=r(64),p=r(159),_=r(7),A=r(167),H=r(27),te=s.JSON,ne=s.Number,j=s.SyntaxError,ee=te&&te.parse,x=a("Object","keys"),M=Object.getOwnPropertyDescriptor,T=o("".charAt),O=o("".slice),R=o(/./.exec),Y=o([].push),q=/^\d$/,me=/^[1-9]$/,xe=/^(?:-|\d)$/,Ee=/^[\t\n\r ]$/,se=0,Fe=1,ue=function(fe,pe){fe=E(fe);var ve=new ie(fe,0),Ae=ve.parse(),be=Ae.value,je=ve.skip(Ee,Ae.end);if(je<fe.length)throw j('Unexpected extra character: "'+T(fe,je)+'" after the parsed data at: '+je);return u(pe)?ae({"":be},"",pe,Ae):be},ae=function(fe,pe,ve,Ae){var be=fe[pe],je=Ae&&be===Ae.value,Se=je&&typeof Ae.source=="string"?{source:Ae.source}:{},Xe,qe,Je,We,Ue;if(h(be)){var Ce=f(be),Le=je?Ae.nodes:Ce?[]:{};if(Ce)for(Xe=Le.length,Je=g(be),We=0;We<Je;We++)_e(be,We,ae(be,""+We,ve,We<Xe?Le[We]:void 0));else for(qe=x(be),Je=g(qe),We=0;We<Je;We++)Ue=qe[We],_e(be,Ue,ae(be,Ue,ve,m(Le,Ue)?Le[Ue]:void 0))}return c(ve,fe,pe,be,Se)},_e=function(fe,pe,ve){if(i){var Ae=M(fe,pe);if(Ae&&!Ae.configurable)return}ve===void 0?delete fe[pe]:p(fe,pe,ve)},oe=function(fe,pe,ve,Ae){this.value=fe,this.end=pe,this.source=ve,this.nodes=Ae},ie=function(fe,pe){this.source=fe,this.index=pe};ie.prototype={fork:function(fe){return new ie(this.source,fe)},parse:function(){var fe=this.source,pe=this.skip(Ee,this.index),ve=this.fork(pe),Ae=T(fe,pe);if(R(xe,Ae))return ve.number();switch(Ae){case"{":return ve.object();case"[":return ve.array();case'"':return ve.string();case"t":return ve.keyword(!0);case"f":return ve.keyword(!1);case"n":return ve.keyword(null)}throw j('Unexpected character: "'+Ae+'" at: '+pe)},node:function(fe,pe,ve,Ae,be){return new oe(pe,Ae,fe?null:O(this.source,ve,Ae),be)},object:function(){for(var fe=this.source,pe=this.index+1,ve=!1,Ae={},be={};pe<fe.length;){if(pe=this.until(['"',"}"],pe),T(fe,pe)==="}"&&!ve){pe++;break}var je=this.fork(pe).string(),Se=je.value;pe=je.end,pe=this.until([":"],pe)+1,pe=this.skip(Ee,pe),je=this.fork(pe).parse(),p(be,Se,je),p(Ae,Se,je.value),pe=this.until([",","}"],je.end);var Xe=T(fe,pe);if(Xe===",")ve=!0,pe++;else if(Xe==="}"){pe++;break}}return this.node(Fe,Ae,this.index,pe,be)},array:function(){for(var fe=this.source,pe=this.index+1,ve=!1,Ae=[],be=[];pe<fe.length;){if(pe=this.skip(Ee,pe),T(fe,pe)==="]"&&!ve){pe++;break}var je=this.fork(pe).parse();if(Y(be,je),Y(Ae,je.value),pe=this.until([",","]"],je.end),T(fe,pe)===",")ve=!0,pe++;else if(T(fe,pe)==="]"){pe++;break}}return this.node(Fe,Ae,this.index,pe,be)},string:function(){var fe=this.index,pe=A(this.source,this.index+1);return this.node(se,pe.value,fe,pe.end)},number:function(){var fe=this.source,pe=this.index,ve=pe;if(T(fe,ve)==="-"&&ve++,T(fe,ve)==="0")ve++;else if(R(me,T(fe,ve)))ve=this.skip(q,++ve);else throw j("Failed to parse number at: "+ve);if(T(fe,ve)==="."&&(ve=this.skip(q,++ve)),T(fe,ve)==="e"||T(fe,ve)==="E"){ve++,(T(fe,ve)==="+"||T(fe,ve)==="-")&&ve++;var Ae=ve;if(ve=this.skip(q,ve),Ae===ve)throw j("Failed to parse number's exponent value at: "+ve)}return this.node(se,ne(O(fe,pe,ve)),pe,ve)},keyword:function(fe){var pe=""+fe,ve=this.index,Ae=ve+pe.length;if(O(this.source,ve,Ae)!==pe)throw j("Failed to parse value at: "+ve);return this.node(se,fe,ve,Ae)},skip:function(fe,pe){for(var ve=this.source;pe<ve.length&&R(fe,T(ve,pe));pe++);return pe},until:function(fe,pe){pe=this.skip(Ee,pe);for(var ve=T(this.source,pe),Ae=0;Ae<fe.length;Ae++)if(fe[Ae]===ve)return pe;throw j('Unexpected character: "'+ve+'" at: '+pe)}};var re=_(function(){var fe="9007199254740993",pe;return ee(fe,function(ve,Ae,be){pe=be.source}),pe!==fe}),ce=H&&!_(function(){return 1/ee("-0 	")!==-1/0});n({target:"JSON",stat:!0,forced:re},{parse:function(pe,ve){return ce&&!u(ve)?ee(pe):ue(pe,ve)}})},(t,e,r)=>{var n=r(14),i=r(39),s=SyntaxError,a=parseInt,o=String.fromCharCode,c=n("".charAt),u=n("".slice),h=n(/./.exec),f={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},m=/^[\da-f]{4}$/i,E=/^[\u0000-\u001F]$/;t.exports=function(g,p){for(var _=!0,A="";p<g.length;){var H=c(g,p);if(H==="\\"){var te=u(g,p,p+2);if(i(f,te))A+=f[te],p+=2;else if(te==="\\u"){p+=2;var ne=u(g,p,p+4);if(!h(m,ne))throw s("Bad Unicode escape at: "+p);A+=o(a(ne,16)),p+=4}else throw s('Unknown escape sequence: "'+te+'"')}else if(H==='"'){_=!1,p++;break}else{if(h(E,H))throw s("Bad control character in string literal at: "+p);A+=H,p++}}if(_)throw s("Unterminated string at: "+p);return{value:A,end:p}}},(t,e,r)=>{var se,Fe,ue,ae,_e,oe,ie,re,ce,fe,pe,ve,Ei,wi,oa,Ss,Ts,qi,Zi;Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=void 0,e.deprecated=x,e.getColorValues=Y,e.getCurrentTransform=q,e.getCurrentTransformInverse=me,e.getFilenameFromUrl=A,e.getPdfFilenameFromUrl=H,e.getRGB=R,e.getXfaPageViewport=O,e.isDataScheme=p,e.isPdfFile=_,e.isValidFetchUrl=ne,e.loadScript=ee,e.noContextMenu=j,e.setLayerDimensions=xe,r(2),r(93),r(101),r(102),r(105),r(107),r(109),r(113),r(116),r(123),r(89),r(84),r(86),r(87);var n=r(169),i=r(1);const s="http://www.w3.org/2000/svg",Ee=class Ee{};Hr(Ee,"CSS",96),Hr(Ee,"PDF",72),Hr(Ee,"PDF_TO_CSS_UNITS",Ee.CSS/Ee.PDF);let a=Ee;e.PixelsPerInch=a;class o extends n.BaseFilterFactory{constructor(){let{docId:Ce,ownerDocument:Le=globalThis.document}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super();ct(this,ve);ct(this,se);ct(this,Fe);ct(this,ue);ct(this,ae);ct(this,_e);ct(this,oe);ct(this,ie);ct(this,re);ct(this,ce);ct(this,fe);ct(this,pe,0);ft(this,ue,Ce),ft(this,ae,Le)}addFilter(Ce){if(!Ce)return"none";let Le=de(this,ve,Ei).get(Ce);if(Le)return Le;let Ve,Ge,ut,Jt;if(Ce.length===1){const nr=Ce[0],xr=new Array(256);for(let pr=0;pr<256;pr++)xr[pr]=nr[pr]/255;Jt=Ve=Ge=ut=xr.join(",")}else{const[nr,xr,pr]=Ce,vr=new Array(256),lr=new Array(256),mr=new Array(256);for(let wr=0;wr<256;wr++)vr[wr]=nr[wr]/255,lr[wr]=xr[wr]/255,mr[wr]=pr[wr]/255;Ve=vr.join(","),Ge=lr.join(","),ut=mr.join(","),Jt=`${Ve}${Ge}${ut}`}if(Le=de(this,ve,Ei).get(Jt),Le)return de(this,ve,Ei).set(Ce,Le),Le;const Kt=`g_${de(this,ue)}_transfer_map_${Xi(this,pe)._++}`,Ze=`url(#${Kt})`;de(this,ve,Ei).set(Ce,Ze),de(this,ve,Ei).set(Jt,Ze);const tr=Qe(this,ve,Ss).call(this,Kt);return Qe(this,ve,qi).call(this,Ve,Ge,ut,tr),Ze}addHCMFilter(Ce,Le){var xr;const Ve=`${Ce}-${Le}`;if(de(this,oe)===Ve)return de(this,ie);if(ft(this,oe,Ve),ft(this,ie,"none"),(xr=de(this,_e))==null||xr.remove(),!Ce||!Le)return de(this,ie);const Ge=Qe(this,ve,Zi).call(this,Ce);Ce=i.Util.makeHexColor(...Ge);const ut=Qe(this,ve,Zi).call(this,Le);if(Le=i.Util.makeHexColor(...ut),de(this,ve,wi).style.color="",Ce==="#000000"&&Le==="#ffffff"||Ce===Le)return de(this,ie);const Jt=new Array(256);for(let pr=0;pr<=255;pr++){const vr=pr/255;Jt[pr]=vr<=.03928?vr/12.92:Vs((vr+.055)/1.055,2.4)}const Kt=Jt.join(","),Ze=`g_${de(this,ue)}_hcm_filter`,tr=ft(this,re,Qe(this,ve,Ss).call(this,Ze));Qe(this,ve,qi).call(this,Kt,Kt,Kt,tr),Qe(this,ve,oa).call(this,tr);const nr=(pr,vr)=>{const lr=Ge[pr]/255,mr=ut[pr]/255,wr=new Array(vr+1);for(let Cr=0;Cr<=vr;Cr++)wr[Cr]=lr+Cr/vr*(mr-lr);return wr.join(",")};return Qe(this,ve,qi).call(this,nr(0,5),nr(1,5),nr(2,5),tr),ft(this,ie,`url(#${Ze})`),de(this,ie)}addHighlightHCMFilter(Ce,Le,Ve,Ge){var mr;const ut=`${Ce}-${Le}-${Ve}-${Ge}`;if(de(this,ce)===ut)return de(this,fe);if(ft(this,ce,ut),ft(this,fe,"none"),(mr=de(this,re))==null||mr.remove(),!Ce||!Le)return de(this,fe);const[Jt,Kt]=[Ce,Le].map(Qe(this,ve,Zi).bind(this));let Ze=Math.round(.2126*Jt[0]+.7152*Jt[1]+.0722*Jt[2]),tr=Math.round(.2126*Kt[0]+.7152*Kt[1]+.0722*Kt[2]),[nr,xr]=[Ve,Ge].map(Qe(this,ve,Zi).bind(this));tr<Ze&&([Ze,tr,nr,xr]=[tr,Ze,xr,nr]),de(this,ve,wi).style.color="";const pr=(wr,Cr,Rr)=>{const ar=new Array(256),it=(tr-Ze)/Rr,ot=wr/255,gr=(Cr-wr)/(255*Rr);let Tr=0;for(let Te=0;Te<=Rr;Te++){const ze=Math.round(Ze+Te*it),zt=ot+Te*gr;for(let ir=Tr;ir<=ze;ir++)ar[ir]=zt;Tr=ze+1}for(let Te=Tr;Te<256;Te++)ar[Te]=ar[Tr-1];return ar.join(",")},vr=`g_${de(this,ue)}_hcm_highlight_filter`,lr=ft(this,re,Qe(this,ve,Ss).call(this,vr));return Qe(this,ve,oa).call(this,lr),Qe(this,ve,qi).call(this,pr(nr[0],xr[0],5),pr(nr[1],xr[1],5),pr(nr[2],xr[2],5),lr),ft(this,fe,`url(#${vr})`),de(this,fe)}destroy(){arguments.length>0&&arguments[0]!==void 0&&arguments[0]&&(de(this,ie)||de(this,fe))||(de(this,Fe)&&(de(this,Fe).parentNode.parentNode.remove(),ft(this,Fe,null)),de(this,se)&&(de(this,se).clear(),ft(this,se,null)),ft(this,pe,0))}}se=new WeakMap,Fe=new WeakMap,ue=new WeakMap,ae=new WeakMap,_e=new WeakMap,oe=new WeakMap,ie=new WeakMap,re=new WeakMap,ce=new WeakMap,fe=new WeakMap,pe=new WeakMap,ve=new WeakSet,Ei=function(){return de(this,se)||ft(this,se,new Map)},wi=function(){if(!de(this,Fe)){const Ce=de(this,ae).createElement("div"),{style:Le}=Ce;Le.visibility="hidden",Le.contain="strict",Le.width=Le.height=0,Le.position="absolute",Le.top=Le.left=0,Le.zIndex=-1;const Ve=de(this,ae).createElementNS(s,"svg");Ve.setAttribute("width",0),Ve.setAttribute("height",0),ft(this,Fe,de(this,ae).createElementNS(s,"defs")),Ce.append(Ve),Ve.append(de(this,Fe)),de(this,ae).body.append(Ce)}return de(this,Fe)},oa=function(Ce){const Le=de(this,ae).createElementNS(s,"feColorMatrix");Le.setAttribute("type","matrix"),Le.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),Ce.append(Le)},Ss=function(Ce){const Le=de(this,ae).createElementNS(s,"filter");return Le.setAttribute("color-interpolation-filters","sRGB"),Le.setAttribute("id",Ce),de(this,ve,wi).append(Le),Le},Ts=function(Ce,Le,Ve){const Ge=de(this,ae).createElementNS(s,Le);Ge.setAttribute("type","discrete"),Ge.setAttribute("tableValues",Ve),Ce.append(Ge)},qi=function(Ce,Le,Ve,Ge){const ut=de(this,ae).createElementNS(s,"feComponentTransfer");Ge.append(ut),Qe(this,ve,Ts).call(this,ut,"feFuncR",Ce),Qe(this,ve,Ts).call(this,ut,"feFuncG",Le),Qe(this,ve,Ts).call(this,ut,"feFuncB",Ve)},Zi=function(Ce){return de(this,ve,wi).style.color=Ce,R(getComputedStyle(de(this,ve,wi)).getPropertyValue("color"))},e.DOMFilterFactory=o;class c extends n.BaseCanvasFactory{constructor(){let{ownerDocument:Ue=globalThis.document}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this._document=Ue}_createCanvas(Ue,Ce){const Le=this._document.createElement("canvas");return Le.width=Ue,Le.height=Ce,Le}}e.DOMCanvasFactory=c;function u(Ue){return Ye(this,arguments,function*(We){let Ce=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(ne(We,document.baseURI)){const Le=yield fetch(We);if(!Le.ok)throw new Error(Le.statusText);return Ce?new Uint8Array(yield Le.arrayBuffer()):(0,i.stringToBytes)(yield Le.text())}return new Promise((Le,Ve)=>{const Ge=new XMLHttpRequest;Ge.open("GET",We,!0),Ce&&(Ge.responseType="arraybuffer"),Ge.onreadystatechange=()=>{if(Ge.readyState===XMLHttpRequest.DONE){if(Ge.status===200||Ge.status===0){let ut;if(Ce&&Ge.response?ut=new Uint8Array(Ge.response):!Ce&&Ge.responseText&&(ut=(0,i.stringToBytes)(Ge.responseText)),ut){Le(ut);return}}Ve(new Error(Ge.statusText))}},Ge.send(null)})})}class h extends n.BaseCMapReaderFactory{_fetchData(Ue,Ce){return u(Ue,this.isCompressed).then(Le=>({cMapData:Le,compressionType:Ce}))}}e.DOMCMapReaderFactory=h;class f extends n.BaseStandardFontDataFactory{_fetchData(Ue){return u(Ue,!0)}}e.DOMStandardFontDataFactory=f;class m extends n.BaseSVGFactory{_createSVG(Ue){return document.createElementNS(s,Ue)}}e.DOMSVGFactory=m;class E{constructor(Ue){let{viewBox:Ce,scale:Le,rotation:Ve,offsetX:Ge=0,offsetY:ut=0,dontFlip:Jt=!1}=Ue;this.viewBox=Ce,this.scale=Le,this.rotation=Ve,this.offsetX=Ge,this.offsetY=ut;const Kt=(Ce[2]+Ce[0])/2,Ze=(Ce[3]+Ce[1])/2;let tr,nr,xr,pr;switch(Ve%=360,Ve<0&&(Ve+=360),Ve){case 180:tr=-1,nr=0,xr=0,pr=1;break;case 90:tr=0,nr=1,xr=1,pr=0;break;case 270:tr=0,nr=-1,xr=-1,pr=0;break;case 0:tr=1,nr=0,xr=0,pr=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Jt&&(xr=-xr,pr=-pr);let vr,lr,mr,wr;tr===0?(vr=Math.abs(Ze-Ce[1])*Le+Ge,lr=Math.abs(Kt-Ce[0])*Le+ut,mr=(Ce[3]-Ce[1])*Le,wr=(Ce[2]-Ce[0])*Le):(vr=Math.abs(Kt-Ce[0])*Le+Ge,lr=Math.abs(Ze-Ce[1])*Le+ut,mr=(Ce[2]-Ce[0])*Le,wr=(Ce[3]-Ce[1])*Le),this.transform=[tr*Le,nr*Le,xr*Le,pr*Le,vr-tr*Le*Kt-xr*Le*Ze,lr-nr*Le*Kt-pr*Le*Ze],this.width=mr,this.height=wr}get rawDims(){const{viewBox:Ue}=this;return(0,i.shadow)(this,"rawDims",{pageWidth:Ue[2]-Ue[0],pageHeight:Ue[3]-Ue[1],pageX:Ue[0],pageY:Ue[1]})}clone(){let{scale:Ue=this.scale,rotation:Ce=this.rotation,offsetX:Le=this.offsetX,offsetY:Ve=this.offsetY,dontFlip:Ge=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new E({viewBox:this.viewBox.slice(),scale:Ue,rotation:Ce,offsetX:Le,offsetY:Ve,dontFlip:Ge})}convertToViewportPoint(Ue,Ce){return i.Util.applyTransform([Ue,Ce],this.transform)}convertToViewportRectangle(Ue){const Ce=i.Util.applyTransform([Ue[0],Ue[1]],this.transform),Le=i.Util.applyTransform([Ue[2],Ue[3]],this.transform);return[Ce[0],Ce[1],Le[0],Le[1]]}convertToPdfPoint(Ue,Ce){return i.Util.applyInverseTransform([Ue,Ce],this.transform)}}e.PageViewport=E;class g extends i.BaseException{constructor(Ue){let Ce=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;super(Ue,"RenderingCancelledException"),this.extraDelay=Ce}}e.RenderingCancelledException=g;function p(We){const Ue=We.length;let Ce=0;for(;Ce<Ue&&We[Ce].trim()==="";)Ce++;return We.substring(Ce,Ce+5).toLowerCase()==="data:"}function _(We){return typeof We=="string"&&/\.pdf$/i.test(We)}function A(We){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)||([We]=We.split(/[#?]/,1)),We.substring(We.lastIndexOf("/")+1)}function H(We){let Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"document.pdf";if(typeof We!="string")return Ue;if(p(We))return(0,i.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),Ue;const Ce=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,Le=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,Ve=Ce.exec(We);let Ge=Le.exec(Ve[1])||Le.exec(Ve[2])||Le.exec(Ve[3]);if(Ge&&(Ge=Ge[0],Ge.includes("%")))try{Ge=Le.exec(decodeURIComponent(Ge))[0]}catch(ut){}return Ge||Ue}class te{constructor(){Hr(this,"started",Object.create(null));Hr(this,"times",[])}time(Ue){Ue in this.started&&(0,i.warn)(`Timer is already running for ${Ue}`),this.started[Ue]=Date.now()}timeEnd(Ue){Ue in this.started||(0,i.warn)(`Timer has not been started for ${Ue}`),this.times.push({name:Ue,start:this.started[Ue],end:Date.now()}),delete this.started[Ue]}toString(){const Ue=[];let Ce=0;for(const{name:Le}of this.times)Ce=Math.max(Le.length,Ce);for(const{name:Le,start:Ve,end:Ge}of this.times)Ue.push(`${Le.padEnd(Ce)} ${Ge-Ve}ms
`);return Ue.join("")}}e.StatTimer=te;function ne(We,Ue){try{const{protocol:Ce}=Ue?new URL(We,Ue):new URL(We);return Ce==="http:"||Ce==="https:"}catch(Ce){return!1}}function j(We){We.preventDefault()}function ee(We){let Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return new Promise((Ce,Le)=>{const Ve=document.createElement("script");Ve.src=We,Ve.onload=function(Ge){Ue&&Ve.remove(),Ce(Ge)},Ve.onerror=function(){Le(new Error(`Cannot load script at: ${Ve.src}`))},(document.head||document.documentElement).append(Ve)})}function x(We){console.log("Deprecated API usage: "+We)}let M;class T{static toDateObject(Ue){if(!Ue||typeof Ue!="string")return null;M||(M=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const Ce=M.exec(Ue);if(!Ce)return null;const Le=parseInt(Ce[1],10);let Ve=parseInt(Ce[2],10);Ve=Ve>=1&&Ve<=12?Ve-1:0;let Ge=parseInt(Ce[3],10);Ge=Ge>=1&&Ge<=31?Ge:1;let ut=parseInt(Ce[4],10);ut=ut>=0&&ut<=23?ut:0;let Jt=parseInt(Ce[5],10);Jt=Jt>=0&&Jt<=59?Jt:0;let Kt=parseInt(Ce[6],10);Kt=Kt>=0&&Kt<=59?Kt:0;const Ze=Ce[7]||"Z";let tr=parseInt(Ce[8],10);tr=tr>=0&&tr<=23?tr:0;let nr=parseInt(Ce[9],10)||0;return nr=nr>=0&&nr<=59?nr:0,Ze==="-"?(ut+=tr,Jt+=nr):Ze==="+"&&(ut-=tr,Jt-=nr),new Date(Date.UTC(Le,Ve,Ge,ut,Jt,Kt))}}e.PDFDateString=T;function O(We,Ue){let{scale:Ce=1,rotation:Le=0}=Ue;const{width:Ve,height:Ge}=We.attributes.style,ut=[0,0,parseInt(Ve),parseInt(Ge)];return new E({viewBox:ut,scale:Ce,rotation:Le})}function R(We){if(We.startsWith("#")){const Ue=parseInt(We.slice(1),16);return[(Ue&16711680)>>16,(Ue&65280)>>8,Ue&255]}return We.startsWith("rgb(")?We.slice(4,-1).split(",").map(Ue=>parseInt(Ue)):We.startsWith("rgba(")?We.slice(5,-1).split(",").map(Ue=>parseInt(Ue)).slice(0,3):((0,i.warn)(`Not a valid color format: "${We}"`),[0,0,0])}function Y(We){const Ue=document.createElement("span");Ue.style.visibility="hidden",document.body.append(Ue);for(const Ce of We.keys()){Ue.style.color=Ce;const Le=window.getComputedStyle(Ue).color;We.set(Ce,R(Le))}Ue.remove()}function q(We){const{a:Ue,b:Ce,c:Le,d:Ve,e:Ge,f:ut}=We.getTransform();return[Ue,Ce,Le,Ve,Ge,ut]}function me(We){const{a:Ue,b:Ce,c:Le,d:Ve,e:Ge,f:ut}=We.getTransform().invertSelf();return[Ue,Ce,Le,Ve,Ge,ut]}function xe(We,Ue){let Ce=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,Le=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;if(Ue instanceof E){const{pageWidth:Ve,pageHeight:Ge}=Ue.rawDims,{style:ut}=We,Jt=i.FeatureTest.isCSSRoundSupported,Kt=`var(--scale-factor) * ${Ve}px`,Ze=`var(--scale-factor) * ${Ge}px`,tr=Jt?`round(${Kt}, 1px)`:`calc(${Kt})`,nr=Jt?`round(${Ze}, 1px)`:`calc(${Ze})`;!Ce||Ue.rotation%180===0?(ut.width=tr,ut.height=nr):(ut.width=nr,ut.height=tr)}Le&&We.setAttribute("data-main-rotation",Ue.rotation)}},(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0,r(2);var n=r(1);class i{constructor(){this.constructor===i&&(0,n.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(h){return"none"}addHCMFilter(h,f){return"none"}addHighlightHCMFilter(h,f,m,E){return"none"}destroy(){}}e.BaseFilterFactory=i;class s{constructor(){this.constructor===s&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(h,f){if(h<=0||f<=0)throw new Error("Invalid canvas size");const m=this._createCanvas(h,f);return{canvas:m,context:m.getContext("2d")}}reset(h,f,m){if(!h.canvas)throw new Error("Canvas is not specified");if(f<=0||m<=0)throw new Error("Invalid canvas size");h.canvas.width=f,h.canvas.height=m}destroy(h){if(!h.canvas)throw new Error("Canvas is not specified");h.canvas.width=0,h.canvas.height=0,h.canvas=null,h.context=null}_createCanvas(h,f){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=s;class a{constructor(h){let{baseUrl:f=null,isCompressed:m=!0}=h;this.constructor===a&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=f,this.isCompressed=m}fetch(h){return Ye(this,null,function*(){let{name:f}=h;if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!f)throw new Error("CMap name must be specified.");const m=this.baseUrl+f+(this.isCompressed?".bcmap":""),E=this.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE;return this._fetchData(m,E).catch(g=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${m}`)})})}_fetchData(h,f){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=a;class o{constructor(h){let{baseUrl:f=null}=h;this.constructor===o&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=f}fetch(h){return Ye(this,null,function*(){let{filename:f}=h;if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!f)throw new Error("Font filename must be specified.");const m=`${this.baseUrl}${f}`;return this._fetchData(m).catch(E=>{throw new Error(`Unable to load font data at: ${m}`)})})}_fetchData(h){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=o;class c{constructor(){this.constructor===c&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(h,f){let m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(h<=0||f<=0)throw new Error("Invalid SVG dimensions");const E=this._createSVG("svg:svg");return E.setAttribute("version","1.1"),m||(E.setAttribute("width",`${h}px`),E.setAttribute("height",`${f}px`)),E.setAttribute("preserveAspectRatio","none"),E.setAttribute("viewBox",`0 0 ${h} ${f}`),E}createElement(h){if(typeof h!="string")throw new Error("Invalid SVG element type");return this._createSVG(h)}_createSVG(h){(0,n.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=c},(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0,r(93),r(101),r(102),r(105),r(107),r(109),r(113),r(116),r(123),r(2);var n=r(1);const i=3285377520,s=4294901760,a=65535;class o{constructor(u){this.h1=u?u&4294967295:i,this.h2=u?u&4294967295:i}update(u){let h,f;if(typeof u=="string"){h=new Uint8Array(u.length*2),f=0;for(let x=0,M=u.length;x<M;x++){const T=u.charCodeAt(x);T<=255?h[f++]=T:(h[f++]=T>>>8,h[f++]=T&255)}}else if((0,n.isArrayBuffer)(u))h=u.slice(),f=h.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const m=f>>2,E=f-m*4,g=new Uint32Array(h.buffer,0,m);let p=0,_=0,A=this.h1,H=this.h2;const te=3432918353,ne=461845907,j=te&a,ee=ne&a;for(let x=0;x<m;x++)x&1?(p=g[x],p=p*te&s|p*j&a,p=p<<15|p>>>17,p=p*ne&s|p*ee&a,A^=p,A=A<<13|A>>>19,A=A*5+3864292196):(_=g[x],_=_*te&s|_*j&a,_=_<<15|_>>>17,_=_*ne&s|_*ee&a,H^=_,H=H<<13|H>>>19,H=H*5+3864292196);switch(p=0,E){case 3:p^=h[m*4+2]<<16;case 2:p^=h[m*4+1]<<8;case 1:p^=h[m*4],p=p*te&s|p*j&a,p=p<<15|p>>>17,p=p*ne&s|p*ee&a,m&1?A^=p:H^=p}this.h1=A,this.h2=H}hexdigest(){let u=this.h1,h=this.h2;return u^=h>>>1,u=u*3981806797&s|u*36045&a,h=h*4283543511&s|((h<<16|u>>>16)*2950163797&s)>>>16,u^=h>>>1,u=u*444984403&s|u*60499&a,h=h*3301882366&s|((h<<16|u>>>16)*3120437893&s)>>>16,u^=h>>>1,(u>>>0).toString(16).padStart(8,"0")+(h>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=o},(t,e,r)=>{var a;Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0,r(125),r(136),r(138),r(141),r(143),r(145),r(147),r(89),r(149);var n=r(1);class i{constructor(c){ct(this,a,new Set);let{ownerDocument:u=globalThis.document,styleElement:h=null}=c;this._document=u,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(c){this.nativeFontFaces.add(c),this._document.fonts.add(c)}removeNativeFontFace(c){this.nativeFontFaces.delete(c),this._document.fonts.delete(c)}insertRule(c){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const u=this.styleElement.sheet;u.insertRule(c,u.cssRules.length)}clear(){for(const c of this.nativeFontFaces)this._document.fonts.delete(c);this.nativeFontFaces.clear(),de(this,a).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}loadSystemFont(c){return Ye(this,null,function*(){if(!(!c||de(this,a).has(c.loadedName))){if((0,n.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:u,src:h,style:f}=c,m=new FontFace(u,h,f);this.addNativeFontFace(m);try{yield m.load(),de(this,a).add(u)}catch(E){(0,n.warn)(`Cannot load system font: ${c.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(m)}return}(0,n.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}})}bind(c){return Ye(this,null,function*(){if(c.attached||c.missingFile&&!c.systemFontInfo)return;if(c.attached=!0,c.systemFontInfo){yield this.loadSystemFont(c.systemFontInfo);return}if(this.isFontLoadingAPISupported){const h=c.createNativeFontFace();if(h){this.addNativeFontFace(h);try{yield h.loaded}catch(f){throw(0,n.warn)(`Failed to load font '${h.family}': '${f}'.`),c.disableFontFace=!0,f}}return}const u=c.createFontFaceRule();if(u){if(this.insertRule(u),this.isSyncFontLoadingSupported)return;yield new Promise(h=>{const f=this._queueLoadingCallback(h);this._prepareFontLoadEvent(c,f)})}})}get isFontLoadingAPISupported(){var u;const c=!!((u=this._document)!=null&&u.fonts);return(0,n.shadow)(this,"isFontLoadingAPISupported",c)}get isSyncFontLoadingSupported(){let c=!1;return(n.isNodeJS||typeof navigator!="undefined"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(c=!0),(0,n.shadow)(this,"isSyncFontLoadingSupported",c)}_queueLoadingCallback(c){function u(){for((0,n.assert)(!f.done,"completeRequest() cannot be called twice."),f.done=!0;h.length>0&&h[0].done;){const m=h.shift();setTimeout(m.callback,0)}}const{loadingRequests:h}=this,f={done:!1,complete:u,callback:c};return h.push(f),f}get _loadTestFont(){const c=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,n.shadow)(this,"_loadTestFont",c)}_prepareFontLoadEvent(c,u){function h(R,Y){return R.charCodeAt(Y)<<24|R.charCodeAt(Y+1)<<16|R.charCodeAt(Y+2)<<8|R.charCodeAt(Y+3)&255}function f(R,Y,q,me){const xe=R.substring(0,Y),Ee=R.substring(Y+q);return xe+me+Ee}let m,E;const g=this._document.createElement("canvas");g.width=1,g.height=1;const p=g.getContext("2d");let _=0;function A(R,Y){if(++_>30){(0,n.warn)("Load test font never loaded."),Y();return}if(p.font="30px "+R,p.fillText(".",0,20),p.getImageData(0,0,1,1).data[3]>0){Y();return}setTimeout(A.bind(null,R,Y))}const H=`lt${Date.now()}${this.loadTestFontId++}`;let te=this._loadTestFont;te=f(te,976,H.length,H);const j=16,ee=1482184792;let x=h(te,j);for(m=0,E=H.length-3;m<E;m+=4)x=x-ee+h(H,m)|0;m<H.length&&(x=x-ee+h(H+"XXX",m)|0),te=f(te,j,4,(0,n.string32)(x));const M=`url(data:font/opentype;base64,${btoa(te)});`,T=`@font-face {font-family:"${H}";src:${M}}`;this.insertRule(T);const O=this._document.createElement("div");O.style.visibility="hidden",O.style.width=O.style.height="10px",O.style.position="absolute",O.style.top=O.style.left="0px";for(const R of[c.loadedName,H]){const Y=this._document.createElement("span");Y.textContent="Hi",Y.style.fontFamily=R,O.append(Y)}this._document.body.append(O),A(H,()=>{O.remove(),u.complete()})}}a=new WeakMap,e.FontLoader=i;class s{constructor(c,u){let{isEvalSupported:h=!0,disableFontFace:f=!1,ignoreErrors:m=!1,inspectFont:E=null}=u;this.compiledGlyphs=Object.create(null);for(const g in c)this[g]=c[g];this.isEvalSupported=h!==!1,this.disableFontFace=f===!0,this.ignoreErrors=m===!0,this._inspectFont=E}createNativeFontFace(){var u;if(!this.data||this.disableFontFace)return null;let c;if(!this.cssFontInfo)c=new FontFace(this.loadedName,this.data,{});else{const h={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(h.style=`oblique ${this.cssFontInfo.italicAngle}deg`),c=new FontFace(this.cssFontInfo.fontFamily,this.data,h)}return(u=this._inspectFont)==null||u.call(this,this),c}createFontFaceRule(){var f;if(!this.data||this.disableFontFace)return null;const c=(0,n.bytesToString)(this.data),u=`url(data:${this.mimetype};base64,${btoa(c)});`;let h;if(!this.cssFontInfo)h=`@font-face {font-family:"${this.loadedName}";src:${u}}`;else{let m=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(m+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),h=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${m}src:${u}}`}return(f=this._inspectFont)==null||f.call(this,this,u),h}getPathGenerator(c,u){if(this.compiledGlyphs[u]!==void 0)return this.compiledGlyphs[u];let h;try{h=c.get(this.loadedName+"_path_"+u)}catch(f){if(!this.ignoreErrors)throw f;return(0,n.warn)(`getPathGenerator - ignoring character: "${f}".`),this.compiledGlyphs[u]=function(m,E){}}if(this.isEvalSupported&&n.FeatureTest.isEvalSupported){const f=[];for(const m of h){const E=m.args!==void 0?m.args.join(","):"";f.push("c.",m.cmd,"(",E,`);
`)}return this.compiledGlyphs[u]=new Function("c","size",f.join(""))}return this.compiledGlyphs[u]=function(f,m){for(const E of h)E.cmd==="scale"&&(E.args=[m,-m]),f[E.cmd].apply(f,E.args)}}}e.FontFaceObject=s},(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0,r(2),r(93),r(101),r(102),r(105),r(107),r(109),r(113),r(116),r(123);var n=r(169),i=r(1);(function(){if(!(globalThis.DOMMatrix||!i.isNodeJS))try{globalThis.DOMMatrix=require$$6.DOMMatrix}catch(f){(0,i.warn)(`Cannot polyfill \`DOMMatrix\`, rendering may be broken: "${f}".`)}})(),function(){if(!(globalThis.Path2D||!i.isNodeJS))try{const{CanvasRenderingContext2D:f}=require$$6,{polyfillPath2D:m}=requirePath2dPolyfill_esm();globalThis.CanvasRenderingContext2D=f,m(globalThis)}catch(f){(0,i.warn)(`Cannot polyfill \`Path2D\`, rendering may be broken: "${f}".`)}}();const s=function(h){return new Promise((f,m)=>{require$$6.readFile(h,(g,p)=>{if(g||!p){m(new Error(g));return}f(new Uint8Array(p))})})};class a extends n.BaseFilterFactory{}e.NodeFilterFactory=a;class o extends n.BaseCanvasFactory{_createCanvas(f,m){return require$$6.createCanvas(f,m)}}e.NodeCanvasFactory=o;class c extends n.BaseCMapReaderFactory{_fetchData(f,m){return s(f).then(E=>({cMapData:E,compressionType:m}))}}e.NodeCMapReaderFactory=c;class u extends n.BaseStandardFontDataFactory{_fetchData(f){return s(f)}}e.NodeStandardFontDataFactory=u},(t,e,r)=>{var Fe,la,ca;Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0,r(2),r(93),r(101),r(102),r(105),r(107),r(109),r(113),r(116),r(123),r(89);var n=r(1),i=r(168),s=r(174),a=r(175);const o=16,c=100,u=4096,h=15,f=10,m=1e3,E=16;function g(oe,ie){if(oe._removeMirroring)throw new Error("Context is already forwarding operations.");oe.__originalSave=oe.save,oe.__originalRestore=oe.restore,oe.__originalRotate=oe.rotate,oe.__originalScale=oe.scale,oe.__originalTranslate=oe.translate,oe.__originalTransform=oe.transform,oe.__originalSetTransform=oe.setTransform,oe.__originalResetTransform=oe.resetTransform,oe.__originalClip=oe.clip,oe.__originalMoveTo=oe.moveTo,oe.__originalLineTo=oe.lineTo,oe.__originalBezierCurveTo=oe.bezierCurveTo,oe.__originalRect=oe.rect,oe.__originalClosePath=oe.closePath,oe.__originalBeginPath=oe.beginPath,oe._removeMirroring=()=>{oe.save=oe.__originalSave,oe.restore=oe.__originalRestore,oe.rotate=oe.__originalRotate,oe.scale=oe.__originalScale,oe.translate=oe.__originalTranslate,oe.transform=oe.__originalTransform,oe.setTransform=oe.__originalSetTransform,oe.resetTransform=oe.__originalResetTransform,oe.clip=oe.__originalClip,oe.moveTo=oe.__originalMoveTo,oe.lineTo=oe.__originalLineTo,oe.bezierCurveTo=oe.__originalBezierCurveTo,oe.rect=oe.__originalRect,oe.closePath=oe.__originalClosePath,oe.beginPath=oe.__originalBeginPath,delete oe._removeMirroring},oe.save=function(){ie.save(),this.__originalSave()},oe.restore=function(){ie.restore(),this.__originalRestore()},oe.translate=function(ce,fe){ie.translate(ce,fe),this.__originalTranslate(ce,fe)},oe.scale=function(ce,fe){ie.scale(ce,fe),this.__originalScale(ce,fe)},oe.transform=function(ce,fe,pe,ve,Ae,be){ie.transform(ce,fe,pe,ve,Ae,be),this.__originalTransform(ce,fe,pe,ve,Ae,be)},oe.setTransform=function(ce,fe,pe,ve,Ae,be){ie.setTransform(ce,fe,pe,ve,Ae,be),this.__originalSetTransform(ce,fe,pe,ve,Ae,be)},oe.resetTransform=function(){ie.resetTransform(),this.__originalResetTransform()},oe.rotate=function(ce){ie.rotate(ce),this.__originalRotate(ce)},oe.clip=function(ce){ie.clip(ce),this.__originalClip(ce)},oe.moveTo=function(re,ce){ie.moveTo(re,ce),this.__originalMoveTo(re,ce)},oe.lineTo=function(re,ce){ie.lineTo(re,ce),this.__originalLineTo(re,ce)},oe.bezierCurveTo=function(re,ce,fe,pe,ve,Ae){ie.bezierCurveTo(re,ce,fe,pe,ve,Ae),this.__originalBezierCurveTo(re,ce,fe,pe,ve,Ae)},oe.rect=function(re,ce,fe,pe){ie.rect(re,ce,fe,pe),this.__originalRect(re,ce,fe,pe)},oe.closePath=function(){ie.closePath(),this.__originalClosePath()},oe.beginPath=function(){ie.beginPath(),this.__originalBeginPath()}}class p{constructor(ie){this.canvasFactory=ie,this.cache=Object.create(null)}getCanvas(ie,re,ce){let fe;return this.cache[ie]!==void 0?(fe=this.cache[ie],this.canvasFactory.reset(fe,re,ce)):(fe=this.canvasFactory.create(re,ce),this.cache[ie]=fe),fe}delete(ie){delete this.cache[ie]}clear(){for(const ie in this.cache){const re=this.cache[ie];this.canvasFactory.destroy(re),delete this.cache[ie]}}}function _(oe,ie,re,ce,fe,pe,ve,Ae,be,je){const[Se,Xe,qe,Je,We,Ue]=(0,i.getCurrentTransform)(oe);if(Xe===0&&qe===0){const Ve=ve*Se+We,Ge=Math.round(Ve),ut=Ae*Je+Ue,Jt=Math.round(ut),Kt=(ve+be)*Se+We,Ze=Math.abs(Math.round(Kt)-Ge)||1,tr=(Ae+je)*Je+Ue,nr=Math.abs(Math.round(tr)-Jt)||1;return oe.setTransform(Math.sign(Se),0,0,Math.sign(Je),Ge,Jt),oe.drawImage(ie,re,ce,fe,pe,0,0,Ze,nr),oe.setTransform(Se,Xe,qe,Je,We,Ue),[Ze,nr]}if(Se===0&&Je===0){const Ve=Ae*qe+We,Ge=Math.round(Ve),ut=ve*Xe+Ue,Jt=Math.round(ut),Kt=(Ae+je)*qe+We,Ze=Math.abs(Math.round(Kt)-Ge)||1,tr=(ve+be)*Xe+Ue,nr=Math.abs(Math.round(tr)-Jt)||1;return oe.setTransform(0,Math.sign(Xe),Math.sign(qe),0,Ge,Jt),oe.drawImage(ie,re,ce,fe,pe,0,0,nr,Ze),oe.setTransform(Se,Xe,qe,Je,We,Ue),[nr,Ze]}oe.drawImage(ie,re,ce,fe,pe,ve,Ae,be,je);const Ce=Math.hypot(Se,Xe),Le=Math.hypot(qe,Je);return[Ce*be,Le*je]}function A(oe){const{width:ie,height:re}=oe;if(ie>m||re>m)return null;const ce=1e3,fe=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),pe=ie+1;let ve=new Uint8Array(pe*(re+1)),Ae,be,je;const Se=ie+7&-8;let Xe=new Uint8Array(Se*re),qe=0;for(const Le of oe.data){let Ve=128;for(;Ve>0;)Xe[qe++]=Le&Ve?0:255,Ve>>=1}let Je=0;for(qe=0,Xe[qe]!==0&&(ve[0]=1,++Je),be=1;be<ie;be++)Xe[qe]!==Xe[qe+1]&&(ve[be]=Xe[qe]?2:1,++Je),qe++;for(Xe[qe]!==0&&(ve[be]=2,++Je),Ae=1;Ae<re;Ae++){qe=Ae*Se,je=Ae*pe,Xe[qe-Se]!==Xe[qe]&&(ve[je]=Xe[qe]?1:8,++Je);let Le=(Xe[qe]?4:0)+(Xe[qe-Se]?8:0);for(be=1;be<ie;be++)Le=(Le>>2)+(Xe[qe+1]?4:0)+(Xe[qe-Se+1]?8:0),fe[Le]&&(ve[je+be]=fe[Le],++Je),qe++;if(Xe[qe-Se]!==Xe[qe]&&(ve[je+be]=Xe[qe]?2:4,++Je),Je>ce)return null}for(qe=Se*(re-1),je=Ae*pe,Xe[qe]!==0&&(ve[je]=8,++Je),be=1;be<ie;be++)Xe[qe]!==Xe[qe+1]&&(ve[je+be]=Xe[qe]?4:8,++Je),qe++;if(Xe[qe]!==0&&(ve[je+be]=4,++Je),Je>ce)return null;const We=new Int32Array([0,pe,-1,0,-pe,0,0,0,1]),Ue=new Path2D;for(Ae=0;Je&&Ae<=re;Ae++){let Le=Ae*pe;const Ve=Le+ie;for(;Le<Ve&&!ve[Le];)Le++;if(Le===Ve)continue;Ue.moveTo(Le%pe,Ae);const Ge=Le;let ut=ve[Le];do{const Jt=We[ut];do Le+=Jt;while(!ve[Le]);const Kt=ve[Le];Kt!==5&&Kt!==10?(ut=Kt,ve[Le]=0):(ut=Kt&51*ut>>4,ve[Le]&=ut>>2|ut<<2),Ue.lineTo(Le%pe,Le/pe|0),ve[Le]||--Je}while(Ge!==Le);--Ae}return Xe=null,ve=null,function(Le){Le.save(),Le.scale(1/ie,-1/re),Le.translate(0,-re),Le.fill(Ue),Le.beginPath(),Le.restore()}}class H{constructor(ie,re){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=n.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=n.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,ie,re])}clone(){const ie=Object.create(this);return ie.clipBox=this.clipBox.slice(),ie}setCurrentPoint(ie,re){this.x=ie,this.y=re}updatePathMinMax(ie,re,ce){[re,ce]=n.Util.applyTransform([re,ce],ie),this.minX=Math.min(this.minX,re),this.minY=Math.min(this.minY,ce),this.maxX=Math.max(this.maxX,re),this.maxY=Math.max(this.maxY,ce)}updateRectMinMax(ie,re){const ce=n.Util.applyTransform(re,ie),fe=n.Util.applyTransform(re.slice(2),ie);this.minX=Math.min(this.minX,ce[0],fe[0]),this.minY=Math.min(this.minY,ce[1],fe[1]),this.maxX=Math.max(this.maxX,ce[0],fe[0]),this.maxY=Math.max(this.maxY,ce[1],fe[1])}updateScalingPathMinMax(ie,re){n.Util.scaleMinMax(ie,re),this.minX=Math.min(this.minX,re[0]),this.maxX=Math.max(this.maxX,re[1]),this.minY=Math.min(this.minY,re[2]),this.maxY=Math.max(this.maxY,re[3])}updateCurvePathMinMax(ie,re,ce,fe,pe,ve,Ae,be,je,Se){const Xe=n.Util.bezierBoundingBox(re,ce,fe,pe,ve,Ae,be,je);if(Se){Se[0]=Math.min(Se[0],Xe[0],Xe[2]),Se[1]=Math.max(Se[1],Xe[0],Xe[2]),Se[2]=Math.min(Se[2],Xe[1],Xe[3]),Se[3]=Math.max(Se[3],Xe[1],Xe[3]);return}this.updateRectMinMax(ie,Xe)}getPathBoundingBox(){let ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:s.PathType.FILL,re=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const ce=[this.minX,this.minY,this.maxX,this.maxY];if(ie===s.PathType.STROKE){re||(0,n.unreachable)("Stroke bounding box must include transform.");const fe=n.Util.singularValueDecompose2dScale(re),pe=fe[0]*this.lineWidth/2,ve=fe[1]*this.lineWidth/2;ce[0]-=pe,ce[1]-=ve,ce[2]+=pe,ce[3]+=ve}return ce}updateClipFromPath(){const ie=n.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(ie||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(ie){this.clipBox=ie,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(){let ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:s.PathType.FILL,re=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return n.Util.intersect(this.clipBox,this.getPathBoundingBox(ie,re))}}function te(oe,ie){if(typeof ImageData!="undefined"&&ie instanceof ImageData){oe.putImageData(ie,0,0);return}const re=ie.height,ce=ie.width,fe=re%E,pe=(re-fe)/E,ve=fe===0?pe:pe+1,Ae=oe.createImageData(ce,E);let be=0,je;const Se=ie.data,Xe=Ae.data;let qe,Je,We,Ue;if(ie.kind===n.ImageKind.GRAYSCALE_1BPP){const Ce=Se.byteLength,Le=new Uint32Array(Xe.buffer,0,Xe.byteLength>>2),Ve=Le.length,Ge=ce+7>>3,ut=4294967295,Jt=n.FeatureTest.isLittleEndian?4278190080:255;for(qe=0;qe<ve;qe++){for(We=qe<pe?E:fe,je=0,Je=0;Je<We;Je++){const Kt=Ce-be;let Ze=0;const tr=Kt>Ge?ce:Kt*8-7,nr=tr&-8;let xr=0,pr=0;for(;Ze<nr;Ze+=8)pr=Se[be++],Le[je++]=pr&128?ut:Jt,Le[je++]=pr&64?ut:Jt,Le[je++]=pr&32?ut:Jt,Le[je++]=pr&16?ut:Jt,Le[je++]=pr&8?ut:Jt,Le[je++]=pr&4?ut:Jt,Le[je++]=pr&2?ut:Jt,Le[je++]=pr&1?ut:Jt;for(;Ze<tr;Ze++)xr===0&&(pr=Se[be++],xr=128),Le[je++]=pr&xr?ut:Jt,xr>>=1}for(;je<Ve;)Le[je++]=0;oe.putImageData(Ae,0,qe*E)}}else if(ie.kind===n.ImageKind.RGBA_32BPP){for(Je=0,Ue=ce*E*4,qe=0;qe<pe;qe++)Xe.set(Se.subarray(be,be+Ue)),be+=Ue,oe.putImageData(Ae,0,Je),Je+=E;qe<ve&&(Ue=ce*fe*4,Xe.set(Se.subarray(be,be+Ue)),oe.putImageData(Ae,0,Je))}else if(ie.kind===n.ImageKind.RGB_24BPP)for(We=E,Ue=ce*We,qe=0;qe<ve;qe++){for(qe>=pe&&(We=fe,Ue=ce*We),je=0,Je=Ue;Je--;)Xe[je++]=Se[be++],Xe[je++]=Se[be++],Xe[je++]=Se[be++],Xe[je++]=255;oe.putImageData(Ae,0,qe*E)}else throw new Error(`bad image kind: ${ie.kind}`)}function ne(oe,ie){if(ie.bitmap){oe.drawImage(ie.bitmap,0,0);return}const re=ie.height,ce=ie.width,fe=re%E,pe=(re-fe)/E,ve=fe===0?pe:pe+1,Ae=oe.createImageData(ce,E);let be=0;const je=ie.data,Se=Ae.data;for(let Xe=0;Xe<ve;Xe++){const qe=Xe<pe?E:fe;({srcPos:be}=(0,a.convertBlackAndWhiteToRGBA)({src:je,srcPos:be,dest:Se,width:ce,height:qe,nonBlackColor:0})),oe.putImageData(Ae,0,Xe*E)}}function j(oe,ie){const re=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const ce of re)oe[ce]!==void 0&&(ie[ce]=oe[ce]);oe.setLineDash!==void 0&&(ie.setLineDash(oe.getLineDash()),ie.lineDashOffset=oe.lineDashOffset)}function ee(oe){if(oe.strokeStyle=oe.fillStyle="#000000",oe.fillRule="nonzero",oe.globalAlpha=1,oe.lineWidth=1,oe.lineCap="butt",oe.lineJoin="miter",oe.miterLimit=10,oe.globalCompositeOperation="source-over",oe.font="10px sans-serif",oe.setLineDash!==void 0&&(oe.setLineDash([]),oe.lineDashOffset=0),!n.isNodeJS){const{filter:ie}=oe;ie!=="none"&&ie!==""&&(oe.filter="none")}}function x(oe,ie,re,ce){const fe=oe.length;for(let pe=3;pe<fe;pe+=4){const ve=oe[pe];if(ve===0)oe[pe-3]=ie,oe[pe-2]=re,oe[pe-1]=ce;else if(ve<255){const Ae=255-ve;oe[pe-3]=oe[pe-3]*ve+ie*Ae>>8,oe[pe-2]=oe[pe-2]*ve+re*Ae>>8,oe[pe-1]=oe[pe-1]*ve+ce*Ae>>8}}}function M(oe,ie,re){const ce=oe.length,fe=1/255;for(let pe=3;pe<ce;pe+=4){const ve=re?re[oe[pe]]:oe[pe];ie[pe]=ie[pe]*ve*fe|0}}function T(oe,ie,re){const ce=oe.length;for(let fe=3;fe<ce;fe+=4){const pe=oe[fe-3]*77+oe[fe-2]*152+oe[fe-1]*28;ie[fe]=re?ie[fe]*re[pe>>8]>>8:ie[fe]*pe>>16}}function O(oe,ie,re,ce,fe,pe,ve,Ae,be,je,Se){const Xe=!!pe,qe=Xe?pe[0]:0,Je=Xe?pe[1]:0,We=Xe?pe[2]:0,Ue=fe==="Luminosity"?T:M,Le=Math.min(ce,Math.ceil(1048576/re));for(let Ve=0;Ve<ce;Ve+=Le){const Ge=Math.min(Le,ce-Ve),ut=oe.getImageData(Ae-je,Ve+(be-Se),re,Ge),Jt=ie.getImageData(Ae,Ve+be,re,Ge);Xe&&x(ut.data,qe,Je,We),Ue(ut.data,Jt.data,ve),ie.putImageData(Jt,Ae,Ve+be)}}function R(oe,ie,re,ce){const fe=ce[0],pe=ce[1],ve=ce[2]-fe,Ae=ce[3]-pe;ve===0||Ae===0||(O(ie.context,re,ve,Ae,ie.subtype,ie.backdrop,ie.transferMap,fe,pe,ie.offsetX,ie.offsetY),oe.save(),oe.globalAlpha=1,oe.globalCompositeOperation="source-over",oe.setTransform(1,0,0,1,0,0),oe.drawImage(re.canvas,0,0),oe.restore())}function Y(oe,ie){const re=n.Util.singularValueDecompose2dScale(oe);re[0]=Math.fround(re[0]),re[1]=Math.fround(re[1]);const ce=Math.fround((globalThis.devicePixelRatio||1)*i.PixelsPerInch.PDF_TO_CSS_UNITS);return ie!==void 0?ie:re[0]<=ce||re[1]<=ce}const q=["butt","round","square"],me=["miter","round","bevel"],xe={},Ee={},_e=class _e{constructor(ie,re,ce,fe,pe,ve,Ae,be){ct(this,Fe);let{optionalContentConfig:je,markedContentStack:Se=null}=ve;this.ctx=ie,this.current=new H(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=re,this.objs=ce,this.canvasFactory=fe,this.filterFactory=pe,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=Se||[],this.optionalContentConfig=je,this.cachedCanvases=new p(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=Ae,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=be,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(ie){let re=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return typeof ie=="string"?ie.startsWith("g_")?this.commonObjs.get(ie):this.objs.get(ie):re}beginDrawing(ie){let{transform:re,viewport:ce,transparency:fe=!1,background:pe=null}=ie;const ve=this.ctx.canvas.width,Ae=this.ctx.canvas.height,be=this.ctx.fillStyle;if(this.ctx.fillStyle=pe||"#ffffff",this.ctx.fillRect(0,0,ve,Ae),this.ctx.fillStyle=be,fe){const je=this.cachedCanvases.getCanvas("transparent",ve,Ae);this.compositeCtx=this.ctx,this.transparentCanvas=je.canvas,this.ctx=je.context,this.ctx.save(),this.ctx.transform(...(0,i.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),ee(this.ctx),re&&(this.ctx.transform(...re),this.outputScaleX=re[0],this.outputScaleY=re[0]),this.ctx.transform(...ce.transform),this.viewportScale=ce.scale,this.baseTransform=(0,i.getCurrentTransform)(this.ctx)}executeOperatorList(ie,re,ce,fe){const pe=ie.argsArray,ve=ie.fnArray;let Ae=re||0;const be=pe.length;if(be===Ae)return Ae;const je=be-Ae>f&&typeof ce=="function",Se=je?Date.now()+h:0;let Xe=0;const qe=this.commonObjs,Je=this.objs;let We;for(;;){if(fe!==void 0&&Ae===fe.nextBreakPoint)return fe.breakIt(Ae,ce),Ae;if(We=ve[Ae],We!==n.OPS.dependency)this[We].apply(this,pe[Ae]);else for(const Ue of pe[Ae]){const Ce=Ue.startsWith("g_")?qe:Je;if(!Ce.has(Ue))return Ce.get(Ue,ce),Ae}if(Ae++,Ae===be)return Ae;if(je&&++Xe>f){if(Date.now()>Se)return ce(),Ae;Xe=0}}}endDrawing(){Qe(this,Fe,la).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const ie of this._cachedBitmapsMap.values()){for(const re of ie.values())typeof HTMLCanvasElement!="undefined"&&re instanceof HTMLCanvasElement&&(re.width=re.height=0);ie.clear()}this._cachedBitmapsMap.clear(),Qe(this,Fe,ca).call(this)}_scaleImage(ie,re){const ce=ie.width,fe=ie.height;let pe=Math.max(Math.hypot(re[0],re[1]),1),ve=Math.max(Math.hypot(re[2],re[3]),1),Ae=ce,be=fe,je="prescale1",Se,Xe;for(;pe>2&&Ae>1||ve>2&&be>1;){let qe=Ae,Je=be;pe>2&&Ae>1&&(qe=Ae>=16384?Math.floor(Ae/2)-1||1:Math.ceil(Ae/2),pe/=Ae/qe),ve>2&&be>1&&(Je=be>=16384?Math.floor(be/2)-1||1:Math.ceil(be)/2,ve/=be/Je),Se=this.cachedCanvases.getCanvas(je,qe,Je),Xe=Se.context,Xe.clearRect(0,0,qe,Je),Xe.drawImage(ie,0,0,Ae,be,0,0,qe,Je),ie=Se.canvas,Ae=qe,be=Je,je=je==="prescale1"?"prescale2":"prescale1"}return{img:ie,paintWidth:Ae,paintHeight:be}}_createMaskCanvas(ie){const re=this.ctx,{width:ce,height:fe}=ie,pe=this.current.fillColor,ve=this.current.patternFill,Ae=(0,i.getCurrentTransform)(re);let be,je,Se,Xe;if((ie.bitmap||ie.data)&&ie.count>1){const Ze=ie.bitmap||ie.data.buffer;je=JSON.stringify(ve?Ae:[Ae.slice(0,4),pe]),be=this._cachedBitmapsMap.get(Ze),be||(be=new Map,this._cachedBitmapsMap.set(Ze,be));const tr=be.get(je);if(tr&&!ve){const nr=Math.round(Math.min(Ae[0],Ae[2])+Ae[4]),xr=Math.round(Math.min(Ae[1],Ae[3])+Ae[5]);return{canvas:tr,offsetX:nr,offsetY:xr}}Se=tr}Se||(Xe=this.cachedCanvases.getCanvas("maskCanvas",ce,fe),ne(Xe.context,ie));let qe=n.Util.transform(Ae,[1/ce,0,0,-1/fe,0,0]);qe=n.Util.transform(qe,[1,0,0,1,0,-fe]);const Je=n.Util.applyTransform([0,0],qe),We=n.Util.applyTransform([ce,fe],qe),Ue=n.Util.normalizeRect([Je[0],Je[1],We[0],We[1]]),Ce=Math.round(Ue[2]-Ue[0])||1,Le=Math.round(Ue[3]-Ue[1])||1,Ve=this.cachedCanvases.getCanvas("fillCanvas",Ce,Le),Ge=Ve.context,ut=Math.min(Je[0],We[0]),Jt=Math.min(Je[1],We[1]);Ge.translate(-ut,-Jt),Ge.transform(...qe),Se||(Se=this._scaleImage(Xe.canvas,(0,i.getCurrentTransformInverse)(Ge)),Se=Se.img,be&&ve&&be.set(je,Se)),Ge.imageSmoothingEnabled=Y((0,i.getCurrentTransform)(Ge),ie.interpolate),_(Ge,Se,0,0,Se.width,Se.height,0,0,ce,fe),Ge.globalCompositeOperation="source-in";const Kt=n.Util.transform((0,i.getCurrentTransformInverse)(Ge),[1,0,0,1,-ut,-Jt]);return Ge.fillStyle=ve?pe.getPattern(re,this,Kt,s.PathType.FILL):pe,Ge.fillRect(0,0,ce,fe),be&&!ve&&(this.cachedCanvases.delete("fillCanvas"),be.set(je,Ve.canvas)),{canvas:Ve.canvas,offsetX:Math.round(ut),offsetY:Math.round(Jt)}}setLineWidth(ie){ie!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=ie,this.ctx.lineWidth=ie}setLineCap(ie){this.ctx.lineCap=q[ie]}setLineJoin(ie){this.ctx.lineJoin=me[ie]}setMiterLimit(ie){this.ctx.miterLimit=ie}setDash(ie,re){const ce=this.ctx;ce.setLineDash!==void 0&&(ce.setLineDash(ie),ce.lineDashOffset=re)}setRenderingIntent(ie){}setFlatness(ie){}setGState(ie){for(const[re,ce]of ie)switch(re){case"LW":this.setLineWidth(ce);break;case"LC":this.setLineCap(ce);break;case"LJ":this.setLineJoin(ce);break;case"ML":this.setMiterLimit(ce);break;case"D":this.setDash(ce[0],ce[1]);break;case"RI":this.setRenderingIntent(ce);break;case"FL":this.setFlatness(ce);break;case"Font":this.setFont(ce[0],ce[1]);break;case"CA":this.current.strokeAlpha=ce;break;case"ca":this.current.fillAlpha=ce,this.ctx.globalAlpha=ce;break;case"BM":this.ctx.globalCompositeOperation=ce;break;case"SMask":this.current.activeSMask=ce?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(ce);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const ie=this.inSMaskMode;this.current.activeSMask&&!ie?this.beginSMaskMode():!this.current.activeSMask&&ie&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const ie=this.ctx.canvas.width,re=this.ctx.canvas.height,ce="smaskGroupAt"+this.groupLevel,fe=this.cachedCanvases.getCanvas(ce,ie,re);this.suspendedCtx=this.ctx,this.ctx=fe.context;const pe=this.ctx;pe.setTransform(...(0,i.getCurrentTransform)(this.suspendedCtx)),j(this.suspendedCtx,pe),g(pe,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),j(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(ie){if(!this.current.activeSMask)return;ie?(ie[0]=Math.floor(ie[0]),ie[1]=Math.floor(ie[1]),ie[2]=Math.ceil(ie[2]),ie[3]=Math.ceil(ie[3])):ie=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const re=this.current.activeSMask,ce=this.suspendedCtx;R(ce,re,this.ctx,ie),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(j(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const ie=this.current;this.stateStack.push(ie),this.current=ie.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),j(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(ie,re,ce,fe,pe,ve){this.ctx.transform(ie,re,ce,fe,pe,ve),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(ie,re,ce){const fe=this.ctx,pe=this.current;let ve=pe.x,Ae=pe.y,be,je;const Se=(0,i.getCurrentTransform)(fe),Xe=Se[0]===0&&Se[3]===0||Se[1]===0&&Se[2]===0,qe=Xe?ce.slice(0):null;for(let Je=0,We=0,Ue=ie.length;Je<Ue;Je++)switch(ie[Je]|0){case n.OPS.rectangle:ve=re[We++],Ae=re[We++];const Ce=re[We++],Le=re[We++],Ve=ve+Ce,Ge=Ae+Le;fe.moveTo(ve,Ae),Ce===0||Le===0?fe.lineTo(Ve,Ge):(fe.lineTo(Ve,Ae),fe.lineTo(Ve,Ge),fe.lineTo(ve,Ge)),Xe||pe.updateRectMinMax(Se,[ve,Ae,Ve,Ge]),fe.closePath();break;case n.OPS.moveTo:ve=re[We++],Ae=re[We++],fe.moveTo(ve,Ae),Xe||pe.updatePathMinMax(Se,ve,Ae);break;case n.OPS.lineTo:ve=re[We++],Ae=re[We++],fe.lineTo(ve,Ae),Xe||pe.updatePathMinMax(Se,ve,Ae);break;case n.OPS.curveTo:be=ve,je=Ae,ve=re[We+4],Ae=re[We+5],fe.bezierCurveTo(re[We],re[We+1],re[We+2],re[We+3],ve,Ae),pe.updateCurvePathMinMax(Se,be,je,re[We],re[We+1],re[We+2],re[We+3],ve,Ae,qe),We+=6;break;case n.OPS.curveTo2:be=ve,je=Ae,fe.bezierCurveTo(ve,Ae,re[We],re[We+1],re[We+2],re[We+3]),pe.updateCurvePathMinMax(Se,be,je,ve,Ae,re[We],re[We+1],re[We+2],re[We+3],qe),ve=re[We+2],Ae=re[We+3],We+=4;break;case n.OPS.curveTo3:be=ve,je=Ae,ve=re[We+2],Ae=re[We+3],fe.bezierCurveTo(re[We],re[We+1],ve,Ae,ve,Ae),pe.updateCurvePathMinMax(Se,be,je,re[We],re[We+1],ve,Ae,ve,Ae,qe),We+=4;break;case n.OPS.closePath:fe.closePath();break}Xe&&pe.updateScalingPathMinMax(Se,qe),pe.setCurrentPoint(ve,Ae)}closePath(){this.ctx.closePath()}stroke(){let ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const re=this.ctx,ce=this.current.strokeColor;re.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof ce=="object"&&(ce!=null&&ce.getPattern)?(re.save(),re.strokeStyle=ce.getPattern(re,this,(0,i.getCurrentTransformInverse)(re),s.PathType.STROKE),this.rescaleAndStroke(!1),re.restore()):this.rescaleAndStroke(!0)),ie&&this.consumePath(this.current.getClippedPathBoundingBox()),re.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(){let ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const re=this.ctx,ce=this.current.fillColor,fe=this.current.patternFill;let pe=!1;fe&&(re.save(),re.fillStyle=ce.getPattern(re,this,(0,i.getCurrentTransformInverse)(re),s.PathType.FILL),pe=!0);const ve=this.current.getClippedPathBoundingBox();this.contentVisible&&ve!==null&&(this.pendingEOFill?(re.fill("evenodd"),this.pendingEOFill=!1):re.fill()),pe&&re.restore(),ie&&this.consumePath(ve)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=xe}eoClip(){this.pendingClip=Ee}beginText(){this.current.textMatrix=n.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const ie=this.pendingTextPaths,re=this.ctx;if(ie===void 0){re.beginPath();return}re.save(),re.beginPath();for(const ce of ie)re.setTransform(...ce.transform),re.translate(ce.x,ce.y),ce.addToPath(re,ce.fontSize);re.restore(),re.clip(),re.beginPath(),delete this.pendingTextPaths}setCharSpacing(ie){this.current.charSpacing=ie}setWordSpacing(ie){this.current.wordSpacing=ie}setHScale(ie){this.current.textHScale=ie/100}setLeading(ie){this.current.leading=-ie}setFont(ie,re){var Se;const ce=this.commonObjs.get(ie),fe=this.current;if(!ce)throw new Error(`Can't find font for ${ie}`);if(fe.fontMatrix=ce.fontMatrix||n.FONT_IDENTITY_MATRIX,(fe.fontMatrix[0]===0||fe.fontMatrix[3]===0)&&(0,n.warn)("Invalid font matrix for font "+ie),re<0?(re=-re,fe.fontDirection=-1):fe.fontDirection=1,this.current.font=ce,this.current.fontSize=re,ce.isType3Font)return;const pe=ce.loadedName||"sans-serif",ve=((Se=ce.systemFontInfo)==null?void 0:Se.css)||`"${pe}", ${ce.fallbackName}`;let Ae="normal";ce.black?Ae="900":ce.bold&&(Ae="bold");const be=ce.italic?"italic":"normal";let je=re;re<o?je=o:re>c&&(je=c),this.current.fontSizeScale=re/je,this.ctx.font=`${be} ${Ae} ${je}px ${ve}`}setTextRenderingMode(ie){this.current.textRenderingMode=ie}setTextRise(ie){this.current.textRise=ie}moveText(ie,re){this.current.x=this.current.lineX+=ie,this.current.y=this.current.lineY+=re}setLeadingMoveText(ie,re){this.setLeading(-re),this.moveText(ie,re)}setTextMatrix(ie,re,ce,fe,pe,ve){this.current.textMatrix=[ie,re,ce,fe,pe,ve],this.current.textMatrixScale=Math.hypot(ie,re),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(ie,re,ce,fe){const pe=this.ctx,ve=this.current,Ae=ve.font,be=ve.textRenderingMode,je=ve.fontSize/ve.fontSizeScale,Se=be&n.TextRenderingMode.FILL_STROKE_MASK,Xe=!!(be&n.TextRenderingMode.ADD_TO_PATH_FLAG),qe=ve.patternFill&&!Ae.missingFile;let Je;(Ae.disableFontFace||Xe||qe)&&(Je=Ae.getPathGenerator(this.commonObjs,ie)),Ae.disableFontFace||qe?(pe.save(),pe.translate(re,ce),pe.beginPath(),Je(pe,je),fe&&pe.setTransform(...fe),(Se===n.TextRenderingMode.FILL||Se===n.TextRenderingMode.FILL_STROKE)&&pe.fill(),(Se===n.TextRenderingMode.STROKE||Se===n.TextRenderingMode.FILL_STROKE)&&pe.stroke(),pe.restore()):((Se===n.TextRenderingMode.FILL||Se===n.TextRenderingMode.FILL_STROKE)&&pe.fillText(ie,re,ce),(Se===n.TextRenderingMode.STROKE||Se===n.TextRenderingMode.FILL_STROKE)&&pe.strokeText(ie,re,ce)),Xe&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,i.getCurrentTransform)(pe),x:re,y:ce,fontSize:je,addToPath:Je})}get isFontSubpixelAAEnabled(){const{context:ie}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);ie.scale(1.5,1),ie.fillText("I",0,10);const re=ie.getImageData(0,0,10,10).data;let ce=!1;for(let fe=3;fe<re.length;fe+=4)if(re[fe]>0&&re[fe]<255){ce=!0;break}return(0,n.shadow)(this,"isFontSubpixelAAEnabled",ce)}showText(ie){const re=this.current,ce=re.font;if(ce.isType3Font)return this.showType3Text(ie);const fe=re.fontSize;if(fe===0)return;const pe=this.ctx,ve=re.fontSizeScale,Ae=re.charSpacing,be=re.wordSpacing,je=re.fontDirection,Se=re.textHScale*je,Xe=ie.length,qe=ce.vertical,Je=qe?1:-1,We=ce.defaultVMetrics,Ue=fe*re.fontMatrix[0],Ce=re.textRenderingMode===n.TextRenderingMode.FILL&&!ce.disableFontFace&&!re.patternFill;pe.save(),pe.transform(...re.textMatrix),pe.translate(re.x,re.y+re.textRise),je>0?pe.scale(Se,-1):pe.scale(Se,1);let Le;if(re.patternFill){pe.save();const Kt=re.fillColor.getPattern(pe,this,(0,i.getCurrentTransformInverse)(pe),s.PathType.FILL);Le=(0,i.getCurrentTransform)(pe),pe.restore(),pe.fillStyle=Kt}let Ve=re.lineWidth;const Ge=re.textMatrixScale;if(Ge===0||Ve===0){const Kt=re.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;(Kt===n.TextRenderingMode.STROKE||Kt===n.TextRenderingMode.FILL_STROKE)&&(Ve=this.getSinglePixelWidth())}else Ve/=Ge;if(ve!==1&&(pe.scale(ve,ve),Ve/=ve),pe.lineWidth=Ve,ce.isInvalidPDFjsFont){const Kt=[];let Ze=0;for(const tr of ie)Kt.push(tr.unicode),Ze+=tr.width;pe.fillText(Kt.join(""),0,0),re.x+=Ze*Ue*Se,pe.restore(),this.compose();return}let ut=0,Jt;for(Jt=0;Jt<Xe;++Jt){const Kt=ie[Jt];if(typeof Kt=="number"){ut+=Je*Kt*fe/1e3;continue}let Ze=!1;const tr=(Kt.isSpace?be:0)+Ae,nr=Kt.fontChar,xr=Kt.accent;let pr,vr,lr=Kt.width;if(qe){const wr=Kt.vmetric||We,Cr=-(Kt.vmetric?wr[1]:lr*.5)*Ue,Rr=wr[2]*Ue;lr=wr?-wr[0]:lr,pr=Cr/ve,vr=(ut+Rr)/ve}else pr=ut/ve,vr=0;if(ce.remeasure&&lr>0){const wr=pe.measureText(nr).width*1e3/fe*ve;if(lr<wr&&this.isFontSubpixelAAEnabled){const Cr=lr/wr;Ze=!0,pe.save(),pe.scale(Cr,1),pr/=Cr}else lr!==wr&&(pr+=(lr-wr)/2e3*fe/ve)}if(this.contentVisible&&(Kt.isInFont||ce.missingFile)){if(Ce&&!xr)pe.fillText(nr,pr,vr);else if(this.paintChar(nr,pr,vr,Le),xr){const wr=pr+fe*xr.offset.x/ve,Cr=vr-fe*xr.offset.y/ve;this.paintChar(xr.fontChar,wr,Cr,Le)}}const mr=qe?lr*Ue-tr*je:lr*Ue+tr*je;ut+=mr,Ze&&pe.restore()}qe?re.y-=ut:re.x+=ut*Se,pe.restore(),this.compose()}showType3Text(ie){const re=this.ctx,ce=this.current,fe=ce.font,pe=ce.fontSize,ve=ce.fontDirection,Ae=fe.vertical?1:-1,be=ce.charSpacing,je=ce.wordSpacing,Se=ce.textHScale*ve,Xe=ce.fontMatrix||n.FONT_IDENTITY_MATRIX,qe=ie.length,Je=ce.textRenderingMode===n.TextRenderingMode.INVISIBLE;let We,Ue,Ce,Le;if(!(Je||pe===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,re.save(),re.transform(...ce.textMatrix),re.translate(ce.x,ce.y),re.scale(Se,ve),We=0;We<qe;++We){if(Ue=ie[We],typeof Ue=="number"){Le=Ae*Ue*pe/1e3,this.ctx.translate(Le,0),ce.x+=Le*Se;continue}const Ve=(Ue.isSpace?je:0)+be,Ge=fe.charProcOperatorList[Ue.operatorListId];if(!Ge){(0,n.warn)(`Type3 character "${Ue.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Ue,this.save(),re.scale(pe,pe),re.transform(...Xe),this.executeOperatorList(Ge),this.restore()),Ce=n.Util.applyTransform([Ue.width,0],Xe)[0]*pe+Ve,re.translate(Ce,0),ce.x+=Ce*Se}re.restore(),this.processingType3=null}}setCharWidth(ie,re){}setCharWidthAndBounds(ie,re,ce,fe,pe,ve){this.ctx.rect(ce,fe,pe-ce,ve-fe),this.ctx.clip(),this.endPath()}getColorN_Pattern(ie){let re;if(ie[0]==="TilingPattern"){const ce=ie[1],fe=this.baseTransform||(0,i.getCurrentTransform)(this.ctx),pe={createCanvasGraphics:ve=>new _e(ve,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};re=new s.TilingPattern(ie,ce,this.ctx,pe,fe)}else re=this._getPattern(ie[1],ie[2]);return re}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(ie,re,ce){const fe=n.Util.makeHexColor(ie,re,ce);this.ctx.strokeStyle=fe,this.current.strokeColor=fe}setFillRGBColor(ie,re,ce){const fe=n.Util.makeHexColor(ie,re,ce);this.ctx.fillStyle=fe,this.current.fillColor=fe,this.current.patternFill=!1}_getPattern(ie){let re=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,ce;return this.cachedPatterns.has(ie)?ce=this.cachedPatterns.get(ie):(ce=(0,s.getShadingPattern)(this.getObject(ie)),this.cachedPatterns.set(ie,ce)),re&&(ce.matrix=re),ce}shadingFill(ie){if(!this.contentVisible)return;const re=this.ctx;this.save();const ce=this._getPattern(ie);re.fillStyle=ce.getPattern(re,this,(0,i.getCurrentTransformInverse)(re),s.PathType.SHADING);const fe=(0,i.getCurrentTransformInverse)(re);if(fe){const{width:pe,height:ve}=re.canvas,[Ae,be,je,Se]=n.Util.getAxialAlignedBoundingBox([0,0,pe,ve],fe);this.ctx.fillRect(Ae,be,je-Ae,Se-be)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,n.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,n.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(ie,re){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(ie)&&ie.length===6&&this.transform(...ie),this.baseTransform=(0,i.getCurrentTransform)(this.ctx),re)){const ce=re[2]-re[0],fe=re[3]-re[1];this.ctx.rect(re[0],re[1],ce,fe),this.current.updateRectMinMax((0,i.getCurrentTransform)(this.ctx),re),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(ie){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const re=this.ctx;ie.isolated||(0,n.info)("TODO: Support non-isolated groups."),ie.knockout&&(0,n.warn)("Knockout groups not supported.");const ce=(0,i.getCurrentTransform)(re);if(ie.matrix&&re.transform(...ie.matrix),!ie.bbox)throw new Error("Bounding box is required.");let fe=n.Util.getAxialAlignedBoundingBox(ie.bbox,(0,i.getCurrentTransform)(re));const pe=[0,0,re.canvas.width,re.canvas.height];fe=n.Util.intersect(fe,pe)||[0,0,0,0];const ve=Math.floor(fe[0]),Ae=Math.floor(fe[1]);let be=Math.max(Math.ceil(fe[2])-ve,1),je=Math.max(Math.ceil(fe[3])-Ae,1),Se=1,Xe=1;be>u&&(Se=be/u,be=u),je>u&&(Xe=je/u,je=u),this.current.startNewPathAndClipBox([0,0,be,je]);let qe="groupAt"+this.groupLevel;ie.smask&&(qe+="_smask_"+this.smaskCounter++%2);const Je=this.cachedCanvases.getCanvas(qe,be,je),We=Je.context;We.scale(1/Se,1/Xe),We.translate(-ve,-Ae),We.transform(...ce),ie.smask?this.smaskStack.push({canvas:Je.canvas,context:We,offsetX:ve,offsetY:Ae,scaleX:Se,scaleY:Xe,subtype:ie.smask.subtype,backdrop:ie.smask.backdrop,transferMap:ie.smask.transferMap||null,startTransformInverse:null}):(re.setTransform(1,0,0,1,0,0),re.translate(ve,Ae),re.scale(Se,Xe),re.save()),j(re,We),this.ctx=We,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(re),this.groupLevel++}endGroup(ie){if(!this.contentVisible)return;this.groupLevel--;const re=this.ctx,ce=this.groupStack.pop();if(this.ctx=ce,this.ctx.imageSmoothingEnabled=!1,ie.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const fe=(0,i.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...fe);const pe=n.Util.getAxialAlignedBoundingBox([0,0,re.canvas.width,re.canvas.height],fe);this.ctx.drawImage(re.canvas,0,0),this.ctx.restore(),this.compose(pe)}}beginAnnotation(ie,re,ce,fe,pe){if(Qe(this,Fe,la).call(this),ee(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(re)&&re.length===4){const ve=re[2]-re[0],Ae=re[3]-re[1];if(pe&&this.annotationCanvasMap){ce=ce.slice(),ce[4]-=re[0],ce[5]-=re[1],re=re.slice(),re[0]=re[1]=0,re[2]=ve,re[3]=Ae;const[be,je]=n.Util.singularValueDecompose2dScale((0,i.getCurrentTransform)(this.ctx)),{viewportScale:Se}=this,Xe=Math.ceil(ve*this.outputScaleX*Se),qe=Math.ceil(Ae*this.outputScaleY*Se);this.annotationCanvas=this.canvasFactory.create(Xe,qe);const{canvas:Je,context:We}=this.annotationCanvas;this.annotationCanvasMap.set(ie,Je),this.annotationCanvas.savedCtx=this.ctx,this.ctx=We,this.ctx.save(),this.ctx.setTransform(be,0,0,-je,0,Ae*je),ee(this.ctx)}else ee(this.ctx),this.ctx.rect(re[0],re[1],ve,Ae),this.ctx.clip(),this.endPath()}this.current=new H(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...ce),this.transform(...fe)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),Qe(this,Fe,ca).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(ie){if(!this.contentVisible)return;const re=ie.count;ie=this.getObject(ie.data,ie),ie.count=re;const ce=this.ctx,fe=this.processingType3;if(fe&&(fe.compiled===void 0&&(fe.compiled=A(ie)),fe.compiled)){fe.compiled(ce);return}const pe=this._createMaskCanvas(ie),ve=pe.canvas;ce.save(),ce.setTransform(1,0,0,1,0,0),ce.drawImage(ve,pe.offsetX,pe.offsetY),ce.restore(),this.compose()}paintImageMaskXObjectRepeat(ie,re){let ce=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,fe=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,pe=arguments.length>4?arguments[4]:void 0,ve=arguments.length>5?arguments[5]:void 0;if(!this.contentVisible)return;ie=this.getObject(ie.data,ie);const Ae=this.ctx;Ae.save();const be=(0,i.getCurrentTransform)(Ae);Ae.transform(re,ce,fe,pe,0,0);const je=this._createMaskCanvas(ie);Ae.setTransform(1,0,0,1,je.offsetX-be[4],je.offsetY-be[5]);for(let Se=0,Xe=ve.length;Se<Xe;Se+=2){const qe=n.Util.transform(be,[re,ce,fe,pe,ve[Se],ve[Se+1]]),[Je,We]=n.Util.applyTransform([0,0],qe);Ae.drawImage(je.canvas,Je,We)}Ae.restore(),this.compose()}paintImageMaskXObjectGroup(ie){if(!this.contentVisible)return;const re=this.ctx,ce=this.current.fillColor,fe=this.current.patternFill;for(const pe of ie){const{data:ve,width:Ae,height:be,transform:je}=pe,Se=this.cachedCanvases.getCanvas("maskCanvas",Ae,be),Xe=Se.context;Xe.save();const qe=this.getObject(ve,pe);ne(Xe,qe),Xe.globalCompositeOperation="source-in",Xe.fillStyle=fe?ce.getPattern(Xe,this,(0,i.getCurrentTransformInverse)(re),s.PathType.FILL):ce,Xe.fillRect(0,0,Ae,be),Xe.restore(),re.save(),re.transform(...je),re.scale(1,-1),_(re,Se.canvas,0,0,Ae,be,0,-1,1,1),re.restore()}this.compose()}paintImageXObject(ie){if(!this.contentVisible)return;const re=this.getObject(ie);if(!re){(0,n.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(re)}paintImageXObjectRepeat(ie,re,ce,fe){if(!this.contentVisible)return;const pe=this.getObject(ie);if(!pe){(0,n.warn)("Dependent image isn't ready yet");return}const ve=pe.width,Ae=pe.height,be=[];for(let je=0,Se=fe.length;je<Se;je+=2)be.push({transform:[re,0,0,ce,fe[je],fe[je+1]],x:0,y:0,w:ve,h:Ae});this.paintInlineImageXObjectGroup(pe,be)}applyTransferMapsToCanvas(ie){return this.current.transferMaps!=="none"&&(ie.filter=this.current.transferMaps,ie.drawImage(ie.canvas,0,0),ie.filter="none"),ie.canvas}applyTransferMapsToBitmap(ie){if(this.current.transferMaps==="none")return ie.bitmap;const{bitmap:re,width:ce,height:fe}=ie,pe=this.cachedCanvases.getCanvas("inlineImage",ce,fe),ve=pe.context;return ve.filter=this.current.transferMaps,ve.drawImage(re,0,0),ve.filter="none",pe.canvas}paintInlineImageXObject(ie){if(!this.contentVisible)return;const re=ie.width,ce=ie.height,fe=this.ctx;if(this.save(),!n.isNodeJS){const{filter:Ae}=fe;Ae!=="none"&&Ae!==""&&(fe.filter="none")}fe.scale(1/re,-1/ce);let pe;if(ie.bitmap)pe=this.applyTransferMapsToBitmap(ie);else if(typeof HTMLElement=="function"&&ie instanceof HTMLElement||!ie.data)pe=ie;else{const be=this.cachedCanvases.getCanvas("inlineImage",re,ce).context;te(be,ie),pe=this.applyTransferMapsToCanvas(be)}const ve=this._scaleImage(pe,(0,i.getCurrentTransformInverse)(fe));fe.imageSmoothingEnabled=Y((0,i.getCurrentTransform)(fe),ie.interpolate),_(fe,ve.img,0,0,ve.paintWidth,ve.paintHeight,0,-ce,re,ce),this.compose(),this.restore()}paintInlineImageXObjectGroup(ie,re){if(!this.contentVisible)return;const ce=this.ctx;let fe;if(ie.bitmap)fe=ie.bitmap;else{const pe=ie.width,ve=ie.height,be=this.cachedCanvases.getCanvas("inlineImage",pe,ve).context;te(be,ie),fe=this.applyTransferMapsToCanvas(be)}for(const pe of re)ce.save(),ce.transform(...pe.transform),ce.scale(1,-1),_(ce,fe,pe.x,pe.y,pe.w,pe.h,0,-1,1,1),ce.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(ie){}markPointProps(ie,re){}beginMarkedContent(ie){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(ie,re){ie==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(re)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(ie){const re=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(ie);const ce=this.ctx;this.pendingClip&&(re||(this.pendingClip===Ee?ce.clip("evenodd"):ce.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),ce.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const ie=(0,i.getCurrentTransform)(this.ctx);if(ie[1]===0&&ie[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(ie[0]),Math.abs(ie[3]));else{const re=Math.abs(ie[0]*ie[3]-ie[2]*ie[1]),ce=Math.hypot(ie[0],ie[2]),fe=Math.hypot(ie[1],ie[3]);this._cachedGetSinglePixelWidth=Math.max(ce,fe)/re}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:ie}=this.current,{a:re,b:ce,c:fe,d:pe}=this.ctx.getTransform();let ve,Ae;if(ce===0&&fe===0){const be=Math.abs(re),je=Math.abs(pe);if(be===je)if(ie===0)ve=Ae=1/be;else{const Se=be*ie;ve=Ae=Se<1?1/Se:1}else if(ie===0)ve=1/be,Ae=1/je;else{const Se=be*ie,Xe=je*ie;ve=Se<1?1/Se:1,Ae=Xe<1?1/Xe:1}}else{const be=Math.abs(re*pe-ce*fe),je=Math.hypot(re,ce),Se=Math.hypot(fe,pe);if(ie===0)ve=Se/be,Ae=je/be;else{const Xe=ie*be;ve=Se>Xe?Se/Xe:1,Ae=je>Xe?je/Xe:1}}this._cachedScaleForStroking[0]=ve,this._cachedScaleForStroking[1]=Ae}return this._cachedScaleForStroking}rescaleAndStroke(ie){const{ctx:re}=this,{lineWidth:ce}=this.current,[fe,pe]=this.getScaleForStroking();if(re.lineWidth=ce||1,fe===1&&pe===1){re.stroke();return}const ve=re.getLineDash();if(ie&&re.save(),re.scale(fe,pe),ve.length>0){const Ae=Math.max(fe,pe);re.setLineDash(ve.map(be=>be/Ae)),re.lineDashOffset/=Ae}re.stroke(),ie&&re.restore()}isContentVisible(){for(let ie=this.markedContentStack.length-1;ie>=0;ie--)if(!this.markedContentStack[ie].visible)return!1;return!0}};Fe=new WeakSet,la=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},ca=function(){if(this.pageColors){const ie=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(ie!=="none"){const re=this.ctx.filter;this.ctx.filter=ie,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=re}}};let se=_e;e.CanvasGraphics=se;for(const oe in n.OPS)se.prototype[oe]!==void 0&&(se.prototype[n.OPS[oe]]=se.prototype[oe])},(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=E,r(2);var n=r(1),i=r(168);const s={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=s;function a(A,H){if(!H)return;const te=H[2]-H[0],ne=H[3]-H[1],j=new Path2D;j.rect(H[0],H[1],te,ne),A.clip(j)}class o{constructor(){this.constructor===o&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class c extends o{constructor(H){super(),this._type=H[1],this._bbox=H[2],this._colorStops=H[3],this._p0=H[4],this._p1=H[5],this._r0=H[6],this._r1=H[7],this.matrix=null}_createGradient(H){let te;this._type==="axial"?te=H.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(te=H.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const ne of this._colorStops)te.addColorStop(ne[0],ne[1]);return te}getPattern(H,te,ne,j){let ee;if(j===s.STROKE||j===s.FILL){const x=te.current.getClippedPathBoundingBox(j,(0,i.getCurrentTransform)(H))||[0,0,0,0],M=Math.ceil(x[2]-x[0])||1,T=Math.ceil(x[3]-x[1])||1,O=te.cachedCanvases.getCanvas("pattern",M,T,!0),R=O.context;R.clearRect(0,0,R.canvas.width,R.canvas.height),R.beginPath(),R.rect(0,0,R.canvas.width,R.canvas.height),R.translate(-x[0],-x[1]),ne=n.Util.transform(ne,[1,0,0,1,x[0],x[1]]),R.transform(...te.baseTransform),this.matrix&&R.transform(...this.matrix),a(R,this._bbox),R.fillStyle=this._createGradient(R),R.fill(),ee=H.createPattern(O.canvas,"no-repeat");const Y=new DOMMatrix(ne);ee.setTransform(Y)}else a(H,this._bbox),ee=this._createGradient(H);return ee}}function u(A,H,te,ne,j,ee,x,M){const T=H.coords,O=H.colors,R=A.data,Y=A.width*4;let q;T[te+1]>T[ne+1]&&(q=te,te=ne,ne=q,q=ee,ee=x,x=q),T[ne+1]>T[j+1]&&(q=ne,ne=j,j=q,q=x,x=M,M=q),T[te+1]>T[ne+1]&&(q=te,te=ne,ne=q,q=ee,ee=x,x=q);const me=(T[te]+H.offsetX)*H.scaleX,xe=(T[te+1]+H.offsetY)*H.scaleY,Ee=(T[ne]+H.offsetX)*H.scaleX,se=(T[ne+1]+H.offsetY)*H.scaleY,Fe=(T[j]+H.offsetX)*H.scaleX,ue=(T[j+1]+H.offsetY)*H.scaleY;if(xe>=ue)return;const ae=O[ee],_e=O[ee+1],oe=O[ee+2],ie=O[x],re=O[x+1],ce=O[x+2],fe=O[M],pe=O[M+1],ve=O[M+2],Ae=Math.round(xe),be=Math.round(ue);let je,Se,Xe,qe,Je,We,Ue,Ce;for(let Le=Ae;Le<=be;Le++){if(Le<se){const Kt=Le<xe?0:(xe-Le)/(xe-se);je=me-(me-Ee)*Kt,Se=ae-(ae-ie)*Kt,Xe=_e-(_e-re)*Kt,qe=oe-(oe-ce)*Kt}else{let Kt;Le>ue?Kt=1:se===ue?Kt=0:Kt=(se-Le)/(se-ue),je=Ee-(Ee-Fe)*Kt,Se=ie-(ie-fe)*Kt,Xe=re-(re-pe)*Kt,qe=ce-(ce-ve)*Kt}let Ve;Le<xe?Ve=0:Le>ue?Ve=1:Ve=(xe-Le)/(xe-ue),Je=me-(me-Fe)*Ve,We=ae-(ae-fe)*Ve,Ue=_e-(_e-pe)*Ve,Ce=oe-(oe-ve)*Ve;const Ge=Math.round(Math.min(je,Je)),ut=Math.round(Math.max(je,Je));let Jt=Y*Le+Ge*4;for(let Kt=Ge;Kt<=ut;Kt++)Ve=(je-Kt)/(je-Je),Ve<0?Ve=0:Ve>1&&(Ve=1),R[Jt++]=Se-(Se-We)*Ve|0,R[Jt++]=Xe-(Xe-Ue)*Ve|0,R[Jt++]=qe-(qe-Ce)*Ve|0,R[Jt++]=255}}function h(A,H,te){const ne=H.coords,j=H.colors;let ee,x;switch(H.type){case"lattice":const M=H.verticesPerRow,T=Math.floor(ne.length/M)-1,O=M-1;for(ee=0;ee<T;ee++){let R=ee*M;for(let Y=0;Y<O;Y++,R++)u(A,te,ne[R],ne[R+1],ne[R+M],j[R],j[R+1],j[R+M]),u(A,te,ne[R+M+1],ne[R+1],ne[R+M],j[R+M+1],j[R+1],j[R+M])}break;case"triangles":for(ee=0,x=ne.length;ee<x;ee+=3)u(A,te,ne[ee],ne[ee+1],ne[ee+2],j[ee],j[ee+1],j[ee+2]);break;default:throw new Error("illegal figure")}}class f extends o{constructor(H){super(),this._coords=H[2],this._colors=H[3],this._figures=H[4],this._bounds=H[5],this._bbox=H[7],this._background=H[8],this.matrix=null}_createMeshCanvas(H,te,ne){const M=Math.floor(this._bounds[0]),T=Math.floor(this._bounds[1]),O=Math.ceil(this._bounds[2])-M,R=Math.ceil(this._bounds[3])-T,Y=Math.min(Math.ceil(Math.abs(O*H[0]*1.1)),3e3),q=Math.min(Math.ceil(Math.abs(R*H[1]*1.1)),3e3),me=O/Y,xe=R/q,Ee={coords:this._coords,colors:this._colors,offsetX:-M,offsetY:-T,scaleX:1/me,scaleY:1/xe},se=Y+2*2,Fe=q+2*2,ue=ne.getCanvas("mesh",se,Fe,!1),ae=ue.context,_e=ae.createImageData(Y,q);if(te){const ie=_e.data;for(let re=0,ce=ie.length;re<ce;re+=4)ie[re]=te[0],ie[re+1]=te[1],ie[re+2]=te[2],ie[re+3]=255}for(const ie of this._figures)h(_e,ie,Ee);return ae.putImageData(_e,2,2),{canvas:ue.canvas,offsetX:M-2*me,offsetY:T-2*xe,scaleX:me,scaleY:xe}}getPattern(H,te,ne,j){a(H,this._bbox);let ee;if(j===s.SHADING)ee=n.Util.singularValueDecompose2dScale((0,i.getCurrentTransform)(H));else if(ee=n.Util.singularValueDecompose2dScale(te.baseTransform),this.matrix){const M=n.Util.singularValueDecompose2dScale(this.matrix);ee=[ee[0]*M[0],ee[1]*M[1]]}const x=this._createMeshCanvas(ee,j===s.SHADING?null:this._background,te.cachedCanvases);return j!==s.SHADING&&(H.setTransform(...te.baseTransform),this.matrix&&H.transform(...this.matrix)),H.translate(x.offsetX,x.offsetY),H.scale(x.scaleX,x.scaleY),H.createPattern(x.canvas,"no-repeat")}}class m extends o{getPattern(){return"hotpink"}}function E(A){switch(A[0]){case"RadialAxial":return new c(A);case"Mesh":return new f(A);case"Dummy":return new m}throw new Error(`Unknown IR type: ${A[0]}`)}const g={COLORED:1,UNCOLORED:2},_=class _{constructor(H,te,ne,j,ee){this.operatorList=H[2],this.matrix=H[3]||[1,0,0,1,0,0],this.bbox=H[4],this.xstep=H[5],this.ystep=H[6],this.paintType=H[7],this.tilingType=H[8],this.color=te,this.ctx=ne,this.canvasGraphicsFactory=j,this.baseTransform=ee}createPatternCanvas(H){const te=this.operatorList,ne=this.bbox,j=this.xstep,ee=this.ystep,x=this.paintType,M=this.tilingType,T=this.color,O=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+M);const R=ne[0],Y=ne[1],q=ne[2],me=ne[3],xe=n.Util.singularValueDecompose2dScale(this.matrix),Ee=n.Util.singularValueDecompose2dScale(this.baseTransform),se=[xe[0]*Ee[0],xe[1]*Ee[1]],Fe=this.getSizeAndScale(j,this.ctx.canvas.width,se[0]),ue=this.getSizeAndScale(ee,this.ctx.canvas.height,se[1]),ae=H.cachedCanvases.getCanvas("pattern",Fe.size,ue.size,!0),_e=ae.context,oe=O.createCanvasGraphics(_e);oe.groupLevel=H.groupLevel,this.setFillAndStrokeStyleToContext(oe,x,T);let ie=R,re=Y,ce=q,fe=me;return R<0&&(ie=0,ce+=Math.abs(R)),Y<0&&(re=0,fe+=Math.abs(Y)),_e.translate(-(Fe.scale*ie),-(ue.scale*re)),oe.transform(Fe.scale,0,0,ue.scale,0,0),_e.save(),this.clipBbox(oe,ie,re,ce,fe),oe.baseTransform=(0,i.getCurrentTransform)(oe.ctx),oe.executeOperatorList(te),oe.endDrawing(),{canvas:ae.canvas,scaleX:Fe.scale,scaleY:ue.scale,offsetX:ie,offsetY:re}}getSizeAndScale(H,te,ne){H=Math.abs(H);const j=Math.max(_.MAX_PATTERN_SIZE,te);let ee=Math.ceil(H*ne);return ee>=j?ee=j:ne=ee/H,{scale:ne,size:ee}}clipBbox(H,te,ne,j,ee){const x=j-te,M=ee-ne;H.ctx.rect(te,ne,x,M),H.current.updateRectMinMax((0,i.getCurrentTransform)(H.ctx),[te,ne,j,ee]),H.clip(),H.endPath()}setFillAndStrokeStyleToContext(H,te,ne){const j=H.ctx,ee=H.current;switch(te){case g.COLORED:const x=this.ctx;j.fillStyle=x.fillStyle,j.strokeStyle=x.strokeStyle,ee.fillColor=x.fillStyle,ee.strokeColor=x.strokeStyle;break;case g.UNCOLORED:const M=n.Util.makeHexColor(ne[0],ne[1],ne[2]);j.fillStyle=M,j.strokeStyle=M,ee.fillColor=M,ee.strokeColor=M;break;default:throw new n.FormatError(`Unsupported paint type: ${te}`)}}getPattern(H,te,ne,j){let ee=ne;j!==s.SHADING&&(ee=n.Util.transform(ee,te.baseTransform),this.matrix&&(ee=n.Util.transform(ee,this.matrix)));const x=this.createPatternCanvas(te);let M=new DOMMatrix(ee);M=M.translate(x.offsetX,x.offsetY),M=M.scale(1/x.scaleX,1/x.scaleY);const T=H.createPattern(x.canvas,"repeat");return T.setTransform(M),T}};Hr(_,"MAX_PATTERN_SIZE",3e3);let p=_;e.TilingPattern=p},(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.convertBlackAndWhiteToRGBA=s,e.convertToRGBA=i,e.grayToRGBA=o,r(93),r(101),r(102),r(105),r(107),r(109),r(113),r(116),r(123);var n=r(1);function i(c){switch(c.kind){case n.ImageKind.GRAYSCALE_1BPP:return s(c);case n.ImageKind.RGB_24BPP:return a(c)}return null}function s(c){let{src:u,srcPos:h=0,dest:f,width:m,height:E,nonBlackColor:g=4294967295,inverseDecode:p=!1}=c;const _=n.FeatureTest.isLittleEndian?4278190080:255,[A,H]=p?[g,_]:[_,g],te=m>>3,ne=m&7,j=u.length;f=new Uint32Array(f.buffer);let ee=0;for(let x=0;x<E;x++){for(const T=h+te;h<T;h++){const O=h<j?u[h]:255;f[ee++]=O&128?H:A,f[ee++]=O&64?H:A,f[ee++]=O&32?H:A,f[ee++]=O&16?H:A,f[ee++]=O&8?H:A,f[ee++]=O&4?H:A,f[ee++]=O&2?H:A,f[ee++]=O&1?H:A}if(ne===0)continue;const M=h<j?u[h++]:255;for(let T=0;T<ne;T++)f[ee++]=M&1<<7-T?H:A}return{srcPos:h,destPos:ee}}function a(c){let{src:u,srcPos:h=0,dest:f,destPos:m=0,width:E,height:g}=c,p=0;const _=u.length>>2,A=new Uint32Array(u.buffer,h,_);if(n.FeatureTest.isLittleEndian){for(;p<_-2;p+=3,m+=4){const H=A[p],te=A[p+1],ne=A[p+2];f[m]=H|4278190080,f[m+1]=H>>>24|te<<8|4278190080,f[m+2]=te>>>16|ne<<16|4278190080,f[m+3]=ne>>>8|4278190080}for(let H=p*4,te=u.length;H<te;H+=3)f[m++]=u[H]|u[H+1]<<8|u[H+2]<<16|4278190080}else{for(;p<_-2;p+=3,m+=4){const H=A[p],te=A[p+1],ne=A[p+2];f[m]=H|255,f[m+1]=H<<24|te>>>8|255,f[m+2]=te<<16|ne>>>16|255,f[m+3]=ne<<8|255}for(let H=p*4,te=u.length;H<te;H+=3)f[m++]=u[H]<<24|u[H+1]<<16|u[H+2]<<8|255}return{srcPos:h,destPos:m}}function o(c,u){if(n.FeatureTest.isLittleEndian)for(let h=0,f=c.length;h<f;h++)u[h]=c[h]*65793|4278190080;else for(let h=0,f=c.length;h<f;h++)u[h]=c[h]*16843008|255}},(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const r=Object.create(null);e.GlobalWorkerOptions=r,r.workerPort=null,r.workerSrc=""},(t,e,r)=>{var c,go,vo,As;Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0,r(2);var n=r(1);const i={DATA:1,ERROR:2},s={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function a(m){switch(m instanceof Error||typeof m=="object"&&m!==null||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),m.name){case"AbortException":return new n.AbortException(m.message);case"MissingPDFException":return new n.MissingPDFException(m.message);case"PasswordException":return new n.PasswordException(m.message,m.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(m.message,m.status);case"UnknownErrorException":return new n.UnknownErrorException(m.message,m.details);default:return new n.UnknownErrorException(m.message,m.toString())}}class o{constructor(E,g,p){ct(this,c);this.sourceName=E,this.targetName=g,this.comObj=p,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=_=>{const A=_.data;if(A.targetName!==this.sourceName)return;if(A.stream){Qe(this,c,vo).call(this,A);return}if(A.callback){const te=A.callbackId,ne=this.callbackCapabilities[te];if(!ne)throw new Error(`Cannot resolve callback ${te}`);if(delete this.callbackCapabilities[te],A.callback===i.DATA)ne.resolve(A.data);else if(A.callback===i.ERROR)ne.reject(a(A.reason));else throw new Error("Unexpected callback case");return}const H=this.actionHandler[A.action];if(!H)throw new Error(`Unknown action from worker: ${A.action}`);if(A.callbackId){const te=this.sourceName,ne=A.sourceName;new Promise(function(j){j(H(A.data))}).then(function(j){p.postMessage({sourceName:te,targetName:ne,callback:i.DATA,callbackId:A.callbackId,data:j})},function(j){p.postMessage({sourceName:te,targetName:ne,callback:i.ERROR,callbackId:A.callbackId,reason:a(j)})});return}if(A.streamId){Qe(this,c,go).call(this,A);return}H(A.data)},p.addEventListener("message",this._onComObjOnMessage)}on(E,g){const p=this.actionHandler;if(p[E])throw new Error(`There is already an actionName called "${E}"`);p[E]=g}send(E,g,p){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:E,data:g},p)}sendWithPromise(E,g,p){const _=this.callbackId++,A=new n.PromiseCapability;this.callbackCapabilities[_]=A;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:E,callbackId:_,data:g},p)}catch(H){A.reject(H)}return A.promise}sendWithStream(E,g,p,_){const A=this.streamId++,H=this.sourceName,te=this.targetName,ne=this.comObj;return new ReadableStream({start:j=>{const ee=new n.PromiseCapability;return this.streamControllers[A]={controller:j,startCall:ee,pullCall:null,cancelCall:null,isClosed:!1},ne.postMessage({sourceName:H,targetName:te,action:E,streamId:A,data:g,desiredSize:j.desiredSize},_),ee.promise},pull:j=>{const ee=new n.PromiseCapability;return this.streamControllers[A].pullCall=ee,ne.postMessage({sourceName:H,targetName:te,stream:s.PULL,streamId:A,desiredSize:j.desiredSize}),ee.promise},cancel:j=>{(0,n.assert)(j instanceof Error,"cancel must have a valid reason");const ee=new n.PromiseCapability;return this.streamControllers[A].cancelCall=ee,this.streamControllers[A].isClosed=!0,ne.postMessage({sourceName:H,targetName:te,stream:s.CANCEL,streamId:A,reason:a(j)}),ee.promise}},p)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}c=new WeakSet,go=function(E){const g=E.streamId,p=this.sourceName,_=E.sourceName,A=this.comObj,H=this,te=this.actionHandler[E.action],ne={enqueue(j){let ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,x=arguments.length>2?arguments[2]:void 0;if(this.isCancelled)return;const M=this.desiredSize;this.desiredSize-=ee,M>0&&this.desiredSize<=0&&(this.sinkCapability=new n.PromiseCapability,this.ready=this.sinkCapability.promise),A.postMessage({sourceName:p,targetName:_,stream:s.ENQUEUE,streamId:g,chunk:j},x)},close(){this.isCancelled||(this.isCancelled=!0,A.postMessage({sourceName:p,targetName:_,stream:s.CLOSE,streamId:g}),delete H.streamSinks[g])},error(j){(0,n.assert)(j instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,A.postMessage({sourceName:p,targetName:_,stream:s.ERROR,streamId:g,reason:a(j)}))},sinkCapability:new n.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:E.desiredSize,ready:null};ne.sinkCapability.resolve(),ne.ready=ne.sinkCapability.promise,this.streamSinks[g]=ne,new Promise(function(j){j(te(E.data,ne))}).then(function(){A.postMessage({sourceName:p,targetName:_,stream:s.START_COMPLETE,streamId:g,success:!0})},function(j){A.postMessage({sourceName:p,targetName:_,stream:s.START_COMPLETE,streamId:g,reason:a(j)})})},vo=function(E){const g=E.streamId,p=this.sourceName,_=E.sourceName,A=this.comObj,H=this.streamControllers[g],te=this.streamSinks[g];switch(E.stream){case s.START_COMPLETE:E.success?H.startCall.resolve():H.startCall.reject(a(E.reason));break;case s.PULL_COMPLETE:E.success?H.pullCall.resolve():H.pullCall.reject(a(E.reason));break;case s.PULL:if(!te){A.postMessage({sourceName:p,targetName:_,stream:s.PULL_COMPLETE,streamId:g,success:!0});break}te.desiredSize<=0&&E.desiredSize>0&&te.sinkCapability.resolve(),te.desiredSize=E.desiredSize,new Promise(function(ne){var j;ne((j=te.onPull)==null?void 0:j.call(te))}).then(function(){A.postMessage({sourceName:p,targetName:_,stream:s.PULL_COMPLETE,streamId:g,success:!0})},function(ne){A.postMessage({sourceName:p,targetName:_,stream:s.PULL_COMPLETE,streamId:g,reason:a(ne)})});break;case s.ENQUEUE:if((0,n.assert)(H,"enqueue should have stream controller"),H.isClosed)break;H.controller.enqueue(E.chunk);break;case s.CLOSE:if((0,n.assert)(H,"close should have stream controller"),H.isClosed)break;H.isClosed=!0,H.controller.close(),Qe(this,c,As).call(this,H,g);break;case s.ERROR:(0,n.assert)(H,"error should have stream controller"),H.controller.error(a(E.reason)),Qe(this,c,As).call(this,H,g);break;case s.CANCEL_COMPLETE:E.success?H.cancelCall.resolve():H.cancelCall.reject(a(E.reason)),Qe(this,c,As).call(this,H,g);break;case s.CANCEL:if(!te)break;new Promise(function(ne){var j;ne((j=te.onCancel)==null?void 0:j.call(te,a(E.reason)))}).then(function(){A.postMessage({sourceName:p,targetName:_,stream:s.CANCEL_COMPLETE,streamId:g,success:!0})},function(ne){A.postMessage({sourceName:p,targetName:_,stream:s.CANCEL_COMPLETE,streamId:g,reason:a(ne)})}),te.sinkCapability.reject(a(E.reason)),te.isCancelled=!0,delete this.streamSinks[g];break;default:throw new Error("Unexpected stream case")}},As=function(E,g){return Ye(this,null,function*(){var p,_,A;yield Promise.allSettled([(p=E.startCall)==null?void 0:p.promise,(_=E.pullCall)==null?void 0:_.promise,(A=E.cancelCall)==null?void 0:A.promise]),delete this.streamControllers[g]})},e.MessageHandler=o},(t,e,r)=>{var s,a;Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var n=r(1);class i{constructor(c){ct(this,s);ct(this,a);let{parsedData:u,rawData:h}=c;ft(this,s,u),ft(this,a,h)}getRaw(){return de(this,a)}get(c){var u;return(u=de(this,s).get(c))!=null?u:null}getAll(){return(0,n.objectFromMap)(de(this,s))}has(c){return de(this,s).has(c)}}s=new WeakMap,a=new WeakMap,e.Metadata=i},(t,e,r)=>{var c,u,h,f,m,E,ua;Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var n=r(1),i=r(170);const s=Symbol("INTERNAL");class a{constructor(_,A){ct(this,c,!0);this.name=_,this.intent=A}get visible(){return de(this,c)}_setVisible(_,A){_!==s&&(0,n.unreachable)("Internal method `_setVisible` called."),ft(this,c,A)}}c=new WeakMap;class o{constructor(_){ct(this,E);ct(this,u,null);ct(this,h,new Map);ct(this,f,null);ct(this,m,null);if(this.name=null,this.creator=null,_!==null){this.name=_.name,this.creator=_.creator,ft(this,m,_.order);for(const A of _.groups)de(this,h).set(A.id,new a(A.name,A.intent));if(_.baseState==="OFF")for(const A of de(this,h).values())A._setVisible(s,!1);for(const A of _.on)de(this,h).get(A)._setVisible(s,!0);for(const A of _.off)de(this,h).get(A)._setVisible(s,!1);ft(this,f,this.getHash())}}isVisible(_){if(de(this,h).size===0)return!0;if(!_)return(0,n.warn)("Optional content group not defined."),!0;if(_.type==="OCG")return de(this,h).has(_.id)?de(this,h).get(_.id).visible:((0,n.warn)(`Optional content group not found: ${_.id}`),!0);if(_.type==="OCMD"){if(_.expression)return Qe(this,E,ua).call(this,_.expression);if(!_.policy||_.policy==="AnyOn"){for(const A of _.ids){if(!de(this,h).has(A))return(0,n.warn)(`Optional content group not found: ${A}`),!0;if(de(this,h).get(A).visible)return!0}return!1}else if(_.policy==="AllOn"){for(const A of _.ids){if(!de(this,h).has(A))return(0,n.warn)(`Optional content group not found: ${A}`),!0;if(!de(this,h).get(A).visible)return!1}return!0}else if(_.policy==="AnyOff"){for(const A of _.ids){if(!de(this,h).has(A))return(0,n.warn)(`Optional content group not found: ${A}`),!0;if(!de(this,h).get(A).visible)return!0}return!1}else if(_.policy==="AllOff"){for(const A of _.ids){if(!de(this,h).has(A))return(0,n.warn)(`Optional content group not found: ${A}`),!0;if(de(this,h).get(A).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${_.policy}.`),!0}return(0,n.warn)(`Unknown group type ${_.type}.`),!0}setVisibility(_){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!de(this,h).has(_)){(0,n.warn)(`Optional content group not found: ${_}`);return}de(this,h).get(_)._setVisible(s,!!A),ft(this,u,null)}get hasInitialVisibility(){return de(this,f)===null||this.getHash()===de(this,f)}getOrder(){return de(this,h).size?de(this,m)?de(this,m).slice():[...de(this,h).keys()]:null}getGroups(){return de(this,h).size>0?(0,n.objectFromMap)(de(this,h)):null}getGroup(_){return de(this,h).get(_)||null}getHash(){if(de(this,u)!==null)return de(this,u);const _=new i.MurmurHash3_64;for(const[A,H]of de(this,h))_.update(`${A}:${H.visible}`);return ft(this,u,_.hexdigest())}}u=new WeakMap,h=new WeakMap,f=new WeakMap,m=new WeakMap,E=new WeakSet,ua=function(_){const A=_.length;if(A<2)return!0;const H=_[0];for(let te=1;te<A;te++){const ne=_[te];let j;if(Array.isArray(ne))j=Qe(this,E,ua).call(this,ne);else if(de(this,h).has(ne))j=de(this,h).get(ne).visible;else return(0,n.warn)(`Optional content group not found: ${ne}`),!0;switch(H){case"And":if(!j)return!1;break;case"Or":if(j)return!0;break;case"Not":return!j;default:return!0}}return H==="And"},e.OptionalContentConfig=o},(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0,r(93),r(101),r(102),r(105),r(107),r(109),r(113),r(116),r(123),r(89);var n=r(1),i=r(168);class s{constructor(u,h){let{length:f,initialData:m,progressiveDone:E=!1,contentDispositionFilename:g=null,disableRange:p=!1,disableStream:_=!1}=u;if((0,n.assert)(h,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=E,this._contentDispositionFilename=g,(m==null?void 0:m.length)>0){const A=m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength?m.buffer:new Uint8Array(m).buffer;this._queuedChunks.push(A)}this._pdfDataRangeTransport=h,this._isStreamingSupported=!_,this._isRangeSupported=!p,this._contentLength=f,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((A,H)=>{this._onReceiveData({begin:A,chunk:H})}),this._pdfDataRangeTransport.addProgressListener((A,H)=>{this._onProgress({loaded:A,total:H})}),this._pdfDataRangeTransport.addProgressiveReadListener(A=>{this._onReceiveData({chunk:A})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(u){let{begin:h,chunk:f}=u;const m=f instanceof Uint8Array&&f.byteLength===f.buffer.byteLength?f.buffer:new Uint8Array(f).buffer;if(h===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(m):this._queuedChunks.push(m);else{const E=this._rangeReaders.some(function(g){return g._begin!==h?!1:(g._enqueue(m),!0)});(0,n.assert)(E,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var u,h;return(h=(u=this._fullRequestReader)==null?void 0:u._loaded)!=null?h:0}_onProgress(u){var h,f,m,E;u.total===void 0?(f=(h=this._rangeReaders[0])==null?void 0:h.onProgress)==null||f.call(h,{loaded:u.loaded}):(E=(m=this._fullRequestReader)==null?void 0:m.onProgress)==null||E.call(m,{loaded:u.loaded,total:u.total})}_onProgressiveDone(){var u;(u=this._fullRequestReader)==null||u.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(u){const h=this._rangeReaders.indexOf(u);h>=0&&this._rangeReaders.splice(h,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const u=this._queuedChunks;return this._queuedChunks=null,new a(this,u,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(u,h){if(h<=this._progressiveDataLength)return null;const f=new o(this,u,h);return this._pdfDataRangeTransport.requestDataRange(u,h),this._rangeReaders.push(f),f}cancelAllRequests(u){var h;(h=this._fullRequestReader)==null||h.cancel(u);for(const f of this._rangeReaders.slice(0))f.cancel(u);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=s;class a{constructor(u,h){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;this._stream=u,this._done=f||!1,this._filename=(0,i.isPdfFile)(m)?m:null,this._queuedChunks=h||[],this._loaded=0;for(const E of this._queuedChunks)this._loaded+=E.byteLength;this._requests=[],this._headersReady=Promise.resolve(),u._fullRequestReader=this,this.onProgress=null}_enqueue(u){this._done||(this._requests.length>0?this._requests.shift().resolve({value:u,done:!1}):this._queuedChunks.push(u),this._loaded+=u.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}read(){return Ye(this,null,function*(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const u=new n.PromiseCapability;return this._requests.push(u),u.promise})}cancel(u){this._done=!0;for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class o{constructor(u,h,f){this._stream=u,this._begin=h,this._end=f,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(u){if(!this._done){if(this._requests.length===0)this._queuedChunk=u;else{this._requests.shift().resolve({value:u,done:!1});for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}read(){return Ye(this,null,function*(){if(this._queuedChunk){const h=this._queuedChunk;return this._queuedChunk=null,{value:h,done:!1}}if(this._done)return{value:void 0,done:!0};const u=new n.PromiseCapability;return this._requests.push(u),u.promise})}cancel(u){this._done=!0;for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0,r(93),r(101),r(102),r(105),r(107),r(109),r(113),r(116),r(123),r(89);var n=r(1),i=r(182);function s(f,m,E){return{method:"GET",headers:f,signal:E.signal,mode:"cors",credentials:m?"include":"same-origin",redirect:"follow"}}function a(f){const m=new Headers;for(const E in f){const g=f[E];g!==void 0&&m.append(E,g)}return m}function o(f){return f instanceof Uint8Array?f.buffer:f instanceof ArrayBuffer?f:((0,n.warn)(`getArrayBuffer - unexpected data format: ${f}`),new Uint8Array(f).buffer)}class c{constructor(m){this.source=m,this.isHttp=/^https?:/i.test(m.url),this.httpHeaders=this.isHttp&&m.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var m,E;return(E=(m=this._fullRequestReader)==null?void 0:m._loaded)!=null?E:0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new u(this),this._fullRequestReader}getRangeReader(m,E){if(E<=this._progressiveDataLength)return null;const g=new h(this,m,E);return this._rangeRequestReaders.push(g),g}cancelAllRequests(m){var E;(E=this._fullRequestReader)==null||E.cancel(m);for(const g of this._rangeRequestReaders.slice(0))g.cancel(m)}}e.PDFFetchStream=c;class u{constructor(m){this._stream=m,this._reader=null,this._loaded=0,this._filename=null;const E=m.source;this._withCredentials=E.withCredentials||!1,this._contentLength=E.length,this._headersCapability=new n.PromiseCapability,this._disableRange=E.disableRange||!1,this._rangeChunkSize=E.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!E.disableStream,this._isRangeSupported=!E.disableRange,this._headers=a(this._stream.httpHeaders);const g=E.url;fetch(g,s(this._headers,this._withCredentials,this._abortController)).then(p=>{if(!(0,i.validateResponseStatus)(p.status))throw(0,i.createResponseStatusError)(p.status,g);this._reader=p.body.getReader(),this._headersCapability.resolve();const _=te=>p.headers.get(te),{allowRangeRequests:A,suggestedLength:H}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:_,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=A,this._contentLength=H||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(_),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){return Ye(this,null,function*(){var g;yield this._headersCapability.promise;const{value:m,done:E}=yield this._reader.read();return E?{value:m,done:E}:(this._loaded+=m.byteLength,(g=this.onProgress)==null||g.call(this,{loaded:this._loaded,total:this._contentLength}),{value:o(m),done:!1})})}cancel(m){var E;(E=this._reader)==null||E.cancel(m),this._abortController.abort()}}class h{constructor(m,E,g){this._stream=m,this._reader=null,this._loaded=0;const p=m.source;this._withCredentials=p.withCredentials||!1,this._readCapability=new n.PromiseCapability,this._isStreamingSupported=!p.disableStream,this._abortController=new AbortController,this._headers=a(this._stream.httpHeaders),this._headers.append("Range",`bytes=${E}-${g-1}`);const _=p.url;fetch(_,s(this._headers,this._withCredentials,this._abortController)).then(A=>{if(!(0,i.validateResponseStatus)(A.status))throw(0,i.createResponseStatusError)(A.status,_);this._readCapability.resolve(),this._reader=A.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}read(){return Ye(this,null,function*(){var g;yield this._readCapability.promise;const{value:m,done:E}=yield this._reader.read();return E?{value:m,done:E}:(this._loaded+=m.byteLength,(g=this.onProgress)==null||g.call(this,{loaded:this._loaded}),{value:o(m),done:!1})})}cancel(m){var E;(E=this._reader)==null||E.cancel(m),this._abortController.abort()}}},(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=c,e.extractFilenameFromHeader=o,e.validateRangeRequestCapabilities=a,e.validateResponseStatus=u;var n=r(1),i=r(183),s=r(168);function a(h){let{getResponseHeader:f,isHttp:m,rangeChunkSize:E,disableRange:g}=h;const p={allowRangeRequests:!1,suggestedLength:void 0},_=parseInt(f("Content-Length"),10);return!Number.isInteger(_)||(p.suggestedLength=_,_<=2*E)||g||!m||f("Accept-Ranges")!=="bytes"||(f("Content-Encoding")||"identity")!=="identity"||(p.allowRangeRequests=!0),p}function o(h){const f=h("Content-Disposition");if(f){let m=(0,i.getFilenameFromContentDispositionHeader)(f);if(m.includes("%"))try{m=decodeURIComponent(m)}catch(E){}if((0,s.isPdfFile)(m))return m}return null}function c(h,f){return h===404||h===0&&f.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+f+'".'):new n.UnexpectedResponseException(`Unexpected server response (${h}) while retrieving PDF "${f}".`,h)}function u(h){return h===200||h===206}},(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=i,r(89),r(149);var n=r(1);function i(s){let a=!0,o=c("filename\\*","i").exec(s);if(o){o=o[1];let p=m(o);return p=unescape(p),p=E(p),p=g(p),h(p)}if(o=f(s),o){const p=g(o);return h(p)}if(o=c("filename","i").exec(s),o){o=o[1];let p=m(o);return p=g(p),h(p)}function c(p,_){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',_)}function u(p,_){if(p){if(!/^[\x00-\xFF]+$/.test(_))return _;try{const A=new TextDecoder(p,{fatal:!0}),H=(0,n.stringToBytes)(_);_=A.decode(H),a=!1}catch(A){}}return _}function h(p){return a&&/[\x80-\xff]/.test(p)&&(p=u("utf-8",p),a&&(p=u("iso-8859-1",p))),p}function f(p){const _=[];let A;const H=c("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(A=H.exec(p))!==null;){let[,ne,j,ee]=A;if(ne=parseInt(ne,10),ne in _){if(ne===0)break;continue}_[ne]=[j,ee]}const te=[];for(let ne=0;ne<_.length&&ne in _;++ne){let[j,ee]=_[ne];ee=m(ee),j&&(ee=unescape(ee),ne===0&&(ee=E(ee))),te.push(ee)}return te.join("")}function m(p){if(p.startsWith('"')){const _=p.slice(1).split('\\"');for(let A=0;A<_.length;++A){const H=_[A].indexOf('"');H!==-1&&(_[A]=_[A].slice(0,H),_.length=A+1),_[A]=_[A].replaceAll(/\\(.)/g,"$1")}p=_.join('"')}return p}function E(p){const _=p.indexOf("'");if(_===-1)return p;const A=p.slice(0,_),te=p.slice(_+1).replace(/^[^']*'/,"");return u(A,te)}function g(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(_,A,H,te){if(H==="q"||H==="Q")return te=te.replaceAll("_"," "),te=te.replaceAll(/=([0-9a-fA-F]{2})/g,function(ne,j){return String.fromCharCode(parseInt(j,16))}),u(A,te);try{te=atob(te)}catch(ne){}return u(A,te)})}return""}},(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0,r(89);var n=r(1),i=r(182);const s=200,a=206;function o(m){const E=m.response;return typeof E!="string"?E:(0,n.stringToBytes)(E).buffer}class c{constructor(E){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.url=E,this.isHttp=/^https?:/i.test(E),this.httpHeaders=this.isHttp&&g.httpHeaders||Object.create(null),this.withCredentials=g.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(E,g,p){const _={begin:E,end:g};for(const A in p)_[A]=p[A];return this.request(_)}requestFull(E){return this.request(E)}request(E){const g=new XMLHttpRequest,p=this.currXhrId++,_=this.pendingRequests[p]={xhr:g};g.open("GET",this.url),g.withCredentials=this.withCredentials;for(const A in this.httpHeaders){const H=this.httpHeaders[A];H!==void 0&&g.setRequestHeader(A,H)}return this.isHttp&&"begin"in E&&"end"in E?(g.setRequestHeader("Range",`bytes=${E.begin}-${E.end-1}`),_.expectedStatus=a):_.expectedStatus=s,g.responseType="arraybuffer",E.onError&&(g.onerror=function(A){E.onError(g.status)}),g.onreadystatechange=this.onStateChange.bind(this,p),g.onprogress=this.onProgress.bind(this,p),_.onHeadersReceived=E.onHeadersReceived,_.onDone=E.onDone,_.onError=E.onError,_.onProgress=E.onProgress,g.send(null),p}onProgress(E,g){var _;const p=this.pendingRequests[E];p&&((_=p.onProgress)==null||_.call(p,g))}onStateChange(E,g){var ne,j,ee;const p=this.pendingRequests[E];if(!p)return;const _=p.xhr;if(_.readyState>=2&&p.onHeadersReceived&&(p.onHeadersReceived(),delete p.onHeadersReceived),_.readyState!==4||!(E in this.pendingRequests))return;if(delete this.pendingRequests[E],_.status===0&&this.isHttp){(ne=p.onError)==null||ne.call(p,_.status);return}const A=_.status||s;if(!(A===s&&p.expectedStatus===a)&&A!==p.expectedStatus){(j=p.onError)==null||j.call(p,_.status);return}const te=o(_);if(A===a){const x=_.getResponseHeader("Content-Range"),M=/bytes (\d+)-(\d+)\/(\d+)/.exec(x);p.onDone({begin:parseInt(M[1],10),chunk:te})}else te?p.onDone({begin:0,chunk:te}):(ee=p.onError)==null||ee.call(p,_.status)}getRequestXhr(E){return this.pendingRequests[E].xhr}isPendingRequest(E){return E in this.pendingRequests}abortRequest(E){const g=this.pendingRequests[E].xhr;delete this.pendingRequests[E],g.abort()}}class u{constructor(E){this._source=E,this._manager=new c(E.url,{httpHeaders:E.httpHeaders,withCredentials:E.withCredentials}),this._rangeChunkSize=E.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(E){const g=this._rangeRequestReaders.indexOf(E);g>=0&&this._rangeRequestReaders.splice(g,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new h(this._manager,this._source),this._fullRequestReader}getRangeReader(E,g){const p=new f(this._manager,E,g);return p.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(p),p}cancelAllRequests(E){var g;(g=this._fullRequestReader)==null||g.cancel(E);for(const p of this._rangeRequestReaders.slice(0))p.cancel(E)}}e.PDFNetworkStream=u;class h{constructor(E,g){this._manager=E;const p={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=g.url,this._fullRequestId=E.requestFull(p),this._headersReceivedCapability=new n.PromiseCapability,this._disableRange=g.disableRange||!1,this._contentLength=g.length,this._rangeChunkSize=g.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const E=this._fullRequestId,g=this._manager.getRequestXhr(E),p=H=>g.getResponseHeader(H),{allowRangeRequests:_,suggestedLength:A}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:p,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});_&&(this._isRangeSupported=!0),this._contentLength=A||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(p),this._isRangeSupported&&this._manager.abortRequest(E),this._headersReceivedCapability.resolve()}_onDone(E){if(E&&(this._requests.length>0?this._requests.shift().resolve({value:E.chunk,done:!1}):this._cachedChunks.push(E.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(E){this._storedError=(0,i.createResponseStatusError)(E,this._url),this._headersReceivedCapability.reject(this._storedError);for(const g of this._requests)g.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(E){var g;(g=this.onProgress)==null||g.call(this,{loaded:E.loaded,total:E.lengthComputable?E.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}read(){return Ye(this,null,function*(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const E=new n.PromiseCapability;return this._requests.push(E),E.promise})}cancel(E){this._done=!0,this._headersReceivedCapability.reject(E);for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class f{constructor(E,g,p){this._manager=E;const _={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=E.url,this._requestId=E.requestRange(g,p,_),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var E;(E=this.onClosed)==null||E.call(this,this)}_onDone(E){const g=E.chunk;this._requests.length>0?this._requests.shift().resolve({value:g,done:!1}):this._queuedChunk=g,this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(E){this._storedError=(0,i.createResponseStatusError)(E,this._url);for(const g of this._requests)g.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(E){var g;this.isStreamingSupported||(g=this.onProgress)==null||g.call(this,{loaded:E.loaded})}get isStreamingSupported(){return!1}read(){return Ye(this,null,function*(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const g=this._queuedChunk;return this._queuedChunk=null,{value:g,done:!1}}if(this._done)return{value:void 0,done:!0};const E=new n.PromiseCapability;return this._requests.push(E),E.promise})}cancel(E){this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0,r(89),r(93),r(101),r(102),r(105),r(107),r(109),r(113),r(116),r(123);var n=r(1),i=r(182);const s=/^file:\/\/\/[a-zA-Z]:\//;function a(p){const _=require$$6,A=_.parse(p);return A.protocol==="file:"||A.host?A:/^[a-z]:[/\\]/i.test(p)?_.parse(`file:///${p}`):(A.host||(A.protocol="file:"),A)}class o{constructor(_){this.source=_,this.url=a(_.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&_.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var _,A;return(A=(_=this._fullRequestReader)==null?void 0:_._loaded)!=null?A:0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new E(this):new f(this),this._fullRequestReader}getRangeReader(_,A){if(A<=this._progressiveDataLength)return null;const H=this.isFsUrl?new g(this,_,A):new m(this,_,A);return this._rangeRequestReaders.push(H),H}cancelAllRequests(_){var A;(A=this._fullRequestReader)==null||A.cancel(_);for(const H of this._rangeRequestReaders.slice(0))H.cancel(_)}}e.PDFNodeStream=o;class c{constructor(_){this._url=_.url,this._done=!1,this._storedError=null,this.onProgress=null;const A=_.source;this._contentLength=A.length,this._loaded=0,this._filename=null,this._disableRange=A.disableRange||!1,this._rangeChunkSize=A.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!A.disableStream,this._isRangeSupported=!A.disableRange,this._readableStream=null,this._readCapability=new n.PromiseCapability,this._headersCapability=new n.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){return Ye(this,null,function*(){var H;if(yield this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const _=this._readableStream.read();return _===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=_.length,(H=this.onProgress)==null||H.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(_).buffer,done:!1})})}cancel(_){if(!this._readableStream){this._error(_);return}this._readableStream.destroy(_)}_error(_){this._storedError=_,this._readCapability.resolve()}_setReadableStream(_){this._readableStream=_,_.on("readable",()=>{this._readCapability.resolve()}),_.on("end",()=>{_.destroy(),this._done=!0,this._readCapability.resolve()}),_.on("error",A=>{this._error(A)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class u{constructor(_){this._url=_.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new n.PromiseCapability;const A=_.source;this._isStreamingSupported=!A.disableStream}get isStreamingSupported(){return this._isStreamingSupported}read(){return Ye(this,null,function*(){var H;if(yield this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const _=this._readableStream.read();return _===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=_.length,(H=this.onProgress)==null||H.call(this,{loaded:this._loaded}),{value:new Uint8Array(_).buffer,done:!1})})}cancel(_){if(!this._readableStream){this._error(_);return}this._readableStream.destroy(_)}_error(_){this._storedError=_,this._readCapability.resolve()}_setReadableStream(_){this._readableStream=_,_.on("readable",()=>{this._readCapability.resolve()}),_.on("end",()=>{_.destroy(),this._done=!0,this._readCapability.resolve()}),_.on("error",A=>{this._error(A)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function h(p,_){return{protocol:p.protocol,auth:p.auth,host:p.hostname,port:p.port,path:p.path,method:"GET",headers:_}}class f extends c{constructor(_){super(_);const A=H=>{if(H.statusCode===404){const ee=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=ee,this._headersCapability.reject(ee);return}this._headersCapability.resolve(),this._setReadableStream(H);const te=ee=>this._readableStream.headers[ee.toLowerCase()],{allowRangeRequests:ne,suggestedLength:j}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:te,isHttp:_.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=ne,this._contentLength=j||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(te)};if(this._request=null,this._url.protocol==="http:"){const H=require$$6;this._request=H.request(h(this._url,_.httpHeaders),A)}else{const H=require$$6;this._request=H.request(h(this._url,_.httpHeaders),A)}this._request.on("error",H=>{this._storedError=H,this._headersCapability.reject(H)}),this._request.end()}}class m extends u{constructor(_,A,H){super(_),this._httpHeaders={};for(const ne in _.httpHeaders){const j=_.httpHeaders[ne];j!==void 0&&(this._httpHeaders[ne]=j)}this._httpHeaders.Range=`bytes=${A}-${H-1}`;const te=ne=>{if(ne.statusCode===404){const j=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=j;return}this._setReadableStream(ne)};if(this._request=null,this._url.protocol==="http:"){const ne=require$$6;this._request=ne.request(h(this._url,this._httpHeaders),te)}else{const ne=require$$6;this._request=ne.request(h(this._url,this._httpHeaders),te)}this._request.on("error",ne=>{this._storedError=ne}),this._request.end()}}class E extends c{constructor(_){super(_);let A=decodeURIComponent(this._url.path);s.test(this._url.href)&&(A=A.replace(/^\//,""));const H=require$$6;H.lstat(A,(te,ne)=>{if(te){te.code==="ENOENT"&&(te=new n.MissingPDFException(`Missing PDF "${A}".`)),this._storedError=te,this._headersCapability.reject(te);return}this._contentLength=ne.size,this._setReadableStream(H.createReadStream(A)),this._headersCapability.resolve()})}}class g extends u{constructor(_,A,H){super(_);let te=decodeURIComponent(this._url.path);s.test(this._url.href)&&(te=te.replace(/^\//,""));const ne=require$$6;this._setReadableStream(ne.createReadStream(te,{start:A,end:H-1}))}}},(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0,r(84),r(86),r(87),r(93),r(101),r(102),r(105),r(107),r(109),r(113),r(116),r(123),r(2),r(89),r(187);var n=r(168),i=r(1);const s={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},a="http://www.w3.org/XML/1998/namespace",o="http://www.w3.org/1999/xlink",c=["butt","round","square"],u=["miter","round","bevel"],h=function(ne){let j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(URL.createObjectURL&&typeof Blob!="undefined"&&!ee)return URL.createObjectURL(new Blob([ne],{type:j}));const x="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let M=`data:${j};base64,`;for(let T=0,O=ne.length;T<O;T+=3){const R=ne[T]&255,Y=ne[T+1]&255,q=ne[T+2]&255,me=R>>2,xe=(R&3)<<4|Y>>4,Ee=T+1<O?(Y&15)<<2|q>>6:64,se=T+2<O?q&63:64;M+=x[me]+x[xe]+x[Ee]+x[se]}return M},f=function(){const ne=new Uint8Array([137,80,78,71,13,10,26,10]),j=12,ee=new Int32Array(256);for(let q=0;q<256;q++){let me=q;for(let xe=0;xe<8;xe++)me=me&1?3988292384^me>>1&2147483647:me>>1&2147483647;ee[q]=me}function x(q,me,xe){let Ee=-1;for(let se=me;se<xe;se++){const Fe=(Ee^q[se])&255,ue=ee[Fe];Ee=Ee>>>8^ue}return Ee^-1}function M(q,me,xe,Ee){let se=Ee;const Fe=me.length;xe[se]=Fe>>24&255,xe[se+1]=Fe>>16&255,xe[se+2]=Fe>>8&255,xe[se+3]=Fe&255,se+=4,xe[se]=q.charCodeAt(0)&255,xe[se+1]=q.charCodeAt(1)&255,xe[se+2]=q.charCodeAt(2)&255,xe[se+3]=q.charCodeAt(3)&255,se+=4,xe.set(me,se),se+=me.length;const ue=x(xe,Ee+4,se);xe[se]=ue>>24&255,xe[se+1]=ue>>16&255,xe[se+2]=ue>>8&255,xe[se+3]=ue&255}function T(q,me,xe){let Ee=1,se=0;for(let Fe=me;Fe<xe;++Fe)Ee=(Ee+(q[Fe]&255))%65521,se=(se+Ee)%65521;return se<<16|Ee}function O(q){if(!i.isNodeJS)return R(q);try{const me=parseInt(process.versions.node)>=8?q:Buffer.from(q),xe=require$$6.deflateSync(me,{level:9});return xe instanceof Uint8Array?xe:new Uint8Array(xe)}catch(me){(0,i.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+me)}return R(q)}function R(q){let me=q.length;const xe=65535,Ee=Math.ceil(me/xe),se=new Uint8Array(2+me+Ee*5+4);let Fe=0;se[Fe++]=120,se[Fe++]=156;let ue=0;for(;me>xe;)se[Fe++]=0,se[Fe++]=255,se[Fe++]=255,se[Fe++]=0,se[Fe++]=0,se.set(q.subarray(ue,ue+xe),Fe),Fe+=xe,ue+=xe,me-=xe;se[Fe++]=1,se[Fe++]=me&255,se[Fe++]=me>>8&255,se[Fe++]=~me&65535&255,se[Fe++]=(~me&65535)>>8&255,se.set(q.subarray(ue),Fe),Fe+=q.length-ue;const ae=T(q,0,q.length);return se[Fe++]=ae>>24&255,se[Fe++]=ae>>16&255,se[Fe++]=ae>>8&255,se[Fe++]=ae&255,se}function Y(q,me,xe,Ee){const se=q.width,Fe=q.height;let ue,ae,_e;const oe=q.data;switch(me){case i.ImageKind.GRAYSCALE_1BPP:ae=0,ue=1,_e=se+7>>3;break;case i.ImageKind.RGB_24BPP:ae=2,ue=8,_e=se*3;break;case i.ImageKind.RGBA_32BPP:ae=6,ue=8,_e=se*4;break;default:throw new Error("invalid format")}const ie=new Uint8Array((1+_e)*Fe);let re=0,ce=0;for(let je=0;je<Fe;++je)ie[re++]=0,ie.set(oe.subarray(ce,ce+_e),re),ce+=_e,re+=_e;if(me===i.ImageKind.GRAYSCALE_1BPP&&Ee){re=0;for(let je=0;je<Fe;je++){re++;for(let Se=0;Se<_e;Se++)ie[re++]^=255}}const fe=new Uint8Array([se>>24&255,se>>16&255,se>>8&255,se&255,Fe>>24&255,Fe>>16&255,Fe>>8&255,Fe&255,ue,ae,0,0,0]),pe=O(ie),ve=ne.length+j*3+fe.length+pe.length,Ae=new Uint8Array(ve);let be=0;return Ae.set(ne,be),be+=ne.length,M("IHDR",fe,Ae,be),be+=j+fe.length,M("IDATA",pe,Ae,be),be+=j+pe.length,M("IEND",new Uint8Array(0),Ae,be),h(Ae,"image/png",xe)}return function(me,xe,Ee){const se=me.kind===void 0?i.ImageKind.GRAYSCALE_1BPP:me.kind;return Y(me,se,xe,Ee)}}();class m{constructor(){this.fontSizeScale=1,this.fontWeight=s.fontWeight,this.fontSize=0,this.textMatrix=i.IDENTITY_MATRIX,this.fontMatrix=i.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=i.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=s.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(j,ee){this.x=j,this.y=ee}}function E(ne){let j=[];const ee=[];for(const x of ne){if(x.fn==="save"){j.push({fnId:92,fn:"group",items:[]}),ee.push(j),j=j.at(-1).items;continue}x.fn==="restore"?j=ee.pop():j.push(x)}return j}function g(ne){if(Number.isInteger(ne))return ne.toString();const j=ne.toFixed(10);let ee=j.length-1;if(j[ee]!=="0")return j;do ee--;while(j[ee]==="0");return j.substring(0,j[ee]==="."?ee:ee+1)}function p(ne){if(ne[4]===0&&ne[5]===0){if(ne[1]===0&&ne[2]===0)return ne[0]===1&&ne[3]===1?"":`scale(${g(ne[0])} ${g(ne[3])})`;if(ne[0]===ne[3]&&ne[1]===-ne[2]){const j=Math.acos(ne[0])*180/Math.PI;return`rotate(${g(j)})`}}else if(ne[0]===1&&ne[1]===0&&ne[2]===0&&ne[3]===1)return`translate(${g(ne[4])} ${g(ne[5])})`;return`matrix(${g(ne[0])} ${g(ne[1])} ${g(ne[2])} ${g(ne[3])} ${g(ne[4])} ${g(ne[5])})`}let _=0,A=0,H=0;class te{constructor(j,ee){let x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;(0,n.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new n.DOMSVGFactory,this.current=new m,this.transformMatrix=i.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=j,this.objs=ee,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!x,this._operatorIdMapping=[];for(const M in i.OPS)this._operatorIdMapping[i.OPS[M]]=M}getObject(j){let ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return typeof j=="string"?j.startsWith("g_")?this.commonObjs.get(j):this.objs.get(j):ee}save(){this.transformStack.push(this.transformMatrix);const j=this.current;this.extraStack.push(j),this.current=j.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(j){this.save(),this.executeOpTree(j),this.restore()}loadDependencies(j){const ee=j.fnArray,x=j.argsArray;for(let M=0,T=ee.length;M<T;M++)if(ee[M]===i.OPS.dependency)for(const O of x[M]){const R=O.startsWith("g_")?this.commonObjs:this.objs,Y=new Promise(q=>{R.get(O,q)});this.current.dependencies.push(Y)}return Promise.all(this.current.dependencies)}transform(j,ee,x,M,T,O){const R=[j,ee,x,M,T,O];this.transformMatrix=i.Util.transform(this.transformMatrix,R),this.tgrp=null}getSVG(j,ee){this.viewport=ee;const x=this._initialize(ee);return this.loadDependencies(j).then(()=>(this.transformMatrix=i.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(j)),x))}convertOpList(j){const ee=this._operatorIdMapping,x=j.argsArray,M=j.fnArray,T=[];for(let O=0,R=M.length;O<R;O++){const Y=M[O];T.push({fnId:Y,fn:ee[Y],args:x[O]})}return E(T)}executeOpTree(j){for(const ee of j){const x=ee.fn,M=ee.fnId,T=ee.args;switch(M|0){case i.OPS.beginText:this.beginText();break;case i.OPS.dependency:break;case i.OPS.setLeading:this.setLeading(T);break;case i.OPS.setLeadingMoveText:this.setLeadingMoveText(T[0],T[1]);break;case i.OPS.setFont:this.setFont(T);break;case i.OPS.showText:this.showText(T[0]);break;case i.OPS.showSpacedText:this.showText(T[0]);break;case i.OPS.endText:this.endText();break;case i.OPS.moveText:this.moveText(T[0],T[1]);break;case i.OPS.setCharSpacing:this.setCharSpacing(T[0]);break;case i.OPS.setWordSpacing:this.setWordSpacing(T[0]);break;case i.OPS.setHScale:this.setHScale(T[0]);break;case i.OPS.setTextMatrix:this.setTextMatrix(T[0],T[1],T[2],T[3],T[4],T[5]);break;case i.OPS.setTextRise:this.setTextRise(T[0]);break;case i.OPS.setTextRenderingMode:this.setTextRenderingMode(T[0]);break;case i.OPS.setLineWidth:this.setLineWidth(T[0]);break;case i.OPS.setLineJoin:this.setLineJoin(T[0]);break;case i.OPS.setLineCap:this.setLineCap(T[0]);break;case i.OPS.setMiterLimit:this.setMiterLimit(T[0]);break;case i.OPS.setFillRGBColor:this.setFillRGBColor(T[0],T[1],T[2]);break;case i.OPS.setStrokeRGBColor:this.setStrokeRGBColor(T[0],T[1],T[2]);break;case i.OPS.setStrokeColorN:this.setStrokeColorN(T);break;case i.OPS.setFillColorN:this.setFillColorN(T);break;case i.OPS.shadingFill:this.shadingFill(T[0]);break;case i.OPS.setDash:this.setDash(T[0],T[1]);break;case i.OPS.setRenderingIntent:this.setRenderingIntent(T[0]);break;case i.OPS.setFlatness:this.setFlatness(T[0]);break;case i.OPS.setGState:this.setGState(T[0]);break;case i.OPS.fill:this.fill();break;case i.OPS.eoFill:this.eoFill();break;case i.OPS.stroke:this.stroke();break;case i.OPS.fillStroke:this.fillStroke();break;case i.OPS.eoFillStroke:this.eoFillStroke();break;case i.OPS.clip:this.clip("nonzero");break;case i.OPS.eoClip:this.clip("evenodd");break;case i.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case i.OPS.paintImageXObject:this.paintImageXObject(T[0]);break;case i.OPS.paintInlineImageXObject:this.paintInlineImageXObject(T[0]);break;case i.OPS.paintImageMaskXObject:this.paintImageMaskXObject(T[0]);break;case i.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(T[0],T[1]);break;case i.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case i.OPS.closePath:this.closePath();break;case i.OPS.closeStroke:this.closeStroke();break;case i.OPS.closeFillStroke:this.closeFillStroke();break;case i.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case i.OPS.nextLine:this.nextLine();break;case i.OPS.transform:this.transform(T[0],T[1],T[2],T[3],T[4],T[5]);break;case i.OPS.constructPath:this.constructPath(T[0],T[1]);break;case i.OPS.endPath:this.endPath();break;case 92:this.group(ee.items);break;default:(0,i.warn)(`Unimplemented operator ${x}`);break}}}setWordSpacing(j){this.current.wordSpacing=j}setCharSpacing(j){this.current.charSpacing=j}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(j,ee,x,M,T,O){const R=this.current;R.textMatrix=R.lineMatrix=[j,ee,x,M,T,O],R.textMatrixScale=Math.hypot(j,ee),R.x=R.lineX=0,R.y=R.lineY=0,R.xcoords=[],R.ycoords=[],R.tspan=this.svgFactory.createElement("svg:tspan"),R.tspan.setAttributeNS(null,"font-family",R.fontFamily),R.tspan.setAttributeNS(null,"font-size",`${g(R.fontSize)}px`),R.tspan.setAttributeNS(null,"y",g(-R.y)),R.txtElement=this.svgFactory.createElement("svg:text"),R.txtElement.append(R.tspan)}beginText(){const j=this.current;j.x=j.lineX=0,j.y=j.lineY=0,j.textMatrix=i.IDENTITY_MATRIX,j.lineMatrix=i.IDENTITY_MATRIX,j.textMatrixScale=1,j.tspan=this.svgFactory.createElement("svg:tspan"),j.txtElement=this.svgFactory.createElement("svg:text"),j.txtgrp=this.svgFactory.createElement("svg:g"),j.xcoords=[],j.ycoords=[]}moveText(j,ee){const x=this.current;x.x=x.lineX+=j,x.y=x.lineY+=ee,x.xcoords=[],x.ycoords=[],x.tspan=this.svgFactory.createElement("svg:tspan"),x.tspan.setAttributeNS(null,"font-family",x.fontFamily),x.tspan.setAttributeNS(null,"font-size",`${g(x.fontSize)}px`),x.tspan.setAttributeNS(null,"y",g(-x.y))}showText(j){const ee=this.current,x=ee.font,M=ee.fontSize;if(M===0)return;const T=ee.fontSizeScale,O=ee.charSpacing,R=ee.wordSpacing,Y=ee.fontDirection,q=ee.textHScale*Y,me=x.vertical,xe=me?1:-1,Ee=x.defaultVMetrics,se=M*ee.fontMatrix[0];let Fe=0;for(const _e of j){if(_e===null){Fe+=Y*R;continue}else if(typeof _e=="number"){Fe+=xe*_e*M/1e3;continue}const oe=(_e.isSpace?R:0)+O,ie=_e.fontChar;let re,ce,fe=_e.width;if(me){let ve;const Ae=_e.vmetric||Ee;ve=_e.vmetric?Ae[1]:fe*.5,ve=-ve*se;const be=Ae[2]*se;fe=Ae?-Ae[0]:fe,re=ve/T,ce=(Fe+be)/T}else re=Fe/T,ce=0;(_e.isInFont||x.missingFile)&&(ee.xcoords.push(ee.x+re),me&&ee.ycoords.push(-ee.y+ce),ee.tspan.textContent+=ie);const pe=me?fe*se-oe*Y:fe*se+oe*Y;Fe+=pe}ee.tspan.setAttributeNS(null,"x",ee.xcoords.map(g).join(" ")),me?ee.tspan.setAttributeNS(null,"y",ee.ycoords.map(g).join(" ")):ee.tspan.setAttributeNS(null,"y",g(-ee.y)),me?ee.y-=Fe:ee.x+=Fe*q,ee.tspan.setAttributeNS(null,"font-family",ee.fontFamily),ee.tspan.setAttributeNS(null,"font-size",`${g(ee.fontSize)}px`),ee.fontStyle!==s.fontStyle&&ee.tspan.setAttributeNS(null,"font-style",ee.fontStyle),ee.fontWeight!==s.fontWeight&&ee.tspan.setAttributeNS(null,"font-weight",ee.fontWeight);const ue=ee.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;if(ue===i.TextRenderingMode.FILL||ue===i.TextRenderingMode.FILL_STROKE?(ee.fillColor!==s.fillColor&&ee.tspan.setAttributeNS(null,"fill",ee.fillColor),ee.fillAlpha<1&&ee.tspan.setAttributeNS(null,"fill-opacity",ee.fillAlpha)):ee.textRenderingMode===i.TextRenderingMode.ADD_TO_PATH?ee.tspan.setAttributeNS(null,"fill","transparent"):ee.tspan.setAttributeNS(null,"fill","none"),ue===i.TextRenderingMode.STROKE||ue===i.TextRenderingMode.FILL_STROKE){const _e=1/(ee.textMatrixScale||1);this._setStrokeAttributes(ee.tspan,_e)}let ae=ee.textMatrix;ee.textRise!==0&&(ae=ae.slice(),ae[5]+=ee.textRise),ee.txtElement.setAttributeNS(null,"transform",`${p(ae)} scale(${g(q)}, -1)`),ee.txtElement.setAttributeNS(a,"xml:space","preserve"),ee.txtElement.append(ee.tspan),ee.txtgrp.append(ee.txtElement),this._ensureTransformGroup().append(ee.txtElement)}setLeadingMoveText(j,ee){this.setLeading(-ee),this.moveText(j,ee)}addFontStyle(j){if(!j.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const ee=h(j.data,j.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${j.loadedName}"; src: url(${ee}); }
`}setFont(j){const ee=this.current,x=this.commonObjs.get(j[0]);let M=j[1];ee.font=x,this.embedFonts&&!x.missingFile&&!this.embeddedFonts[x.loadedName]&&(this.addFontStyle(x),this.embeddedFonts[x.loadedName]=x),ee.fontMatrix=x.fontMatrix||i.FONT_IDENTITY_MATRIX;let T="normal";x.black?T="900":x.bold&&(T="bold");const O=x.italic?"italic":"normal";M<0?(M=-M,ee.fontDirection=-1):ee.fontDirection=1,ee.fontSize=M,ee.fontFamily=x.loadedName,ee.fontWeight=T,ee.fontStyle=O,ee.tspan=this.svgFactory.createElement("svg:tspan"),ee.tspan.setAttributeNS(null,"y",g(-ee.y)),ee.xcoords=[],ee.ycoords=[]}endText(){var ee;const j=this.current;j.textRenderingMode&i.TextRenderingMode.ADD_TO_PATH_FLAG&&((ee=j.txtElement)!=null&&ee.hasChildNodes())&&(j.element=j.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(j){j>0&&(this.current.lineWidth=j)}setLineCap(j){this.current.lineCap=c[j]}setLineJoin(j){this.current.lineJoin=u[j]}setMiterLimit(j){this.current.miterLimit=j}setStrokeAlpha(j){this.current.strokeAlpha=j}setStrokeRGBColor(j,ee,x){this.current.strokeColor=i.Util.makeHexColor(j,ee,x)}setFillAlpha(j){this.current.fillAlpha=j}setFillRGBColor(j,ee,x){this.current.fillColor=i.Util.makeHexColor(j,ee,x),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(j){this.current.strokeColor=this._makeColorN_Pattern(j)}setFillColorN(j){this.current.fillColor=this._makeColorN_Pattern(j)}shadingFill(j){const{width:ee,height:x}=this.viewport,M=i.Util.inverseTransform(this.transformMatrix),[T,O,R,Y]=i.Util.getAxialAlignedBoundingBox([0,0,ee,x],M),q=this.svgFactory.createElement("svg:rect");q.setAttributeNS(null,"x",T),q.setAttributeNS(null,"y",O),q.setAttributeNS(null,"width",R-T),q.setAttributeNS(null,"height",Y-O),q.setAttributeNS(null,"fill",this._makeShadingPattern(j)),this.current.fillAlpha<1&&q.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(q)}_makeColorN_Pattern(j){return j[0]==="TilingPattern"?this._makeTilingPattern(j):this._makeShadingPattern(j)}_makeTilingPattern(j){const ee=j[1],x=j[2],M=j[3]||i.IDENTITY_MATRIX,[T,O,R,Y]=j[4],q=j[5],me=j[6],xe=j[7],Ee=`shading${H++}`,[se,Fe,ue,ae]=i.Util.normalizeRect([...i.Util.applyTransform([T,O],M),...i.Util.applyTransform([R,Y],M)]),[_e,oe]=i.Util.singularValueDecompose2dScale(M),ie=q*_e,re=me*oe,ce=this.svgFactory.createElement("svg:pattern");ce.setAttributeNS(null,"id",Ee),ce.setAttributeNS(null,"patternUnits","userSpaceOnUse"),ce.setAttributeNS(null,"width",ie),ce.setAttributeNS(null,"height",re),ce.setAttributeNS(null,"x",`${se}`),ce.setAttributeNS(null,"y",`${Fe}`);const fe=this.svg,pe=this.transformMatrix,ve=this.current.fillColor,Ae=this.current.strokeColor,be=this.svgFactory.create(ue-se,ae-Fe);if(this.svg=be,this.transformMatrix=M,xe===2){const je=i.Util.makeHexColor(...ee);this.current.fillColor=je,this.current.strokeColor=je}return this.executeOpTree(this.convertOpList(x)),this.svg=fe,this.transformMatrix=pe,this.current.fillColor=ve,this.current.strokeColor=Ae,ce.append(be.childNodes[0]),this.defs.append(ce),`url(#${Ee})`}_makeShadingPattern(j){switch(typeof j=="string"&&(j=this.objs.get(j)),j[0]){case"RadialAxial":const ee=`shading${H++}`,x=j[3];let M;switch(j[1]){case"axial":const T=j[4],O=j[5];M=this.svgFactory.createElement("svg:linearGradient"),M.setAttributeNS(null,"id",ee),M.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),M.setAttributeNS(null,"x1",T[0]),M.setAttributeNS(null,"y1",T[1]),M.setAttributeNS(null,"x2",O[0]),M.setAttributeNS(null,"y2",O[1]);break;case"radial":const R=j[4],Y=j[5],q=j[6],me=j[7];M=this.svgFactory.createElement("svg:radialGradient"),M.setAttributeNS(null,"id",ee),M.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),M.setAttributeNS(null,"cx",Y[0]),M.setAttributeNS(null,"cy",Y[1]),M.setAttributeNS(null,"r",me),M.setAttributeNS(null,"fx",R[0]),M.setAttributeNS(null,"fy",R[1]),M.setAttributeNS(null,"fr",q);break;default:throw new Error(`Unknown RadialAxial type: ${j[1]}`)}for(const T of x){const O=this.svgFactory.createElement("svg:stop");O.setAttributeNS(null,"offset",T[0]),O.setAttributeNS(null,"stop-color",T[1]),M.append(O)}return this.defs.append(M),`url(#${ee})`;case"Mesh":return(0,i.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${j[0]}`)}}setDash(j,ee){this.current.dashArray=j,this.current.dashPhase=ee}constructPath(j,ee){const x=this.current;let M=x.x,T=x.y,O=[],R=0;for(const Y of j)switch(Y|0){case i.OPS.rectangle:M=ee[R++],T=ee[R++];const q=ee[R++],me=ee[R++],xe=M+q,Ee=T+me;O.push("M",g(M),g(T),"L",g(xe),g(T),"L",g(xe),g(Ee),"L",g(M),g(Ee),"Z");break;case i.OPS.moveTo:M=ee[R++],T=ee[R++],O.push("M",g(M),g(T));break;case i.OPS.lineTo:M=ee[R++],T=ee[R++],O.push("L",g(M),g(T));break;case i.OPS.curveTo:M=ee[R+4],T=ee[R+5],O.push("C",g(ee[R]),g(ee[R+1]),g(ee[R+2]),g(ee[R+3]),g(M),g(T)),R+=6;break;case i.OPS.curveTo2:O.push("C",g(M),g(T),g(ee[R]),g(ee[R+1]),g(ee[R+2]),g(ee[R+3])),M=ee[R+2],T=ee[R+3],R+=4;break;case i.OPS.curveTo3:M=ee[R+2],T=ee[R+3],O.push("C",g(ee[R]),g(ee[R+1]),g(M),g(T),g(M),g(T)),R+=4;break;case i.OPS.closePath:O.push("Z");break}O=O.join(" "),x.path&&j.length>0&&j[0]!==i.OPS.rectangle&&j[0]!==i.OPS.moveTo?O=x.path.getAttributeNS(null,"d")+O:(x.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(x.path)),x.path.setAttributeNS(null,"d",O),x.path.setAttributeNS(null,"fill","none"),x.element=x.path,x.setCurrentPoint(M,T)}endPath(){const j=this.current;if(j.path=null,!this.pendingClip)return;if(!j.element){this.pendingClip=null;return}const ee=`clippath${_++}`,x=this.svgFactory.createElement("svg:clipPath");x.setAttributeNS(null,"id",ee),x.setAttributeNS(null,"transform",p(this.transformMatrix));const M=j.element.cloneNode(!0);if(this.pendingClip==="evenodd"?M.setAttributeNS(null,"clip-rule","evenodd"):M.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,x.append(M),this.defs.append(x),j.activeClipUrl){j.clipGroup=null;for(const T of this.extraStack)T.clipGroup=null;x.setAttributeNS(null,"clip-path",j.activeClipUrl)}j.activeClipUrl=`url(#${ee})`,this.tgrp=null}clip(j){this.pendingClip=j}closePath(){const j=this.current;if(j.path){const ee=`${j.path.getAttributeNS(null,"d")}Z`;j.path.setAttributeNS(null,"d",ee)}}setLeading(j){this.current.leading=-j}setTextRise(j){this.current.textRise=j}setTextRenderingMode(j){this.current.textRenderingMode=j}setHScale(j){this.current.textHScale=j/100}setRenderingIntent(j){}setFlatness(j){}setGState(j){for(const[ee,x]of j)switch(ee){case"LW":this.setLineWidth(x);break;case"LC":this.setLineCap(x);break;case"LJ":this.setLineJoin(x);break;case"ML":this.setMiterLimit(x);break;case"D":this.setDash(x[0],x[1]);break;case"RI":this.setRenderingIntent(x);break;case"FL":this.setFlatness(x);break;case"Font":this.setFont(x);break;case"CA":this.setStrokeAlpha(x);break;case"ca":this.setFillAlpha(x);break;default:(0,i.warn)(`Unimplemented graphic state operator ${ee}`);break}}fill(){const j=this.current;j.element&&(j.element.setAttributeNS(null,"fill",j.fillColor),j.element.setAttributeNS(null,"fill-opacity",j.fillAlpha),this.endPath())}stroke(){const j=this.current;j.element&&(this._setStrokeAttributes(j.element),j.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(j){let ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const x=this.current;let M=x.dashArray;ee!==1&&M.length>0&&(M=M.map(function(T){return ee*T})),j.setAttributeNS(null,"stroke",x.strokeColor),j.setAttributeNS(null,"stroke-opacity",x.strokeAlpha),j.setAttributeNS(null,"stroke-miterlimit",g(x.miterLimit)),j.setAttributeNS(null,"stroke-linecap",x.lineCap),j.setAttributeNS(null,"stroke-linejoin",x.lineJoin),j.setAttributeNS(null,"stroke-width",g(ee*x.lineWidth)+"px"),j.setAttributeNS(null,"stroke-dasharray",M.map(g).join(" ")),j.setAttributeNS(null,"stroke-dashoffset",g(ee*x.dashPhase)+"px")}eoFill(){var j;(j=this.current.element)==null||j.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var j;(j=this.current.element)==null||j.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const j=this.svgFactory.createElement("svg:rect");j.setAttributeNS(null,"x","0"),j.setAttributeNS(null,"y","0"),j.setAttributeNS(null,"width","1px"),j.setAttributeNS(null,"height","1px"),j.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(j)}paintImageXObject(j){const ee=this.getObject(j);if(!ee){(0,i.warn)(`Dependent image with object ID ${j} is not ready yet`);return}this.paintInlineImageXObject(ee)}paintInlineImageXObject(j,ee){const x=j.width,M=j.height,T=f(j,this.forceDataSchema,!!ee),O=this.svgFactory.createElement("svg:rect");O.setAttributeNS(null,"x","0"),O.setAttributeNS(null,"y","0"),O.setAttributeNS(null,"width",g(x)),O.setAttributeNS(null,"height",g(M)),this.current.element=O,this.clip("nonzero");const R=this.svgFactory.createElement("svg:image");R.setAttributeNS(o,"xlink:href",T),R.setAttributeNS(null,"x","0"),R.setAttributeNS(null,"y",g(-M)),R.setAttributeNS(null,"width",g(x)+"px"),R.setAttributeNS(null,"height",g(M)+"px"),R.setAttributeNS(null,"transform",`scale(${g(1/x)} ${g(-1/M)})`),ee?ee.append(R):this._ensureTransformGroup().append(R)}paintImageMaskXObject(j){const ee=this.getObject(j.data,j);if(ee.bitmap){(0,i.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const x=this.current,M=ee.width,T=ee.height,O=x.fillColor;x.maskId=`mask${A++}`;const R=this.svgFactory.createElement("svg:mask");R.setAttributeNS(null,"id",x.maskId);const Y=this.svgFactory.createElement("svg:rect");Y.setAttributeNS(null,"x","0"),Y.setAttributeNS(null,"y","0"),Y.setAttributeNS(null,"width",g(M)),Y.setAttributeNS(null,"height",g(T)),Y.setAttributeNS(null,"fill",O),Y.setAttributeNS(null,"mask",`url(#${x.maskId})`),this.defs.append(R),this._ensureTransformGroup().append(Y),this.paintInlineImageXObject(ee,R)}paintFormXObjectBegin(j,ee){if(Array.isArray(j)&&j.length===6&&this.transform(j[0],j[1],j[2],j[3],j[4],j[5]),ee){const x=ee[2]-ee[0],M=ee[3]-ee[1],T=this.svgFactory.createElement("svg:rect");T.setAttributeNS(null,"x",ee[0]),T.setAttributeNS(null,"y",ee[1]),T.setAttributeNS(null,"width",g(x)),T.setAttributeNS(null,"height",g(M)),this.current.element=T,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(j){const ee=this.svgFactory.create(j.width,j.height),x=this.svgFactory.createElement("svg:defs");ee.append(x),this.defs=x;const M=this.svgFactory.createElement("svg:g");return M.setAttributeNS(null,"transform",p(j.transform)),ee.append(M),this.svg=M,ee}_ensureClipGroup(){if(!this.current.clipGroup){const j=this.svgFactory.createElement("svg:g");j.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(j),this.current.clipGroup=j}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",p(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}e.SVGGraphics=te},(t,e,r)=>{var n=r(3),i=r(188),s=r(193);n({target:"Array",proto:!0},{group:function(o){var c=arguments.length>1?arguments[1]:void 0;return i(this,o,c)}}),s("group")},(t,e,r)=>{var n=r(99),i=r(14),s=r(13),a=r(40),o=r(18),c=r(64),u=r(189),h=r(108),f=Array,m=i([].push);t.exports=function(E,g,p,_){for(var A=a(E),H=s(A),te=n(g,p),ne=u(null),j=c(H),ee=0,x,M,T;j>ee;ee++)T=H[ee],M=o(te(T,ee,A)),M in ne?m(ne[M],T):ne[M]=[T];if(_&&(x=_(A),x!==f))for(M in ne)ne[M]=h(x,ne[M]);return ne}},(t,e,r)=>{var n=r(47),i=r(190),s=r(66),a=r(55),o=r(192),c=r(43),u=r(54),h=">",f="<",m="prototype",E="script",g=u("IE_PROTO"),p=function(){},_=function(j){return f+E+h+j+f+"/"+E+h},A=function(j){j.write(_("")),j.close();var ee=j.parentWindow.Object;return j=null,ee},H=function(){var j=c("iframe"),ee="java"+E+":",x;return j.style.display="none",o.appendChild(j),j.src=String(ee),x=j.contentWindow.document,x.open(),x.write(_("document.F=Object")),x.close(),x.F},te,ne=function(){try{te=new ActiveXObject("htmlfile")}catch(ee){}ne=typeof document!="undefined"?document.domain&&te?A(te):H():A(te);for(var j=s.length;j--;)delete ne[m][s[j]];return ne()};a[g]=!0,t.exports=Object.create||function(ee,x){var M;return ee!==null?(p[m]=n(ee),M=new p,p[m]=null,M[g]=ee):M=ne(),x===void 0?M:i.f(M,x)}},(t,e,r)=>{var n=r(6),i=r(46),s=r(45),a=r(47),o=r(12),c=r(191);e.f=n&&!i?Object.defineProperties:function(h,f){a(h);for(var m=o(f),E=c(f),g=E.length,p=0,_;g>p;)s.f(h,_=E[p++],m[_]);return h}},(t,e,r)=>{var n=r(59),i=r(66);t.exports=Object.keys||function(a){return n(a,i)}},(t,e,r)=>{var n=r(24);t.exports=n("document","documentElement")},(t,e,r)=>{var n=r(34),i=r(189),s=r(45).f,a=n("unscopables"),o=Array.prototype;o[a]===void 0&&s(o,a,{configurable:!0,value:i(null)}),t.exports=function(c){o[a][c]=!0}},(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0,r(89);class n{static textContent(s){const a=[],o={items:a,styles:Object.create(null)};function c(u){var m;if(!u)return;let h=null;const f=u.name;if(f==="#text")h=u.value;else if(n.shouldBuildText(f))(m=u==null?void 0:u.attributes)!=null&&m.textContent?h=u.attributes.textContent:u.value&&(h=u.value);else return;if(h!==null&&a.push({str:h}),!!u.children)for(const E of u.children)c(E)}return c(s),o}static shouldBuildText(s){return!(s==="textarea"||s==="input"||s==="option"||s==="select")}}e.XfaText=n},(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=p,e.updateTextLayer=_,r(89),r(2);var n=r(1),i=r(168);const s=1e5,a=30,o=.8,c=new Map;function u(A,H){let te;if(H&&n.FeatureTest.isOffscreenCanvasSupported)te=new OffscreenCanvas(A,A).getContext("2d",{alpha:!1});else{const ne=document.createElement("canvas");ne.width=ne.height=A,te=ne.getContext("2d",{alpha:!1})}return te}function h(A,H){const te=c.get(A);if(te)return te;const ne=u(a,H);ne.font=`${a}px ${A}`;const j=ne.measureText("");let ee=j.fontBoundingBoxAscent,x=Math.abs(j.fontBoundingBoxDescent);if(ee){const T=ee/(ee+x);return c.set(A,T),ne.canvas.width=ne.canvas.height=0,T}ne.strokeStyle="red",ne.clearRect(0,0,a,a),ne.strokeText("g",0,0);let M=ne.getImageData(0,0,a,a).data;x=0;for(let T=M.length-1-3;T>=0;T-=4)if(M[T]>0){x=Math.ceil(T/4/a);break}ne.clearRect(0,0,a,a),ne.strokeText("A",0,a),M=ne.getImageData(0,0,a,a).data,ee=0;for(let T=0,O=M.length;T<O;T+=4)if(M[T]>0){ee=a-Math.floor(T/4/a);break}if(ne.canvas.width=ne.canvas.height=0,ee){const T=ee/(ee+x);return c.set(A,T),T}return c.set(A,o),o}function f(A,H,te){const ne=document.createElement("span"),j={angle:0,canvasWidth:0,hasText:H.str!=="",hasEOL:H.hasEOL,fontSize:0};A._textDivs.push(ne);const ee=n.Util.transform(A._transform,H.transform);let x=Math.atan2(ee[1],ee[0]);const M=te[H.fontName];M.vertical&&(x+=Math.PI/2);const T=Math.hypot(ee[2],ee[3]),O=T*h(M.fontFamily,A._isOffscreenCanvasSupported);let R,Y;x===0?(R=ee[4],Y=ee[5]-O):(R=ee[4]+O*Math.sin(x),Y=ee[5]-O*Math.cos(x));const q="calc(var(--scale-factor)*",me=ne.style;A._container===A._rootContainer?(me.left=`${(100*R/A._pageWidth).toFixed(2)}%`,me.top=`${(100*Y/A._pageHeight).toFixed(2)}%`):(me.left=`${q}${R.toFixed(2)}px)`,me.top=`${q}${Y.toFixed(2)}px)`),me.fontSize=`${q}${T.toFixed(2)}px)`,me.fontFamily=M.fontFamily,j.fontSize=T,ne.setAttribute("role","presentation"),ne.textContent=H.str,ne.dir=H.dir,A._fontInspectorEnabled&&(ne.dataset.fontName=H.fontName),x!==0&&(j.angle=x*(180/Math.PI));let xe=!1;if(H.str.length>1)xe=!0;else if(H.str!==" "&&H.transform[0]!==H.transform[3]){const Ee=Math.abs(H.transform[0]),se=Math.abs(H.transform[3]);Ee!==se&&Math.max(Ee,se)/Math.min(Ee,se)>1.5&&(xe=!0)}xe&&(j.canvasWidth=M.vertical?H.height:H.width),A._textDivProperties.set(ne,j),A._isReadableStream&&A._layoutText(ne)}function m(A){const{div:H,scale:te,properties:ne,ctx:j,prevFontSize:ee,prevFontFamily:x}=A,{style:M}=H;let T="";if(ne.canvasWidth!==0&&ne.hasText){const{fontFamily:O}=M,{canvasWidth:R,fontSize:Y}=ne;(ee!==Y||x!==O)&&(j.font=`${Y*te}px ${O}`,A.prevFontSize=Y,A.prevFontFamily=O);const{width:q}=j.measureText(H.textContent);q>0&&(T=`scaleX(${R*te/q})`)}ne.angle!==0&&(T=`rotate(${ne.angle}deg) ${T}`),T.length>0&&(M.transform=T)}function E(A){if(A._canceled)return;const H=A._textDivs,te=A._capability;if(H.length>s){te.resolve();return}if(!A._isReadableStream)for(const j of H)A._layoutText(j);te.resolve()}class g{constructor(H){var me;let{textContentSource:te,container:ne,viewport:j,textDivs:ee,textDivProperties:x,textContentItemsStr:M,isOffscreenCanvasSupported:T}=H;this._textContentSource=te,this._isReadableStream=te instanceof ReadableStream,this._container=this._rootContainer=ne,this._textDivs=ee||[],this._textContentItemsStr=M||[],this._isOffscreenCanvasSupported=T,this._fontInspectorEnabled=!!((me=globalThis.FontInspector)!=null&&me.enabled),this._reader=null,this._textDivProperties=x||new WeakMap,this._canceled=!1,this._capability=new n.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:j.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:u(0,T)};const{pageWidth:O,pageHeight:R,pageX:Y,pageY:q}=j.rawDims;this._transform=[1,0,0,-1,-Y,q+R],this._pageWidth=O,this._pageHeight=R,(0,i.setLayerDimensions)(ne,j),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new n.AbortException("TextLayer task cancelled."))}_processItems(H,te){for(const ne of H){if(ne.str===void 0){if(ne.type==="beginMarkedContentProps"||ne.type==="beginMarkedContent"){const j=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),ne.id!==null&&this._container.setAttribute("id",`${ne.id}`),j.append(this._container)}else ne.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(ne.str),f(this,ne,te)}}_layoutText(H){const te=this._layoutTextParams.properties=this._textDivProperties.get(H);if(this._layoutTextParams.div=H,m(this._layoutTextParams),te.hasText&&this._container.append(H),te.hasEOL){const ne=document.createElement("br");ne.setAttribute("role","presentation"),this._container.append(ne)}}_render(){const H=new n.PromiseCapability;let te=Object.create(null);if(this._isReadableStream){const ne=()=>{this._reader.read().then(j=>{let{value:ee,done:x}=j;if(x){H.resolve();return}Object.assign(te,ee.styles),this._processItems(ee.items,te),ne()},H.reject)};this._reader=this._textContentSource.getReader(),ne()}else if(this._textContentSource){const{items:ne,styles:j}=this._textContentSource;this._processItems(ne,j),H.resolve()}else throw new Error('No "textContentSource" parameter specified.');H.promise.then(()=>{te=null,E(this)},this._capability.reject)}}e.TextLayerRenderTask=g;function p(A){!A.textContentSource&&(A.textContent||A.textContentStream)&&((0,i.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),A.textContentSource=A.textContent||A.textContentStream);const{container:H,viewport:te}=A,ne=getComputedStyle(H),j=ne.getPropertyValue("visibility"),ee=parseFloat(ne.getPropertyValue("--scale-factor"));j==="visible"&&(!ee||Math.abs(ee-te.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const x=new g(A);return x._render(),x}function _(A){let{container:H,viewport:te,textDivs:ne,textDivProperties:j,isOffscreenCanvasSupported:ee,mustRotate:x=!0,mustRescale:M=!0}=A;if(x&&(0,i.setLayerDimensions)(H,{rotation:te.rotation}),M){const T=u(0,ee),R={prevFontSize:null,prevFontFamily:null,div:null,scale:te.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:T};for(const Y of ne)R.properties=j.get(Y),R.div=Y,m(R)}}},(t,e,r)=>{var h,f,m,E,g,p,_,A,H,te,ne,ha,Cs,da,fa;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0,r(125),r(136),r(138),r(141),r(143),r(145),r(147);var n=r(1),i=r(164),s=r(197),a=r(202),o=r(168),c=r(203);const T=class T{constructor(R){ct(this,ne);ct(this,h);ct(this,f,!1);ct(this,m,null);ct(this,E,this.pointerup.bind(this));ct(this,g,this.pointerdown.bind(this));ct(this,p,new Map);ct(this,_,!1);ct(this,A,!1);ct(this,H,!1);ct(this,te);let{uiManager:Y,pageIndex:q,div:me,accessibilityManager:xe,annotationLayer:Ee,viewport:se,l10n:Fe}=R;const ue=[s.FreeTextEditor,a.InkEditor,c.StampEditor];if(!T._initialized){T._initialized=!0;for(const ae of ue)ae.initialize(Fe)}Y.registerEditorTypes(ue),ft(this,te,Y),this.pageIndex=q,this.div=me,ft(this,h,xe),ft(this,m,Ee),this.viewport=se,de(this,te).addLayer(this)}get isEmpty(){return de(this,p).size===0}updateToolbar(R){de(this,te).updateToolbar(R)}updateMode(){let R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:de(this,te).getMode();Qe(this,ne,fa).call(this),R===n.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),R!==n.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",R===n.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",R===n.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",R===n.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(R){if(!R&&de(this,te).getMode()!==n.AnnotationEditorType.INK)return;if(!R){for(const q of de(this,p).values())if(q.isEmpty()){q.setInBackground();return}}Qe(this,ne,Cs).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(R){de(this,te).setEditingState(R)}addCommands(R){de(this,te).addCommands(R)}enable(){this.div.style.pointerEvents="auto";const R=new Set;for(const q of de(this,p).values())q.enableEditing(),q.annotationElementId&&R.add(q.annotationElementId);if(!de(this,m))return;const Y=de(this,m).getEditableAnnotations();for(const q of Y){if(q.hide(),de(this,te).isDeletedAnnotationElement(q.data.id)||R.has(q.data.id))continue;const me=this.deserialize(q);me&&(this.addOrRebuild(me),me.enableEditing())}}disable(){var Y;ft(this,H,!0),this.div.style.pointerEvents="none";const R=new Set;for(const q of de(this,p).values()){if(q.disableEditing(),!q.annotationElementId||q.serialize()!==null){R.add(q.annotationElementId);continue}(Y=this.getEditableAnnotation(q.annotationElementId))==null||Y.show(),q.remove()}if(de(this,m)){const q=de(this,m).getEditableAnnotations();for(const me of q){const{id:xe}=me.data;R.has(xe)||de(this,te).isDeletedAnnotationElement(xe)||me.show()}}Qe(this,ne,fa).call(this),this.isEmpty&&(this.div.hidden=!0),ft(this,H,!1)}getEditableAnnotation(R){var Y;return((Y=de(this,m))==null?void 0:Y.getEditableAnnotation(R))||null}setActiveEditor(R){de(this,te).getActive()!==R&&de(this,te).setActiveEditor(R)}enableClick(){this.div.addEventListener("pointerdown",de(this,g)),this.div.addEventListener("pointerup",de(this,E))}disableClick(){this.div.removeEventListener("pointerdown",de(this,g)),this.div.removeEventListener("pointerup",de(this,E))}attach(R){de(this,p).set(R.id,R);const{annotationElementId:Y}=R;Y&&de(this,te).isDeletedAnnotationElement(Y)&&de(this,te).removeDeletedAnnotationElement(R)}detach(R){var Y;de(this,p).delete(R.id),(Y=de(this,h))==null||Y.removePointerInTextLayer(R.contentDiv),!de(this,H)&&R.annotationElementId&&de(this,te).addDeletedAnnotationElement(R)}remove(R){this.detach(R),de(this,te).removeEditor(R),R.div.contains(document.activeElement)&&setTimeout(()=>{de(this,te).focusMainContainer()},0),R.div.remove(),R.isAttachedToDOM=!1,de(this,A)||this.addInkEditorIfNeeded(!1)}changeParent(R){var Y;R.parent!==this&&(R.annotationElementId&&(de(this,te).addDeletedAnnotationElement(R.annotationElementId),i.AnnotationEditor.deleteAnnotationElement(R),R.annotationElementId=null),this.attach(R),(Y=R.parent)==null||Y.detach(R),R.setParent(this),R.div&&R.isAttachedToDOM&&(R.div.remove(),this.div.append(R.div)))}add(R){if(this.changeParent(R),de(this,te).addEditor(R),this.attach(R),!R.isAttachedToDOM){const Y=R.render();this.div.append(Y),R.isAttachedToDOM=!0}R.fixAndSetPosition(),R.onceAdded(),de(this,te).addToAnnotationStorage(R)}moveEditorInDOM(R){var q;if(!R.isAttachedToDOM)return;const{activeElement:Y}=document;R.div.contains(Y)&&(R._focusEventsAllowed=!1,setTimeout(()=>{R.div.contains(document.activeElement)?R._focusEventsAllowed=!0:(R.div.addEventListener("focusin",()=>{R._focusEventsAllowed=!0},{once:!0}),Y.focus())},0)),R._structTreeParentId=(q=de(this,h))==null?void 0:q.moveElementInDOM(this.div,R.div,R.contentDiv,!0)}addOrRebuild(R){R.needsToBeRebuilt()?R.rebuild():this.add(R)}addUndoableEditor(R){const Y=()=>R._uiManager.rebuild(R),q=()=>{R.remove()};this.addCommands({cmd:Y,undo:q,mustExec:!1})}getNextId(){return de(this,te).getId()}pasteEditor(R,Y){de(this,te).updateToolbar(R),de(this,te).updateMode(R);const{offsetX:q,offsetY:me}=Qe(this,ne,da).call(this),xe=this.getNextId(),Ee=Qe(this,ne,ha).call(this,Er({parent:this,id:xe,x:q,y:me,uiManager:de(this,te),isCentered:!0},Y));Ee&&this.add(Ee)}deserialize(R){var Y;switch((Y=R.annotationType)!=null?Y:R.annotationEditorType){case n.AnnotationEditorType.FREETEXT:return s.FreeTextEditor.deserialize(R,this,de(this,te));case n.AnnotationEditorType.INK:return a.InkEditor.deserialize(R,this,de(this,te));case n.AnnotationEditorType.STAMP:return c.StampEditor.deserialize(R,this,de(this,te))}return null}addNewEditor(){Qe(this,ne,Cs).call(this,Qe(this,ne,da).call(this),!0)}setSelected(R){de(this,te).setSelected(R)}toggleSelected(R){de(this,te).toggleSelected(R)}isSelected(R){return de(this,te).isSelected(R)}unselect(R){de(this,te).unselect(R)}pointerup(R){const{isMac:Y}=n.FeatureTest.platform;if(!(R.button!==0||R.ctrlKey&&Y)&&R.target===this.div&&de(this,_)){if(ft(this,_,!1),!de(this,f)){ft(this,f,!0);return}if(de(this,te).getMode()===n.AnnotationEditorType.STAMP){de(this,te).unselectAll();return}Qe(this,ne,Cs).call(this,R,!1)}}pointerdown(R){if(de(this,_)){ft(this,_,!1);return}const{isMac:Y}=n.FeatureTest.platform;if(R.button!==0||R.ctrlKey&&Y||R.target!==this.div)return;ft(this,_,!0);const q=de(this,te).getActive();ft(this,f,!q||q.isEmpty())}findNewParent(R,Y,q){const me=de(this,te).findParent(Y,q);return me===null||me===this?!1:(me.changeParent(R),!0)}destroy(){var R,Y;((R=de(this,te).getActive())==null?void 0:R.parent)===this&&(de(this,te).commitOrRemove(),de(this,te).setActiveEditor(null));for(const q of de(this,p).values())(Y=de(this,h))==null||Y.removePointerInTextLayer(q.contentDiv),q.setParent(null),q.isAttachedToDOM=!1,q.div.remove();this.div=null,de(this,p).clear(),de(this,te).removeLayer(this)}render(R){let{viewport:Y}=R;this.viewport=Y,(0,o.setLayerDimensions)(this.div,Y);for(const q of de(this,te).getEditors(this.pageIndex))this.add(q);this.updateMode()}update(R){let{viewport:Y}=R;de(this,te).commitOrRemove(),this.viewport=Y,(0,o.setLayerDimensions)(this.div,{rotation:Y.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:R,pageHeight:Y}=this.viewport.rawDims;return[R,Y]}};h=new WeakMap,f=new WeakMap,m=new WeakMap,E=new WeakMap,g=new WeakMap,p=new WeakMap,_=new WeakMap,A=new WeakMap,H=new WeakMap,te=new WeakMap,ne=new WeakSet,ha=function(R){switch(de(this,te).getMode()){case n.AnnotationEditorType.FREETEXT:return new s.FreeTextEditor(R);case n.AnnotationEditorType.INK:return new a.InkEditor(R);case n.AnnotationEditorType.STAMP:return new c.StampEditor(R)}return null},Cs=function(R,Y){const q=this.getNextId(),me=Qe(this,ne,ha).call(this,{parent:this,id:q,x:R.offsetX,y:R.offsetY,uiManager:de(this,te),isCentered:Y});return me&&this.add(me),me},da=function(){const{x:R,y:Y,width:q,height:me}=this.div.getBoundingClientRect(),xe=Math.max(0,R),Ee=Math.max(0,Y),se=Math.min(window.innerWidth,R+q),Fe=Math.min(window.innerHeight,Y+me),ue=(xe+se)/2-R,ae=(Ee+Fe)/2-Y,[_e,oe]=this.viewport.rotation%180===0?[ue,ae]:[ae,ue];return{offsetX:_e,offsetY:oe}},fa=function(){ft(this,A,!0);for(const R of de(this,p).values())R.isEmpty()&&R.remove();ft(this,A,!1)},Hr(T,"_initialized",!1);let u=T;e.AnnotationEditorLayer=u},(t,e,r)=>{var c,u,h,f,m,E,g,p,_,A,xo,yo,Eo,Ji,pa,wo,ma;Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0,r(89);var n=r(1),i=r(165),s=r(164),a=r(198);const T=class T extends s.AnnotationEditor{constructor(Y){super(Br(Er({},Y),{name:"freeTextEditor"}));ct(this,A);ct(this,c,this.editorDivBlur.bind(this));ct(this,u,this.editorDivFocus.bind(this));ct(this,h,this.editorDivInput.bind(this));ct(this,f,this.editorDivKeydown.bind(this));ct(this,m);ct(this,E,"");ct(this,g,`${this.id}-editor`);ct(this,p);ct(this,_,null);ft(this,m,Y.color||T._defaultColor||s.AnnotationEditor._defaultLineColor),ft(this,p,Y.fontSize||T._defaultFontSize)}static get _keyboardManager(){const Y=T.prototype,q=Ee=>Ee.isEmpty(),me=i.AnnotationEditorUIManager.TRANSLATE_SMALL,xe=i.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new i.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],Y.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],Y.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],Y._translateEmpty,{args:[-me,0],checker:q}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],Y._translateEmpty,{args:[-xe,0],checker:q}],[["ArrowRight","mac+ArrowRight"],Y._translateEmpty,{args:[me,0],checker:q}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],Y._translateEmpty,{args:[xe,0],checker:q}],[["ArrowUp","mac+ArrowUp"],Y._translateEmpty,{args:[0,-me],checker:q}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],Y._translateEmpty,{args:[0,-xe],checker:q}],[["ArrowDown","mac+ArrowDown"],Y._translateEmpty,{args:[0,me],checker:q}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],Y._translateEmpty,{args:[0,xe],checker:q}]]))}static initialize(Y){s.AnnotationEditor.initialize(Y,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const q=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(q.getPropertyValue("--freetext-padding"))}static updateDefaultParams(Y,q){switch(Y){case n.AnnotationEditorParamsType.FREETEXT_SIZE:T._defaultFontSize=q;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:T._defaultColor=q;break}}updateParams(Y,q){switch(Y){case n.AnnotationEditorParamsType.FREETEXT_SIZE:Qe(this,A,xo).call(this,q);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:Qe(this,A,yo).call(this,q);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,T._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,T._defaultColor||s.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,de(this,p)],[n.AnnotationEditorParamsType.FREETEXT_COLOR,de(this,m)]]}_translateEmpty(Y,q){this._uiManager.translateSelectedEditors(Y,q,!0)}getInitialTranslation(){const Y=this.parentScale;return[-T._internalPadding*Y,-(T._internalPadding+de(this,p))*Y]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",de(this,f)),this.editorDiv.addEventListener("focus",de(this,u)),this.editorDiv.addEventListener("blur",de(this,c)),this.editorDiv.addEventListener("input",de(this,h)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",de(this,g)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",de(this,f)),this.editorDiv.removeEventListener("focus",de(this,u)),this.editorDiv.removeEventListener("blur",de(this,c)),this.editorDiv.removeEventListener("input",de(this,h)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(Y){this._focusEventsAllowed&&(super.focusin(Y),Y.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var Y;if(this.width){Qe(this,A,ma).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(Y=this._initialOptions)!=null&&Y.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const Y=de(this,E),q=ft(this,E,Qe(this,A,Eo).call(this).trimEnd());if(Y===q)return;const me=xe=>{if(ft(this,E,xe),!xe){this.remove();return}Qe(this,A,pa).call(this),this._uiManager.rebuild(this),Qe(this,A,Ji).call(this)};this.addCommands({cmd:()=>{me(q)},undo:()=>{me(Y)},mustExec:!1}),Qe(this,A,Ji).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(Y){this.enterInEditMode()}keydown(Y){Y.target===this.div&&Y.key==="Enter"&&(this.enterInEditMode(),Y.preventDefault())}editorDivKeydown(Y){T._keyboardManager.exec(this,Y)}editorDivFocus(Y){this.isEditing=!0}editorDivBlur(Y){this.isEditing=!1}editorDivInput(Y){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let Y,q;this.width&&(Y=this.x,q=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",de(this,g)),this.enableEditing(),s.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(xe=>{var Ee;return(Ee=this.editorDiv)==null?void 0:Ee.setAttribute("aria-label",xe)}),s.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(xe=>{var Ee;return(Ee=this.editorDiv)==null?void 0:Ee.setAttribute("default-content",xe)}),this.editorDiv.contentEditable=!0;const{style:me}=this.editorDiv;if(me.fontSize=`calc(${de(this,p)}px * var(--scale-factor))`,me.color=de(this,m),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,i.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[xe,Ee]=this.parentDimensions;if(this.annotationElementId){const{position:se}=de(this,_);let[Fe,ue]=this.getInitialTranslation();[Fe,ue]=this.pageTranslationToScreen(Fe,ue);const[ae,_e]=this.pageDimensions,[oe,ie]=this.pageTranslation;let re,ce;switch(this.rotation){case 0:re=Y+(se[0]-oe)/ae,ce=q+this.height-(se[1]-ie)/_e;break;case 90:re=Y+(se[0]-oe)/ae,ce=q-(se[1]-ie)/_e,[Fe,ue]=[ue,-Fe];break;case 180:re=Y-this.width+(se[0]-oe)/ae,ce=q-(se[1]-ie)/_e,[Fe,ue]=[-Fe,-ue];break;case 270:re=Y+(se[0]-oe-this.height*_e)/ae,ce=q+(se[1]-ie-this.width*ae)/_e,[Fe,ue]=[-ue,Fe];break}this.setAt(re*xe,ce*Ee,Fe,ue)}else this.setAt(Y*xe,q*Ee,this.width*xe,this.height*Ee);Qe(this,A,pa).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(Y,q,me){let xe=null;if(Y instanceof a.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:se,fontColor:Fe},rect:ue,rotation:ae,id:_e},textContent:oe,textPosition:ie,parent:{page:{pageNumber:re}}}=Y;if(!oe||oe.length===0)return null;xe=Y={annotationType:n.AnnotationEditorType.FREETEXT,color:Array.from(Fe),fontSize:se,value:oe.join(`
`),position:ie,pageIndex:re-1,rect:ue,rotation:ae,id:_e,deleted:!1}}const Ee=super.deserialize(Y,q,me);return ft(Ee,p,Y.fontSize),ft(Ee,m,n.Util.makeHexColor(...Y.color)),ft(Ee,E,Y.value),Ee.annotationElementId=Y.id||null,ft(Ee,_,xe),Ee}serialize(){let Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const q=T._internalPadding*this.parentScale,me=this.getRect(q,q),xe=s.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:de(this,m)),Ee={annotationType:n.AnnotationEditorType.FREETEXT,color:xe,fontSize:de(this,p),value:de(this,E),pageIndex:this.pageIndex,rect:me,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return Y?Ee:this.annotationElementId&&!Qe(this,A,wo).call(this,Ee)?null:(Ee.id=this.annotationElementId,Ee)}};c=new WeakMap,u=new WeakMap,h=new WeakMap,f=new WeakMap,m=new WeakMap,E=new WeakMap,g=new WeakMap,p=new WeakMap,_=new WeakMap,A=new WeakSet,xo=function(Y){const q=xe=>{this.editorDiv.style.fontSize=`calc(${xe}px * var(--scale-factor))`,this.translate(0,-(xe-de(this,p))*this.parentScale),ft(this,p,xe),Qe(this,A,Ji).call(this)},me=de(this,p);this.addCommands({cmd:()=>{q(Y)},undo:()=>{q(me)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},yo=function(Y){const q=de(this,m);this.addCommands({cmd:()=>{ft(this,m,this.editorDiv.style.color=Y)},undo:()=>{ft(this,m,this.editorDiv.style.color=q)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Eo=function(){const Y=this.editorDiv.getElementsByTagName("div");if(Y.length===0)return this.editorDiv.innerText;const q=[];for(const me of Y)q.push(me.innerText.replace(/\r\n?|\n/,""));return q.join(`
`)},Ji=function(){const[Y,q]=this.parentDimensions;let me;if(this.isAttachedToDOM)me=this.div.getBoundingClientRect();else{const{currentLayer:xe,div:Ee}=this,se=Ee.style.display;Ee.style.display="hidden",xe.div.append(this.div),me=Ee.getBoundingClientRect(),Ee.remove(),Ee.style.display=se}this.rotation%180===this.parentRotation%180?(this.width=me.width/Y,this.height=me.height/q):(this.width=me.height/Y,this.height=me.width/q),this.fixAndSetPosition()},pa=function(){if(this.editorDiv.replaceChildren(),!!de(this,E))for(const Y of de(this,E).split(`
`)){const q=document.createElement("div");q.append(Y?document.createTextNode(Y):document.createElement("br")),this.editorDiv.append(q)}},wo=function(Y){const{value:q,fontSize:me,color:xe,rect:Ee,pageIndex:se}=de(this,_);return Y.value!==q||Y.fontSize!==me||Y.rect.some((Fe,ue)=>Math.abs(Fe-Ee[ue])>=1)||Y.color.some((Fe,ue)=>Fe!==xe[ue])||Y.pageIndex!==se},ma=function(){let Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.annotationElementId)return;if(Qe(this,A,Ji).call(this),!Y&&(this.width===0||this.height===0)){setTimeout(()=>Qe(this,A,ma).call(this,!0),0);return}const q=T._internalPadding*this.parentScale;de(this,_).rect=this.getRect(q,q)},Hr(T,"_freeTextDefaultContent",""),Hr(T,"_internalPadding",0),Hr(T,"_defaultColor",null),Hr(T,"_defaultFontSize",10),Hr(T,"_type","freetext");let o=T;e.FreeTextEditor=o},(t,e,r)=>{var ce,pe,ti,bo,be,je,Se,Xe,qe,Je,We,Ue,Ce,Le,Ve,Ge,ut,Jt,Kt,Ze,tr,nr,So,Rs,ga,_a,mr,wr,Cr,Rr,ar,it,ot,va,Tr,Te,ze,zt,To,xa;Object.defineProperty(e,"__esModule",{value:!0}),e.StampAnnotationElement=e.InkAnnotationElement=e.FreeTextAnnotationElement=e.AnnotationLayer=void 0,r(89),r(125),r(136),r(138),r(141),r(143),r(145),r(147);var n=r(1),i=r(168),s=r(163),a=r(199),o=r(200),c=r(201);const u=1e3,h=9,f=new WeakSet;function m(or){return{width:or[2]-or[0],height:or[3]-or[1]}}class E{static create(ke){switch(ke.data.annotationType){case n.AnnotationType.LINK:return new p(ke);case n.AnnotationType.TEXT:return new _(ke);case n.AnnotationType.WIDGET:switch(ke.data.fieldType){case"Tx":return new H(ke);case"Btn":return ke.data.radioButton?new j(ke):ke.data.checkBox?new ne(ke):new ee(ke);case"Ch":return new x(ke);case"Sig":return new te(ke)}return new A(ke);case n.AnnotationType.POPUP:return new M(ke);case n.AnnotationType.FREETEXT:return new O(ke);case n.AnnotationType.LINE:return new R(ke);case n.AnnotationType.SQUARE:return new Y(ke);case n.AnnotationType.CIRCLE:return new q(ke);case n.AnnotationType.POLYLINE:return new me(ke);case n.AnnotationType.CARET:return new Ee(ke);case n.AnnotationType.INK:return new se(ke);case n.AnnotationType.POLYGON:return new xe(ke);case n.AnnotationType.HIGHLIGHT:return new Fe(ke);case n.AnnotationType.UNDERLINE:return new ue(ke);case n.AnnotationType.SQUIGGLY:return new ae(ke);case n.AnnotationType.STRIKEOUT:return new _e(ke);case n.AnnotationType.STAMP:return new oe(ke);case n.AnnotationType.FILEATTACHMENT:return new ie(ke);default:return new g(ke)}}}const fe=class fe{constructor(ke){ct(this,ce,!1);let{isRenderable:Oe=!1,ignoreBorder:He=!1,createQuadrilaterals:$e=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.isRenderable=Oe,this.data=ke.data,this.layer=ke.layer,this.linkService=ke.linkService,this.downloadManager=ke.downloadManager,this.imageResourcesPath=ke.imageResourcesPath,this.renderForms=ke.renderForms,this.svgFactory=ke.svgFactory,this.annotationStorage=ke.annotationStorage,this.enableScripting=ke.enableScripting,this.hasJSActions=ke.hasJSActions,this._fieldObjects=ke.fieldObjects,this.parent=ke.parent,Oe&&(this.container=this._createContainer(He)),$e&&this._createQuadrilaterals()}static _hasPopupData(ke){let{titleObj:Oe,contentsObj:He,richText:$e}=ke;return!!(Oe!=null&&Oe.str||He!=null&&He.str||$e!=null&&$e.str)}get hasPopupData(){return fe._hasPopupData(this.data)}_createContainer(ke){const{data:Oe,parent:{page:He,viewport:$e}}=this,St=document.createElement("section");St.setAttribute("data-annotation-id",Oe.id),this instanceof A||(St.tabIndex=u),St.style.zIndex=this.parent.zIndex++,this.data.popupRef&&St.setAttribute("aria-haspopup","dialog"),Oe.noRotate&&St.classList.add("norotate");const{pageWidth:$t,pageHeight:Yt,pageX:_r,pageY:sr}=$e.rawDims;if(!Oe.rect||this instanceof M){const{rotation:Me}=Oe;return!Oe.hasOwnCanvas&&Me!==0&&this.setRotation(Me,St),St}const{width:ye,height:De}=m(Oe.rect),Re=n.Util.normalizeRect([Oe.rect[0],He.view[3]-Oe.rect[1]+He.view[1],Oe.rect[2],He.view[3]-Oe.rect[3]+He.view[1]]);if(!ke&&Oe.borderStyle.width>0){St.style.borderWidth=`${Oe.borderStyle.width}px`;const Me=Oe.borderStyle.horizontalCornerRadius,Ne=Oe.borderStyle.verticalCornerRadius;if(Me>0||Ne>0){const kt=`calc(${Me}px * var(--scale-factor)) / calc(${Ne}px * var(--scale-factor))`;St.style.borderRadius=kt}else if(this instanceof j){const kt=`calc(${ye}px * var(--scale-factor)) / calc(${De}px * var(--scale-factor))`;St.style.borderRadius=kt}switch(Oe.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:St.style.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:St.style.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:St.style.borderBottomStyle="solid";break}const et=Oe.borderColor||null;et?(ft(this,ce,!0),St.style.borderColor=n.Util.makeHexColor(et[0]|0,et[1]|0,et[2]|0)):St.style.borderWidth=0}St.style.left=`${100*(Re[0]-_r)/$t}%`,St.style.top=`${100*(Re[1]-sr)/Yt}%`;const{rotation:Ie}=Oe;return Oe.hasOwnCanvas||Ie===0?(St.style.width=`${100*ye/$t}%`,St.style.height=`${100*De/Yt}%`):this.setRotation(Ie,St),St}setRotation(ke){let Oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.container;if(!this.data.rect)return;const{pageWidth:He,pageHeight:$e}=this.parent.viewport.rawDims,{width:St,height:$t}=m(this.data.rect);let Yt,_r;ke%180===0?(Yt=100*St/He,_r=100*$t/$e):(Yt=100*$t/He,_r=100*St/$e),Oe.style.width=`${Yt}%`,Oe.style.height=`${_r}%`,Oe.setAttribute("data-main-rotation",(360-ke)%360)}get _commonActions(){const ke=(Oe,He,$e)=>{const St=$e.detail[Oe],$t=St[0],Yt=St.slice(1);$e.target.style[He]=a.ColorConverters[`${$t}_HTML`](Yt),this.annotationStorage.setValue(this.data.id,{[He]:a.ColorConverters[`${$t}_rgb`](Yt)})};return(0,n.shadow)(this,"_commonActions",{display:Oe=>{const{display:He}=Oe.detail,$e=He%2===1;this.container.style.visibility=$e?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:$e,noPrint:He===1||He===2})},print:Oe=>{this.annotationStorage.setValue(this.data.id,{noPrint:!Oe.detail.print})},hidden:Oe=>{const{hidden:He}=Oe.detail;this.container.style.visibility=He?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:He,noView:He})},focus:Oe=>{setTimeout(()=>Oe.target.focus({preventScroll:!1}),0)},userName:Oe=>{Oe.target.title=Oe.detail.userName},readonly:Oe=>{Oe.target.disabled=Oe.detail.readonly},required:Oe=>{this._setRequired(Oe.target,Oe.detail.required)},bgColor:Oe=>{ke("bgColor","backgroundColor",Oe)},fillColor:Oe=>{ke("fillColor","backgroundColor",Oe)},fgColor:Oe=>{ke("fgColor","color",Oe)},textColor:Oe=>{ke("textColor","color",Oe)},borderColor:Oe=>{ke("borderColor","borderColor",Oe)},strokeColor:Oe=>{ke("strokeColor","borderColor",Oe)},rotation:Oe=>{const He=Oe.detail.rotation;this.setRotation(He),this.annotationStorage.setValue(this.data.id,{rotation:He})}})}_dispatchEventFromSandbox(ke,Oe){const He=this._commonActions;for(const $e of Object.keys(Oe.detail)){const St=ke[$e]||He[$e];St==null||St(Oe)}}_setDefaultPropertiesFromJS(ke){if(!this.enableScripting)return;const Oe=this.annotationStorage.getRawValue(this.data.id);if(!Oe)return;const He=this._commonActions;for(const[$e,St]of Object.entries(Oe)){const $t=He[$e];if($t){const Yt={detail:{[$e]:St},target:ke};$t(Yt),delete Oe[$e]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:ke}=this.data;if(!ke)return;const[Oe,He,$e,St]=this.data.rect;if(ke.length===1){const[,{x:Ne,y:et},{x:kt,y:Rt}]=ke[0];if($e===Ne&&St===et&&Oe===kt&&He===Rt)return}const{style:$t}=this.container;let Yt;if(de(this,ce)){const{borderColor:Ne,borderWidth:et}=$t;$t.borderWidth=0,Yt=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Ne}" stroke-width="${et}">`],this.container.classList.add("hasBorder")}const _r=$e-Oe,sr=St-He,{svgFactory:ye}=this,De=ye.createElement("svg");De.classList.add("quadrilateralsContainer"),De.setAttribute("width",0),De.setAttribute("height",0);const Re=ye.createElement("defs");De.append(Re);const Ie=ye.createElement("clipPath"),Me=`clippath_${this.data.id}`;Ie.setAttribute("id",Me),Ie.setAttribute("clipPathUnits","objectBoundingBox"),Re.append(Ie);for(const[,{x:Ne,y:et},{x:kt,y:Rt}]of ke){const Tt=ye.createElement("rect"),Ut=(kt-Oe)/_r,ur=(St-et)/sr,fr=(Ne-kt)/_r,Sr=(et-Rt)/sr;Tt.setAttribute("x",Ut),Tt.setAttribute("y",ur),Tt.setAttribute("width",fr),Tt.setAttribute("height",Sr),Ie.append(Tt),Yt==null||Yt.push(`<rect vector-effect="non-scaling-stroke" x="${Ut}" y="${ur}" width="${fr}" height="${Sr}"/>`)}de(this,ce)&&(Yt.push("</g></svg>')"),$t.backgroundImage=Yt.join("")),this.container.append(De),this.container.style.clipPath=`url(#${Me})`}_createPopup(){const{container:ke,data:Oe}=this;ke.setAttribute("aria-haspopup","dialog");const He=new M({data:{color:Oe.color,titleObj:Oe.titleObj,modificationDate:Oe.modificationDate,contentsObj:Oe.contentsObj,richText:Oe.richText,parentRect:Oe.rect,borderStyle:0,id:`popup_${Oe.id}`,rotation:Oe.rotation},parent:this.parent,elements:[this]});this.parent.div.append(He.render())}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(ke){let Oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const He=[];if(this._fieldObjects){const $e=this._fieldObjects[ke];if($e)for(const{page:St,id:$t,exportValues:Yt}of $e){if(St===-1||$t===Oe)continue;const _r=typeof Yt=="string"?Yt:null,sr=document.querySelector(`[data-element-id="${$t}"]`);if(sr&&!f.has(sr)){(0,n.warn)(`_getElementsByName - element not allowed: ${$t}`);continue}He.push({id:$t,exportValue:_r,domElement:sr})}return He}for(const $e of document.getElementsByName(ke)){const{exportValue:St}=$e,$t=$e.getAttribute("data-element-id");$t!==Oe&&f.has($e)&&He.push({id:$t,exportValue:St,domElement:$e})}return He}show(){var ke;this.container&&(this.container.hidden=!1),(ke=this.popup)==null||ke.maybeShow()}hide(){var ke;this.container&&(this.container.hidden=!0),(ke=this.popup)==null||ke.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const ke=this.getElementsToTriggerPopup();if(Array.isArray(ke))for(const Oe of ke)Oe.classList.add("highlightArea");else ke.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:ke,data:{id:Oe}}=this;this.container.addEventListener("dblclick",()=>{var He;(He=this.linkService.eventBus)==null||He.dispatch("switchannotationeditormode",{source:this,mode:ke,editId:Oe})})}};ce=new WeakMap;let g=fe;class p extends g{constructor(Oe){let He=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;super(Oe,{isRenderable:!0,ignoreBorder:!!(He!=null&&He.ignoreBorder),createQuadrilaterals:!0});ct(this,pe);this.isTooltipOnly=Oe.data.isTooltipOnly}render(){const{data:Oe,linkService:He}=this,$e=document.createElement("a");$e.setAttribute("data-element-id",Oe.id);let St=!1;return Oe.url?(He.addLinkAttributes($e,Oe.url,Oe.newWindow),St=!0):Oe.action?(this._bindNamedAction($e,Oe.action),St=!0):Oe.attachment?(this._bindAttachment($e,Oe.attachment),St=!0):Oe.setOCGState?(Qe(this,pe,bo).call(this,$e,Oe.setOCGState),St=!0):Oe.dest?(this._bindLink($e,Oe.dest),St=!0):(Oe.actions&&(Oe.actions.Action||Oe.actions["Mouse Up"]||Oe.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction($e,Oe),St=!0),Oe.resetForm?(this._bindResetFormAction($e,Oe.resetForm),St=!0):this.isTooltipOnly&&!St&&(this._bindLink($e,""),St=!0)),this.container.classList.add("linkAnnotation"),St&&this.container.append($e),this.container}_bindLink(Oe,He){Oe.href=this.linkService.getDestinationHash(He),Oe.onclick=()=>(He&&this.linkService.goToDestination(He),!1),(He||He==="")&&Qe(this,pe,ti).call(this)}_bindNamedAction(Oe,He){Oe.href=this.linkService.getAnchorUrl(""),Oe.onclick=()=>(this.linkService.executeNamedAction(He),!1),Qe(this,pe,ti).call(this)}_bindAttachment(Oe,He){Oe.href=this.linkService.getAnchorUrl(""),Oe.onclick=()=>{var $e;return($e=this.downloadManager)==null||$e.openOrDownloadData(this.container,He.content,He.filename),!1},Qe(this,pe,ti).call(this)}_bindJSAction(Oe,He){Oe.href=this.linkService.getAnchorUrl("");const $e=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const St of Object.keys(He.actions)){const $t=$e.get(St);$t&&(Oe[$t]=()=>{var Yt;return(Yt=this.linkService.eventBus)==null||Yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:He.id,name:St}}),!1})}Oe.onclick||(Oe.onclick=()=>!1),Qe(this,pe,ti).call(this)}_bindResetFormAction(Oe,He){const $e=Oe.onclick;if($e||(Oe.href=this.linkService.getAnchorUrl("")),Qe(this,pe,ti).call(this),!this._fieldObjects){(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),$e||(Oe.onclick=()=>!1);return}Oe.onclick=()=>{var De;$e==null||$e();const{fields:St,refs:$t,include:Yt}=He,_r=[];if(St.length!==0||$t.length!==0){const Re=new Set($t);for(const Ie of St){const Me=this._fieldObjects[Ie]||[];for(const{id:Ne}of Me)Re.add(Ne)}for(const Ie of Object.values(this._fieldObjects))for(const Me of Ie)Re.has(Me.id)===Yt&&_r.push(Me)}else for(const Re of Object.values(this._fieldObjects))_r.push(...Re);const sr=this.annotationStorage,ye=[];for(const Re of _r){const{id:Ie}=Re;switch(ye.push(Ie),Re.type){case"text":{const Ne=Re.defaultValue||"";sr.setValue(Ie,{value:Ne});break}case"checkbox":case"radiobutton":{const Ne=Re.defaultValue===Re.exportValues;sr.setValue(Ie,{value:Ne});break}case"combobox":case"listbox":{const Ne=Re.defaultValue||"";sr.setValue(Ie,{value:Ne});break}default:continue}const Me=document.querySelector(`[data-element-id="${Ie}"]`);if(Me){if(!f.has(Me)){(0,n.warn)(`_bindResetFormAction - element not allowed: ${Ie}`);continue}}else continue;Me.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((De=this.linkService.eventBus)==null||De.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:ye,name:"ResetForm"}})),!1}}}pe=new WeakSet,ti=function(){this.container.setAttribute("data-internal-link","")},bo=function(Oe,He){Oe.href=this.linkService.getAnchorUrl(""),Oe.onclick=()=>(this.linkService.executeSetOCGState(He),!1),Qe(this,pe,ti).call(this)};class _ extends g{constructor(ke){super(ke,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const ke=document.createElement("img");return ke.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",ke.alt="[{{type}} Annotation]",ke.dataset.l10nId="text_annotation_type",ke.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(ke),this.container}}class A extends g{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(ke){var Oe;this.data.hasOwnCanvas&&(((Oe=ke.previousSibling)==null?void 0:Oe.nodeName)==="CANVAS"&&(ke.previousSibling.hidden=!0),ke.hidden=!1)}_getKeyModifier(ke){const{isWin:Oe,isMac:He}=n.FeatureTest.platform;return Oe&&ke.ctrlKey||He&&ke.metaKey}_setEventListener(ke,Oe,He,$e,St){He.includes("mouse")?ke.addEventListener(He,$t=>{var Yt;(Yt=this.linkService.eventBus)==null||Yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:$e,value:St($t),shift:$t.shiftKey,modifier:this._getKeyModifier($t)}})}):ke.addEventListener(He,$t=>{var Yt;if(He==="blur"){if(!Oe.focused||!$t.relatedTarget)return;Oe.focused=!1}else if(He==="focus"){if(Oe.focused)return;Oe.focused=!0}St&&((Yt=this.linkService.eventBus)==null||Yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:$e,value:St($t)}}))})}_setEventListeners(ke,Oe,He,$e){var St,$t,Yt;for(const[_r,sr]of He)(sr==="Action"||(St=this.data.actions)!=null&&St[sr])&&((sr==="Focus"||sr==="Blur")&&(Oe||(Oe={focused:!1})),this._setEventListener(ke,Oe,_r,sr,$e),sr==="Focus"&&!(($t=this.data.actions)!=null&&$t.Blur)?this._setEventListener(ke,Oe,"blur","Blur",null):sr==="Blur"&&!((Yt=this.data.actions)!=null&&Yt.Focus)&&this._setEventListener(ke,Oe,"focus","Focus",null))}_setBackgroundColor(ke){const Oe=this.data.backgroundColor||null;ke.style.backgroundColor=Oe===null?"transparent":n.Util.makeHexColor(Oe[0],Oe[1],Oe[2])}_setTextStyle(ke){const Oe=["left","center","right"],{fontColor:He}=this.data.defaultAppearanceData,$e=this.data.defaultAppearanceData.fontSize||h,St=ke.style;let $t;const Yt=2,_r=sr=>Math.round(10*sr)/10;if(this.data.multiLine){const sr=Math.abs(this.data.rect[3]-this.data.rect[1]-Yt),ye=Math.round(sr/(n.LINE_FACTOR*$e))||1,De=sr/ye;$t=Math.min($e,_r(De/n.LINE_FACTOR))}else{const sr=Math.abs(this.data.rect[3]-this.data.rect[1]-Yt);$t=Math.min($e,_r(sr/n.LINE_FACTOR))}St.fontSize=`calc(${$t}px * var(--scale-factor))`,St.color=n.Util.makeHexColor(He[0],He[1],He[2]),this.data.textAlignment!==null&&(St.textAlign=Oe[this.data.textAlignment])}_setRequired(ke,Oe){Oe?ke.setAttribute("required",!0):ke.removeAttribute("required"),ke.setAttribute("aria-required",Oe)}}class H extends A{constructor(ke){const Oe=ke.renderForms||!ke.data.hasAppearance&&!!ke.data.fieldValue;super(ke,{isRenderable:Oe})}setPropertyOnSiblings(ke,Oe,He,$e){const St=this.annotationStorage;for(const $t of this._getElementsByName(ke.name,ke.id))$t.domElement&&($t.domElement[Oe]=He),St.setValue($t.id,{[$e]:He})}render(){var $e,St;const ke=this.annotationStorage,Oe=this.data.id;this.container.classList.add("textWidgetAnnotation");let He=null;if(this.renderForms){const $t=ke.getValue(Oe,{value:this.data.fieldValue});let Yt=$t.value||"";const _r=ke.getValue(Oe,{charLimit:this.data.maxLen}).charLimit;_r&&Yt.length>_r&&(Yt=Yt.slice(0,_r));let sr=$t.formattedValue||(($e=this.data.textContent)==null?void 0:$e.join(`
`))||null;sr&&this.data.comb&&(sr=sr.replaceAll(/\s+/g,""));const ye={userValue:Yt,formattedValue:sr,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(He=document.createElement("textarea"),He.textContent=sr!=null?sr:Yt,this.data.doNotScroll&&(He.style.overflowY="hidden")):(He=document.createElement("input"),He.type="text",He.setAttribute("value",sr!=null?sr:Yt),this.data.doNotScroll&&(He.style.overflowX="hidden")),this.data.hasOwnCanvas&&(He.hidden=!0),f.add(He),He.setAttribute("data-element-id",Oe),He.disabled=this.data.readOnly,He.name=this.data.fieldName,He.tabIndex=u,this._setRequired(He,this.data.required),_r&&(He.maxLength=_r),He.addEventListener("input",Re=>{ke.setValue(Oe,{value:Re.target.value}),this.setPropertyOnSiblings(He,"value",Re.target.value,"value"),ye.formattedValue=null}),He.addEventListener("resetform",Re=>{var Me;const Ie=(Me=this.data.defaultFieldValue)!=null?Me:"";He.value=ye.userValue=Ie,ye.formattedValue=null});let De=Re=>{const{formattedValue:Ie}=ye;Ie!=null&&(Re.target.value=Ie),Re.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){He.addEventListener("focus",Ie=>{if(ye.focused)return;const{target:Me}=Ie;ye.userValue&&(Me.value=ye.userValue),ye.lastCommittedValue=Me.value,ye.commitKey=1,ye.focused=!0}),He.addEventListener("updatefromsandbox",Ie=>{this.showElementAndHideCanvas(Ie.target);const Me={value(Ne){var et;ye.userValue=(et=Ne.detail.value)!=null?et:"",ke.setValue(Oe,{value:ye.userValue.toString()}),Ne.target.value=ye.userValue},formattedValue(Ne){const{formattedValue:et}=Ne.detail;ye.formattedValue=et,et!=null&&Ne.target!==document.activeElement&&(Ne.target.value=et),ke.setValue(Oe,{formattedValue:et})},selRange(Ne){Ne.target.setSelectionRange(...Ne.detail.selRange)},charLimit:Ne=>{var Tt;const{charLimit:et}=Ne.detail,{target:kt}=Ne;if(et===0){kt.removeAttribute("maxLength");return}kt.setAttribute("maxLength",et);let Rt=ye.userValue;!Rt||Rt.length<=et||(Rt=Rt.slice(0,et),kt.value=ye.userValue=Rt,ke.setValue(Oe,{value:Rt}),(Tt=this.linkService.eventBus)==null||Tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Oe,name:"Keystroke",value:Rt,willCommit:!0,commitKey:1,selStart:kt.selectionStart,selEnd:kt.selectionEnd}}))}};this._dispatchEventFromSandbox(Me,Ie)}),He.addEventListener("keydown",Ie=>{var et;ye.commitKey=1;let Me=-1;if(Ie.key==="Escape"?Me=0:Ie.key==="Enter"&&!this.data.multiLine?Me=2:Ie.key==="Tab"&&(ye.commitKey=3),Me===-1)return;const{value:Ne}=Ie.target;ye.lastCommittedValue!==Ne&&(ye.lastCommittedValue=Ne,ye.userValue=Ne,(et=this.linkService.eventBus)==null||et.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Oe,name:"Keystroke",value:Ne,willCommit:!0,commitKey:Me,selStart:Ie.target.selectionStart,selEnd:Ie.target.selectionEnd}}))});const Re=De;De=null,He.addEventListener("blur",Ie=>{var Ne;if(!ye.focused||!Ie.relatedTarget)return;ye.focused=!1;const{value:Me}=Ie.target;ye.userValue=Me,ye.lastCommittedValue!==Me&&((Ne=this.linkService.eventBus)==null||Ne.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Oe,name:"Keystroke",value:Me,willCommit:!0,commitKey:ye.commitKey,selStart:Ie.target.selectionStart,selEnd:Ie.target.selectionEnd}})),Re(Ie)}),(St=this.data.actions)!=null&&St.Keystroke&&He.addEventListener("beforeinput",Ie=>{var ur;ye.lastCommittedValue=null;const{data:Me,target:Ne}=Ie,{value:et,selectionStart:kt,selectionEnd:Rt}=Ne;let Tt=kt,Ut=Rt;switch(Ie.inputType){case"deleteWordBackward":{const fr=et.substring(0,kt).match(/\w*[^\w]*$/);fr&&(Tt-=fr[0].length);break}case"deleteWordForward":{const fr=et.substring(kt).match(/^[^\w]*\w*/);fr&&(Ut+=fr[0].length);break}case"deleteContentBackward":kt===Rt&&(Tt-=1);break;case"deleteContentForward":kt===Rt&&(Ut+=1);break}Ie.preventDefault(),(ur=this.linkService.eventBus)==null||ur.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Oe,name:"Keystroke",value:et,change:Me||"",willCommit:!1,selStart:Tt,selEnd:Ut}})}),this._setEventListeners(He,ye,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Ie=>Ie.target.value)}if(De&&He.addEventListener("blur",De),this.data.comb){const Ie=(this.data.rect[2]-this.data.rect[0])/_r;He.classList.add("comb"),He.style.letterSpacing=`calc(${Ie}px * var(--scale-factor) - 1ch)`}}else He=document.createElement("div"),He.textContent=this.data.fieldValue,He.style.verticalAlign="middle",He.style.display="table-cell";return this._setTextStyle(He),this._setBackgroundColor(He),this._setDefaultPropertiesFromJS(He),this.container.append(He),this.container}}class te extends A{constructor(ke){super(ke,{isRenderable:!!ke.data.hasOwnCanvas})}}class ne extends A{constructor(ke){super(ke,{isRenderable:ke.renderForms})}render(){const ke=this.annotationStorage,Oe=this.data,He=Oe.id;let $e=ke.getValue(He,{value:Oe.exportValue===Oe.fieldValue}).value;typeof $e=="string"&&($e=$e!=="Off",ke.setValue(He,{value:$e})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const St=document.createElement("input");return f.add(St),St.setAttribute("data-element-id",He),St.disabled=Oe.readOnly,this._setRequired(St,this.data.required),St.type="checkbox",St.name=Oe.fieldName,$e&&St.setAttribute("checked",!0),St.setAttribute("exportValue",Oe.exportValue),St.tabIndex=u,St.addEventListener("change",$t=>{const{name:Yt,checked:_r}=$t.target;for(const sr of this._getElementsByName(Yt,He)){const ye=_r&&sr.exportValue===Oe.exportValue;sr.domElement&&(sr.domElement.checked=ye),ke.setValue(sr.id,{value:ye})}ke.setValue(He,{value:_r})}),St.addEventListener("resetform",$t=>{const Yt=Oe.defaultFieldValue||"Off";$t.target.checked=Yt===Oe.exportValue}),this.enableScripting&&this.hasJSActions&&(St.addEventListener("updatefromsandbox",$t=>{const Yt={value(_r){_r.target.checked=_r.detail.value!=="Off",ke.setValue(He,{value:_r.target.checked})}};this._dispatchEventFromSandbox(Yt,$t)}),this._setEventListeners(St,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],$t=>$t.target.checked)),this._setBackgroundColor(St),this._setDefaultPropertiesFromJS(St),this.container.append(St),this.container}}class j extends A{constructor(ke){super(ke,{isRenderable:ke.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const ke=this.annotationStorage,Oe=this.data,He=Oe.id;let $e=ke.getValue(He,{value:Oe.fieldValue===Oe.buttonValue}).value;typeof $e=="string"&&($e=$e!==Oe.buttonValue,ke.setValue(He,{value:$e}));const St=document.createElement("input");if(f.add(St),St.setAttribute("data-element-id",He),St.disabled=Oe.readOnly,this._setRequired(St,this.data.required),St.type="radio",St.name=Oe.fieldName,$e&&St.setAttribute("checked",!0),St.tabIndex=u,St.addEventListener("change",$t=>{const{name:Yt,checked:_r}=$t.target;for(const sr of this._getElementsByName(Yt,He))ke.setValue(sr.id,{value:!1});ke.setValue(He,{value:_r})}),St.addEventListener("resetform",$t=>{const Yt=Oe.defaultFieldValue;$t.target.checked=Yt!=null&&Yt===Oe.buttonValue}),this.enableScripting&&this.hasJSActions){const $t=Oe.buttonValue;St.addEventListener("updatefromsandbox",Yt=>{const _r={value:sr=>{const ye=$t===sr.detail.value;for(const De of this._getElementsByName(sr.target.name)){const Re=ye&&De.id===He;De.domElement&&(De.domElement.checked=Re),ke.setValue(De.id,{value:Re})}}};this._dispatchEventFromSandbox(_r,Yt)}),this._setEventListeners(St,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Yt=>Yt.target.checked)}return this._setBackgroundColor(St),this._setDefaultPropertiesFromJS(St),this.container.append(St),this.container}}class ee extends p{constructor(ke){super(ke,{ignoreBorder:ke.data.hasAppearance})}render(){const ke=super.render();ke.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(ke.title=this.data.alternativeText);const Oe=ke.lastChild;return this.enableScripting&&this.hasJSActions&&Oe&&(this._setDefaultPropertiesFromJS(Oe),Oe.addEventListener("updatefromsandbox",He=>{this._dispatchEventFromSandbox({},He)})),ke}}class x extends A{constructor(ke){super(ke,{isRenderable:ke.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const ke=this.annotationStorage,Oe=this.data.id,He=ke.getValue(Oe,{value:this.data.fieldValue}),$e=document.createElement("select");f.add($e),$e.setAttribute("data-element-id",Oe),$e.disabled=this.data.readOnly,this._setRequired($e,this.data.required),$e.name=this.data.fieldName,$e.tabIndex=u;let St=this.data.combo&&this.data.options.length>0;this.data.combo||($e.size=this.data.options.length,this.data.multiSelect&&($e.multiple=!0)),$e.addEventListener("resetform",ye=>{const De=this.data.defaultFieldValue;for(const Re of $e.options)Re.selected=Re.value===De});for(const ye of this.data.options){const De=document.createElement("option");De.textContent=ye.displayValue,De.value=ye.exportValue,He.value.includes(ye.exportValue)&&(De.setAttribute("selected",!0),St=!1),$e.append(De)}let $t=null;if(St){const ye=document.createElement("option");ye.value=" ",ye.setAttribute("hidden",!0),ye.setAttribute("selected",!0),$e.prepend(ye),$t=()=>{ye.remove(),$e.removeEventListener("input",$t),$t=null},$e.addEventListener("input",$t)}const Yt=ye=>{const De=ye?"value":"textContent",{options:Re,multiple:Ie}=$e;return Ie?Array.prototype.filter.call(Re,Me=>Me.selected).map(Me=>Me[De]):Re.selectedIndex===-1?null:Re[Re.selectedIndex][De]};let _r=Yt(!1);const sr=ye=>{const De=ye.target.options;return Array.prototype.map.call(De,Re=>({displayValue:Re.textContent,exportValue:Re.value}))};return this.enableScripting&&this.hasJSActions?($e.addEventListener("updatefromsandbox",ye=>{const De={value(Re){$t==null||$t();const Ie=Re.detail.value,Me=new Set(Array.isArray(Ie)?Ie:[Ie]);for(const Ne of $e.options)Ne.selected=Me.has(Ne.value);ke.setValue(Oe,{value:Yt(!0)}),_r=Yt(!1)},multipleSelection(Re){$e.multiple=!0},remove(Re){const Ie=$e.options,Me=Re.detail.remove;Ie[Me].selected=!1,$e.remove(Me),Ie.length>0&&Array.prototype.findIndex.call(Ie,et=>et.selected)===-1&&(Ie[0].selected=!0),ke.setValue(Oe,{value:Yt(!0),items:sr(Re)}),_r=Yt(!1)},clear(Re){for(;$e.length!==0;)$e.remove(0);ke.setValue(Oe,{value:null,items:[]}),_r=Yt(!1)},insert(Re){const{index:Ie,displayValue:Me,exportValue:Ne}=Re.detail.insert,et=$e.children[Ie],kt=document.createElement("option");kt.textContent=Me,kt.value=Ne,et?et.before(kt):$e.append(kt),ke.setValue(Oe,{value:Yt(!0),items:sr(Re)}),_r=Yt(!1)},items(Re){const{items:Ie}=Re.detail;for(;$e.length!==0;)$e.remove(0);for(const Me of Ie){const{displayValue:Ne,exportValue:et}=Me,kt=document.createElement("option");kt.textContent=Ne,kt.value=et,$e.append(kt)}$e.options.length>0&&($e.options[0].selected=!0),ke.setValue(Oe,{value:Yt(!0),items:sr(Re)}),_r=Yt(!1)},indices(Re){const Ie=new Set(Re.detail.indices);for(const Me of Re.target.options)Me.selected=Ie.has(Me.index);ke.setValue(Oe,{value:Yt(!0)}),_r=Yt(!1)},editable(Re){Re.target.disabled=!Re.detail.editable}};this._dispatchEventFromSandbox(De,ye)}),$e.addEventListener("input",ye=>{var Re;const De=Yt(!0);ke.setValue(Oe,{value:De}),ye.preventDefault(),(Re=this.linkService.eventBus)==null||Re.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Oe,name:"Keystroke",value:_r,changeEx:De,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners($e,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],ye=>ye.target.value)):$e.addEventListener("input",function(ye){ke.setValue(Oe,{value:Yt(!0)})}),this.data.combo&&this._setTextStyle($e),this._setBackgroundColor($e),this._setDefaultPropertiesFromJS($e),this.container.append($e),this.container}}class M extends g{constructor(ke){const{data:Oe,elements:He}=ke;super(ke,{isRenderable:g._hasPopupData(Oe)}),this.elements=He}render(){this.container.classList.add("popupAnnotation");const ke=new T({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),Oe=[];for(const He of this.elements)He.popup=ke,Oe.push(He.data.id),He.addHighlightArea();return this.container.setAttribute("aria-controls",Oe.map(He=>`${n.AnnotationPrefix}${He}`).join(",")),this.container}}class T{constructor(ke){ct(this,nr);ct(this,be,null);ct(this,je,Qe(this,nr,So).bind(this));ct(this,Se,Qe(this,nr,_a).bind(this));ct(this,Xe,Qe(this,nr,ga).bind(this));ct(this,qe,Qe(this,nr,Rs).bind(this));ct(this,Je,null);ct(this,We,null);ct(this,Ue,null);ct(this,Ce,null);ct(this,Le,null);ct(this,Ve,null);ct(this,Ge,!1);ct(this,ut,null);ct(this,Jt,null);ct(this,Kt,null);ct(this,Ze,null);ct(this,tr,!1);var Me;let{container:Oe,color:He,elements:$e,titleObj:St,modificationDate:$t,contentsObj:Yt,richText:_r,parent:sr,rect:ye,parentRect:De,open:Re}=ke;ft(this,We,Oe),ft(this,Ze,St),ft(this,Ue,Yt),ft(this,Kt,_r),ft(this,Le,sr),ft(this,Je,He),ft(this,Jt,ye),ft(this,Ve,De),ft(this,Ce,$e);const Ie=i.PDFDateString.toDateObject($t);Ie&&ft(this,be,sr.l10n.get("annotation_date_string",{date:Ie.toLocaleDateString(),time:Ie.toLocaleTimeString()})),this.trigger=$e.flatMap(Ne=>Ne.getElementsToTriggerPopup());for(const Ne of this.trigger)Ne.addEventListener("click",de(this,qe)),Ne.addEventListener("mouseenter",de(this,Xe)),Ne.addEventListener("mouseleave",de(this,Se)),Ne.classList.add("popupTriggerArea");for(const Ne of $e)(Me=Ne.container)==null||Me.addEventListener("keydown",de(this,je));de(this,We).hidden=!0,Re&&Qe(this,nr,Rs).call(this)}render(){if(de(this,ut))return;const{page:{view:ke},viewport:{rawDims:{pageWidth:Oe,pageHeight:He,pageX:$e,pageY:St}}}=de(this,Le),$t=ft(this,ut,document.createElement("div"));if($t.className="popup",de(this,Je)){const Tt=$t.style.outlineColor=n.Util.makeHexColor(...de(this,Je));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?$t.style.backgroundColor=`color-mix(in srgb, ${Tt} 30%, white)`:$t.style.backgroundColor=n.Util.makeHexColor(...de(this,Je).map(ur=>Math.floor(.7*(255-ur)+ur)))}const Yt=document.createElement("span");Yt.className="header";const _r=document.createElement("h1");if(Yt.append(_r),{dir:_r.dir,str:_r.textContent}=de(this,Ze),$t.append(Yt),de(this,be)){const Tt=document.createElement("span");Tt.classList.add("popupDate"),de(this,be).then(Ut=>{Tt.textContent=Ut}),Yt.append(Tt)}const sr=de(this,Ue),ye=de(this,Kt);if(ye!=null&&ye.str&&(!(sr!=null&&sr.str)||sr.str===ye.str))c.XfaLayer.render({xfaHtml:ye.html,intent:"richText",div:$t}),$t.lastChild.classList.add("richText","popupContent");else{const Tt=this._formatContents(sr);$t.append(Tt)}let De=!!de(this,Ve),Re=De?de(this,Ve):de(this,Jt);for(const Tt of de(this,Ce))if(!Re||n.Util.intersect(Tt.data.rect,Re)!==null){Re=Tt.data.rect,De=!0;break}const Ie=n.Util.normalizeRect([Re[0],ke[3]-Re[1]+ke[1],Re[2],ke[3]-Re[3]+ke[1]]),Ne=De?Re[2]-Re[0]+5:0,et=Ie[0]+Ne,kt=Ie[1],{style:Rt}=de(this,We);Rt.left=`${100*(et-$e)/Oe}%`,Rt.top=`${100*(kt-St)/He}%`,de(this,We).append($t)}_formatContents(ke){let{str:Oe,dir:He}=ke;const $e=document.createElement("p");$e.classList.add("popupContent"),$e.dir=He;const St=Oe.split(/(?:\r\n?|\n)/);for(let $t=0,Yt=St.length;$t<Yt;++$t){const _r=St[$t];$e.append(document.createTextNode(_r)),$t<Yt-1&&$e.append(document.createElement("br"))}return $e}forceHide(){ft(this,tr,this.isVisible),de(this,tr)&&(de(this,We).hidden=!0)}maybeShow(){de(this,tr)&&(ft(this,tr,!1),de(this,We).hidden=!1)}get isVisible(){return de(this,We).hidden===!1}}be=new WeakMap,je=new WeakMap,Se=new WeakMap,Xe=new WeakMap,qe=new WeakMap,Je=new WeakMap,We=new WeakMap,Ue=new WeakMap,Ce=new WeakMap,Le=new WeakMap,Ve=new WeakMap,Ge=new WeakMap,ut=new WeakMap,Jt=new WeakMap,Kt=new WeakMap,Ze=new WeakMap,tr=new WeakMap,nr=new WeakSet,So=function(ke){ke.altKey||ke.shiftKey||ke.ctrlKey||ke.metaKey||(ke.key==="Enter"||ke.key==="Escape"&&de(this,Ge))&&Qe(this,nr,Rs).call(this)},Rs=function(){ft(this,Ge,!de(this,Ge)),de(this,Ge)?(Qe(this,nr,ga).call(this),de(this,We).addEventListener("click",de(this,qe)),de(this,We).addEventListener("keydown",de(this,je))):(Qe(this,nr,_a).call(this),de(this,We).removeEventListener("click",de(this,qe)),de(this,We).removeEventListener("keydown",de(this,je)))},ga=function(){de(this,ut)||this.render(),this.isVisible?de(this,Ge)&&de(this,We).classList.add("focused"):(de(this,We).hidden=!1,de(this,We).style.zIndex=parseInt(de(this,We).style.zIndex)+1e3)},_a=function(){de(this,We).classList.remove("focused"),!(de(this,Ge)||!this.isVisible)&&(de(this,We).hidden=!0,de(this,We).style.zIndex=parseInt(de(this,We).style.zIndex)-1e3)};class O extends g{constructor(ke){super(ke,{isRenderable:!0,ignoreBorder:!0}),this.textContent=ke.data.textContent,this.textPosition=ke.data.textPosition,this.annotationEditorType=n.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const ke=document.createElement("div");ke.classList.add("annotationTextContent"),ke.setAttribute("role","comment");for(const Oe of this.textContent){const He=document.createElement("span");He.textContent=Oe,ke.append(He)}this.container.append(ke)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}e.FreeTextAnnotationElement=O;class R extends g{constructor(Oe){super(Oe,{isRenderable:!0,ignoreBorder:!0});ct(this,mr,null)}render(){this.container.classList.add("lineAnnotation");const Oe=this.data,{width:He,height:$e}=m(Oe.rect),St=this.svgFactory.create(He,$e,!0),$t=ft(this,mr,this.svgFactory.createElement("svg:line"));return $t.setAttribute("x1",Oe.rect[2]-Oe.lineCoordinates[0]),$t.setAttribute("y1",Oe.rect[3]-Oe.lineCoordinates[1]),$t.setAttribute("x2",Oe.rect[2]-Oe.lineCoordinates[2]),$t.setAttribute("y2",Oe.rect[3]-Oe.lineCoordinates[3]),$t.setAttribute("stroke-width",Oe.borderStyle.width||1),$t.setAttribute("stroke","transparent"),$t.setAttribute("fill","transparent"),St.append($t),this.container.append(St),!Oe.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return de(this,mr)}addHighlightArea(){this.container.classList.add("highlightArea")}}mr=new WeakMap;class Y extends g{constructor(Oe){super(Oe,{isRenderable:!0,ignoreBorder:!0});ct(this,wr,null)}render(){this.container.classList.add("squareAnnotation");const Oe=this.data,{width:He,height:$e}=m(Oe.rect),St=this.svgFactory.create(He,$e,!0),$t=Oe.borderStyle.width,Yt=ft(this,wr,this.svgFactory.createElement("svg:rect"));return Yt.setAttribute("x",$t/2),Yt.setAttribute("y",$t/2),Yt.setAttribute("width",He-$t),Yt.setAttribute("height",$e-$t),Yt.setAttribute("stroke-width",$t||1),Yt.setAttribute("stroke","transparent"),Yt.setAttribute("fill","transparent"),St.append(Yt),this.container.append(St),!Oe.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return de(this,wr)}addHighlightArea(){this.container.classList.add("highlightArea")}}wr=new WeakMap;class q extends g{constructor(Oe){super(Oe,{isRenderable:!0,ignoreBorder:!0});ct(this,Cr,null)}render(){this.container.classList.add("circleAnnotation");const Oe=this.data,{width:He,height:$e}=m(Oe.rect),St=this.svgFactory.create(He,$e,!0),$t=Oe.borderStyle.width,Yt=ft(this,Cr,this.svgFactory.createElement("svg:ellipse"));return Yt.setAttribute("cx",He/2),Yt.setAttribute("cy",$e/2),Yt.setAttribute("rx",He/2-$t/2),Yt.setAttribute("ry",$e/2-$t/2),Yt.setAttribute("stroke-width",$t||1),Yt.setAttribute("stroke","transparent"),Yt.setAttribute("fill","transparent"),St.append(Yt),this.container.append(St),!Oe.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return de(this,Cr)}addHighlightArea(){this.container.classList.add("highlightArea")}}Cr=new WeakMap;class me extends g{constructor(Oe){super(Oe,{isRenderable:!0,ignoreBorder:!0});ct(this,Rr,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const Oe=this.data,{width:He,height:$e}=m(Oe.rect),St=this.svgFactory.create(He,$e,!0);let $t=[];for(const _r of Oe.vertices){const sr=_r.x-Oe.rect[0],ye=Oe.rect[3]-_r.y;$t.push(sr+","+ye)}$t=$t.join(" ");const Yt=ft(this,Rr,this.svgFactory.createElement(this.svgElementName));return Yt.setAttribute("points",$t),Yt.setAttribute("stroke-width",Oe.borderStyle.width||1),Yt.setAttribute("stroke","transparent"),Yt.setAttribute("fill","transparent"),St.append(Yt),this.container.append(St),!Oe.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return de(this,Rr)}addHighlightArea(){this.container.classList.add("highlightArea")}}Rr=new WeakMap;class xe extends me{constructor(ke){super(ke),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Ee extends g{constructor(ke){super(ke,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class se extends g{constructor(Oe){super(Oe,{isRenderable:!0,ignoreBorder:!0});ct(this,ar,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=n.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const Oe=this.data,{width:He,height:$e}=m(Oe.rect),St=this.svgFactory.create(He,$e,!0);for(const $t of Oe.inkLists){let Yt=[];for(const sr of $t){const ye=sr.x-Oe.rect[0],De=Oe.rect[3]-sr.y;Yt.push(`${ye},${De}`)}Yt=Yt.join(" ");const _r=this.svgFactory.createElement(this.svgElementName);de(this,ar).push(_r),_r.setAttribute("points",Yt),_r.setAttribute("stroke-width",Oe.borderStyle.width||1),_r.setAttribute("stroke","transparent"),_r.setAttribute("fill","transparent"),!Oe.popupRef&&this.hasPopupData&&this._createPopup(),St.append(_r)}return this.container.append(St),this.container}getElementsToTriggerPopup(){return de(this,ar)}addHighlightArea(){this.container.classList.add("highlightArea")}}ar=new WeakMap,e.InkAnnotationElement=se;class Fe extends g{constructor(ke){super(ke,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class ue extends g{constructor(ke){super(ke,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class ae extends g{constructor(ke){super(ke,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class _e extends g{constructor(ke){super(ke,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class oe extends g{constructor(ke){super(ke,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}e.StampAnnotationElement=oe;class ie extends g{constructor(Oe){var St;super(Oe,{isRenderable:!0});ct(this,ot);ct(this,it,null);const{filename:He,content:$e}=this.data.file;this.filename=(0,i.getFilenameFromUrl)(He,!0),this.content=$e,(St=this.linkService.eventBus)==null||St.dispatch("fileattachmentannotation",{source:this,filename:He,content:$e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:Oe,data:He}=this;let $e;He.hasAppearance||He.fillAlpha===0?$e=document.createElement("div"):($e=document.createElement("img"),$e.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(He.name)?"paperclip":"pushpin"}.svg`,He.fillAlpha&&He.fillAlpha<1&&($e.style=`filter: opacity(${Math.round(He.fillAlpha*100)}%);`)),$e.addEventListener("dblclick",Qe(this,ot,va).bind(this)),ft(this,it,$e);const{isMac:St}=n.FeatureTest.platform;return Oe.addEventListener("keydown",$t=>{$t.key==="Enter"&&(St?$t.metaKey:$t.ctrlKey)&&Qe(this,ot,va).call(this)}),!He.popupRef&&this.hasPopupData?this._createPopup():$e.classList.add("popupTriggerArea"),Oe.append($e),Oe}getElementsToTriggerPopup(){return de(this,it)}addHighlightArea(){this.container.classList.add("highlightArea")}}it=new WeakMap,ot=new WeakSet,va=function(){var Oe;(Oe=this.downloadManager)==null||Oe.openOrDownloadData(this.container,this.content,this.filename)};class re{constructor(ke){ct(this,zt);ct(this,Tr,null);ct(this,Te,null);ct(this,ze,new Map);let{div:Oe,accessibilityManager:He,annotationCanvasMap:$e,l10n:St,page:$t,viewport:Yt}=ke;this.div=Oe,ft(this,Tr,He),ft(this,Te,$e),this.l10n=St,this.page=$t,this.viewport=Yt,this.zIndex=0,this.l10n||(this.l10n=o.NullL10n)}render(ke){return Ye(this,null,function*(){const{annotations:Oe}=ke,He=this.div;(0,i.setLayerDimensions)(He,this.viewport);const $e=new Map,St={data:null,layer:He,linkService:ke.linkService,downloadManager:ke.downloadManager,imageResourcesPath:ke.imageResourcesPath||"",renderForms:ke.renderForms!==!1,svgFactory:new i.DOMSVGFactory,annotationStorage:ke.annotationStorage||new s.AnnotationStorage,enableScripting:ke.enableScripting===!0,hasJSActions:ke.hasJSActions,fieldObjects:ke.fieldObjects,parent:this,elements:null};for(const $t of Oe){if($t.noHTML)continue;const Yt=$t.annotationType===n.AnnotationType.POPUP;if(Yt){const ye=$e.get($t.id);if(!ye)continue;St.elements=ye}else{const{width:ye,height:De}=m($t.rect);if(ye<=0||De<=0)continue}St.data=$t;const _r=E.create(St);if(!_r.isRenderable)continue;if(!Yt&&$t.popupRef){const ye=$e.get($t.popupRef);ye?ye.push(_r):$e.set($t.popupRef,[_r])}_r.annotationEditorType>0&&de(this,ze).set(_r.data.id,_r);const sr=_r.render();$t.hidden&&(sr.style.visibility="hidden"),Qe(this,zt,To).call(this,sr,$t.id)}Qe(this,zt,xa).call(this),yield this.l10n.translate(He)})}update(ke){let{viewport:Oe}=ke;const He=this.div;this.viewport=Oe,(0,i.setLayerDimensions)(He,{rotation:Oe.rotation}),Qe(this,zt,xa).call(this),He.hidden=!1}getEditableAnnotations(){return Array.from(de(this,ze).values())}getEditableAnnotation(ke){return de(this,ze).get(ke)}}Tr=new WeakMap,Te=new WeakMap,ze=new WeakMap,zt=new WeakSet,To=function(ke,Oe){var $e;const He=ke.firstChild||ke;He.id=`${n.AnnotationPrefix}${Oe}`,this.div.append(ke),($e=de(this,Tr))==null||$e.moveElementInDOM(this.div,ke,He,!1)},xa=function(){if(!de(this,Te))return;const ke=this.div;for(const[Oe,He]of de(this,Te)){const $e=ke.querySelector(`[data-annotation-id="${Oe}"]`);if(!$e)continue;const{firstChild:St}=$e;St?St.nodeName==="CANVAS"?St.replaceWith(He):St.before(He):$e.append(He)}de(this,Te).clear()},e.AnnotationLayer=re},(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function r(s){return Math.floor(Math.max(0,Math.min(1,s))*255).toString(16).padStart(2,"0")}function n(s){return Math.max(0,Math.min(255,255*s))}class i{static CMYK_G(a){let[o,c,u,h]=a;return["G",1-Math.min(1,.3*o+.59*u+.11*c+h)]}static G_CMYK(a){let[o]=a;return["CMYK",0,0,0,1-o]}static G_RGB(a){let[o]=a;return["RGB",o,o,o]}static G_rgb(a){let[o]=a;return o=n(o),[o,o,o]}static G_HTML(a){let[o]=a;const c=r(o);return`#${c}${c}${c}`}static RGB_G(a){let[o,c,u]=a;return["G",.3*o+.59*c+.11*u]}static RGB_rgb(a){return a.map(n)}static RGB_HTML(a){return`#${a.map(r).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB(a){let[o,c,u,h]=a;return["RGB",1-Math.min(1,o+h),1-Math.min(1,u+h),1-Math.min(1,c+h)]}static CMYK_rgb(a){let[o,c,u,h]=a;return[n(1-Math.min(1,o+h)),n(1-Math.min(1,u+h)),n(1-Math.min(1,c+h))]}static CMYK_HTML(a){const o=this.CMYK_RGB(a).slice(1);return this.RGB_HTML(o)}static RGB_CMYK(a){let[o,c,u]=a;const h=1-o,f=1-c,m=1-u,E=Math.min(h,f,m);return["CMYK",h,f,m,E]}}e.ColorConverters=i},(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullL10n=void 0,e.getL10nFallback=n;const r={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} Ã— {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} Ã— {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typingâ€¦",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};r.print_progress_percent="{{progress}}%";function n(o,c){switch(o){case"find_match_count":o=`find_match_count[${c.total===1?"one":"other"}]`;break;case"find_match_count_limit":o=`find_match_count_limit[${c.limit===1?"one":"other"}]`;break}return r[o]||""}function i(o,c){return c?o.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(u,h)=>h in c?c[h]:"{{"+h+"}}"):o}const s={getLanguage(){return Ye(this,null,function*(){return"en-us"})},getDirection(){return Ye(this,null,function*(){return"ltr"})},get(c){return Ye(this,arguments,function*(o){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n(o,u);return i(h,u)})},translate(o){return Ye(this,null,function*(){})}};e.NullL10n=s},(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0,r(89);var n=r(194);class i{static setupStorage(a,o,c,u,h){const f=u.getValue(o,{value:null});switch(c.name){case"textarea":if(f.value!==null&&(a.textContent=f.value),h==="print")break;a.addEventListener("input",m=>{u.setValue(o,{value:m.target.value})});break;case"input":if(c.attributes.type==="radio"||c.attributes.type==="checkbox"){if(f.value===c.attributes.xfaOn?a.setAttribute("checked",!0):f.value===c.attributes.xfaOff&&a.removeAttribute("checked"),h==="print")break;a.addEventListener("change",m=>{u.setValue(o,{value:m.target.checked?m.target.getAttribute("xfaOn"):m.target.getAttribute("xfaOff")})})}else{if(f.value!==null&&a.setAttribute("value",f.value),h==="print")break;a.addEventListener("input",m=>{u.setValue(o,{value:m.target.value})})}break;case"select":if(f.value!==null){a.setAttribute("value",f.value);for(const m of c.children)m.attributes.value===f.value?m.attributes.selected=!0:m.attributes.hasOwnProperty("selected")&&delete m.attributes.selected}a.addEventListener("input",m=>{const E=m.target.options,g=E.selectedIndex===-1?"":E[E.selectedIndex].value;u.setValue(o,{value:g})});break}}static setAttributes(a){let{html:o,element:c,storage:u=null,intent:h,linkService:f}=a;const{attributes:m}=c,E=o instanceof HTMLAnchorElement;m.type==="radio"&&(m.name=`${m.name}-${h}`);for(const[g,p]of Object.entries(m))if(p!=null)switch(g){case"class":p.length&&o.setAttribute(g,p.join(" "));break;case"dataId":break;case"id":o.setAttribute("data-element-id",p);break;case"style":Object.assign(o.style,p);break;case"textContent":o.textContent=p;break;default:(!E||g!=="href"&&g!=="newWindow")&&o.setAttribute(g,p)}E&&f.addLinkAttributes(o,m.href,m.newWindow),u&&m.dataId&&this.setupStorage(o,m.dataId,c,u)}static render(a){var p;const o=a.annotationStorage,c=a.linkService,u=a.xfaHtml,h=a.intent||"display",f=document.createElement(u.name);u.attributes&&this.setAttributes({html:f,element:u,intent:h,linkService:c});const m=[[u,-1,f]],E=a.div;if(E.append(f),a.viewport){const _=`matrix(${a.viewport.transform.join(",")})`;E.style.transform=_}h!=="richText"&&E.setAttribute("class","xfaLayer xfaFont");const g=[];for(;m.length>0;){const[_,A,H]=m.at(-1);if(A+1===_.children.length){m.pop();continue}const te=_.children[++m.at(-1)[1]];if(te===null)continue;const{name:ne}=te;if(ne==="#text"){const ee=document.createTextNode(te.value);g.push(ee),H.append(ee);continue}const j=(p=te==null?void 0:te.attributes)!=null&&p.xmlns?document.createElementNS(te.attributes.xmlns,ne):document.createElement(ne);if(H.append(j),te.attributes&&this.setAttributes({html:j,element:te,storage:o,intent:h,linkService:c}),te.children&&te.children.length>0)m.push([te,-1,j]);else if(te.value){const ee=document.createTextNode(te.value);n.XfaText.shouldBuildText(ne)&&g.push(ee),j.append(ee)}}for(const _ of E.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))_.setAttribute("readOnly",!0);return{textDivs:g}}static update(a){const o=`matrix(${a.viewport.transform.join(",")})`;a.div.style.transform=o,a.div.hidden=!1}}e.XfaLayer=i},(t,e,r)=>{var u,h,f,m,E,g,p,_,A,H,te,ne,j,ee,x,Ao,Co,Ro,ko,ya,Io,Ea,Po,Oo,Fo,Lo,Do,Wn,wa,ks,Is,bi,ba,Ps,pe,Mo,Sa,No,Bo,Ta,Os,Si;Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0,r(89),r(2);var n=r(1),i=r(164),s=r(198),a=r(168),o=r(165);const Je=class Je extends i.AnnotationEditor{constructor(Ce){super(Br(Er({},Ce),{name:"inkEditor"}));ct(this,x);ct(this,u,0);ct(this,h,0);ct(this,f,this.canvasPointermove.bind(this));ct(this,m,this.canvasPointerleave.bind(this));ct(this,E,this.canvasPointerup.bind(this));ct(this,g,this.canvasPointerdown.bind(this));ct(this,p,new Path2D);ct(this,_,!1);ct(this,A,!1);ct(this,H,!1);ct(this,te,null);ct(this,ne,0);ct(this,j,0);ct(this,ee,null);this.color=Ce.color||null,this.thickness=Ce.thickness||null,this.opacity=Ce.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(Ce){i.AnnotationEditor.initialize(Ce,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(Ce,Le){switch(Ce){case n.AnnotationEditorParamsType.INK_THICKNESS:Je._defaultThickness=Le;break;case n.AnnotationEditorParamsType.INK_COLOR:Je._defaultColor=Le;break;case n.AnnotationEditorParamsType.INK_OPACITY:Je._defaultOpacity=Le/100;break}}updateParams(Ce,Le){switch(Ce){case n.AnnotationEditorParamsType.INK_THICKNESS:Qe(this,x,Ao).call(this,Le);break;case n.AnnotationEditorParamsType.INK_COLOR:Qe(this,x,Co).call(this,Le);break;case n.AnnotationEditorParamsType.INK_OPACITY:Qe(this,x,Ro).call(this,Le);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,Je._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,Je._defaultColor||i.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(Je._defaultOpacity*100)]]}get propertiesToUpdate(){var Ce;return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Je._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||Je._defaultColor||i.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*((Ce=this.opacity)!=null?Ce:Je._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(Qe(this,x,ks).call(this),Qe(this,x,Is).call(this)),this.isAttachedToDOM||(this.parent.add(this),Qe(this,x,bi).call(this)),Qe(this,x,Si).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,de(this,te).disconnect(),ft(this,te,null),super.remove())}setParent(Ce){!this.parent&&Ce?this._uiManager.removeShouldRescale(this):this.parent&&Ce===null&&this._uiManager.addShouldRescale(this),super.setParent(Ce)}onScaleChanging(){const[Ce,Le]=this.parentDimensions,Ve=this.width*Ce,Ge=this.height*Le;this.setDimensions(Ve,Ge)}enableEditMode(){de(this,_)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",de(this,g)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",de(this,g)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){de(this,_)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),ft(this,_,!0),this.div.classList.add("disabled"),Qe(this,x,Si).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(Ce){this._focusEventsAllowed&&(super.focusin(Ce),this.enableEditMode())}canvasPointerdown(Ce){Ce.button!==0||!this.isInEditMode()||de(this,_)||(this.setInForeground(),Ce.preventDefault(),Ce.type!=="mouse"&&this.div.focus(),Qe(this,x,Io).call(this,Ce.offsetX,Ce.offsetY))}canvasPointermove(Ce){Ce.preventDefault(),Qe(this,x,Ea).call(this,Ce.offsetX,Ce.offsetY)}canvasPointerup(Ce){Ce.preventDefault(),Qe(this,x,wa).call(this,Ce)}canvasPointerleave(Ce){Qe(this,x,wa).call(this,Ce)}get isResizable(){return!this.isEmpty()&&de(this,_)}render(){if(this.div)return this.div;let Ce,Le;this.width&&(Ce=this.x,Le=this.y),super.render(),i.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(Kt=>{var Ze;return(Ze=this.div)==null?void 0:Ze.setAttribute("aria-label",Kt)});const[Ve,Ge,ut,Jt]=Qe(this,x,ko).call(this);if(this.setAt(Ve,Ge,0,0),this.setDims(ut,Jt),Qe(this,x,ks).call(this),this.width){const[Kt,Ze]=this.parentDimensions;this.setAspectRatio(this.width*Kt,this.height*Ze),this.setAt(Ce*Kt,Le*Ze,this.width*Kt,this.height*Ze),ft(this,H,!0),Qe(this,x,bi).call(this),this.setDims(this.width*Kt,this.height*Ze),Qe(this,x,Wn).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Qe(this,x,Is).call(this),this.div}setDimensions(Ce,Le){const Ve=Math.round(Ce),Ge=Math.round(Le);if(de(this,ne)===Ve&&de(this,j)===Ge)return;ft(this,ne,Ve),ft(this,j,Ge),this.canvas.style.visibility="hidden";const[ut,Jt]=this.parentDimensions;this.width=Ce/ut,this.height=Le/Jt,this.fixAndSetPosition(),de(this,_)&&Qe(this,x,ba).call(this,Ce,Le),Qe(this,x,bi).call(this),Qe(this,x,Wn).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(Ce,Le,Ve){var mr,wr,Cr;if(Ce instanceof s.InkAnnotationElement)return null;const Ge=super.deserialize(Ce,Le,Ve);Ge.thickness=Ce.thickness,Ge.color=n.Util.makeHexColor(...Ce.color),Ge.opacity=Ce.opacity;const[ut,Jt]=Ge.pageDimensions,Kt=Ge.width*ut,Ze=Ge.height*Jt,tr=Ge.parentScale,nr=Ce.thickness/2;ft(Ge,_,!0),ft(Ge,ne,Math.round(Kt)),ft(Ge,j,Math.round(Ze));const{paths:xr,rect:pr,rotation:vr}=Ce;for(let{bezier:Rr}of xr){Rr=Qe(mr=Je,pe,No).call(mr,Rr,pr,vr);const ar=[];Ge.paths.push(ar);let it=tr*(Rr[0]-nr),ot=tr*(Rr[1]-nr);for(let Tr=2,Te=Rr.length;Tr<Te;Tr+=6){const ze=tr*(Rr[Tr]-nr),zt=tr*(Rr[Tr+1]-nr),ir=tr*(Rr[Tr+2]-nr),cr=tr*(Rr[Tr+3]-nr),or=tr*(Rr[Tr+4]-nr),ke=tr*(Rr[Tr+5]-nr);ar.push([[it,ot],[ze,zt],[ir,cr],[or,ke]]),it=or,ot=ke}const gr=Qe(this,pe,Mo).call(this,ar);Ge.bezierPath2D.push(gr)}const lr=Qe(wr=Ge,x,Ta).call(wr);return ft(Ge,h,Math.max(i.AnnotationEditor.MIN_SIZE,lr[2]-lr[0])),ft(Ge,u,Math.max(i.AnnotationEditor.MIN_SIZE,lr[3]-lr[1])),Qe(Cr=Ge,x,ba).call(Cr,Kt,Ze),Ge}serialize(){if(this.isEmpty())return null;const Ce=this.getRect(0,0),Le=i.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:Le,thickness:this.thickness,opacity:this.opacity,paths:Qe(this,x,Bo).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,Ce),pageIndex:this.pageIndex,rect:Ce,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};u=new WeakMap,h=new WeakMap,f=new WeakMap,m=new WeakMap,E=new WeakMap,g=new WeakMap,p=new WeakMap,_=new WeakMap,A=new WeakMap,H=new WeakMap,te=new WeakMap,ne=new WeakMap,j=new WeakMap,ee=new WeakMap,x=new WeakSet,Ao=function(Ce){const Le=this.thickness;this.addCommands({cmd:()=>{this.thickness=Ce,Qe(this,x,Si).call(this)},undo:()=>{this.thickness=Le,Qe(this,x,Si).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Co=function(Ce){const Le=this.color;this.addCommands({cmd:()=>{this.color=Ce,Qe(this,x,Wn).call(this)},undo:()=>{this.color=Le,Qe(this,x,Wn).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Ro=function(Ce){Ce/=100;const Le=this.opacity;this.addCommands({cmd:()=>{this.opacity=Ce,Qe(this,x,Wn).call(this)},undo:()=>{this.opacity=Le,Qe(this,x,Wn).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},ko=function(){const{parentRotation:Ce,parentDimensions:[Le,Ve]}=this;switch(Ce){case 90:return[0,Ve,Ve,Le];case 180:return[Le,Ve,Le,Ve];case 270:return[Le,0,Ve,Le];default:return[0,0,Le,Ve]}},ya=function(){const{ctx:Ce,color:Le,opacity:Ve,thickness:Ge,parentScale:ut,scaleFactor:Jt}=this;Ce.lineWidth=Ge*ut/Jt,Ce.lineCap="round",Ce.lineJoin="round",Ce.miterLimit=10,Ce.strokeStyle=`${Le}${(0,o.opacityToHex)(Ve)}`},Io=function(Ce,Le){var Ve;this.canvas.addEventListener("contextmenu",a.noContextMenu),this.canvas.addEventListener("pointerleave",de(this,m)),this.canvas.addEventListener("pointermove",de(this,f)),this.canvas.addEventListener("pointerup",de(this,E)),this.canvas.removeEventListener("pointerdown",de(this,g)),this.isEditing=!0,de(this,H)||(ft(this,H,!0),Qe(this,x,bi).call(this),this.thickness||(this.thickness=Je._defaultThickness),this.color||(this.color=Je._defaultColor||i.AnnotationEditor._defaultLineColor),(Ve=this.opacity)!=null||(this.opacity=Je._defaultOpacity)),this.currentPath.push([Ce,Le]),ft(this,A,!1),Qe(this,x,ya).call(this),ft(this,ee,()=>{Qe(this,x,Fo).call(this),de(this,ee)&&window.requestAnimationFrame(de(this,ee))}),window.requestAnimationFrame(de(this,ee))},Ea=function(Ce,Le){const[Ve,Ge]=this.currentPath.at(-1);if(this.currentPath.length>1&&Ce===Ve&&Le===Ge)return;const ut=this.currentPath;let Jt=de(this,p);if(ut.push([Ce,Le]),ft(this,A,!0),ut.length<=2){Jt.moveTo(...ut[0]),Jt.lineTo(Ce,Le);return}ut.length===3&&(ft(this,p,Jt=new Path2D),Jt.moveTo(...ut[0])),Qe(this,x,Lo).call(this,Jt,...ut.at(-3),...ut.at(-2),Ce,Le)},Po=function(){if(this.currentPath.length===0)return;const Ce=this.currentPath.at(-1);de(this,p).lineTo(...Ce)},Oo=function(Ce,Le){ft(this,ee,null),Ce=Math.min(Math.max(Ce,0),this.canvas.width),Le=Math.min(Math.max(Le,0),this.canvas.height),Qe(this,x,Ea).call(this,Ce,Le),Qe(this,x,Po).call(this);let Ve;if(this.currentPath.length!==1)Ve=Qe(this,x,Do).call(this);else{const Ze=[Ce,Le];Ve=[[Ze,Ze.slice(),Ze.slice(),Ze]]}const Ge=de(this,p),ut=this.currentPath;this.currentPath=[],ft(this,p,new Path2D);const Jt=()=>{this.allRawPaths.push(ut),this.paths.push(Ve),this.bezierPath2D.push(Ge),this.rebuild()},Kt=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Qe(this,x,ks).call(this),Qe(this,x,Is).call(this)),Qe(this,x,Si).call(this))};this.addCommands({cmd:Jt,undo:Kt,mustExec:!0})},Fo=function(){if(!de(this,A))return;ft(this,A,!1);const Ce=Math.ceil(this.thickness*this.parentScale),Le=this.currentPath.slice(-3),Ve=Le.map(Jt=>Jt[0]),Ge=Le.map(Jt=>Jt[1]);Math.min(...Ve)-Ce,Math.max(...Ve)+Ce,Math.min(...Ge)-Ce,Math.max(...Ge)+Ce;const{ctx:ut}=this;ut.save(),ut.clearRect(0,0,this.canvas.width,this.canvas.height);for(const Jt of this.bezierPath2D)ut.stroke(Jt);ut.stroke(de(this,p)),ut.restore()},Lo=function(Ce,Le,Ve,Ge,ut,Jt,Kt){const Ze=(Le+Ge)/2,tr=(Ve+ut)/2,nr=(Ge+Jt)/2,xr=(ut+Kt)/2;Ce.bezierCurveTo(Ze+2*(Ge-Ze)/3,tr+2*(ut-tr)/3,nr+2*(Ge-nr)/3,xr+2*(ut-xr)/3,nr,xr)},Do=function(){const Ce=this.currentPath;if(Ce.length<=2)return[[Ce[0],Ce[0],Ce.at(-1),Ce.at(-1)]];const Le=[];let Ve,[Ge,ut]=Ce[0];for(Ve=1;Ve<Ce.length-2;Ve++){const[pr,vr]=Ce[Ve],[lr,mr]=Ce[Ve+1],wr=(pr+lr)/2,Cr=(vr+mr)/2,Rr=[Ge+2*(pr-Ge)/3,ut+2*(vr-ut)/3],ar=[wr+2*(pr-wr)/3,Cr+2*(vr-Cr)/3];Le.push([[Ge,ut],Rr,ar,[wr,Cr]]),[Ge,ut]=[wr,Cr]}const[Jt,Kt]=Ce[Ve],[Ze,tr]=Ce[Ve+1],nr=[Ge+2*(Jt-Ge)/3,ut+2*(Kt-ut)/3],xr=[Ze+2*(Jt-Ze)/3,tr+2*(Kt-tr)/3];return Le.push([[Ge,ut],nr,xr,[Ze,tr]]),Le},Wn=function(){if(this.isEmpty()){Qe(this,x,Ps).call(this);return}Qe(this,x,ya).call(this);const{canvas:Ce,ctx:Le}=this;Le.setTransform(1,0,0,1,0,0),Le.clearRect(0,0,Ce.width,Ce.height),Qe(this,x,Ps).call(this);for(const Ve of this.bezierPath2D)Le.stroke(Ve)},wa=function(Ce){this.canvas.removeEventListener("pointerleave",de(this,m)),this.canvas.removeEventListener("pointermove",de(this,f)),this.canvas.removeEventListener("pointerup",de(this,E)),this.canvas.addEventListener("pointerdown",de(this,g)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",a.noContextMenu)},10),Qe(this,x,Oo).call(this,Ce.offsetX,Ce.offsetY),this.addToAnnotationStorage(),this.setInBackground()},ks=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",i.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(Ce=>{var Le;return(Le=this.canvas)==null?void 0:Le.setAttribute("aria-label",Ce)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Is=function(){ft(this,te,new ResizeObserver(Ce=>{const Le=Ce[0].contentRect;Le.width&&Le.height&&this.setDimensions(Le.width,Le.height)})),de(this,te).observe(this.div)},bi=function(){if(!de(this,H))return;const[Ce,Le]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Ce),this.canvas.height=Math.ceil(this.height*Le),Qe(this,x,Ps).call(this)},ba=function(Ce,Le){const Ve=Qe(this,x,Os).call(this),Ge=(Ce-Ve)/de(this,h),ut=(Le-Ve)/de(this,u);this.scaleFactor=Math.min(Ge,ut)},Ps=function(){const Ce=Qe(this,x,Os).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Ce,this.translationY*this.scaleFactor+Ce)},pe=new WeakSet,Mo=function(Ce){const Le=new Path2D;for(let Ve=0,Ge=Ce.length;Ve<Ge;Ve++){const[ut,Jt,Kt,Ze]=Ce[Ve];Ve===0&&Le.moveTo(...ut),Le.bezierCurveTo(Jt[0],Jt[1],Kt[0],Kt[1],Ze[0],Ze[1])}return Le},Sa=function(Ce,Le,Ve){const[Ge,ut,Jt,Kt]=Le;switch(Ve){case 0:for(let Ze=0,tr=Ce.length;Ze<tr;Ze+=2)Ce[Ze]+=Ge,Ce[Ze+1]=Kt-Ce[Ze+1];break;case 90:for(let Ze=0,tr=Ce.length;Ze<tr;Ze+=2){const nr=Ce[Ze];Ce[Ze]=Ce[Ze+1]+Ge,Ce[Ze+1]=nr+ut}break;case 180:for(let Ze=0,tr=Ce.length;Ze<tr;Ze+=2)Ce[Ze]=Jt-Ce[Ze],Ce[Ze+1]+=ut;break;case 270:for(let Ze=0,tr=Ce.length;Ze<tr;Ze+=2){const nr=Ce[Ze];Ce[Ze]=Jt-Ce[Ze+1],Ce[Ze+1]=Kt-nr}break;default:throw new Error("Invalid rotation")}return Ce},No=function(Ce,Le,Ve){const[Ge,ut,Jt,Kt]=Le;switch(Ve){case 0:for(let Ze=0,tr=Ce.length;Ze<tr;Ze+=2)Ce[Ze]-=Ge,Ce[Ze+1]=Kt-Ce[Ze+1];break;case 90:for(let Ze=0,tr=Ce.length;Ze<tr;Ze+=2){const nr=Ce[Ze];Ce[Ze]=Ce[Ze+1]-ut,Ce[Ze+1]=nr-Ge}break;case 180:for(let Ze=0,tr=Ce.length;Ze<tr;Ze+=2)Ce[Ze]=Jt-Ce[Ze],Ce[Ze+1]-=ut;break;case 270:for(let Ze=0,tr=Ce.length;Ze<tr;Ze+=2){const nr=Ce[Ze];Ce[Ze]=Kt-Ce[Ze+1],Ce[Ze+1]=Jt-nr}break;default:throw new Error("Invalid rotation")}return Ce},Bo=function(Ce,Le,Ve,Ge){var tr,nr;const ut=[],Jt=this.thickness/2,Kt=Ce*Le+Jt,Ze=Ce*Ve+Jt;for(const xr of this.paths){const pr=[],vr=[];for(let lr=0,mr=xr.length;lr<mr;lr++){const[wr,Cr,Rr,ar]=xr[lr],it=Ce*wr[0]+Kt,ot=Ce*wr[1]+Ze,gr=Ce*Cr[0]+Kt,Tr=Ce*Cr[1]+Ze,Te=Ce*Rr[0]+Kt,ze=Ce*Rr[1]+Ze,zt=Ce*ar[0]+Kt,ir=Ce*ar[1]+Ze;lr===0&&(pr.push(it,ot),vr.push(it,ot)),pr.push(gr,Tr,Te,ze,zt,ir),vr.push(gr,Tr),lr===mr-1&&vr.push(zt,ir)}ut.push({bezier:Qe(tr=Je,pe,Sa).call(tr,pr,Ge,this.rotation),points:Qe(nr=Je,pe,Sa).call(nr,vr,Ge,this.rotation)})}return ut},Ta=function(){let Ce=1/0,Le=-1/0,Ve=1/0,Ge=-1/0;for(const ut of this.paths)for(const[Jt,Kt,Ze,tr]of ut){const nr=n.Util.bezierBoundingBox(...Jt,...Kt,...Ze,...tr);Ce=Math.min(Ce,nr[0]),Ve=Math.min(Ve,nr[1]),Le=Math.max(Le,nr[2]),Ge=Math.max(Ge,nr[3])}return[Ce,Ve,Le,Ge]},Os=function(){return de(this,_)?Math.ceil(this.thickness*this.parentScale):0},Si=function(){let Ce=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isEmpty())return;if(!de(this,_)){Qe(this,x,Wn).call(this);return}const Le=Qe(this,x,Ta).call(this),Ve=Qe(this,x,Os).call(this);ft(this,h,Math.max(i.AnnotationEditor.MIN_SIZE,Le[2]-Le[0])),ft(this,u,Math.max(i.AnnotationEditor.MIN_SIZE,Le[3]-Le[1]));const Ge=Math.ceil(Ve+de(this,h)*this.scaleFactor),ut=Math.ceil(Ve+de(this,u)*this.scaleFactor),[Jt,Kt]=this.parentDimensions;this.width=Ge/Jt,this.height=ut/Kt,this.setAspectRatio(Ge,ut);const Ze=this.translationX,tr=this.translationY;this.translationX=-Le[0],this.translationY=-Le[1],Qe(this,x,bi).call(this),Qe(this,x,Wn).call(this),ft(this,ne,Ge),ft(this,j,ut),this.setDims(Ge,ut);const nr=Ce?Ve/this.scaleFactor/2:0;this.translate(Ze-this.translationX-nr,tr-this.translationY-nr)},ct(Je,pe),Hr(Je,"_defaultColor",null),Hr(Je,"_defaultOpacity",1),Hr(Je,"_defaultThickness",1),Hr(Je,"_type","ink");let c=Je;e.InkEditor=c},(t,e,r)=>{var c,u,h,f,m,E,g,p,_,A,H,Qi,es,Fs,Aa,Uo,jo,Ca,Ls,Wo;Object.defineProperty(e,"__esModule",{value:!0}),e.StampEditor=void 0,r(149),r(152);var n=r(1),i=r(164),s=r(168),a=r(198);const Y=class Y extends i.AnnotationEditor{constructor(xe){super(Br(Er({},xe),{name:"stampEditor"}));ct(this,H);ct(this,c,null);ct(this,u,null);ct(this,h,null);ct(this,f,null);ct(this,m,null);ct(this,E,null);ct(this,g,null);ct(this,p,null);ct(this,_,!1);ct(this,A,!1);ft(this,f,xe.bitmapUrl),ft(this,m,xe.bitmapFile)}static initialize(xe){i.AnnotationEditor.initialize(xe)}static get supportedTypes(){const xe=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,n.shadow)(this,"supportedTypes",xe.map(Ee=>`image/${Ee}`))}static get supportedTypesStr(){return(0,n.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(xe){return this.supportedTypes.includes(xe)}static paste(xe,Ee){Ee.pasteEditor(n.AnnotationEditorType.STAMP,{bitmapFile:xe.getAsFile()})}remove(){var xe,Ee;de(this,u)&&(ft(this,c,null),this._uiManager.imageManager.deleteId(de(this,u)),(xe=de(this,E))==null||xe.remove(),ft(this,E,null),(Ee=de(this,g))==null||Ee.disconnect(),ft(this,g,null)),super.remove()}rebuild(){if(!this.parent){de(this,u)&&Qe(this,H,Fs).call(this);return}super.rebuild(),this.div!==null&&(de(this,u)&&Qe(this,H,Fs).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(de(this,h)||de(this,c)||de(this,f)||de(this,m))}get isResizable(){return!0}render(){if(this.div)return this.div;let xe,Ee;if(this.width&&(xe=this.x,Ee=this.y),super.render(),this.div.hidden=!0,de(this,c)?Qe(this,H,Aa).call(this):Qe(this,H,Fs).call(this),this.width){const[se,Fe]=this.parentDimensions;this.setAt(xe*se,Ee*Fe,this.width*se,this.height*Fe)}return this.div}static deserialize(xe,Ee,se){if(xe instanceof a.StampAnnotationElement)return null;const Fe=super.deserialize(xe,Ee,se),{rect:ue,bitmapUrl:ae,bitmapId:_e,isSvg:oe,accessibilityData:ie}=xe;_e&&se.imageManager.isValidId(_e)?ft(Fe,u,_e):ft(Fe,f,ae),ft(Fe,_,oe);const[re,ce]=Fe.pageDimensions;return Fe.width=(ue[2]-ue[0])/re,Fe.height=(ue[3]-ue[1])/ce,ie&&(Fe.altTextData=ie),Fe}serialize(){let xe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,Ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.isEmpty())return null;const se={annotationType:n.AnnotationEditorType.STAMP,bitmapId:de(this,u),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:de(this,_),structTreeParentId:this._structTreeParentId};if(xe)return se.bitmapUrl=Qe(this,H,Ls).call(this,!0),se.accessibilityData=this.altTextData,se;const{decorative:Fe,altText:ue}=this.altTextData;if(!Fe&&ue&&(se.accessibilityData={type:"Figure",alt:ue}),Ee===null)return se;Ee.stamps||(Ee.stamps=new Map);const ae=de(this,_)?(se.rect[2]-se.rect[0])*(se.rect[3]-se.rect[1]):null;if(!Ee.stamps.has(de(this,u)))Ee.stamps.set(de(this,u),{area:ae,serialized:se}),se.bitmap=Qe(this,H,Ls).call(this,!1);else if(de(this,_)){const _e=Ee.stamps.get(de(this,u));ae>_e.area&&(_e.area=ae,_e.serialized.bitmap.close(),_e.serialized.bitmap=Qe(this,H,Ls).call(this,!1))}return se}};c=new WeakMap,u=new WeakMap,h=new WeakMap,f=new WeakMap,m=new WeakMap,E=new WeakMap,g=new WeakMap,p=new WeakMap,_=new WeakMap,A=new WeakMap,H=new WeakSet,Qi=function(xe){let Ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!xe){this.remove();return}ft(this,c,xe.bitmap),Ee||(ft(this,u,xe.id),ft(this,_,xe.isSvg)),Qe(this,H,Aa).call(this)},es=function(){ft(this,h,null),this._uiManager.enableWaiting(!1),de(this,E)&&this.div.focus()},Fs=function(){if(de(this,u)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(de(this,u)).then(Ee=>Qe(this,H,Qi).call(this,Ee,!0)).finally(()=>Qe(this,H,es).call(this));return}if(de(this,f)){const Ee=de(this,f);ft(this,f,null),this._uiManager.enableWaiting(!0),ft(this,h,this._uiManager.imageManager.getFromUrl(Ee).then(se=>Qe(this,H,Qi).call(this,se)).finally(()=>Qe(this,H,es).call(this)));return}if(de(this,m)){const Ee=de(this,m);ft(this,m,null),this._uiManager.enableWaiting(!0),ft(this,h,this._uiManager.imageManager.getFromFile(Ee).then(se=>Qe(this,H,Qi).call(this,se)).finally(()=>Qe(this,H,es).call(this)));return}const xe=document.createElement("input");xe.type="file",xe.accept=Y.supportedTypesStr,ft(this,h,new Promise(Ee=>{xe.addEventListener("change",()=>Ye(this,null,function*(){if(!xe.files||xe.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const se=yield this._uiManager.imageManager.getFromFile(xe.files[0]);Qe(this,H,Qi).call(this,se)}Ee()})),xe.addEventListener("cancel",()=>{this.remove(),Ee()})}).finally(()=>Qe(this,H,es).call(this))),xe.click()},Aa=function(){const{div:xe}=this;let{width:Ee,height:se}=de(this,c);const[Fe,ue]=this.pageDimensions,ae=.75;if(this.width)Ee=this.width*Fe,se=this.height*ue;else if(Ee>ae*Fe||se>ae*ue){const re=Math.min(ae*Fe/Ee,ae*ue/se);Ee*=re,se*=re}const[_e,oe]=this.parentDimensions;this.setDims(Ee*_e/Fe,se*oe/ue),this._uiManager.enableWaiting(!1);const ie=ft(this,E,document.createElement("canvas"));xe.append(ie),xe.hidden=!1,Qe(this,H,Ca).call(this,Ee,se),Qe(this,H,Wo).call(this),de(this,A)||(this.parent.addUndoableEditor(this),ft(this,A,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},Uo=function(xe,Ee){var ae;const[se,Fe]=this.parentDimensions;this.width=xe/se,this.height=Ee/Fe,this.setDims(xe,Ee),(ae=this._initialOptions)!=null&&ae.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,de(this,p)!==null&&clearTimeout(de(this,p)),ft(this,p,setTimeout(()=>{ft(this,p,null),Qe(this,H,Ca).call(this,xe,Ee)},200))},jo=function(xe,Ee){const{width:se,height:Fe}=de(this,c);let ue=se,ae=Fe,_e=de(this,c);for(;ue>2*xe||ae>2*Ee;){const oe=ue,ie=ae;ue>2*xe&&(ue=ue>=16384?Math.floor(ue/2)-1:Math.ceil(ue/2)),ae>2*Ee&&(ae=ae>=16384?Math.floor(ae/2)-1:Math.ceil(ae/2));const re=new OffscreenCanvas(ue,ae);re.getContext("2d").drawImage(_e,0,0,oe,ie,0,0,ue,ae),_e=re.transferToImageBitmap()}return _e},Ca=function(xe,Ee){xe=Math.ceil(xe),Ee=Math.ceil(Ee);const se=de(this,E);if(!se||se.width===xe&&se.height===Ee)return;se.width=xe,se.height=Ee;const Fe=de(this,_)?de(this,c):Qe(this,H,jo).call(this,xe,Ee),ue=se.getContext("2d");ue.filter=this._uiManager.hcmFilter,ue.drawImage(Fe,0,0,Fe.width,Fe.height,0,0,xe,Ee)},Ls=function(xe){if(xe){if(de(this,_)){const Fe=this._uiManager.imageManager.getSvgUrl(de(this,u));if(Fe)return Fe}const Ee=document.createElement("canvas");return{width:Ee.width,height:Ee.height}=de(this,c),Ee.getContext("2d").drawImage(de(this,c),0,0),Ee.toDataURL()}if(de(this,_)){const[Ee,se]=this.pageDimensions,Fe=Math.round(this.width*Ee*s.PixelsPerInch.PDF_TO_CSS_UNITS),ue=Math.round(this.height*se*s.PixelsPerInch.PDF_TO_CSS_UNITS),ae=new OffscreenCanvas(Fe,ue);return ae.getContext("2d").drawImage(de(this,c),0,0,de(this,c).width,de(this,c).height,0,0,Fe,ue),ae.transferToImageBitmap()}return structuredClone(de(this,c))},Wo=function(){ft(this,g,new ResizeObserver(xe=>{const Ee=xe[0].contentRect;Ee.width&&Ee.height&&Qe(this,H,Uo).call(this,Ee.width,Ee.height)})),de(this,g).observe(this.div)},Hr(Y,"_type","stamp");let o=Y;e.StampEditor=o}],__webpack_module_cache__={};function __w_pdfjs_require__(t){var e=__webpack_module_cache__[t];if(e!==void 0)return e.exports;var r=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t].call(r.exports,r,r.exports,__w_pdfjs_require__),r.exports}var __webpack_exports__={};return(()=>{var t=__webpack_exports__;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(t,"AnnotationEditorLayer",{enumerable:!0,get:function(){return s.AnnotationEditorLayer}}),Object.defineProperty(t,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(t,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(t,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return a.AnnotationEditorUIManager}}),Object.defineProperty(t,"AnnotationLayer",{enumerable:!0,get:function(){return o.AnnotationLayer}}),Object.defineProperty(t,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(t,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(t,"DOMSVGFactory",{enumerable:!0,get:function(){return n.DOMSVGFactory}}),Object.defineProperty(t,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}}),Object.defineProperty(t,"GlobalWorkerOptions",{enumerable:!0,get:function(){return c.GlobalWorkerOptions}}),Object.defineProperty(t,"ImageKind",{enumerable:!0,get:function(){return e.ImageKind}}),Object.defineProperty(t,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(t,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(t,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(t,"PDFDataRangeTransport",{enumerable:!0,get:function(){return r.PDFDataRangeTransport}}),Object.defineProperty(t,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty(t,"PDFWorker",{enumerable:!0,get:function(){return r.PDFWorker}}),Object.defineProperty(t,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(t,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(t,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}}),Object.defineProperty(t,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}}),Object.defineProperty(t,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty(t,"SVGGraphics",{enumerable:!0,get:function(){return r.SVGGraphics}}),Object.defineProperty(t,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(t,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(t,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(t,"XfaLayer",{enumerable:!0,get:function(){return u.XfaLayer}}),Object.defineProperty(t,"build",{enumerable:!0,get:function(){return r.build}}),Object.defineProperty(t,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(t,"getDocument",{enumerable:!0,get:function(){return r.getDocument}}),Object.defineProperty(t,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty(t,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty(t,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}}),Object.defineProperty(t,"isDataScheme",{enumerable:!0,get:function(){return n.isDataScheme}}),Object.defineProperty(t,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty(t,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty(t,"noContextMenu",{enumerable:!0,get:function(){return n.noContextMenu}}),Object.defineProperty(t,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}}),Object.defineProperty(t,"renderTextLayer",{enumerable:!0,get:function(){return i.renderTextLayer}}),Object.defineProperty(t,"setLayerDimensions",{enumerable:!0,get:function(){return n.setLayerDimensions}}),Object.defineProperty(t,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(t,"updateTextLayer",{enumerable:!0,get:function(){return i.updateTextLayer}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return r.version}});var e=__w_pdfjs_require__(1),r=__w_pdfjs_require__(124),n=__w_pdfjs_require__(168),i=__w_pdfjs_require__(195),s=__w_pdfjs_require__(196),a=__w_pdfjs_require__(165),o=__w_pdfjs_require__(198),c=__w_pdfjs_require__(176),u=__w_pdfjs_require__(201)})(),__webpack_exports__})())}(pdf)),pdf.exports}var pdfExports=requirePdf();pdfExports.GlobalWorkerOptions.workerSrc=new URL(""+new URL("pdf.worker.min-SzY6Yteu.js",import.meta.url).href,import.meta.url).toString();const fuchsiaColor="#D100D1",Doc=reactExports.forwardRef((t,e)=>{const[r,n]=reactExports.useState(!0),[i,s]=reactExports.useState(null),[a,o]=reactExports.useState(!1),[c,u]=reactExports.useState(null),[h,f]=reactExports.useState("Conectando al servidor, por favor espere..."),[m,E]=reactExports.useState(0),g=reactExports.useRef(null),p=reactExports.useRef(!1),_=reactExports.useRef(!1),A=useNavigate();useAuthState(auth),useTheme();const H=!0,te=JSON.parse(sessionStorage.getItem("selectedFicha")||"null");if(!te)return jsxRuntimeExports.jsx(Box,{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",children:jsxRuntimeExports.jsx(Typography,{color:"error",children:"No se encontrÃ³ ninguna ficha seleccionada. Regrese al catÃ¡logo y elija un documento."})});const ne=`${te.grupo}/${te.sector}/${te.cod}/f`,j=["Conectando al servidor, por favor espere...","Calculando, por favor espere...","Aplicando formato y realizando validaciones...","Cargando las primeras configuraciones...","Inicializando el proceso de simulaciÃ³n...","Verificando los datos iniciales...","Generando el documento solicitado...","Aplicando formato y realizando validaciones...","Finalizando tareas pendientes y liberando recursos..."];reactExports.useEffect(()=>{if(!r)return;let O=0,R;const Y=()=>{O=(O+1)%j.length,f(j[O]),R=setTimeout(Y,Math.floor(Math.random()*3e3)+10)};return Y(),()=>clearTimeout(R)},[r]);const ee=reactExports.useCallback(()=>Ye(void 0,null,function*(){n(!0),s(null);const O=sessionStorage.getItem("excelData")?JSON.parse(sessionStorage.getItem("excelData")):{},R=`${configURL.API_URL}/${ne}?timestamp=${new Date().getTime()}`;try{const Y=yield axios.post(R,O,{responseType:"arraybuffer",timeout:1e4});if(Y.status===200&&Y.data)return u(!0),new Uint8Array(Y.data);throw new Error("Error al obtener PDF desde API")}catch(Y){console.warn("API no disponible, cargando PDF local...",Y),u(!1);try{const q=`/routers/${te.grupo}/${te.sector}/${te.cod}.pdf`,me=yield fetch(q);if(!me.ok)throw new Error("No se encontrÃ³ el PDF local.");return new Uint8Array(yield me.arrayBuffer())}catch(q){throw console.error("No se pudo cargar PDF local:",q),s("No se pudo cargar PDF local."),q}}}),[ne,te]),x=reactExports.useCallback(O=>Ye(void 0,null,function*(){p.current=!0,s(null);try{const R=yield pdfExports.getDocument({data:O}).promise,Y=g.current;if(!Y)return;Y.innerHTML="";const q=2,me=70,xe=70,Ee=50,se=50;for(let Fe=1;Fe<=R.numPages;Fe++){const ue=yield R.getPage(Fe),ae=ue.getViewport({scale:1}),_e=document.createElement("canvas");_e.width=ae.width*q,_e.height=ae.height*q;const oe=_e.getContext("2d");oe.setTransform(q,0,0,q,0,0),yield ue.render({canvasContext:oe,viewport:ae}).promise;const ie=ae.width-me-xe,re=ae.height-Ee-se,ce=document.createElement("canvas");ce.width=ie*q,ce.height=re*q,ce.getContext("2d").drawImage(_e,me*q,Ee*q,ie*q,re*q,0,0,ie*q,re*q),ce.style.width="100%",ce.style.height="auto",ce.style.display="block";const pe=document.createElement("div");pe.style.boxShadow="0 4px 4px rgba(0,0,0,0.1)",pe.style.background="white",pe.appendChild(ce),Y.appendChild(pe)}}catch(R){console.error(R),s(`Error al renderizar PDF: ${R.message}`)}finally{n(!1),p.current=!1}}),[]);reactExports.useEffect(()=>{_.current||(_.current=!0,ee().then(O=>x(O)).catch(O=>{console.error("Fallo al cargar PDF:",O),s("No se pudo cargar el PDF."),n(!1)}))},[ee,x]);const M=()=>Ye(void 0,null,function*(){try{n(!0);const O=yield ee(),R=new Blob([O],{type:"application/pdf"}),Y=URL.createObjectURL(R),q=document.createElement("a");q.href=Y,q.download=`${te.cod}.pdf`,document.body.appendChild(q),q.click(),document.body.removeChild(q)}catch(O){console.error("Error al descargar PDF:",O)}finally{n(!1)}});reactExports.useImperativeHandle(e,()=>({abrirModalx:()=>o(!0),handleDownload:M}));const T=(O,R)=>{E(R),R===0?o(!0):R===1?M():R===2&&A("/Blog")};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Backdrop,{open:r,style:{zIndex:1201,color:"#000"},children:jsxRuntimeExports.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[jsxRuntimeExports.jsx(CircularProgress,{color:"inherit",sx:{color:"white"}}),jsxRuntimeExports.jsx(Typography,{variant:"h6",sx:{color:"white",marginTop:2},children:h})]})}),i&&jsxRuntimeExports.jsx(Typography,{align:"center",color:"error",children:i}),jsxRuntimeExports.jsx(Box,{display:"flex",flexDirection:"column",alignItems:"flex-start",position:"relative",sx:{pb:c?"56px":0},children:jsxRuntimeExports.jsx("div",{ref:g,style:{display:"flex",flexWrap:"wrap",justifyContent:"center",maxWidth:"1200px",margin:"120px auto 0 auto",width:"100%",cursor:c&&H?"pointer":"default"},onClick:()=>{c&&H&&o(!0)}})}),c===null&&jsxRuntimeExports.jsx(Typography,{align:"center",children:"Verificando disponibilidad de la API..."}),c===!0&&H&&jsxRuntimeExports.jsxs(BottomNavigation,{value:m,onChange:T,sx:{width:"100%",position:"fixed",bottom:0,bgcolor:"white",borderTop:"1px solid #ddd",zIndex:1300},showLabels:!0,children:[jsxRuntimeExports.jsx(BottomNavigationAction,{label:"Personalizar",icon:jsxRuntimeExports.jsx(TuneIcon,{}),sx:{color:m===0?fuchsiaColor:"gray","&.Mui-selected":{color:fuchsiaColor}}}),jsxRuntimeExports.jsx(BottomNavigationAction,{label:"Descargar",icon:jsxRuntimeExports.jsx(PictureAsPdfIcon,{}),sx:{color:m===1?"#d32f2f":"gray","&.Mui-selected":{color:"#d32f2f"}}}),jsxRuntimeExports.jsx(BottomNavigationAction,{label:"Cerrar",icon:jsxRuntimeExports.jsx(CloseIcon,{}),onClick:()=>A("/Blog"),sx:{color:"gray","&:hover":{color:"#000"}}})]}),jsxRuntimeExports.jsxs(Drawer,{anchor:"left",open:a,onClose:()=>o(!1),PaperProps:{sx:{width:"0%"}},children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",gutterBottom:!0,children:"Ajustes"}),jsxRuntimeExports.jsx(ExcelUploaderStorage,{openx:a,cerrarModalx:()=>o(!1),handleRecalculate:()=>Ye(void 0,null,function*(){o(!1);try{n(!0);const O=yield ee();yield x(O)}catch(O){console.error("Error al recalcular:",O),s("Error al recalcular PDF.")}finally{n(!1)}})})]}),jsxRuntimeExports.jsx(Lt,{}),c===!1&&jsxRuntimeExports.jsx(Typography,{align:"center",color:"error",children:"API no disponible, se estÃ¡ usando el PDF local."})]})}),HomePage$3=()=>jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(HomePage$6,{showLanding:!1,showCarrusel:!1,showInicio:!1,showDescripcion:!1,showServicios:!1,showFaq:!1,showContacto:!0,showPrivacyPolicy:!1,showTermsOfUse:!1,showAboutUs:!1})}),HomePage$2=()=>jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(HomePage$6,{showLanding:!1,showCarrusel:!1,showInicio:!1,showDescripcion:!1,showServicios:!0,showFaq:!1,showContacto:!0,showPrivacyPolicy:!1,showTermsOfUse:!1,showAboutUs:!1})}),HomePage$1=()=>{const t=[{sector:"B1_EnergÃ­a_solar",grupo:"B1_InstalaciÃ³n_y_mantenimiento",cod:"B11_InstalaciÃ³n_paneles_solares",descripcion:["1. Verifica la orientaciÃ³n de los paneles.","2. Limpieza periÃ³dica para mantener eficiencia.","3. RevisiÃ³n de conexiones cada 6 meses."]},{sector:"B2_Eficiencia_energÃ©tica",grupo:"B2_Ahorro_energÃ©tico",cod:"B21_MediciÃ³n_consumo",descripcion:["1. Instalar medidores inteligentes.","2. Analizar patrones de consumo."]}],[e,r]=reactExports.useState(!1),[n,i]=reactExports.useState(null),[s,a]=reactExports.useState(null),[o,c]=reactExports.useState(null),[u,h]=reactExports.useState(null),[f,m]=reactExports.useState(""),g=[...t,...Catalogo].reduce((ne,j)=>{const{sector:ee,grupo:x,cod:M,descripcion:T}=j,O=x,R=ee;return ne[O]||(ne[O]={}),ne[O][R]||(ne[O][R]=[]),ne[O][R].push({cod:M,descripcion:Array.isArray(T)?T:T?[T]:["(Sin descripciÃ³n disponible)"],video:`/video/${O}/${R}/${M}.mp4`}),ne},{}),p=Object.entries(g).map(([ne,j])=>{const ee=Object.entries(j).map(([x,M])=>{const T=M.filter(O=>O.cod.toLowerCase().includes(f.toLowerCase())||O.descripcion.some(R=>R.toLowerCase().includes(f.toLowerCase())));return x.toLowerCase().includes(f.toLowerCase())||T.length>0?[x,T]:null}).filter(Boolean);return ne.toLowerCase().includes(f.toLowerCase())||ee.length>0?[ne,Object.fromEntries(ee)]:null}).filter(Boolean),_=ne=>(j,ee)=>{a(ee?ne:null),c(null),h(null)},A=ne=>(j,ee)=>{h(ee?ne:null)},H=ne=>{i(ne),r(!0)},te=()=>{r(!1),i(null)};return jsxRuntimeExports.jsxs(Box,{sx:{width:"100%",minHeight:"100vh",bgcolor:"white",py:4,maxWidth:"1200px",mx:"auto",px:0},children:["    ",jsxRuntimeExports.jsxs(Container,{maxWidth:!1,disableGutters:!0,sx:{px:0},children:[jsxRuntimeExports.jsx(Typography,{variant:"h4",sx:{fontWeight:"bold",mb:3,color:"#000",textAlign:"center"}}),jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",alignItems:"center",mb:3},children:[jsxRuntimeExports.jsx(SearchIcon,{sx:{color:"action.active",mr:1}}),jsxRuntimeExports.jsx(TextField,{fullWidth:!0,variant:"outlined",placeholder:"Buscar por palabra clave...",value:f,onChange:ne=>m(ne.target.value)})]}),p.length>0?p.map(([ne,j])=>jsxRuntimeExports.jsxs(Accordion,{expanded:s===ne,onChange:_(ne),disableGutters:!0,elevation:0,sx:{background:"transparent",border:"none",boxShadow:"none",mb:.5,"&:before":{display:"none"}},children:[jsxRuntimeExports.jsx(AccordionSummary,{expandIcon:jsxRuntimeExports.jsx(ExpandMoreIcon,{sx:{color:"#000",fontSize:"1.1rem"}}),sx:{minHeight:32,py:0,"& .MuiAccordionSummary-content":{margin:0,"&.Mui-expanded":{margin:0}}},children:jsxRuntimeExports.jsx(Typography,{variant:"h6",sx:{fontWeight:"bold",fontSize:"1rem",color:"#1976d2",textTransform:"uppercase",width:"100%"},children:ne.includes("_")?ne.split("_").slice(1).join("_").replaceAll("_"," "):ne})}),jsxRuntimeExports.jsx(AccordionDetails,{sx:{px:0},children:Object.entries(j).map(([ee,x])=>jsxRuntimeExports.jsx(AccordionDetails,{sx:{px:0},children:x.map(M=>jsxRuntimeExports.jsxs(Accordion,{expanded:u===M.cod,onChange:A(M.cod),disableGutters:!0,elevation:0,sx:{background:"transparent",border:"none",boxShadow:"none",mb:.5,"&:before":{display:"none"}},children:[jsxRuntimeExports.jsx(AccordionSummary,{expandIcon:jsxRuntimeExports.jsx(ExpandMoreIcon,{sx:{color:"#000",fontSize:"1rem"}}),sx:{minHeight:28,py:1,"& .MuiAccordionSummary-content":{margin:0,"&.Mui-expanded":{margin:0}}},children:jsxRuntimeExports.jsx(Typography,{sx:{fontWeight:"bold",fontSize:"0.9rem",width:"100%"},children:M.cod.includes("_")?M.cod.split("_").slice(1).join("_").replaceAll("_"," "):M.cod})}),jsxRuntimeExports.jsxs(AccordionDetails,{sx:{px:1,py:.5},children:[jsxRuntimeExports.jsx(Typography,{sx:{width:"100%",whiteSpace:"pre-wrap",mb:.5,fontSize:"0.85rem",color:"#444"},children:Array.isArray(M.descripcion)?M.descripcion.join(`
`):"(Sin descripciÃ³n disponible)"}),jsxRuntimeExports.jsx(Box,{sx:{display:"flex",justifyContent:"flex-end"},children:jsxRuntimeExports.jsx(Button,{variant:"text",size:"small",color:"primary",startIcon:jsxRuntimeExports.jsx(PlayCircleFilledIcon,{}),onClick:()=>H(M.video),sx:{textTransform:"none",fontWeight:500,borderRadius:2,"&:hover":{backgroundColor:"rgba(25, 118, 210, 0.08)"}},children:"Ver video"})})]})]},M.cod))},ee))})]},ne)):jsxRuntimeExports.jsxs(Typography,{sx:{mt:4,textAlign:"center",color:"gray"},children:['No se encontraron resultados para "',f,'".']}),jsxRuntimeExports.jsxs(Dialog,{open:e,onClose:te,fullScreen:!0,PaperProps:{sx:{width:"100vw",height:"100vh",borderRadius:0,overflow:"hidden",backgroundColor:"#2e2e2e",display:"flex",justifyContent:"center",alignItems:"center",margin:0}},children:[jsxRuntimeExports.jsx("video",{src:n||"",controls:!0,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,style:{width:"100%",height:"100%",objectFit:"cover"},onClick:ne=>ne.stopPropagation(),onError:ne=>{const j=ne.target;j.dataset.fallback||(console.warn(`No se encontrÃ³ el video: ${n}. Se usarÃ¡ el video por defecto.`),j.dataset.fallback="true",j.src="/video/1.mp4",j.load(),j.play().catch(()=>{}))}}),jsxRuntimeExports.jsx(Box,{onClick:ne=>{ne.stopPropagation(),te()},sx:{position:"absolute",bottom:33,right:16,backgroundColor:"rgba(255,0,0,0.9)",borderRadius:"50%",width:44,height:44,display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",zIndex:10},children:jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),jsxRuntimeExports.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]})]})},HomePage=()=>jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(HomePage$6,{showLanding:!1,showCarrusel:!1,showInicio:!1,showDescripcion:!1,showServicios:!1,showFaq:!1,showContacto:!1,showPrivacyPolicy:!1,showTermsOfUse:!1,showAboutUs:!0})}),NavigationBarDocs=()=>{useAuthState(auth);const[t,e]=reactExports.useState(()=>sessionStorage.getItem("searchText")||""),[r,n]=reactExports.useState(null),[i,s]=reactExports.useState({}),[a,o]=reactExports.useState(!1),[c,u]=reactExports.useState(()=>{const O=sessionStorage.getItem("selectedFicha");return O?JSON.parse(O):null}),[h,f]=reactExports.useState(()=>{const O=sessionStorage.getItem("excelData");return O?JSON.parse(O):{}}),[m,E]=reactExports.useState(0),[g,p]=reactExports.useState(0),_=useNavigate();useLocation();const A=(O="")=>O.toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/_/g," ").replace(/\s+/g," ").trim();reactExports.useEffect(()=>{sessionStorage.setItem("searchText",t)},[t]);const H=reactExports.useMemo(()=>{const O=A(t);return Catalogo.filter(R=>{const Y=A(R.cod),q=A(R.sector),me=A(R.grupo);return!t||Y.includes(O)||q.includes(O)||me.includes(O)})},[t]),te=reactExports.useMemo(()=>{const O={};return H.forEach(Y=>{O[Y.grupo]||(O[Y.grupo]={}),O[Y.grupo][Y.sector]||(O[Y.grupo][Y.sector]=[]),O[Y.grupo][Y.sector].push(Y)}),Object.keys(O).sort((Y,q)=>Y.localeCompare(q,"es",{sensitivity:"base"})).reduce((Y,q)=>{const me=O[q],xe=Object.keys(me).sort((Ee,se)=>Ee.localeCompare(se,"es",{sensitivity:"base"})).reduce((Ee,se)=>{const Fe=[...me[se]].sort((ue,ae)=>ue.cod.localeCompare(ae.cod,"es",{sensitivity:"base"}));return Ee[se]=Fe,Ee},{});return Y[q]=xe,Y},{})},[H]),ne=O=>Ye(void 0,null,function*(){try{u(O),sessionStorage.setItem("selectedFicha",JSON.stringify(O));const R=`routers/${O.grupo}/${O.sector}/${O.cod}.xlsx`,Y=yield fetch(R);if(!Y.ok)throw new Error(`No se pudo cargar el archivo: ${R}`);const q=yield Y.arrayBuffer(),me=readSync(q,{type:"array"}),xe=me.SheetNames.reduce((Ee,se)=>{const Fe=utils.sheet_to_json(me.Sheets[se],{header:1});return Ee[se]=Fe.filter(ue=>ue.some(ae=>ae!=null&&ae!=="")),Ee},{});f(xe),sessionStorage.setItem("excelData",JSON.stringify(xe)),E(Ee=>Ee+1),o(!1),n(null),s({}),_("/doc")}catch(R){console.error(R),y.error("No se pudo cargar la ficha seleccionada.")}}),[j,ee]=reactExports.useState(!1),[x,M]=reactExports.useState(16/9),T=()=>{_("/ayuda")};return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs(Box,{sx:{position:"relative",width:"100%",minHeight:"100vh",overflow:"hidden",backgroundColor:"#fff"},children:[jsxRuntimeExports.jsx(Box,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"#fff",zIndex:-1}}),jsxRuntimeExports.jsxs(Box,{sx:{position:"relative",zIndex:1},children:[jsxRuntimeExports.jsxs(Container,{sx:{py:8},children:[jsxRuntimeExports.jsxs(Box,{sx:{textAlign:"center",mb:4},children:[jsxRuntimeExports.jsx(Typography,{variant:"h9",sx:{fontWeight:"bold",color:"#000",mb:0,display:"flex",justifyContent:"center",alignItems:"center",gap:1},children:"Blog de Plantilas TÃ©cnicas 'Personalizables'"}),jsxRuntimeExports.jsx(Typography,{variant:"h4",sx:{fontWeight:999,background:"linear-gradient(90deg, #00f0ff, #0077ff)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",mb:0,textShadow:"2px 2px 6px rgba(0,0,0,0.25)"},children:"Vatiaco"}),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs(Typography,{variant:"body2",sx:{color:"rgba(0,0,0,0.7)"},children:[jsxRuntimeExports.jsx(Box,{component:"span",onClick:T,sx:{color:"#1976d2",fontWeight:700,borderBottom:"2px solid #1976d2",paddingBottom:"2px",cursor:"pointer",display:"inline-flex",alignItems:"center","&:hover":{color:"#00b0ff",borderColor:"#00b0ff"}},children:"Personaliza"}),", descarga y comparte."," ",jsxRuntimeExports.jsx(Link$1,{href:"https://creativecommons.org/licenses/by/4.0/deed.es",target:"_blank",rel:"noopener noreferrer",underline:"hover",sx:{color:"#1976d2"},children:jsxRuntimeExports.jsx("img",{src:"https://licensebuttons.net/l/by/4.0/88x31.png",alt:"Creative Commons Attribution 4.0 License",style:{verticalAlign:"middle",height:20}})})]})})]}),Object.entries(te).map(([O,R])=>jsxRuntimeExports.jsxs(Box,{sx:{mb:6},children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",align:"center",sx:{fontWeight:"bold",background:"linear-gradient(90deg, #00f0ff, #0077ff)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",mb:3,textTransform:"uppercase",textShadow:"2px 2px 4px rgba(0,0,0,0.2)"},children:O.includes("_")?O.split("_").slice(1).join("_").replaceAll("_"," "):O}),Object.entries(R).map(([Y,q])=>jsxRuntimeExports.jsxs(Box,{sx:{mb:4},children:[jsxRuntimeExports.jsx(Typography,{variant:"h7",align:"center",sx:{fontWeight:"bold",background:"linear-gradient(90deg, #00f0ff, #0077ff)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",mb:2,textTransform:"capitalize",textShadow:"1px 1px 2px rgba(0,0,0,0.2)"},children:Y.includes("_")?Y.split("_").slice(1).join("_").replaceAll("_"," "):Y}),jsxRuntimeExports.jsxs(Box,{sx:{position:"relative"},children:[jsxRuntimeExports.jsx(Box,{id:`scroll-container-${O}-${Y}`,sx:{display:"flex",overflowX:"auto",scrollBehavior:"smooth",gap:3,pb:2,px:1,flexWrap:"nowrap",scrollSnapType:"x mandatory","&::-webkit-scrollbar":{height:6},"&::-webkit-scrollbar-thumb":{backgroundColor:"#00b0ff",borderRadius:4},"&::-webkit-scrollbar-track":{backgroundColor:"#e0f7fa"}},children:q.map(me=>jsxRuntimeExports.jsx(Box,{sx:{flex:{xs:"0 0 90%",sm:"0 0 48%"},minWidth:{xs:"90%",sm:"48%"},scrollSnapAlign:"start"},children:jsxRuntimeExports.jsx(Card,{onClick:()=>ne(me),sx:{borderRadius:"12px",overflow:"hidden",cursor:"pointer",backgroundColor:"#fff",border:"2px solid #00b0ff",boxShadow:"0 4px 12px rgba(0,0,0,0.08)",transition:"all 0.3s ease",position:"relative","&:hover":{transform:"translateY(-6px)",boxShadow:"0 8px 24px rgba(0,0,0,0.15)",borderColor:"#0091ea"}},children:jsxRuntimeExports.jsx(Box,{sx:{position:"relative",width:"100%",paddingTop:"55%"},children:jsxRuntimeExports.jsx(CardMedia,{component:"img",image:`/routers/${encodeURIComponent(O)}/${encodeURIComponent(Y)}/${encodeURIComponent(me.cod)}.png`,alt:me.cod,sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"contain",backgroundColor:"#fafafa"},onError:xe=>{xe.currentTarget.onerror=null,xe.currentTarget.src="/img/defecto.png"}})})})},me.cod))}),jsxRuntimeExports.jsx(Box,{sx:{position:"absolute",top:"50%",left:0,transform:"translateY(-50%)",zIndex:10},children:jsxRuntimeExports.jsx(Box,{onClick:()=>{const me=document.getElementById(`scroll-container-${O}-${Y}`);me&&(me.scrollLeft-=me.clientWidth*.8)},sx:{cursor:"pointer",backgroundColor:"rgba(255,255,255,0.3)",borderRadius:"50%",width:60,height:60,display:"flex",alignItems:"center",justifyContent:"center",transition:"0.3s",ml:1,"&:hover":{backgroundColor:"rgba(255,255,255,0.6)"}},children:jsxRuntimeExports.jsx(Typography,{variant:"h3",sx:{color:"#0077ff",fontWeight:"bold"},children:"â€¹"})})}),jsxRuntimeExports.jsx(Box,{sx:{position:"absolute",top:"50%",right:0,transform:"translateY(-50%)",zIndex:10},children:jsxRuntimeExports.jsx(Box,{onClick:()=>{const me=document.getElementById(`scroll-container-${O}-${Y}`);me&&(me.scrollLeft+=me.clientWidth*.8)},sx:{cursor:"pointer",backgroundColor:"rgba(255,255,255,0.3)",borderRadius:"50%",width:60,height:60,display:"flex",alignItems:"center",justifyContent:"center",transition:"0.3s",mr:1,"&:hover":{backgroundColor:"rgba(255,255,255,0.6)"}},children:jsxRuntimeExports.jsx(Typography,{variant:"h3",sx:{color:"#0077ff",fontWeight:"bold"},children:"â€º"})})})]})]},Y))]},O))]}),jsxRuntimeExports.jsx(HomePage$6,{showLanding:!1,showCarrusel:!1,showInicio:!1,showDescripcion:!1,showServicios:!1,showFaq:!1,showContacto:!0,showPrivacyPolicy:!1,showTermsOfUse:!1,showAboutUs:!1})]})]})})};function TopNavBar(){const t=useNavigate();useAuthState(auth);const[e,r]=reactExports.useState(0),[n,i]=reactExports.useState(null),[s,a]=reactExports.useState(null),o=!!s,[c,u]=reactExports.useState(()=>sessionStorage.getItem("searchText")||""),[h,f]=reactExports.useState(null),[m,E]=reactExports.useState({}),[g,p]=reactExports.useState(()=>{const Y=sessionStorage.getItem("selectedFicha");return Y?JSON.parse(Y):null}),[_,A]=reactExports.useState(()=>{const Y=sessionStorage.getItem("excelData");return Y?JSON.parse(Y):{}}),[H,te]=reactExports.useState(0),ne=[{label:"Contacto",path:"/Contacto",icon:jsxRuntimeExports.jsx(ContactMailIcon,{fontSize:"small"})},{label:"TÃ©rminos de Uso",path:"/Terminos",icon:jsxRuntimeExports.jsx(GavelIcon,{fontSize:"small"})},{label:"Privacidad",path:"/Privacidad",icon:jsxRuntimeExports.jsx(PolicyIcon,{fontSize:"small"})},{label:"Sobre Vatiaco",path:"/Sobre",icon:jsxRuntimeExports.jsx(InfoIcon,{fontSize:"small"})}],j=[{label:"",icon:jsxRuntimeExports.jsx(HomeIcon,{}),path:"/Blog"},{label:"Docs",icon:jsxRuntimeExports.jsx(DescriptionIcon,{}),isMenu:!0},{label:"",icon:jsxRuntimeExports.jsx(HelpOutlineIcon,{}),path:"/ayuda"},{label:"Login",icon:jsxRuntimeExports.jsx(PersonOutlineIcon,{}),path:"/login"}],ee=(Y="")=>Y.toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/_/g," ").replace(/\s+/g," ").trim();reactExports.useEffect(()=>{sessionStorage.setItem("searchText",c)},[c]);const x=reactExports.useMemo(()=>{const Y=ee(c);return Catalogo.filter(q=>{const me=ee(q.cod),xe=ee(q.sector),Ee=ee(q.grupo);return!c||me.includes(Y)||xe.includes(Y)||Ee.includes(Y)})},[c]),M=reactExports.useMemo(()=>{const Y={};return x.forEach(q=>{Y[q.grupo]||(Y[q.grupo]={}),Y[q.grupo][q.sector]||(Y[q.grupo][q.sector]=[]),Y[q.grupo][q.sector].push(q)}),Object.keys(Y).sort((q,me)=>q.localeCompare(me,"es",{sensitivity:"base"})).reduce((q,me)=>{const xe=Y[me],Ee=Object.keys(xe).sort((se,Fe)=>se.localeCompare(Fe,"es",{sensitivity:"base"})).reduce((se,Fe)=>(se[Fe]=[...xe[Fe]].sort((ue,ae)=>ue.cod.localeCompare(ae.cod,"es",{sensitivity:"base"})),se),{});return q[me]=Ee,q},{})},[x]),T=Y=>{f(h===Y?null:Y),E({})},O=(Y,q)=>{E(me=>Br(Er({},me),{[Y]:me[Y]===q?null:q}))},R=Y=>Ye(this,null,function*(){try{p(Y),sessionStorage.setItem("selectedFicha",JSON.stringify(Y));const q=`routers/${Y.grupo}/${Y.sector}/${Y.cod}.xlsx`,me=yield fetch(q);if(!me.ok)throw new Error(`No se pudo cargar el archivo: ${q}`);const xe=yield me.arrayBuffer(),Ee=readSync(xe,{type:"array"}),se=Ee.SheetNames.reduce((Fe,ue)=>{const ae=utils.sheet_to_json(Ee.Sheets[ue],{header:1});return Fe[ue]=ae.filter(_e=>_e.some(oe=>oe!=null&&oe!=="")),Fe},{});A(se),sessionStorage.setItem("excelData",JSON.stringify(se)),te(Fe=>Fe+1),a(null),f(null),E({}),t("/Blog"),setTimeout(()=>t("/doc"),200)}catch(q){console.error(q),y.error("No se pudo cargar la ficha seleccionada.")}});return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(AppBar,{position:"fixed",sx:{top:0,bgcolor:"white",borderBottom:"1px solid #ddd",boxShadow:"none",zIndex:1300},children:jsxRuntimeExports.jsx(BottomNavigation,{value:e,onChange:(Y,q)=>{const me=j[q];me.isMenu?a(Y.currentTarget):(r(q),a(null),me.icon.type===HomeIcon?(window.scrollTo({top:0,behavior:"smooth"}),t("/Blog"),f(null),E({})):me.path&&t(me.path))},sx:{bgcolor:"white"},children:j.map((Y,q)=>jsxRuntimeExports.jsx(BottomNavigationAction,{label:Y.label,icon:Y.icon},q))})}),jsxRuntimeExports.jsxs(Menu,{anchorEl:s,open:o,onClose:()=>a(null),PaperProps:{sx:{width:350,maxHeight:"70vh",borderRadius:2,bgcolor:"white",color:"black",border:"1px solid #ddd",boxShadow:"0px 2px 8px rgba(0,0,0,0.1)",p:1}},children:[jsxRuntimeExports.jsx(Box,{sx:{px:2,pb:1},children:jsxRuntimeExports.jsx(TextField,{fullWidth:!0,variant:"outlined",placeholder:"Buscar documento...",value:c,onChange:Y=>u(Y.target.value.toLowerCase()),InputProps:{startAdornment:jsxRuntimeExports.jsx(InputAdornment,{position:"start",children:jsxRuntimeExports.jsx(FilterAltIcon,{sx:{color:"#555"}})}),sx:{color:"black",backgroundColor:"#fafafa",borderRadius:2,"& .MuiOutlinedInput-notchedOutline":{borderColor:"#ccc"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#999"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#1976d2"}}},sx:{mb:2}})}),jsxRuntimeExports.jsx(List,{dense:!0,children:Object.entries(M).map(([Y,q])=>jsxRuntimeExports.jsxs(React.Fragment,{children:[jsxRuntimeExports.jsxs(ListItemButton,{onClick:()=>T(Y),sx:{"&:hover":{backgroundColor:"#f5f5f5"}},children:[h===Y?jsxRuntimeExports.jsx(ArrowDropDownIcon,{sx:{color:"#1976d2",mr:1}}):jsxRuntimeExports.jsx(ArrowRightIcon,{sx:{color:"#555",mr:1}}),jsxRuntimeExports.jsx(ListItemText,{primary:Y.includes("_")?Y.split("_").slice(1).join("_").replaceAll("_"," "):Y,primaryTypographyProps:{style:{color:"#222",fontWeight:500}}})]}),jsxRuntimeExports.jsx(Collapse,{in:h===Y,children:Object.entries(q).map(([me,xe])=>jsxRuntimeExports.jsxs(React.Fragment,{children:[jsxRuntimeExports.jsxs(ListItemButton,{sx:{pl:4,"&:hover":{backgroundColor:"#f5f5f5"}},onClick:()=>O(Y,me),children:[m[Y]===me?jsxRuntimeExports.jsx(ArrowDropDownIcon,{sx:{color:"#2e7d32",mr:1}}):jsxRuntimeExports.jsx(ArrowRightIcon,{sx:{color:"#555",mr:1}}),jsxRuntimeExports.jsx(ListItemText,{primary:me.includes("_")?me.split("_").slice(1).join("_").replaceAll("_"," "):me,primaryTypographyProps:{style:{color:"#333"}}})]}),jsxRuntimeExports.jsx(Collapse,{in:m[Y]===me,children:xe.map(Ee=>jsxRuntimeExports.jsxs(ListItemButton,{sx:{pl:8,"&:hover":{backgroundColor:"#f5f5f5"}},onClick:()=>{a(null),R(Ee)},children:[jsxRuntimeExports.jsx(DescriptionIcon,{sx:{color:"#ed6c02",mr:1}}),jsxRuntimeExports.jsx(ListItemText,{primary:Ee.cod.includes("_")?Ee.cod.split("_").slice(1).join("_").replaceAll("_"," "):Ee.cod,primaryTypographyProps:{style:{color:"#333"}}})]},Ee.cod))})]},me))}),jsxRuntimeExports.jsx(Divider,{sx:{borderColor:"#eee"}})]},Y))})]}),jsxRuntimeExports.jsx(Box,{sx:{position:"fixed",bottom:0,width:"100%",zIndex:100},children:jsxRuntimeExports.jsx(BottomNavigation,{value:n,sx:{bgcolor:"white",borderTop:"1px solid #ddd"},children:ne.map((Y,q)=>jsxRuntimeExports.jsx(BottomNavigationAction,{label:Y.label,icon:Y.icon,onClick:()=>{n===q?i(null):(i(q),t(Y.path))}},Y.label))})})]})}const DoctecEmbed$1=()=>{const[t,e]=reactExports.useState(!0),[r,n]=reactExports.useState(!1),[i,s]=reactExports.useState(!1),a="https://tb.doctec.duckdns.org/";return reactExports.useEffect(()=>{fetch(a,{mode:"no-cors"}).then(()=>{e(!1),n(!1)}).catch(()=>{e(!1),n(!0)});const o=c=>{var u;(u=c.data)!=null&&u.loggedIn&&s(!0)};return window.addEventListener("message",o),()=>window.removeEventListener("message",o)},[]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Card,{sx:{height:"100vh",width:"100%",mt:"0px",position:"relative"},children:jsxRuntimeExports.jsxs(CardContent,{sx:{height:"100%",padding:0,position:"relative"},children:[t&&jsxRuntimeExports.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:10},children:jsxRuntimeExports.jsx(CircularProgress,{color:"inherit",sx:{color:"black"}})}),r&&jsxRuntimeExports.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",textAlign:"center",padding:20},children:[jsxRuntimeExports.jsx(Typography,{variant:"h4",gutterBottom:!0,children:"ðŸ˜µâ€ðŸ’«"}),jsxRuntimeExports.jsx(Typography,{variant:"h6",children:"Â¡Ups! No se pudo cargar el contenido."}),jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"textSecondary",children:"Por favor, verifica tu conexiÃ³n o intenta recargar."})]}),!t&&!r&&jsxRuntimeExports.jsx("iframe",{src:a,title:"Doctec",width:"100%",height:"100%",style:{border:"none"}})]})}),jsxRuntimeExports.jsx(Lt,{})]})},DoctecEmbed=()=>{const[t,e]=reactExports.useState(!0),[r,n]=reactExports.useState(!1),i="https://doctec.duckdns.org/";return reactExports.useEffect(()=>{y.info(jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("strong",{children:"Usuario de prueba:"}),jsxRuntimeExports.jsx("br",{}),"Username: dd@dd.dd",jsxRuntimeExports.jsx("br",{}),"Password: dddddd"]}),{position:"top-right",autoClose:1e4,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),fetch(i,{mode:"no-cors"}).then(()=>{e(!1),n(!1)}).catch(()=>{e(!1),n(!0)})},[]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Card,{sx:{height:"90vh",width:"100%",mt:"64px",position:"relative"},children:jsxRuntimeExports.jsxs(CardContent,{sx:{height:"100%",padding:0,position:"relative"},children:[t&&jsxRuntimeExports.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:10},children:jsxRuntimeExports.jsx(CircularProgress,{color:"inherit",sx:{color:"black"}})}),r&&jsxRuntimeExports.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",textAlign:"center",padding:20},children:[jsxRuntimeExports.jsx(Typography,{variant:"h4",gutterBottom:!0,children:"ðŸ˜µâ€ðŸ’«"}),jsxRuntimeExports.jsx(Typography,{variant:"h6",children:"Â¡Ups! No se pudo cargar el contenido."}),jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"textSecondary",children:"Por favor, verifica tu conexiÃ³n o intenta recargar."})]}),!t&&!r&&jsxRuntimeExports.jsx("iframe",{src:i,title:"Doctec",width:"100%",height:"100%",style:{border:"none"}})]})}),jsxRuntimeExports.jsx(Lt,{})]})},RegisterForm=()=>{const t=useNavigate(),[e,r]=reactExports.useState(""),[n,i]=reactExports.useState(""),[s,a]=reactExports.useState(""),[o,c]=reactExports.useState(!1),[u,h]=reactExports.useState(!1),[f,m]=reactExports.useState(!1),[E,g]=reactExports.useState(null),[p,_]=reactExports.useState(!1),A=H=>Ye(void 0,null,function*(){if(H.preventDefault(),m(!0),g(null),n!==s){g("Las contraseÃ±as no coinciden."),m(!1);return}try{const ne=(yield createUserWithEmailAndPassword(auth,e,n)).user;yield sendEmailVerification(ne),yield signOut(auth),y.success("Revise su correo para verificar su cuenta."),setTimeout(()=>{t("/login")},5e3)}catch(te){console.error("Error:",te.message),g(te.message)}finally{m(!1)}});return jsxRuntimeExports.jsx(Container,{component:"main",maxWidth:"xs",children:jsxRuntimeExports.jsxs(Box,{sx:{maxWidth:400,mx:"auto",mt:10,marginBottom:"1000px"},children:[jsxRuntimeExports.jsx(Typography,{variant:"h5",children:"Registro"}),jsxRuntimeExports.jsxs("form",{onSubmit:A,style:{width:"100%"},children:[jsxRuntimeExports.jsx(TextField,{label:"Email",variant:"outlined",fullWidth:!0,margin:"normal",value:e,onChange:H=>r(H.target.value),required:!0}),jsxRuntimeExports.jsxs(Box,{sx:{position:"relative",mb:2},children:[jsxRuntimeExports.jsx(TextField,{label:"ContraseÃ±a",type:o?"text":"password",variant:"outlined",fullWidth:!0,value:n,onChange:H=>i(H.target.value),required:!0}),jsxRuntimeExports.jsx(IconButton,{onClick:()=>c(H=>!H),sx:{position:"absolute",right:8,top:"50%",transform:"translateY(-50%)"},children:o?jsxRuntimeExports.jsx(VisibilityIcon,{}):jsxRuntimeExports.jsx(VisibilityOffIcon,{})})]}),jsxRuntimeExports.jsxs(Box,{sx:{position:"relative",mb:2},children:[jsxRuntimeExports.jsx(TextField,{label:"Confirmar ContraseÃ±a",type:u?"text":"password",variant:"outlined",fullWidth:!0,value:s,onChange:H=>a(H.target.value),required:!0}),jsxRuntimeExports.jsx(IconButton,{onClick:()=>h(H=>!H),sx:{position:"absolute",right:8,top:"50%",transform:"translateY(-50%)"},children:u?jsxRuntimeExports.jsx(VisibilityIcon,{}):jsxRuntimeExports.jsx(VisibilityOffIcon,{})})]}),jsxRuntimeExports.jsx(FormControlLabel,{control:jsxRuntimeExports.jsx(Checkbox,{checked:p,onChange:H=>_(H.target.checked),color:"primary",required:!0}),label:jsxRuntimeExports.jsxs(Typography,{variant:"body2",children:["Acepto los"," ",jsxRuntimeExports.jsx("a",{href:"/terms",target:"_blank",rel:"noopener noreferrer",children:"TÃ©rminos de Uso"})," ","y la"," ",jsxRuntimeExports.jsx("a",{href:"/privacy",target:"_blank",rel:"noopener noreferrer",children:"PolÃ­tica de Privacidad"}),"."]})}),E&&jsxRuntimeExports.jsx(Typography,{color:"error",children:E}),jsxRuntimeExports.jsx(Button,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",disabled:f,sx:{mt:2},children:f?"Registrando...":"Registrarse"})]}),jsxRuntimeExports.jsx("div",{style:{textAlign:"center",marginTop:16},children:jsxRuntimeExports.jsx(Link,{to:"/login",children:"Ya tengo una cuenta"})})]})})},ForgotPassword=()=>{const[t,e]=reactExports.useState(""),r=useNavigate(),n=s=>{e(s.target.value)},i=s=>Ye(void 0,null,function*(){s.preventDefault();try{const a=getAuth();yield sendPasswordResetEmail(a,t),y.success("Por favor, revise su correo"),setTimeout(()=>{r("/login")},3e3)}catch(a){y.alert("Could not send reset email.")}});return jsxRuntimeExports.jsxs(Box,{className:"pageContainer",sx:{p:3,maxWidth:400,margin:"auto",marginBottom:"1000px"},children:[jsxRuntimeExports.jsx("header",{children:jsxRuntimeExports.jsx(Typography,{variant:"h5",align:"center",gutterBottom:!0,children:"Restaurar contraseÃ±a"})}),jsxRuntimeExports.jsxs("main",{children:[jsxRuntimeExports.jsxs("form",{onSubmit:i,children:[jsxRuntimeExports.jsx(TextField,{type:"email",label:"Email",variant:"outlined",fullWidth:!0,required:!0,value:t,onChange:n,sx:{mb:2}}),jsxRuntimeExports.jsx(Link,{to:"/login",style:{textDecoration:"none"},children:jsxRuntimeExports.jsx(Typography,{variant:"body2",align:"center",sx:{mb:2},children:"Inicia sesiÃ³n"})}),jsxRuntimeExports.jsxs(Box,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[jsxRuntimeExports.jsx(Typography,{variant:"body1",children:"Send Reset Link"}),jsxRuntimeExports.jsx(Button,{type:"submit",variant:"contained",color:"primary",endIcon:jsxRuntimeExports.jsx(ArrowRightIcon$1,{}),children:"Send"})]})]}),jsxRuntimeExports.jsx(Lt,{})]})]})},Redirect=({url:t})=>jsxRuntimeExports.jsx(Navigate,{to:t,replace:!0}),WhatsAppButton=()=>{const t="34600366211",e="Hola, he visto tu blog y ...";return jsxRuntimeExports.jsx(Tooltip,{title:"Chatear por WhatsApp",arrow:!0,placement:"left",children:jsxRuntimeExports.jsx(Fab,{variant:"outlined","aria-label":"whatsapp",sx:{position:"fixed",bottom:100,right:16,zIndex:9999,border:"2px solid #25D366",backgroundColor:"transparent",color:"#25D366","&:hover":{backgroundColor:"rgba(37, 211, 102, 0.1)"}},onClick:()=>window.open(`https://wa.me/${t}?text=${encodeURIComponent(e)}`,"_blank"),children:jsxRuntimeExports.jsx(WhatsAppIcon,{sx:{mt:-.5}})})})},WhatsAppWrapper=()=>{const t=useLocation();return["/login","/sign-up","/forgot-password"].includes(t.pathname.toLowerCase())?null:jsxRuntimeExports.jsx(WhatsAppButton,{})},App=()=>jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",flexDirection:"column",minHeight:"100vh"},children:[jsxRuntimeExports.jsxs(HashRouter,{children:[jsxRuntimeExports.jsx(TopNavBar,{}),jsxRuntimeExports.jsx(Box,{sx:{flex:1},children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/map/:lat/:lng",element:jsxRuntimeExports.jsx(MapaModal,{})}),jsxRuntimeExports.jsx(Route,{path:"/user/*",element:jsxRuntimeExports.jsx(Redirect,{url:"/"})}),jsxRuntimeExports.jsx(Route,{path:"/login",element:jsxRuntimeExports.jsx(DoctecEmbed$1,{})}),jsxRuntimeExports.jsx(Route,{path:"/sign-up",element:jsxRuntimeExports.jsx(RegisterForm,{})}),jsxRuntimeExports.jsx(Route,{path:"/forgot-password",element:jsxRuntimeExports.jsx(ForgotPassword,{})}),jsxRuntimeExports.jsx(Route,{path:"/terms",element:jsxRuntimeExports.jsx(HomePage$4,{})}),jsxRuntimeExports.jsx(Route,{path:"/privacy",element:jsxRuntimeExports.jsx(HomePage$5,{})}),jsxRuntimeExports.jsx(Route,{path:"/home",element:jsxRuntimeExports.jsx(HomePage$6,{})}),jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(NavigationBarDocs,{})}),jsxRuntimeExports.jsx(Route,{path:"/Blog",element:jsxRuntimeExports.jsx(NavigationBarDocs,{})}),jsxRuntimeExports.jsx(Route,{path:"/ayuda",element:jsxRuntimeExports.jsx(HomePage$1,{})}),jsxRuntimeExports.jsx(Route,{path:"/servicios",element:jsxRuntimeExports.jsx(HomePage$2,{})}),jsxRuntimeExports.jsx(Route,{path:"/contacto",element:jsxRuntimeExports.jsx(HomePage$3,{})}),jsxRuntimeExports.jsx(Route,{path:"/terminos",element:jsxRuntimeExports.jsx(HomePage$4,{})}),jsxRuntimeExports.jsx(Route,{path:"/privacidad",element:jsxRuntimeExports.jsx(HomePage$5,{})}),jsxRuntimeExports.jsx(Route,{path:"/sobre",element:jsxRuntimeExports.jsx(HomePage,{})}),jsxRuntimeExports.jsx(Route,{path:"/contacto",element:jsxRuntimeExports.jsx(HomePage$3,{})}),jsxRuntimeExports.jsx(Route,{path:"/doc",element:jsxRuntimeExports.jsx(Doc,{})}),jsxRuntimeExports.jsx(Route,{path:"/thingsboard",element:jsxRuntimeExports.jsx(DoctecEmbed$1,{})}),jsxRuntimeExports.jsx(Route,{path:"/paperless",element:jsxRuntimeExports.jsx(DoctecEmbed,{})})]})}),jsxRuntimeExports.jsx(WhatsAppWrapper,{})]}),jsxRuntimeExports.jsx(CookieConsent,{})]});clientExports.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(App,{}));
